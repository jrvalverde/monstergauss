                                                                       
                                                                       
                                                                       
                                                                       
                                                                       
                                                                       
                                                                       
                                                                       
             M   M   OOO   N   N   SSS   TTTTT  EEEEE  RRRR            
             MM MM  O   O  NN  N  S   S    T    E      R   R           
             M M M  O   O  N N N  S        T    E      R   R           
             M M M  O   O  N N N   SSS     T    EEEEE  RRRR            
             M   M  O   O  N N N      S    T    E      R R             
             M   M  O   O  N  NN  S   S    T    E      R  R            
             M   M   OOO   N   N   SSS     T    EEEEE  R   R           
                                                                       
                                                                       
                                                                       
                    GGG     A    U   U   SSS    SSS                    
                   G   G   A A   U   U  S   S  S   S                   
                   G      A   A  U   U  S      S                       
                   G GGG  AAAAA  U   U   SSS    SSS                    
                   G   G  A   A  U   U      S      S                   
                   G   G  A   A  U   U  S   S  S   S                   
                    GGG   A   A   UUU    SSS    SSS                    
1
                                                                       
                                                                       
                                                                       
                                CONTENTS                               
                                ********                               
                                                                       
                                                                       
0CHAPTER 1: GENERAL DESCRIPTION ........................................1
0CHAPTER 2: ROUTE GENERATION ..........................................17
0CHAPTER 3: IBM JCL AND DISK FILE USAGE ...............................30
0CHAPTER 4: GEOMETRY INPUT ............................................34
0CHAPTER 5: BASIS SETS ................................................61
0CHAPTER 6: INITIAL GUESS .............................................76
0CHAPTER 7: SCF OPTIONS ...............................................86
0CHAPTER 8: MULLIKEN POPULATION ANALYSIS ..............................92
0CHAPTER 9: PERTURBATIONAL MOLECULAR ORBITAL ANALYSIS .................96
0CHAPTER 10: ENERGY DECOMPOSITION / BSSE .............................101
0CHAPTER 11: OPTIMIZATION METHODS ....................................105
0CHAPTER 12: LOCALIZED ORBITALS ......................................117
0CHAPTER 13: ONE ELECTRON PROPERTIES .................................119
0CHAPTER 14: CONFIGURATION INTERACTION ...............................125
0CHAPTER 15: ONE ELECTRON PROPERTY TRANSFORMATION ....................129
1                                                                          
 1                                                                         
                                                                           
                                                                           
                                                                           
 CHAPTER 1: GENERAL DESCRIPTION.                                           
 **********                                                                
                                                                           
     ******************************************************************    
                                                                           
     MONSTERGAUSS ... A SERIES OF PROGRAMS DESIGNED TO PERFORM AB          
                      INITIO SELF-CONSISTENT FIELD MOLECULAR               
                      ORBITAL CALCULATIONS ON ORGANIC MOLECULES.           
                                                                           
     ******************************************************************    
                                                                           
     THIS PROGRAM IS BASED AROUND PARTS OF POPLE'S GAUSSIAN 82             
     (SPECIFICALLY THE INTEGRAL AND DERIVATIVE ROUTINES),                  
     AND FEATURES ANALYTIC GRADIENT OPTIMIZATION OF GEOMETRIES,            
     PLUS VARIOUS OTHER OPTIONS SUCH AS RESTRICTED HARTREE-FOCK OPEN       
     SHELL SCF, PAIR-WISE MC-SCF, BOYS LOCALIZATION, ONE ELECTRON          
     PROPERTIES, QUANTITATIVE PMO ANALYSIS, A DIRECT CI AND                
     THE MOROKUMA ENERGY DECOMPOSITION.                                    
                                                                           
     MONSTERGAUSS HAS BEEN DESIGNED TO BE COMPATIBLE, WITH MINIMAL         
     CHANGES, WITH IBM AND CDC MAINFRAMES, GOULD MINICOMPUTERS,            
     THE DEC VAX MINICOMPUTERS, AND ALL UNIX-BASED SYSTEMS.                
                                                                           
     VERSION: 13 AUGUST 1991.                                              
                                                                           
     AUTHORS:                                                              
                                                                           
     MIKE PETERSON,                                                        
     DEPARTMENT OF CHEMISTRY,                                              
     UNIVERSITY OF TORONTO,                                                
     80 ST. GEORGE STREET,                                                 
     TORONTO, ONTARIO, CANADA  M5S 1A1.                                    
     TELEPHONE: (416) 978-7094.                                            
                                                                           
     RAY POIRIER,                                                          
     DEPARTMENT OF CHEMISTRY,                                              
     MEMORIAL UNIVERSITY OF NEWFOUNDLAND,                                  
     ELIZABETH AVENUE,                                                     
     ST. JOHN'S, NEWFOUNDLAND, CANADA  A1B 3X7.                            
     TELEPHONE: (709) 737-8609.                                            
1                                                                          
                          GENERAL DESCRIPTION                             2
                                                                           
                                                                           
                                                                           
     CONTROL INPUT ... SPECIFICATION OF THE TYPE OF CALCULATION.           
                                                                           
     THERE ARE 5 CONTROL CARDS (*MOL, *PRT, *PUN, *IOP AND *CON)           
     WHICH MAY BE USED, BUT ONLY THE *MOL CARD IS REQUIRED. THE            
     KEYWORD OCCUPIES COLUMNS 1-4 AND ARE READ IN THE FOLLOWING ORDER:     
                                                                           
     *MOL ... THIS CARD MARKS THE START OF A NEW CALCULATION, AND MAY      
              CONTAIN SEVERAL PROGRAM OPTIONS IN COLUMNS 5-72.             
                                                                           
     *PRT ... THIS CARD SPECIFIES SOME OF THE PRINT OPTIONS.               
                                                                           
     *PUN ... THIS CARD SPECIFIES SOME OF THE PUNCH OPTIONS.               
                                                                           
     *IOP ... SETTING OF SPECIFIC IOP'S.                                   
                                                                           
     *CON ... READ A SET OF CONVERSION FACTORS FOR THIS CALCULATION.       
                                                                           
     GENERAL RULES.                                                        
                                                                           
     1  THE CODE WORD OCCUPIES COLUMNS 1-4, AND THE PARAMETERS (IF ANY)    
     MAY APPEAR ANYWHERE IN COLUMNS 5-72.                                  
                                                                           
     2  THE PARAMETERS MAY BE ABBREVIATED TO THEIR 1 (*PRT, AND *PUN       
     CARDS) OR 2 (*MOL CARDS) LETTER CODES - GENERALLY THE FIRST (2)       
     LETTER(S) FOR ONE WORD OPTIONS, OR THE FIRST LETTER OF EACH WORD      
     FOR TWO WORD OPTIONS. SUBPARAMETERS FOLLOW AN = SIGN, AND             
     GENERALLY MAY BE ABBREVIATED TO ONE LETTER.                           
                                                                           
     3  SEPARATE OPTIONS WITH A COMMA. BLANKS MAY BE INSERTED ANYWHERE     
     ON THE CONTROL CARDS. THE OPTIONS MAY APPEAR IN ANY ORDER.            
                                                                           
     4  THE PROGRAM WILL CONVERT LOWER CASE TO UPPER CASE                  
     AUTOMATICALLY WHERE NECESSARY.                                        
                                                                           
1                                                                          
 3                        GENERAL DESCRIPTION                              
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     *MOL CARD DETAILS.                                                    
     ******************************************************************    
                                                                           
     THE OPTIONS AVAILABLE WILL BE BROKEN INTO THE ROUGH                   
     CLASSIFICATIONS OF GENERAL, GEOMETRY, BASIS SET, INITIAL GUESS,       
     SCF, OPTIMIZATION AND PROPERTIES. THE MINIMUM ABBREVIATON             
     FOLLOWS EACH KEYWORD IN PARENTHESES.                                  
                                                                           
     GENERAL.                                                              
                                                                           
     CHECK(CH) ... THIS IS A CHECK RUN - THE GEOMETRY, BASIS SET,          
     VARIATION CARDS FOR OPTIMIZATION, ETC ARE READ IN, AND                
     PRINTED - NO ACTUAL CALCULATION OF INTEGRALS ETC IS PERFORMED.        
     SPECIFYING THE SUBPARAMETER CH=IGUESS(I) CAUSES THE INITIAL           
     GUESS TO BE PERFORMED AND PRINTED ON THE CHECK RUN - FOR              
     PROJECTIONS FROM COEFFICIENT OR DENSITY MATRICES ALREADY ON           
     DISK, ANY FURTHER CH=I RUNS AND THE ACTUAL RUN SHOULD USE             
     GUESS=NONE (SEE BELOW).                                               
     BE CAREFUL THAT OPTIONS SET BY *IOP CARDS (SEE BELOW) WILL NOT        
     CAUSE PROBLEMS ON CHECK JOBS.                                         
     THE ONLY CARDS NOT CHECKED ARE PMO/LMO CARDS FOR THE                  
     SECOND AND SUBSEQUENT POINTS OF SURFACE SCANS.                        
                                                                           
     GEOMETRY INPUT - DETAILS IN LINKS 0201 AND 0202.                      
                                                                           
     GEOM(GE) ... THE METHOD OF GEOMETRY INPUT IS SPECIFIED AS A           
     SUBPARAMETER (THE DEFAULT IS FREE FORMAT Z MATRIX INPUT):             
     GE=ZMAT(Z) ... FIXED FORMAT Z MATRIX INPUT.                           
     GE=ANG(A) ... DIRECT COORDINATE INPUT IN ANGSTROMS.                   
     GE=BOHR(B) ... DIRECT COORDINATE INPUT IN BOHR (ATOMIC UNITS).        
     GE=STDGEOM(S) ... USE STANDARD GEOMETRY - SEE LINK 0201.              
                                                                           
     AMASS(AM) ... ATOMIC MASS SELECTION. THE DEFAULT IS TO SELECT         
     THE MASS NUMBER FOR THE MOST ABUNDANT ISOTOPE. OTHER POSSIBILITIES    
     MAY BE SELECTED BY A SUBPARAMETER:                                    
     AM=AVERAGE(A) ... USE ABUNDANCE AVERAGED ATOMIC WEIGHTS.              
     AM=ISOTOPIC(I) ... USE MASS NUMBER FOR MOST ABUNDANT ISOTOPE          
     (THIS IS THE DEFAULT IF THE AM OPTION IS NOT SPECIFIED).              
     AM=READ(R) ... SET THE MASS NUMBERS FOR THE MOST ABUNDANT             
     ISOTOPE FOR EACH ATOM, THEN READ CHANGES.                             
     AM=DUMP(D) ... DUMP THE CONTENTS OF THE ISOTOPIC MASS TABLES.         
     NOTE: IF AM IS SPECIFIED, A SUBPARAMETER MUST BE SPECIFIED.           
                                                                           
     SSCAN(SS) ... SURFACE SCAN. THE DEFAULT IS TO SCAN OVER A SET OF      
     GEOMETRICAL PARAMETERS, BUT A SET OF EXTERNAL ELECTRIC FIELDS         
     MAY ALSO BE SCANNED BY SPECIFYING A SUBPARAMETER:                     
     SS=FIELD(F) ... SCAN OVER ELECTRIC FIELD VALUES INSTEAD OF            
     GEOMETRIES.                                                           
                                                                           
     BASIS SET SPECIFICATION AND INTEGRAL EVALUATION - FOR DETAILS SEE     
     LINKS 0301-0311.                                                      
                                                                           
     BASIS(BA) ... THE BASIS TYPE IS GIVEN BY A SUBPARAMETER AS IN         
     BASIS=TN, TN*, TN**, TN+ OR TN++ WHERE T IS THE BASIS TYPE            
     (ONE OF M, V, E, P, C OR G).                                          
     N IS USED TO SELECT THE ACTUAL BASIS SET FOR EACH TYPE:               
     MN GIVES THE STO-NG MINIMAL BASIS SET,                                
1                                                                          
                          GENERAL DESCRIPTION                             4
                                                                           
                                                                           
                                                                           
     VN GIVES THE SPLIT VALENCE N-21G BASIS SET,                           
     EN GIVES THE EXTENDED N-31G BASIS SET,                                
     PN GIVES THE N-21G BASIS SET DEVISED BY PULAY AND CO-WORKERS,         
     CN GIVES THE N-311G BASIS SET DESIGNED FOR POST-SCF CALCULATIONS,     
     G GIVES A GENERAL BASIS SET WHICH IS READ FROM CARDS (N MAY NOT       
     BE USED).                                                             
     THE DEFAULT BASIS SET IS STO-3G (M3).                                 
     IF T IS SPECIFIED, N MUST ALSO BE GIVEN IF T IS NOT G.                
                                                                           
     THE *'S INDICATE THE PRESENCE OF POLARIZATION FUNCTIONS:              
     FOR BASIS M, ONLY MN* IS PERMITTED AND D ORBITALS WILL BE ADDED       
     TO THE ATOMS NA-AR.                                                   
     FOR BASIS V, THE FIRST * ADDS D ORBITALS TO THE ATOMS                 
     NA-XE (NOTE THAT THE DEFAULT POLARIZED BASIS DOES NOT PUT             
     POLARIZATION FUNCTIONS ON H/HE, OR LI-NE).                            
     FOR BASES E AND C, THE FIRST * ADDS D ORBITALS TO THE ATOMS           
     LI-XE, WHILE THE SECOND * PUTS P ORBITALS ON H/HE.                    
                                                                           
     THE +'S INDICATE THE PRESENCE OF DIFFUSE FUNCTIONS:                   
     FOR BASIS M, NO DIFFUSE FUNCTIONS MAKE ANY SENSE, SO NO MN+           
     BASIS SETS ARE AVAILABLE.                                             
     FOR BASES V, E AND C, THE FIRST + ADDS DIFFUSE SP ORBITALS TO THE     
     ATOMS LI-XE, WHILE THE SECOND + PUTS DIFFUSE S ORBITALS ON H/HE.      
     FOR BASIS G, G* INDICATES THAT THE BASIS CONTAINS D/F ORBITALS.       
     IF '*' OR '+' IS INCLUDED IN THE BASIS SET DESCRIPTOR, 70             
     ITERATIONS ARE ALLOWED FOR THE FIRST SCF.                             
                                                                           
     DF ... THE BASIS SET CONTAINS D OR F ORBITALS. THIS OPTION IS         
     NOT REQUIRED FOR MN*, EN*(*) OR G* BASIS SETS, BUT IS REQUIRED        
     IF ATOMS PAST CALCIUM ARE USED FOR MN OR VN BASES. A SUBPARAMETER     
     MAY BE USED TO INDICATE THE TYPE OF D/F FUNCTIONS TO BE USED:         
     DF=CARTESIAN(C) WILL USE CARTESIAN D/F (6D/10F) FUNCTIONS,            
     WHILE DF=PURE(P) USES PURE D/F (5D/7F) FUNCTIONS. THE                 
     DEFAULT IS P FOR ALL BASES EXCEPT FOR VN*, VN**, EN* AND EN**,        
     WHICH USE CARTESIAN D/F (6D/10F) FUNCTIONS.                           
     THE BASIS FUNCTION ORDER (WITH THE CORRESPONDING PRINT SYMBOL IN      
     PARENTHESES) IS XX, YY, ZZ, XY, XZ AND YZ FOR 6D; 2ZZ-XX-YY (D0),     
     XZ (D1+), YZ (D1-), XX-YY (D2+) AND XY (D2-) FOR 5D. FOR 10F, THE     
     ORDER IS XXX, YYY, ZZZ, XYY, XXY, XXZ, XZZ, YZZ, YYZ AND XYZ; FOR     
     7F IT IS ZZZ-XXZ-YYZ (F0), XZZ-XXX-XYY (F1+), YZZ-YYY-XXY (F1-),      
     XXZ-YYZ (F2+), XYZ (F2-), XXX-XYY (F3+) AND XXY-YYY (F3-).            
                                                                           
     1POLARIZE(1P) ... PUT P POLARIZATION FUNCTIONS ON ROW 1 (H-HE).       
     SUBPARAMETER:                                                         
     1P=YES(Y) ... YES.                                                    
     1P=NO(N) ... NO.                                                      
                                                                           
     2POLARIZE(2P) ... PUT D POLARIZATION FUNCTIONS ON ROW 2 (LI-NE).      
     SUBPARAMETER:                                                         
     2P=YES(Y) ... YES.                                                    
     2P=NO(N) ... NO.                                                      
                                                                           
     3POLARIZE(3P) ... PUT D POLARIZATION FUNCTIONS ON ROW 3 (NA-AR).      
     SUBPARAMETER:                                                         
     3P=YES(Y) ... YES.                                                    
     3P=NO(N) ... NO.                                                      
                                                                           
1                                                                          
 5                        GENERAL DESCRIPTION                              
                                                                           
                                                                           
                                                                           
     4POLARIZE(4P) ... PUT D POLARIZATION FUNCTIONS ON ROW 4 (K-KR).       
     SUBPARAMETER:                                                         
     4P=YES(Y) ... YES.                                                    
     4P=NO(N) ... NO.                                                      
                                                                           
     5POLARIZE(5P) ... PUT D POLARIZATION FUNCTIONS ON ROW 5 (RB-XE).      
     SUBPARAMETER:                                                         
     5P=YES(Y) ... YES.                                                    
     5P=NO(N) ... NO.                                                      
                                                                           
     NOTE: FOR OPTIONS 1P THROUGH 5P TO BE RECOGNIZED, EITHER '*'          
     MUST HAVE BEEN SPECIFIED WITH THE BA OPTION, OR THE DF OPTION         
     WAS SPECIFIED. THERE ARE NO DEFAULTS FOR ANY OF THE OPTIONS,          
     SO A SUBPARAMETER MUST ALWAYS BE GIVEN.                               
                                                                           
     1DIFFUSE(1D) ... PUT S DIFFUSE FUNCTIONS ON ROW 1 (H-HE).             
     SUBPARAMETER:                                                         
     1D=YES(Y) ... YES.                                                    
     1D=NO(N) ... NO.                                                      
                                                                           
     2DIFFUSE(2D) ... PUT P DIFFUSE FUNCTIONS ON ROW 2 (LI-NE).            
     SUBPARAMETER:                                                         
     2D=YES(Y) ... YES.                                                    
     2D=NO(N) ... NO.                                                      
                                                                           
     3DIFFUSE(3D) ... PUT P DIFFUSE FUNCTIONS ON ROW 3 (NA-AR).            
     SUBPARAMETER:                                                         
     3D=YES(Y) ... YES.                                                    
     3D=NO(N) ... NO.                                                      
                                                                           
     4DIFFUSE(4D) ... PUT P DIFFUSE FUNCTIONS ON ROW 4 (K-KR).             
     SUBPARAMETER:                                                         
     4D=YES(Y) ... YES.                                                    
     4D=NO(N) ... NO.                                                      
                                                                           
     5DIFFUSE(5D) ... PUT P DIFFUSE FUNCTIONS ON ROW 5 (RB-XE).            
     SUBPARAMETER:                                                         
     5D=YES(Y) ... YES.                                                    
     5D=NO(N) ... NO.                                                      
                                                                           
     NOTE: FOR OPTIONS 1D THROUGH 5D TO BE RECOGNIZED, '+'                 
     MUST HAVE BEEN SPECIFIED WITH THE BA OPTION.                          
     THERE ARE NO DEFAULTS FOR ANY OF THE OPTIONS,                         
     SO A SUBPARAMETER MUST ALWAYS BE GIVEN.                               
     TO USE A BASIS SET WITH BOTH POLARIZATION AND DIFFUSE FUNCTIONS,      
     USE BASIS=TN+ (OR BASIS=TN++ IF DESIRED) AND DF; THEN ALL THE         
     POLARIZATION/DIFFUSE CONTROL OPTIONS 1POL-5POL AND 1DIF-5DIF          
     ARE AVAILABLE TO CUSTOMIZE THE BASIS SET.                             
                                                                           
     INITIAL GUESS - SEE LINK 0402 FOR DETAILS.                            
                                                                           
     GUESS(GU) ... THE TYPE OF INITIAL GUESS IS GIVEN BY A                 
     SUBPARAMETER:                                                         
     GU=EH(E) ... EXTENDED HUCKEL GUESS (USE ONLY FOR THE INTERNAL         
     BASIS SET TYPE M).                                                    
     GU=PH(P) ... PROJECTED HUCKEL GUESS FROM STO-3G TO BASIS USED.        
     GU=HDIAG(H) ... DIAGONALIZE THE CORE HAMILTONIAN MATRIX.              
     GU=DIN(D) ... READ DENSITY MATRIX.                                    
1                                                                          
                          GENERAL DESCRIPTION                             6
                                                                           
                                                                           
                                                                           
     GU=CIN(C) ... READ COEFFICIENT MATRIX.                                
     GU=STO3G(S) ... READ THE STO-3G COEFFICIENT MATRIX AND PROJECT        
     THOSE COEFFICIENTS TO THE ACTUAL BASIS USED.                          
     GU=V321G(V) ... READ THE 3-21G COEFFICIENT MATRIX AND PROJECT         
     THOSE COEFFICIENTS TO THE ACTUAL BASIS USED.                          
     GU=GENERAL(G) ... READ THE GENERAL BASIS COEFFICIENT MATRIX AND       
     PROJECT THOSE COEFFICIENTS TO THE ACTUAL BASIS USED.                  
     GU=NONE(N) ... NO INITIAL GUESS - ALREADY ON DISK FROM A PREVIOUS     
     CALCULATION.                                                          
     THE DEFAULT IS AN EXTENDED HUCKEL GUESS FOR THE STO-NG BASES          
     (TYPE M), AND A PROJECTED HUCKEL GUESS FOR THE OTHER INTERNAL         
     BASES (TYPES V, E, P AND C) AND GENERAL BASES.                        
     FOR PROJECTED GUESSES, THE BASIS SET PROJECTED FROM IS ALWAYS         
     ASSUMED TO BE DF=P (5D, NOT 6D).                                      
     NOTE: IF ANY MATRICES ARE READ IN, THEY WILL BE READ FROM             
     LOGICAL FILE CODE 1 (IBM UNIT FT01F001), NOT THE REGULAR              
     INPUT STREAM (LOGICAL FILE CODE 5, IBM UNIT FT05F001).                
                                                                           
     ACONFIG(AC) ... ALTERATION OF CONFIGURATION. THIS OPTION ALLOWS       
     THE USER TO CHANGE THE OCCUPANCY SCHEME OF THE INITIAL GUESS MO -     
     SEE LINK 0402 FOR DETAILS.  THE INITIAL GUESS COEFFICIENTS ARE        
     ALSO PRINTED AUTOMATICALLY UNLESS THE I=N OPTION IS USED ON THE       
     *PRT CARD. THIS OPTION IS NOT POSSIBLE FOR RHF RUNS.                  
                                                                           
     SCF EQUATIONS - SEE LINKS 0501, 0502 AND 0503 FOR DETAILS.            
     THE DEFAULT IS CLOSED SHELL RHF.                                      
                                                                           
     UHF(UH) ... USE UHF OPEN SHELL (SPIN-UNRESTRICTED SCF).               
                                                                           
     RHF(RH) ... USE RHF OPEN SHELL / PAIR EXCITATION MC-SCF.              
     A SUBPARAMETER ALLOWS THE SPECIFICATION OF A CONVERGENCE OPTION:      
     RH=RESET(R) ... RESET AN INTERNAL SCALE FACTOR BEFORE EVERY CYCLE     
     OF THE SCF. THIS MAY CAUSE NON-CONVERGENCE IN SOME CASES,             
     ESPECIALLY LARGE BASIS SETS, BUT IS USUALLY THE FASTEST MODE          
     OF OPERATION. THIS IS THE DEFAULT MODE (NO SUBPARAMETER GIVEN).       
     RH=NORESET(N) ... TURN OFF THE RESET SWITCH - THIS MAY                
     HELP OR HINDER CONVERGENCE, SO GOOD LUCK. IF THE SCF CONVERGES        
     IN NORESET MODE, IT IS RESTARTED IN RESET MODE TO ENSURE THE          
     COEFFICIENTS ARE REALLY CONVERGED.                                    
     RH=INCREMENT(I) ... USE NORESET MODE UNTIL THE DENSITY                
     CONVERGES WITHIN A CERTAIN VALUE, THEN START INCREMENTING THE         
     SCALE FACTOR FOR SUCCESSIVE SCF ITERATIONS.                           
     RH=OMIT(O) ... SIMPLY OMIT COEFFICIENT CHANGES THAT ARE TOO           
     LARGE, AND PRINT A MESSAGE.                                           
     SUBSEQUENT RHF'S (FOR OPTIMIZATION OR SURFACE SCAN RUNS) ALWAYS       
     USE THE DEFAULT MODE (RESET MODE).                                    
     SEE LINK 0401 FOR DETAILS OF THE RHF INPUT REQUIRED.                  
                                                                           
     CONV(CO) ... THE CONVERGENCE OPTIONS DESIRED ARE SPECIFIED BY A       
     MAXIMUM OF 2 ONE LETTER SUBPARAMETERS:                                
     CO=I ... I REPRESENTS ONE OF THE NUMBERS 5 THROUGH 9 INCLUSIVE,       
     AND SETS THE DENSITY CONVERGENCE TO 10**(-I). THE DEFAULT             
     CONVERGENCE IS 10**(-9) FOR CLOSED SHELL OR UHF SCF,                  
     AND 10**(-6) FOR THE RHF SCF.                                         
     CO=M ... ALLOW 190 SCF ITERATIONS (THE MAXIMUM NUMBER).               
     CO=C ... ALLOW 190 SCF ITERATIONS, AND CONTINUE THE RUN               
     EVEN IF THE SCF IS STILL NOT CONVERGED PROVIDED THE ENERGY CHANGE     
     BETWEEN SUCCESSIVE ITERATIONS IS LESS THAN 10**(-6) HARTREES.         
1                                                                          
 7                        GENERAL DESCRIPTION                              
                                                                           
                                                                           
                                                                           
     CO=D ... USE THE DEWAR EXTRAPOLATION TECHNIQUE.                       
     CO=N ... NO SCF EXTRAPOLATION.                                        
     NOTE: TWO SUBPARAMETERS MAY BE SPECIFIED BY COMBINING THE ONE         
     LETTER CODES: CO=D6, CO=8N, CO=CN FOR EXAMPLE. THE COMBINATIONS       
     CO=CM, CO=DN AND CO=IJ (WHERE I AND J ARE 5, 6, 7, 8, OR 9) ARE       
     ILLEGAL.                                                              
                                                                           
     OPTIMIZATION - SEE LINKS 0202, 0301 AND 0701-0711 FOR DETAILS.        
                                                                           
     GOPT(GO) ... OPTIMIZE THE GEOMETRY. THE USE OF INTERNAL               
     COORDINATES IS THE DEFAULT. THE SUBPARAMETER GO=CC(C) INDICATES       
     THE USE OF CARTESIAN COORDINATES (NOT RECOMMENDED) - THIS IS          
     AUTOMATICALLY FORCED IF THE GEOMETRY IS INPUT IN ANGSTROMS OR         
     BOHR. FOR FREE FORMAT Z MATRIX RUNS USING SIMULTANEOUS                
     OPTIMIZATION METHODS (IE. NOT METHOD=Z), THE DEFAULT IS TO            
     OPTIMIZE ONLY THE Z MATRIX PARAMETERS SPECIFIED AS VARIABLES,         
     FIXING THOSE SUPPLIED AS CONSTANTS. THE SUBPARAMETER GO=READ(R)       
     WILL READ THE OPTIMIZATON CONSTRAINTS FROM CARDS WHEN THE FREE        
     FORMAT Z MATRIX GEOMETRY INPUT IS USED. NOTE THAT IF NO               
     VARIABLES ARE USED, OR THE FIXED FORMAT IS USED, OR THE STANDARD      
     GEOMETRY IS USED, THE CONSTRAINT CARDS MUST BE SUPPLIED.              
     VARIATION CARDS MUST ALWAYS BE SUPPLIED FOR THE Z MATRIX              
     OPTIMIZATION METHOD.                                                  
     FOR FORCE OPTIMIZATIONS, THE BASIS SET FORCE IS NOT CALCULATED        
     UNLESS BOPT IS ALSO SPECIFIED.                                        
                                                                           
     BOPT(BO) ... OPTIMIZE THE BASIS SET.                                  
                                                                           
     METHOD(ME) ... THE OPTIMIZATION METHOD IS GIVEN BY A                  
     SUBPARAMETER:                                                         
     ME=BFGS(B) ... BFGS OPTIMIZATION WITH THE GRADIENT.                   
     ME=OC(O) ... OPTIMALLY CONDITIONED OPTIMIZATION WITH THE GRADIENT.    
     THIS IS THE DEFAULT OPTIMIZATION METHOD IF THE ME= OPTION IS NOT      
     SPECIFIED.                                                            
     ME=VA05(V) ... SOLUTION OF THE GRADIENT EQUATIONS USING THE           
     VA05AD ROUTINE.                                                       
     ME=DOC(D) ... OPTIMALLY CONDITIONED OPTIMIZATION WITHOUT THE          
     GRADIENT (DERIVATIVE-FREE).                                           
     ME=ZM(Z) ... DERIVATIVE-FREE METHOD OF OPTIMIZING THE Z MATRIX        
     PARAMETERS FROM GAUSSIAN 70 USING PARABOLIC INTERPOLATION.            
                                                                           
     RING(RI) ... THE STRUCTURE TO BE OPTIMIZED CONTAINS A RING. SINCE     
     THE PRESENCE OF A RING IMPOSES SEVERE CONSTRAINTS ON THE BOND         
     LENGTHS, BOND ANGLES AND DIHEDRAL ANGLES THAT ARE PHYSICALLY          
     REASONABLE, THIS OPTION CAUSES THE FOLLOWING CHANGES IN THE           
     OPTIMIZATION ROUTINES TO HELP SUCH STRUCTURES BE OPTIMIZED            
     SUCCESSFULLY:                                                         
     THE BOND STRETCH FORCE CONSTANT GUESSES ARE SET TO AT LEAST 7.5,      
     THE BOND ANGLE AND DIHEDRAL ANGLE INITIAL FORCE CONSTANT              
     GUESSES ARE CHANGED TO 5.0 (FROM 1.0 AND 0.5 RESPECTIVELY),           
     THE OC OPTIMIZATION METHOD EXTRAPOLATION LIMIT IS CHANGED TO          
     3.0 (FROM 10.0),                                                      
     AND THE VA05 OPTIMIZATION METHOD STEP SIZE (DSTEP) IS CHANGED TO      
     0.01 (FROM 0.02).                                                     
                                                                           
     RESTART(RE) ... RESTART OF A FORCE OPTIMIZATION. FOR GOPT RUNS,       
     THE ORIGINAL STARTING GEOMETRY IS READ IN AS USUAL, THEN UPDATED      
     BY THE VALUES SAVED IN FILE 1 OF UNIT IMAT - THIS UNIT MUST HAVE      
1                                                                          
                          GENERAL DESCRIPTION                             8
                                                                           
                                                                           
                                                                           
     BEEN SAVED TO USE THIS OPTION SUCCESSFULLY. FOR BOPT RUNS, THE        
     BASIS SET IS READ IN AS USUAL, THEN UPDATED BY THE VALUES IN THE      
     BASIS SET FILES OF UNIT IMAT - THIS UNIT MUST HAVE BEEN SAVED TO      
     USE THIS OPTION SUCCESSFULLY.                                         
     GUESS=NONE CAN BE SPECIFIED TO RE-USE THE PREVIOUS COEFFICIENT /      
     DENSITY MATRICES. NOTE THAT THE GEOMETRY AND/OR BASIS SET             
     VARIATION CARDS ARE NOT READ AGAIN, BUT THE OPTIMIZATION CONTROL      
     CARDS ARE READ AGAIN.                                                 
     GUESS=NONE IS ALWAYS ASSUMED FOR BOPT RESTARTS.                       
     RE=GEOMETRY(G) ... FOR OTHER THAN FORCE OPTIMIZATION RUNS, THE        
     ORIGINAL GEOMETRY IS READ IN AS USUAL, THEN JUST THE GEOMETRY         
     IS UPDATED FROM UNIT IMAT - THIS UNIT MUST HAVE BEEN SAVED TO         
     USE THIS OPTION SUCCESSFULLY. BE CAREFUL ON CHECK RUNS WHERE          
     THE RESTART FILE MAY NOT HAVE BEEN CREATED YET, FOR EXAMPLE IN        
     A PREVIOUS STEP OF THE SAME JOB.                                      
     RE=BASIS(B) ... FOR OTHER THAN FORCE OPTIMIZATION RUNS, THE           
     BASIS SET IS READ IN AS USUAL, THEN UPDATED BY THE VALUES IN THE      
     BASIS SET FILES OF UNIT IMAT - THIS UNIT MUST HAVE BEEN SAVED TO      
     USE THIS OPTION SUCCESSFULLY.                                         
                                                                           
     NPRINT(NP) ... NO PRINT OPTION FOR Z MATRIX OPTIMIZATION (ME=Z)       
     RUNS - MOST INTERMEDIATE PRINTING IS TURNED OFF, BUT THE FIRST        
     AND LAST POINTS ARE PRINTED FULLY.                                    
                                                                           
     PROPERTIES - SEE LINKS 0508, 0601, 0602, 0801-0803 AND 0901-0907.     
     NOTE: LMO, SIZE AND OEP SHOULD NOT BE USED WITH THE RHF SCF,          
     EXCEPT FOR THE SPECIAL CASES DETAILED IN LINK 0401.                   
                                                                           
     DMOMENT(DM) ... CALCULATE THE DIPOLE MOMENT.                          
                                                                           
     LMO(LM) ... LOCALIZE THE MOLECULAR ORBITALS. AN OPTIONAL              
     SUBPARAMETER MAY BE USED FOR RESEARCH INTO LMO POLARIZABILITIES:      
     LM=1 ... COMPUTE AND SAVE THE ZERO FIELD LMO ROTATIONS.               
     LM=2 ... APPLY THE ZERO FIELD LMO ROTATIONS TO A FINITE FIELD         
     CASE (SEE LINKS 0601 AND 0801 FOR MORE DETAILS ON THE LMO -           
     FINITE FIELD PROBLEM).                                                
                                                                           
     SIZE(SI) ... LOCALIZE THE MOLECULAR ORBITALS AND CALCULATE THEIR      
     SIZES.                                                                
                                                                           
     OEP(OE) ... EVALUATION OF ONE-ELECTRON PROPERTIES. THE ORBITALS       
     TO USE ARE GIVEN BY A SUBPARAMETER:                                   
     OE=LMO(L) ... PROPERTIES OVER LMO.                                    
     OE=CMO(C) ... PROPERTIES OVER CMO.                                    
     THE DEFAULT IS OVER LMO IF ORBITALS WERE LOCALIZED, ELSE OVER CMO.    
     FOR OPTIMIZATIONS WITH THE FP OPTION, OR FOR SURFACE SCANS, THE       
     OEP INPUT IS READ ONLY ONCE AND SAVED ON DISK, RESULTING IN THE       
     SAME SET OF PROPERTIES BEING REPEATED AUTOMATICALLY.                  
                                                                           
     POLARIZABILITY(PO) ... ESTIMATE DIPOLE POLARIZABILITY.                
                                                                           
     FORCE(FO) ... CALCULATE THE FORCE (GRADIENT), IN INTERNAL             
     COORDINATES BY DEFAULT. SPECIFYING FO=CC(C) CALCULATES THE FORCES     
     IN CARTESIAN COORDINATES. THIS OPTION MUST NOT BE USED FOR            
     FORCE OPTIMIZATION RUNS.                                              
                                                                           
1                                                                          
 9                        GENERAL DESCRIPTION                              
                                                                           
                                                                           
                                                                           
     FREQUENCIES(FR) ... CALCULATE THE FORCE CONSTANTS (HESSIAN).          
     FOR GEOMETRY OPTIMIZATION RUNS (GOPT), A SUBPARAMETER MAY BE          
     USED:                                                                 
     FR=FIRST(F) WILL EVALUATE THE HESSIAN AT THE FIRST POINT OF THE       
     OPTIMIZATION ONLY. THIS IS USEFUL TO START AN OPTIMIZATION            
     OF A DIFFICULT STRUCTURE, OR FOR TRANSITION STATE OPTIMIZATIONS.      
     FR=BOTH(B) WILL EVALUATE THE HESSIAN AT THE FIRST AND LAST            
     POINTS OF THE OPTIMIZATION ONLY.                                      
     FR=LAST(L) WILL EVALUATE THE HESSIAN AT THE LAST POINT OF THE         
     OPTIMIZATION ONLY (I.E. AT THE CONVERGED GEOMETRY). THIS IS           
     USEFUL FOR PERFORMING AN "ORDER CHECK" ON A GEOMETRY.                 
                                                                           
     FPOINT(FP) ... CALCULATE ANY MOLECULAR PROPERTIES FOR THE FIRST       
     POINT OF GEOMETRY/BASIS SET OPTIMIZATIONS, AS WELL AS AT THE END      
     (THEY ARE USUALLY ONLY CALCULATED AT THE END).                        
                                                                           
     FIELD(FI) ... THE TYPE OF FIELD TO BE APPLIED IS GIVEN BY A           
     SUBPARAMETER:                                                         
     FI=ELECTRIC(E) ... CALCULATION TO BE PERFORMED IN THE PRESENCE        
     OF A UNIFORM EXTERNAL ELECTRIC FIELD.                                 
     FI=SCRF(S) ... CALCULATION TO BE PERFORMED USING SELF CONSISTENT      
     REACTION FIELD THEORY, TO EVALUATE SOLVENT EFFECTS.                   
     REFERENCES: J.L. RIVAIL AND D. RINALDI, CHEM. PHYS., 18, 233          
     (1976); R. CIMIRAGLIA, S. MIERTUS AND J. TOMASI, CHEM. PHYS.          
     LETT., 80, 286 (1981).                                                
     THE SCRF IS ONLY AVAILABLE FOR CLOSED SHELL WAVEFUNCTIONS.            
                                                                           
     PMO(PM) ... PERFORM A PMO ANALYSIS. THE SUBPARAMETER PM=SAVE(S)       
     PUNCHES THE SAVE DATA (S, H, F AND C MATRICES) IN LINK 0601, WHILE    
     PM=RESTART(R) WILL READ IN THE SAVE DATA AND GO DIRECTLY TO THE       
     PMO ANALYSIS - NO PROPERTIES MAY BE REQUESTED IN A PMO RESTART.       
     THE INITIAL GUESS(GU) OPTION IS IGNORED FOR A PMO RESTART.            
     FOR OPTIMIZATION RUNS THE ANALYSIS IS PERFORMED FOR THE LAST          
     POINT, UNLESS THE FP OPTION IS SPECIFIED. THE PMO ANALYSIS IS         
     POSSIBLE ONLY FOR CLOSED SHELL MOLECULES.                             
     REFERENCE: M.-H. WHANGBO, H.B. SCHLEGEL AND S. WOLFE, J. AMER.        
     CHEM. SOC., 99, 1296 (1977).                                          
                                                                           
     EDECOMPOSITION(ED) ... PERFORM THE MOROKUMA ENERGY DECOMPOSITION.     
     THIS OPTION MAY BE COMBINED WITH THE BSSE OPTION.                     
     THIS OPTION IS NOT COMPATABLE WITH MOST OTHER OPTIONS (E.G.           
     SSCAN, GOPT, DM, LMO/SIZE, PMO, CI).                                  
                                                                           
     BSSE(BS) ... PERFORM A BASIS SET SUPERPOSITION ERROR (BSSE)           
     CORRECTION ("COUNTER-POISE" CORRECTION).                              
     THIS OPTION MAY BE COMBINED WITH THE EDECOMPOSITION OPTION.           
     THIS OPTION IS NOT COMPATABLE WITH MOST OTHER OPTIONS (E.G.           
     SSCAN, GOPT, DM, LMO/SIZE, PMO, CI).                                  
                                                                           
     CI ... DIRECT CI FOR THE LOWEST ROOT (STATE) OF A GIVEN SYMMETRY      
     AND MULTIPLICITY (POSSIBILITIES ARE CLOSED SHELL SINGLETS AND RHF     
     OPEN SHELL SINGLETS, DOUBLETS, TRIPLETS AND QUARTETS). THIS OPTION    
     REQUIRES 6 ADDITIONAL I/O UNITS.                                      
     THE NORMAL MODE OF OPERATION REQUIRES TWO RUNS:                       
     THE FIRST SPECIFYING THE SUBPARAMETER CI=SETUP(S) FOR                 
     COMPLETE PRINTING OF THE SCF COEFFICIENTS, BUT NO ATTEMPT IS          
     MADE TO ENTER THE CI PROGRAMS (LINKS 0901-0906). THE MO VECTOR        
     SYMMETRIES SHOULD BE DETERMINED BY INSPECTION (THE VALID POINT        
1                                                                          
                          GENERAL DESCRIPTION                            10
                                                                           
                                                                           
                                                                           
     GROUPS ARE C1, CS, C2V AND D2H), THEN THE SECOND RUN SPECIFYING       
     CI=RESTART(R) IS MADE. THIS ASSUMES THE DIRECT ACCESS FILE AND        
     2-ELECTRON INTEGRALS HAVE BEEN SAVED FROM THE SETUP RUN, AS NO        
     INTEGRALS ARE RECALCULATED. THE INITIAL GUESS(GU) OPTION IS           
     IGNORED FOR CI RESTARTS, AND NO OTHER PROPERTIES MAY BE REQUESTED.    
     SPECIFY JUST CI TO DO THE INTEGRALS, SCF AND CI IN ONE SHOT (EG       
     FOR SURFACE SCANS OR CASES WITH NO SYMMETRY). THE CI IS PERFORMED     
     AT THE LAST POINT OF OPTIMIZATION RUNS UNLESS THE FP OPTION IS        
     SPECIFIED. FOR SURFACE SCANS, OR OPTIMIZATIONS RUNS WITH THE FP       
     OPTION, THE INTEGRAL TRANSFORMATION AND CI CONTROL CARDS ARE READ     
     ONLY ONCE AND SAVED ON DISK - THUS ALL POINTS MUST HAVE THE SAME      
     MO ORDER AND SYMMETRY. THE UHF SCF MAY NOT BE USED.                   
     REFERENCE: N.C. HANDY, J.D. GODDARD AND H.F. SCHAEFER, J. CHEM.       
     PHYS., 71, 426 (1979).                                                
                                                                           
     MRDCI(MR) ... PREPARE THE FILES NECESSARY FOR BUENKER'S MRD-CI        
     PROGRAM SYSTEM. THE COORDINATES, ONE ELECTRON INTEGRALS AND MO        
     MO COEFFICIENTS ARE WRITTEN TO UNIT 11 (THE SECOND CI FILE), AND      
     THE TWO ELECTRON INTEGRALS TO UNIT 9 AS USUAL. THE SUBPARAMETER       
     MR=SCF(S) SPECIFIES THAT MONSTERGAUSS PERFORM THE SCF CALCULATION     
     AND WRITE THOSE FINAL MO COEFFICIENTS RATHER THAN THE INITIAL         
     GUESS COEFFICIENTS. THIS OPTION IS NOT COMPATIBLE WITH                
     OPTIMIZATION RUNS, THE DIRECT CI, SURFACE SCANS OR PMO RESTARTS.      
                                                                           
1                                                                          
 11                       GENERAL DESCRIPTION                              
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     *PRT OPTIONS.                                                         
     ******************************************************************    
                                                                           
     ANY OF THE FOLLOWING CODE WORDS (LETTERS) MUST BE FOLLOWED BY         
     =YES(Y) OR =NO(N) TO TURN THE OPTIONS ON OR OFF RESPECTIVELY.         
     *PRT OPTIONS ARE USED ON EVERY ROUTE CARD WHERE THEY ARE              
     APPLICABLE.                                                           
                                                                           
     BASIS(B) ... PRINT THE BASIS SET. THE DEFAULT IS B=NO(N) EXCEPT       
     FOR GENERAL BASIS OR BOPT RUNS.                                       
                                                                           
     IGC(I) ... PRINT THE INITIAL GUESS COEFFICIENTS. THE DEFAULT IS       
     I=NO(N) UNLESS THE AC OPTION ON THE *MOL CARD WAS USED.               
                                                                           
     C ... PRINT THE COEFFICIENTS AND ORBITAL ENERGIES (DEFAULT=YES).      
     SPECIFYING C=Y WILL FORCE PRINTING OF ALL THE MO COEFFICIENTS         
     AS ONLY THE LOWEST TEN VIRTUALS ARE PRINTED BY DEFAULT.               
                                                                           
     D ... PRINT THE DENSITY MATRIX (DEFAULT=NO).                          
                                                                           
     GEOM(G) ... PRINT FULL GEOMETRY CHECK, INCLUDING REQUESTED BOND       
     AND TORSIONAL ANGLES - SEE LINK 0601 (DEFAULT=NO).                    
                                                                           
     POP(P) ... PRINT CONTROL IN THE MULLIKEN POPULATION ANALYSIS -        
     THE DEFAULT PRINTING IS ONLY RESULTS CONDENSED TO ATOMS.              
     SPECIFYING P=YES(Y) TURNS ON ALL PRINTING, WHILE P=NO(N) TURNS        
     ALL PRINTING OFF.                                                     
                                                                           
     MOINTS(M) ... PRINT THE INTEGRALS OVER MO IN THE SIZE AND/OR          
     ONE-ELECTRON PROPERTIES PACKAGES (DEFAULT=NO).                        
                                                                           
     TIME(T) ... PRINT THE TIMING INFORMATION AND A MESSAGE FOR EACH       
     NEW LINK (DEFAULT=NO).                                                
     TIMING INFORMATION IS NOT AVAILABLE ON IBM/VAX/UNX COMPUTERS,         
     SO ONLY THE MESSAGE FOR EACH NEW LINK IS PRINTED.                     
                                                                           
1                                                                          
                          GENERAL DESCRIPTION                            12
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     *PUN OPTIONS.                                                         
     ******************************************************************    
                                                                           
     THE PRESENCE OF ANY OF THE FOLLOWING CODE LETTERS WILL CAUSE          
     PUNCHING OF THAT ITEM. THE DEFAULT IS NO PUNCHING OF ANYTHING.        
     PUNCHING OCCURS AT THE FIRST POINT OF SURFACE SCANS, AND THE          
     LAST POINT OF GEOMETRY/BASIS SET OPTIMIZATIONS.                       
     THE FIRST 40 LETTERS ON THE TITLE CARD (SEE LINK 0202) WILL BE        
     USED TO IDENTIFY PUNCHED OUTPUT DECKS.                                
                                                                           
     C ... PUNCH THE COEFFICIENTS AND ORBITAL ENERGIES.                    
                                                                           
     D ... PUNCH THE DENSITY MATRIX.                                       
                                                                           
     LMO(L) ... PUNCH THE LMO COEFFICIENTS.                                
                                                                           
     Z ... PUNCH THE FINAL Z MATRIX FOR GOPT RUNS.                         
                                                                           
1                                                                          
 13                       GENERAL DESCRIPTION                              
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     *IOP - SETTING SPECIFIC IOP'S.                                        
     ******************************************************************    
                                                                           
     THIS CONTROL CARD IS USED TO SET SPECIFIC IOP'S ON SPECIFIC ROUTE     
     CARDS. VALUES OF ISEQ, IOP AND IVAL ARE READ FROM A CARD (3I4         
     FORMAT). ISEQ IS THE NUMBER OF THE BASIC ROUTE CARD (SEE ROUTINE      
     ROUTE), IOP IS THE IOP NUMBER (13-92) AND IVAL IS THE                 
     VALUE TO INSERT (0-7). TERMINATE THE LIST OF CHANGES WITH A           
     BLANK CARD. COMMENTS MAY BE PLACED IN COLUMNS 13 TO 72.               
     FOR EXAMPLE, TO TURN ON FULL PRINTING OF THE GRADIENT COMPONENTS      
     IT IS NECESSARY TO SET IOP(21)=2 ON THE ROUTE CARDS CALLING           
     GROUP 7, THE GRADIENT LINKS. FROM ROUTINE ROUTE (BELOW),              
     GROUP 7 IS USED THREE TIMES IN THE COMPLETE ROUTE - AS                
     SEQUENCE NUMBERS 8, 15 AND 21. FOR FULL PRINTING AT ONLY THE          
     THE FIRST POINT OF SINGLE POINT, GRADIENT OPTIMIZATION OR SURFACE     
     SCAN RUNS, THE *IOP CARD                                              
        8  21   2  GRADIENT COMPONENTS                                     
     WOULD BE USED. FOR COMPLETE PRINTING AT EACH POINT OF GRADIENT        
     OPTIMIZATIONS OR SURFACE SCANS (USING THE FORCE OPTION) THE CARD      
       15  21   2  GRADIENT COMPONENTS DURING OPTS/SCANS                   
     WOULD DO THE TRICK. FOR Z MATRIX OPTIMIZATIONS NOT USING THE          
     FIRST POINT (FP) OPTION, THE CARD                                     
       21  21   2  GRADIENT COMPONENTS AT FINAL POINT OF Z MATRIX OPTS     
     WOULD PRINT THE GRADIENT COMPONENTS AT THE OPTIMUM GEOMETRY.          
     NOTE THAT LINKS MAY BE ADDED OR DELETED FROM THE ROUTE BY             
     SPECIFYING IOP'S BETWEEN 61 AND 92. FOR EXAMPLE, THE CARD             
        2  66   0  DELETE 2-ELECTRON SP INTEGRAL ROUTINE (SHELL)           
     WOULD DELETE LINK 0306 FROM THE ROUTE. BE CAREFUL DURING CHECK        
     JOBS THAT LINKS ADDED/DELETED WILL NOT CAUSE TROUBLE.                 
                                                                           
1                                                                          
                          GENERAL DESCRIPTION                            14
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     *CON - SETTING NEW CONVERSION FACTORS.                                
     ******************************************************************    
                                                                           
     THE FOLLOWING CARD, IN 5F12.6 FORMAT, GIVES THE VALUES TO USE FOR     
     AUTOAN (CONVERSION OF BOHR TO ANGSTROMS), DCONST (CONVERSION OF       
     DIPOLE MOMENT TO DEBYE), FCONV (CONVERSION OF FORCES FROM             
     HARTREE/BOHR TO MDYNE), FCCONV (CONVERSION OF FORCE CONSTANTS         
     FROM HARTREE/ANGSTROM**2 TO MDYNE/ANGSTROM), AND VCM (CONVERSION      
     OF ELECTRIC FIELD FROM ATOMIC UNITS TO VOLTS/CM). ALL FIVE VALUES     
     MUST BE GIVEN. THE CURRENT VALUES ARE BASED ON THE 1973 REVISED       
     FUNDAMENTAL CONSTANTS (THE VALUES FROM GAUSSIAN 70 WERE               
     0.529167165, 2.54158059, 8.2380, 4.3593 AND 0.0 (UNKNOWN)).           
                                                                           
1                                                                          
 15                       GENERAL DESCRIPTION                              
                                                                           
                                                                           
                                                                           
     *****************************************************************     
     THE FOLLOWING RESTRICTIONS MUST BE TAKEN INTO CONSIDERATION           
     *****************************************************************     
                                                                           
     1  INTERNAL MINIMAL STO-NG BASES ARE AVAILABLE FOR THE ATOMS H-XE     
     (EXCEPT Y-CD) FOR N BETWEEN 2 AND 6.                                  
     INTERNAL SPLIT VALENCE N-21G BASES ARE AVAILABLE FOR THE ATOMS        
     H-XE (MAIN GROUP ONLY, N = 3), H-AR (N = 6),                          
     AND THE ATOMS H-NE (N = 4).                                           
     INTERNAL EXTENDED N-31G BASES ARE AVAILABLE FOR THE ATOMS H-NE,       
     AND P-CL (N = 4), FOR H, HE, C-F (N = 5), AND FOR H-AR (N = 6).       
     NOTE THAT THE 4-31G BASIS FOR LI AND BE IS ACTUALLY A 5-21G BASIS.    
     INTERNAL PULAY N-21G BASES ARE AVAILBLE FOR H, B-F (N = 4 ONLY).      
     THE INTERNAL N-311G BASES, INTENDED FOR USE WITH CORRELATED           
     WAVEFUNCTIONS, ARE AVAILBLE FOR THE ATOMS H-NE (N = 6 ONLY).          
     FOR FURTHER DETAILS CONSULT PROGRAM GINPUT ... LINK 0301.             
     POLARIZED BASIS SETS ARE NOT AVAILABLE FOR ALL THE ATOMS              
     AND BASIS SETS LISTED ABOVE.                                          
                                                                           
     2  CI IS POSSIBLE ONLY FOR CLOSED SHELLS, AND FOR OPEN SHELL          
     SINGLETS, DOUBLETS, TRIPLETS AND QUARTETS WHERE EACH OPEN SHELL       
     OCCUPIED BY BY ONE ALPHA SPIN ELECTRON. CASES WITH PARTIALLY          
     OCCUPIED OPEN SHELLS (I.E. DEGENERATE OPEN SHELL ORBITALS) CAN        
     NOT BE HANDLED.                                                       
                                                                           
     3  GEOMETRY GRADIENTS ARE AVAILABLE FOR SPD BASIS SETS, BUT BASIS     
     SET GRADIENTS ONLY FOR SP BASIS SETS. FOR PURE 5D FUNCTIONS, THE      
     NUMBER OF ATOMIC ORBITALS MUST BE #NB OR LESS WHEN EACH 5D SET IS     
     IS REPLACED BY A 6D SET OF FUNCTIONS FOR THE GRADIENT EVALUATION.     
                                                                           
     ******************************************************************    
     THE ABOVE CARDS ARE SUFFICIENT TO COMPLETELY DEFINE THE ROUTING       
     ******************************************************************    
                                                                           
     SOME INPUT EXAMPLES                                                   
     ASSUME CARD COLUMNS ARE                                               
     123...                                                                
                                                                           
     SINGLE STO-3G CALCULATION ON A CLOSED SHELL MOLECULE  Z-MATRIX        
     SPECIFICATION OF GEOMETRY  CALCULATE DIPOLE MOMENT                    
     *MOL GEOM=ZMAT, BASIS=M3, DM                                          
                                                                           
     GEOMETRY OPTIMIZATION RUN  STO-3G BASIS  OPEN SHELL                   
     *MOL BASIS=M3, UHF, GOPT, METHOD=ZM                                   
                                                                           
     4-31G OPTIMIZATION OF THE GEOMETRY AND BASIS SET  Z MATRIX INPUT      
     OF THE GEOMETRY  CLOSED SHELL  LOCALIZE THE ORBITALS WITH SIZES       
     USE THE BFGS METHOD  PRINT THE FULL POPULATION ANALYSIS AND           
     PUNCH THE DENSITY MATRIX AT THE END OF THE OPTIMIZATION.              
     *MOL BASIS=E4, GOPT, BOPT, METHOD = BFGS, S I Z E                     
     *PRT POP=YES                                                          
     *PUN DENSITY                                                          
                                                                           
     USING THE DEFAULT OPTIONS WHERE APPLICABLE THE ABOVE THREE            
     EXAMPLES MAY ALSO BE WRITTEN (USING MINIMUM ABBREVIATIONS)            
                                                                           
     *MOLGE=Z,DM                                                           
                                                                           
1                                                                          
                          GENERAL DESCRIPTION                            16
                                                                           
                                                                           
                                                                           
     *MOLUH,GO,ME=Z                                                        
                                                                           
     *MOLBA=E4,GO,BO,ME=B,SI                                               
     *PRTP=Y                                                               
     *PUND                                                                 
                                                                           
     FOR THOSE USING THE INTERNAL BASIS SETS VERY LITTLE IN THE            
     WAY OF INPUT REMAINS                                                  
     THIS IS BUT THE INPUT OF GEOMETRY THROUGH THE                         
     COORDINATE GENERATION ROUTINES ... LINK 0201 OR LINK 0202,            
     AND                                                                   
     FOR OPTIMIZATION RUNS                                                 
     THE INPUT OF PARAMETERS TO BE VARIED                                  
     SEE ROUTINES VGEOM (LINK 0202), GINPUT (LINK 0301), AND GBOPT         
     (LINK 0711) FOR DETAILS ON GEOMETRY AND BASIS SET OPTIMIZATION.       
     FOR INPUT OF AN EXTERNAL BASIS SET DETAILS ARE GIVEN IN ROUTINE       
     GBASIS (LINK 0301).                                                   
                                                                           
     ******************************************************************    
1                                                                          
 17                                                                        
                                                                           
                                                                           
                                                                           
 CHAPTER 2: ROUTE GENERATION.                                              
 **********                                                                
                                                                           
     FOR THOSE WHO LIKE TO KNOW WHAT'S GOING ON,                           
     THE METHOD OF GENERATING ROUTES IS DESCRIBED IN DETAIL.               
                                                                           
     IMAGINE THAT THE ROUTE WAS PUNCHED ON CARDS - THEN EACH CARD          
     WOULD LOOK LIKE:                                                      
     GROUP  OPTIONS  LINKS  JUMP                                           
     WHERE THE GROUP NUMBER OCCUPIES COLUMNS 1-4, THE OPTIONS 5-60,        
     THE LINKS 61-92, AND A JUMP FIELD.                                    
                                                                           
     ******************************************************************    
                                                                           
     TO UNDERSTAND THE MEANING OF THE FIELDS A BIT OF GENERAL              
     DESCRIPTION OF THE METHOD OF OVERLAYING IS ESSENTIAL.                 
                                                                           
     NOTE THAT THESE INTERNAL LINKS OFTEN RESEMBLE THE                     
     EXTERNAL OVERLAY STRUCTURE AS SET UP BY THE LINKAGE EDITOR ...        
     AND THEY ARE SIMILAR IN THAT INFORMATION IS PASSED BETWEEN            
     LINKS ONLY THROUGH COMMON OR ON DISK.                                 
                                                                           
     EACH PROGRAM RETURNS TO THE CONTROL ROUTINE 'CHAIN' WHICH CALLS       
     THE NEXT PROGRAM IN THE SEQUENCE GIVEN BY THE USER.                   
                                                                           
     THE GROUPS ARE NOT IN THEMSELVES PROGRAMS BUT JUST CONVENIENT         
     HEADINGS FOR A SET OF PROGRAMS CALLED LINKS.                          
     HERE THE NONEXISTANT GROUPS ARE LABELED                               
     100  200  300  400  500  600  700  800  900                           
     WHERE IN GENERAL TERMS:                                               
     GROUP 100 DEALS WITH INITIALIZATION AND ROUTE GENERATION,             
     200 DEALS WITH COORDINATE GENERATION,                                 
     300 WITH INTEGRAL EVALUATION,                                         
     400 WITH INITIAL GUESS,                                               
     500 WITH THE SELF-CONSISTENT FIELD EQUATIONS,                         
     600 WITH POPULATION ANALYSIS, PMO ANALYSIS, AND ED/BSSE,              
     700 WITH DERIVATIVES AND SIMULTANEOUS OPTIMIZATION,                   
     800 WITH BOYS LOCALIZATION PROCEDURE AND ONE ELECTRON PROPERTIES,     
     900 WITH INTEGRAL TRANSFORMATION AND CI.                              
                                                                           
     WITH EACH GROUP MAY BE ASSOCIATED FROM 1 TO 32 LINKS                  
     NUMBERED ... FOR EXAMPLE                                              
     301  302  AND  303                                                    
     MEANING LINKS 1 2 AND 3 OF GROUP 3 ( OR 0300 )                        
     HAPPILY THE LINKS ACTUALLY EXIST AND ARE IN REALITY THE               
     LINKS OF OUR CHAIN.                                                   
                                                                           
     TO SET UP A ROUTE THROUGH MONSTERGAUSS IT IS FIRST NECESSARY          
     TO KNOW WHICH LINKS OF WHICH GROUPS ARE REQUIRED AND                  
     IN WHAT ORDER THEY ARE TO BE EXECUTED.                                
     THE DICTIONARY OF LINKS GIVEN BELOW SHOULD AID IN THE                 
     FORMER TASK.                                                          
                                                                           
     THE FIRST FIELD IS THE GROUP NUMBER, BEING ONE OF                     
     2, 3, 4, 5, 6, 7, 8 OR 9 (SHORT FOR 200, 300, 400, 500, 600,          
     700, 800 OR 900).                                                     
     THE USER NEVER SPECIFIES GROUP 0100 LINKS, AS THESE LINKS ARE         
     INSERTED INTO THE ROUTE AUTOMATICALLY BY THE ROUTE GENERATOR.         
1                                                                          
                            ROUTE GENERATION                             18
                                                                           
                                                                           
                                                                           
     SPECIFICATION OF THE LINK NUMBERS IS A BIT LESS OBVIOUS -             
     PLACING A NON-ZERO VALUE (1 FOR EXAMPLE) IN THE FIRST LINK            
     FIELD (COLUMN 61) SIGNIFIES A CALL TO LINK 1,                         
     THAT IN THE SECOND FIELD (COLUMN 62) A CALL TO LINK 2 AND             
     SO ON.                                                                
     NOTE THAT MORE THAN ONE LINK MAY BE CALLED FROM A SINGLE              
     GROUP CARD,                                                           
     AND THAT THE LINKS WILL ALWAYS BE CALLED IN NUMERICAL ORDER.          
     IN ORDER TO CALL THE LINKS OF AN GROUP OUT OF ORDER,                  
     MULTIPLE GROUP CALLS ARE REQUIRED.                                    
                                                                           
     ASSOCIATED WITH EACH GROUP ... AND HENCE WITH EACH SET OF             
     LINKS ... IS A SET OF OPTIONS.                                        
     THESE ARE LISTED WITH EACH MAJOR PROGRAM AND IT WILL BE               
     NECESSARY TO CONSULT THE INDIVIDUAL LINKS FOR DETAILED                
     DESCRIPTIONS.                                                         
     THESE OPTIONS ... TERMED IOP(5) TO IOP(60) ... ARE FOUND              
     IN COLUMNS 5 TO 60 RESPECTIVELY OF THE GROUP CARDS.                   
                                                                           
     NORMALLY THE GROUP CARDS ARE EXECUTED IN THE ORDER IN WHICH           
     THEY WERE GENERATED,                                                  
     HOWEVER PROVISION HAS BEEN MADE FOR JUMPING ... ONLY BACKWARDS ...    
     SO AS TO BE ABLE TO CREATE LOOPS                                      
     FOR EXAMPLE THE GROUP STRUCTURE FOR THE OPTIMIZATION OF THE           
     GEOMETRY OF A MOLECULE MIGHT BE SOMETHING LIKE THE FOLLOWING          
                                                                           
     GENERATE INITIAL GEOMETRY                                             
     NEXT                                                                  
     EVALUATE INTEGRALS                                                    
     NEXT                                                                  
     TAKE AN INITIAL GUESS AT THE WAVEFUNCTION                             
     NEXT                                                                  
     EXECUTE SCF PROCEDURE                                                 
     NEXT                                                                  
     PERFORM A POPULATION ANALYSIS ... AS THIS IS THE FIRST                
     CALCULATION IN THE OPTIMIZATION SOME PRINTING MIGHT BE DONE TO        
     MAKE CERTAIN THAT ALL IS GOING WELL                                   
     NEXT                                                                  
     ALTER INITIAL GEOMETRY                                                
     NEXT                                                                  
     AND THIS MARKS THE BEGINNING OF OUR PROGRAMMED LOOP                   
     ..................................................................    
     AGAIN EVALUATE INTEGRALS                                              
     NEXT                                                                  
     PERFORM SCF CALCULATION ... THE DENSITY MATRIX FROM THE               
     PREVIOUS CALCULATION WILL AUTOMATICALLY BE USED AS AN INITIAL         
     GUESS TO THIS CALCULATION                                             
     NEXT                                                                  
     AGAIN ALTER GEOMETRY                                                  
     NOW  JUMPBACK TWO CARDS  TO CALCULATE INTEGRALS                       
     VOILA ... WE HAVE A LOOP                                              
     ..................................................................    
     WHEN THE OPTIMIZATION IS COMPLETE THIS JUMP WILL AUTOMATICALLY        
     BE BYPASSED SO AS TO ALLOW US TO GO ON TO OTHER GROUP CARDS           
     FOR EXAMPLE                                                           
     CALCULATE DIPOLE MOMENT INTEGRALS FOR BOYS LOCALIZATION               
     DO A POPULATION ANALYSIS                                              
     AND FINALLY                                                           
1                                                                          
 19                         ROUTE GENERATION                               
                                                                           
                                                                           
                                                                           
     DO A BOYS LOCALIZATION.                                               
     A JUMP AFTER EXECUTION OF ALL THE LINKS IN A GIVEN GROUP              
     IS SIGNALED BY A NEGATIVE NUMBER ON THE GROUP CARD (JUMP FIELD).      
                                                                           
     FOR FURTHER UNDERSTANDING, STUDY THE STANDARD ROUTES AND THEIR        
     VARIANTS GENERATED BY MONSTERGAUSS.                                   
                                                                           
     ******************************************************************    
                                                                           
1                                                                          
                            ROUTE GENERATION                             20
                                                                           
                                                                           
                                                                           
     DICTIONARY OF LINKS AND ASSOCIATED ROUTINES.                          
     NOTE THAT ONLY ONE SOURCE COPY OF EACH                                
     ROUTINE APPEARS IN THE ENTIRE SYSTEM -                                
     WHERE A ROUTINE IS NEEDED IN SEVERAL LINKS THIS LONE COPY WILL        
     EITHER BE FOUND WITH THE EARLIEST ... LOWEST NUMBERED ... LINK        
     WHICH USES IT, OR IN ONE OF THE UTILITY LINKS.                        
     OTHER LINKS USING THE SAME ROUTINE HAVE THE NAME ENCLOSED IN          
     PARENTHESES. THE ONLY ROUTINE WRITTEN IN ASSEMBLER IS UNPACK.         
     ROUTINES DUMMYI ALLOW SECOND LEVEL OVERLAYS                           
     IN THE INTEGRAL PROGRAMS.                                             
     THE CODES (FMTGEN), (RPOLX), (F0INIT) AND (F1DA) MEAN THAT            
     NUMEROUS ROUTINES FOR INTEGRAL/DERIVATIVE EVALUATION ARE USED.        
     MOST ROUTINES FROM LINK 9990 ARE USED IN ALL INTEGRAL/DERIVATIVE      
     LINKS, AND MOST ROUTINES FROM LINK 9991 ARE USED IN ALL FIRST         
     DERIVATIVE LINKS.                                                     
     ROUTINES FROM LINK 9999 ARE USED THROUGHOUT THE PROGRAM.              
     ******************************************************************    
     THE FOLLOWING ROUTINES ARE USED BY MANY LINKS, AND ARE LOCATED        
     IN THE ROOT SEGMENT OF MONSTERGAUSS: GAUSS, CHAIN, TREAD, TWRITE.     
     ..................................................................    
     LINK 0100                                                             
     PROGRAM SETUP ... DEFINES MATRIX FILE, INITIATES CALCULATION.         
     ASSOCIATED SUBROUTINES:                                               
     CRITIC,GAMGEN,(FMTGEN)                                                
     ..................................................................    
     LINK 0101                                                             
     PROGRAM LNK1 ... DEFINES THE ROUTE FOR THE CALCULATION.               
     ASSOCIATED SUBROUTINES:                                               
     FINDC,ROUTE                                                           
     ..................................................................    
     LINK 0201                                                             
     PROGRAM STDGEO ... MOLECULAR GEOMETRY FROM A STANDARD MODEL.          
     ASSOCIATED SUBROUTINES:                                               
     GETCHR,GETBL,SGDUMP,BD201                                             
     ..................................................................    
     LINK 0202                                                             
     PROGRAM VGEOM ... INPUT OF THE MOLECULAR GEOMETRY.                    
     ASSOCIATED SUBROUTINES:                                               
     ZPARAM,BUILDZ,VEC,VPROD,SINCOS,ZSCALE,FREEZ,ZPRINT,FILMAS,(FREEFM)    
     ..................................................................    
     LINK 0301                                                             
     PROGRAM GINPUT ... SETUP PROGRAM FOR GAUSSIAN INTEGRAL PACKAGE.       
     ASSOCIATED SUBROUTINES:                                               
     STO,NM1G,GBASIS,S1S,S2S,S2P,S2SP,S3S,S3P,S3SP,S3D,S3SPD1,S3SPD2,      
     S4S,S4P,S4SP,S4SPD1,S4SPD2,S5SP,EZERO,EONE,ETWO,ETHREE,EFOUR,         
     BERROR                                                                
     ..................................................................    
     LINK 0302                                                             
     PROGRAM STVINT ... OVERLAP AND CORE HAMILTONIAN INTEGRALS (T+V).      
     ASSOCIATED SUBROUTINES:                                               
     OVRLAP,(RPOLX),(FILMAT),(PUREDF)                                      
     ..................................................................    
     LINK 0303                                                             
     PROGRAM DIPOLE ... CALCULATION OF X, Y AND Z DIPOLE INTEGRALS.        
     ASSOCIATED SUBROUTINES:                                               
     (GETCC1),(GET1CS),(GET2CS),(FILMAT),(PUREDF)                          
     ..................................................................    
     LINK 0306                                                             
1                                                                          
 21                         ROUTE GENERATION                               
                                                                           
                                                                           
                                                                           
     PROGRAM SHELL ... GAUSSIAN SP TWO ELECTRON INTEGRAL PACKAGE.          
     ASSOCIATED SUBROUTINES:                                               
     FILMAX,SINFO,SGEOM,PINF,SP0000,SP0001,SP0011,SP0101,SP0111,SP1111,    
     ROT2,TQ0011,TQ0101,TQ0111,TQ1111,R30001,R30011,R30101,R30111,         
     R31111,SHLOUT,(FMTGEN)                                                
     ..................................................................    
     LINK 0307                                                             
     PROGRAM UNCON ... 2-ELECTRON INTEGRALS FOR (SP)D FUNCTIONS.           
     ASSOCIATED SUBROUTINES:                                               
     UFILLC,URD65,FORMP,FORMQ,FABCD,ROTATE,FORMS,(FMTGEN),(SHLOUT)         
     ..................................................................    
     LINK 0308                                                             
     PROGRAM PHOENX ... 2-ELECTRON INTEGRALS FOR (SP)DF FUNCTIONS.         
     ASSOCIATED SUBROUTINES:                                               
     AOSUMF,CNTPRM,MTGET,F0ROOT,F0SUM,(RPOLX),(FMTGEN),(F0INIT),           
     (PURDF2),(SHLOUT)                                                     
     ..................................................................    
     LINK 0309                                                             
     PROGRAM DSTVWT ... ONE ELECTRON DERIVATIVE PACKAGE.                   
     ASSOCIATED SUBROUTINES:                                               
     ..................................................................    
     LINK 0310                                                             
     PROGRAM DPHNXW ... 2-ELECTRON DERIVATIVES FOR SPD FUNCTIONS.          
     ASSOCIATED SUBROUTINES:                                               
     ..................................................................    
     LINK 0311                                                             
     PROGRAM SECINT ... INTEGRAL SELECTION FOR ENERGY DECOMPOSITION.       
     ASSOCIATED SUBROUTINES:                                               
     ..................................................................    
     LINK 0401                                                             
     PROGRAM RHFIN ... RHF PARAMETER INPUT.                                
     ASSOCIATED SUBROUTINES:                                               
     AKLBKL,ICOMB,IFACT                                                    
     ..................................................................    
     LINK 0402                                                             
     PROGRAM GUESS ... INITIAL GUESS ROUTINE.                              
     ASSOCIATED SUBROUTINES:                                               
     HUCKEL,BLOCK,ORTHOC,DENSTY,NVSQRT,READER,MATREC,FGUESS,KSTO,KM1G,     
     KM11G,(TRED12),(FREEFM)                                               
     ..................................................................    
     LINK 0403                                                             
     PROGRAM SECORT ... INITIAL GUESS FOR ENERGY DECOMPOSITION.            
     ASSOCIATED SUBROUTINES:                                               
     ..................................................................    
     LINK 0501                                                             
     PROGRAM CLOSED ... ROOTHAAN CLOSED SHELL SCF.                         
     ASSOCIATED SUBROUTINES:                                               
     FORMV,CYCCLO,FOFCLO,CONCLO,TRACLO,SQUARE,LINEAR,SCRFT,                
     (UNPACK),(TRED12)                                                     
     ..................................................................    
     LINK 0502                                                             
     PROGRAM UHFOPN ... SOLUTION OF THE POPLE-NESBET EQUATIONS.            
     ASSOCIATED SUBROUTINES:                                               
     (FORMV),CYCOPN,FOFOPN,CONOPN,SPIN,TRAOPN,(SCRFT),(SQUARE),            
     (UNPACK),(TRED12)                                                     
     ..................................................................    
     LINK 0503                                                             
     PROGRAM GSCF ... GENERAL RESTRICTED HARTREE-FOCK OPEN SHELL SCF.      
1                                                                          
                            ROUTE GENERATION                             22
                                                                           
                                                                           
                                                                           
     ASSOCIATED SUBROUTINES:                                               
     JKMATX,MCCI,VCOEF,MCFOCK,PAIRS,ROTSCF,CONRHF,CSD,LAGRNG,SCHMDT,       
     CALDEN,CALENG,TRARHF,RSCRFT,(SQUARE),(TRACLO),(SPIN),(TRED12),        
     (UNPACK)                                                              
     ..................................................................    
     LINK 0505                                                             
     PROGRAM ZCLOSE ... CLOSED SHELL SCF WITH ENERGY DECOMPOSITION.        
     ASSOCIATED SUBROUTINES:                                               
     ZFORMV,ZCYCCL,ZSELCT,EFLD,(FOFCLO),(CONCLO),(TRACLO),                 
     (SQUARE),(LINEAR),(UNPACK),(TRED12)                                   
     ..................................................................    
     LINK 0506                                                             
     PROGRAM ZUHF ... UHF WITH ENERGY DECOMPOSITION.                       
     ASSOCIATED SUBROUTINES:                                               
     ..................................................................    
     LINK 0507                                                             
     PROGRAM ZRHF ... RHF WITH ENERGY DECOMPOSITION.                       
     ASSOCIATED SUBROUTINES:                                               
     ..................................................................    
     LINK 0601                                                             
     PROGRAM POPGEN ... POPULATION ANALYSIS.                               
     ASSOCIATED SUBROUTINES:                                               
     DISMAT,CROSS,BORDER,DQ,PUNCH,MRDCI,(MAPRO1)                           
     ..................................................................    
     LINK 0602                                                             
     PROGRAM PMO ... PERTURBATIONAL MO ANALYSIS.                           
     ASSOCIATED SUBROUTINES:                                               
     FRGMNT,PARTS,PARTSE,TRUNCA,FRGTRS,TRANSF,VD01A,(TRED12)               
     ..................................................................    
     LINK 0603                                                             
     PROGRAM ZMOROK ... ENERGY DECOMPOSITION / BSSE DRIVER.                
     ASSOCIATED SUBROUTINES:                                               
     ..................................................................    
     LINK 0701                                                             
     PROGRAM FORCEB ... GEOMETRY AND BASIS SET FORCES FOR SP BASES.        
     ASSOCIATED SUBROUTINES:                                               
     ONELB,TWOLB,FPPPPB,(FMTGEN)                                           
     ..................................................................    
     LINK 0702                                                             
     PROGRAM FORCE ... 1-ELECTRON GEOMETRY GRADIENT.                       
     ASSOCIATED SUBROUTINES:                                               
     REDOD,DSTVNT,(DRVIP1),(RPOLX),(FMTGEN)                                
     ..................................................................    
     LINK 0703                                                             
     PROGRAM DTWOL ... 2-ELECTRON GEOMETRY GRADIENT FOR SP FUNCTIONS.      
     ASSOCIATED SUBROUTINES:                                               
     FPPPP,(FMTGEN)                                                        
     ..................................................................    
     LINK 0704                                                             
     PROGRAM DPHNIX ... 2-E GEOMETRY GRADIENT FOR (SP)DF FUNCTIONS.        
     ASSOCIATED SUBROUTINES:                                               
     REDODD,D2AO,F1ROOT,F1SUM,(RPOLX),(FMTGEN),(F0INIT),(F1DA)             
     ..................................................................    
     LINK 0708                                                             
     PROGRAM CPHF ... COUPLED PERTURBED HARTREE-FOCK CALCUATION.           
     ASSOCIATED SUBROUTINES:                                               
     ..................................................................    
     LINK 0709                                                             
1                                                                          
 23                         ROUTE GENERATION                               
                                                                           
                                                                           
                                                                           
     PROGRAM DD1E ... 1-ELECTRON GEOMETRY SECOND DERIVATIVES.              
     ASSOCIATED SUBROUTINES:                                               
     ..................................................................    
     LINK 0710                                                             
     PROGRAM DD2E ... 2-ELECTRON GEOMETRY SECOND DERIVATIVES.              
     ASSOCIATED SUBROUTINES:                                               
     ..................................................................    
     LINK 0711                                                             
     PROGRAM GBOPT ... SIMULTANEOUS GEOMETRY / BASIS SET OPTIMIZATION.     
     ASSOCIATED SUBROUTINES:                                               
     GBPRNT,GBSET,BFGS,MC11AD,MC11BD,MC11ED,OC,DSRCH,FORMPQ,LTOLSP,        
     LSPTOL,MODCON,LTMVEC,LTTRVC,SETLT,VA05MP,MB11MP,FCPRNT,BOST,BEND,     
     TORS,LIBE,INVERT,DOC,SEARCH,LSPVEC,PICK,                              
     (TRED12),(BUILDZ),(VEC),(VPROD),(SINCOS),(ZPARAM),(ZPRINT)            
     ..................................................................    
     LINK 0801                                                             
     PROGRAM BOYLOC ... BOYS LOCALIZED ORBITALS AND SIZES.                 
     ASSOCIATED SUBROUTINES:                                               
     LOCAL,SUBSET,LSHFT,SIM,ROTAT,FBOND,MOSIZE,PROPB,SIZES,                
     (SHFT71),(PRODS1),(PRODF1),(OLAP1),(OPAB4),(TRED12),(MAPRO1)          
     ..................................................................    
     LINK 0802                                                             
     PROGRAM OEPROP ... ONE ELECTRON PROPERTIES.                           
     ASSOCIATED SUBROUTINES:                                               
     BCONV,DINTFM,PROPB1,SHFT71,PRODS1,PRODF1,ANONUC,DIPNUC,               
     AMGNUC,QUDNUC,OCTNUC,FLDNUC,GRDNUC,SLDNUC,OLAP1,                      
     OPAA1,OPAA2,OPAA3,OPAB1,OPAB2,OPAB3,OPAB4,OPAB5,OPAC1,OPAC2,          
     OPAC3,OPAD1,FMC,AAINER,PRNT,PAXIS,RSQ,MABAT,DIAG70                    
     ..................................................................    
     LINK 0803                                                             
     PROGRAM DIPSQ ... ESTIMATE DIPOLE POLARIZABILITIES.                   
     ASSOCIATED SUBROUTINES:                                               
     TRACE4,(MAPRO1)                                                       
     ..................................................................    
     LINK 0901                                                             
     PROGRAM INTRAN ... INTEGRAL TRANSFORMATION.                           
     ASSOCIATED SUBROUTINES:                                               
     TR1,GF1,TR2,SET,INTPRT,(UNPACK)                                       
     ..................................................................    
     LINK 0902                                                             
     PROGRAM COUPLE ... CI COUPLING COEFFICIENTS.                          
     ASSOCIATED SUBROUTINES:                                               
     SETUP1,SETUP2,SETUP3,SETUP4,SETUP5,LHSRHS,TYPDD1,TYPDD2,TYPDD3,       
     TYPDD4,TYPDD5,CODED1,CODED2,CODED3,CODED4,CODED5,SUBR1,SUBR2,         
     SUBR3,TYPES1,TYPES2,TYPES3,TYPES4,TYPES5,CODES1,CODES2,CODES3,        
     CODES4,CODES5,MATRG,MATR,ZERO3,INTER,INTERS,INTESS,INT0,              
     LIST1,LIST2,FIND1,FIND12,FIND3,FINDS,ENTER2,ENTF12,ENTF3,ENTS,        
     OUTPUT,WRTOUT                                                         
     ..................................................................    
     LINK 0903                                                             
     PROGRAM CONFIG ... CI CONFIGURATION GENERATOR.                        
     ASSOCIATED SUBROUTINES:                                               
     OPCODE,ITYPD,ITYPS                                                    
     ..................................................................    
     LINK 0904                                                             
     PROGRAM INTSRT ... CI INTEGRAL SORT.                                  
     ASSOCIATED SUBROUTINES:                                               
     CONSTS,COUL,EXCH,MOIN,REORDR,(UNPACK)                                 
1                                                                          
                            ROUTE GENERATION                             24
                                                                           
                                                                           
                                                                           
     ..................................................................    
     LINK 0905                                                             
     PROGRAM FORMTP ... CI FORMULA TAPE GENERATOR.                         
     ASSOCIATED SUBROUTINES:                                               
     FNOPEN,OPENO1,OPENO2,OPENO3,OPENO4,OPENO5,OPENO6,WRT,WRT3,            
     WST,WST3,ICUP,(UNPACK)                                                
     ..................................................................    
     LINK 0906                                                             
     PROGRAM CIROOT ... DIRECT CI FOR LOWEST ROOT.                         
     ASSOCIATED SUBROUTINES:                                               
     OPQUE,SFOPEN,CIUNPK,(TRED12)                                          
     ..................................................................    
     LINK 0907                                                             
     PROGRAM OEPMO ... ONE ELECTRON PROPERTIES OVER MOLECULAR ORBITALS.    
     ASSOCIATED SUBROUTINES:                                               
     ATMUL                                                                 
     ..................................................................    
     LINK 9990                                                             
     INTEGRAL EVALUATION UTILITY ROUTINES:                                 
     FILLC,(FILLST),FILLCP,(SETCP),FILMAT,GET1CS,GET2C,GET2CS,GET3C,       
     GETA1,GETA2,GETCC1,GETCC2,GETIP2,PUREDF,(PURSET),PURDF2,QINF,         
     TWOD2C,TWOD3C,TWOD4C                                                  
     CMPLTC,DINT2E,FMTGEN,FMTSET,FORMFN,FPX,FX,RFPX,RFX,RPOLX,             
     RYSPOL,RYSROT,RYSSET,BDT2W2,                                          
     F02CTR,F03CTR,F04CTR,F0CFIL,F0CLD1,F0CLD2,F0INIT                      
     WHERE INITIALIZATION ENTRY POINTS ARE ENCLOSED IN PARENTHESES.        
     ..................................................................    
     LINK 9991                                                             
     FIRST DERIVATIVE EVALUATION UTILITY ROUTINES:                         
     D2ZER,DIPA,DIPAB,DIPABI,DIPABC,DIPAC,DIPACI,DRVIP1,                   
     F1DA,F1DAB1,F1DAB2,F1DABC,F1DAC1,F1DAC2,RAWST                         
     ..................................................................    
     LINK 9999                                                             
     GENERAL UTILITY ROUTINES:                                             
     NWIORD,NWIOWR,NWIOWT,FREEFM,TRED12,TQL12,MATPAC,MAPRO1,GBSOUT,        
     MATOUT,UPPER                                                          
     ******************************************************************    
                                                                           
1                                                                          
 25                         ROUTE GENERATION                               
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     SOME GENERAL COMMENTS ABOUT ADDING PROGRAMS TO MONSTERGAUSS           
     ******************************************************************    
                                                                           
     1  THE LAST OR TERMINAL EXECUTABLE STATEMENT IN ANY PROGRAM           
     SHOULD BE ... RETURN ... NEVER STOP.                                  
     THIS RESULTS IN THE LOADING OF THE NEXT LINK TO BE EXECUTED           
     IF IOP(1)=0 ... THE ROUTE CONTINUES NORMALLY INCLUDING THE            
     EXECUTION OF ANY LOOPS                                                
     IF IOP(1)=1 ... BYPASS ANY LOOP JUMP AFTER THIS LINK.                 
     IF IOP(1)=2 ... BYPASS ALL LINKS IN THE ROUTE UNTIL AFTER THE         
     NEXT LOOP JUMP (THE JUMP IS ALSO BYPASSED).                           
     IF IOP(1)=999 ... THIS IS THE FIRST ENTRY INTO LNK1.                  
     IF IOP(1) IS SET TO A NEGATIVE NUMBER, THE ROUTE WILL BE              
     TERMINATED IMMEDIATELY - IF IOP(1)=-1, THE CURRENT DENSITY            
     MATRIX WILL BE PUNCHED OUT BEFORE STARTING A NEW CALCULATION.         
     IF IOP(1)=-3, THE CURRENT BASIS SET IS PRINTED BEFORE TERMINATING     
     THE RUN.                                                              
                                                                           
     2  CHAIN MUST BE EXTENDED WHEN A NEW LINK IS ADDED.                   
                                                                           
     3  CHECK THE DICTIONARY OF PROGRAM AND SUBROUTINE NAMES               
     SO AS TO AVOID DUPLICATIONS ... AND MUCH TROUBLE.                     
                                                                           
     4  EACH LINK SHOULD CHECK IOP(10) WHEN IT IS ENTERED, AND RETURN      
     IMMEDIATELY IF NOTHING IS TO BE DONE ON CHECK RUNS (IOP(10)=0).       
     THIS ALLOWS EVEN CHECK RUNS TO ACTIVATE EACH DESIRED LINK AT          
     LEAST ONCE.                                                           
                                                                           
     ******************************************************************    
1                                                                          
                            ROUTE GENERATION                             26
                                                                           
                                                                           
                                                                           
     USE OF COMMON /A/:                                                    
                                                                           
     THIS IS ONE OF FEW AREAS OF CORE STORAGE WHICH REMAINS STATIC         
     DURING THE OVERLAYING PROCESS.                                        
     THEREFORE IT CONTAINS ALL INFORMATION NECESSARY TO INITIATE           
     COMMUNICATIONS FROM ONE PROGRAM TO ANOTHER.                           
                                                                           
     THE VARIOUS BLOCKS OF STORAGE ARE EMPLOYED AS FOLLOWS:                
                                                                           
     PERTAINING TO THE VARIOUS PROGRAM OPTIONS                             
                                                                           
     COMMON /A/ IOP(99)                                                    
                                                                           
     IOP ... THE PROGRAM OPTIONS IOP(1) TO IOP(60) AND IOP(93) TO          
     IOP(99) AND                                                           
     THE SPECIFICATION OF LINKS IOP(61) TO IOP(92)                         
                                                                           
     IOP(1) TO IOP(12) AND IOP(93) TO IOP(99) ARE NOT CHANGED DURING       
     OPTION LOADING FOR EACH LINK AND CAN BE USED TO STORE OTHER           
     VALUES ... CURRENTLY:                                                 
                                                                           
     IOP(1) IS USED TO INDICATE THAT THE NEXT JUMP ENCOUNTERED IN THE      
     EXECUTION OF THE ROUTE CARDS SHOULD BE SKIPPED (IF IOP(1)=1).         
     IF IOP(1)=0, ANY LOOPS ENCOUNTERED WILL BE EXECUTED.                  
     IF IOP(1) IS NEGATIVE, THE EXECUTION OF THE CURRENT ROUTE IS          
     ABANDONED, AFTER PUNCHING THE DENSITY MATRIX IF IOP(1)=-1.            
     IF IOP(1)=-3, THE CURRENT BASIS SET IS PRINTED BEFORE THE RUN         
     IS ABORTED.                                                           
     IF IOP(1)=2, ALL GROUP CARDS UP TO AND INCLUDING THE NEXT             
     JUMP DIRECTIVE ARE IGNORED.                                           
                                                                           
     IOP(2) IS NOT USED.                                                   
                                                                           
     IOP(3) IS USED TO SPECIFY IF THE CALCULATION IS TO BE DONE            
     IN THE PRESENCE OF A FIELD.                                           
     IF IOP(3)=0 THERE IS NO EXTERNAL FIELD.                               
     IF IOP(3)=1 THERE IS A UNIFORM EXTERNAL ELECTRIC FIELD PRESENT.       
     IF IOP(3)=2 THE CALCULATION IS TO INCLUDE SOLVENT EFFECTS (SCRFT).    
                                                                           
     IOP(4) IS USED BY THE MOROKUMA ENERGY DECOMPOSITION AND/OR            
     COUNTER-POISE BASIS SET SUPERPOSITION ERROR CORRECTION.               
     IF IOP(4) IS 0, THEN NEITHER OF THESE OPTIONS IS IN EFFECT.           
                                                                           
     IOP(5) IS THE GEOMETRY INPUT CODE: 0 FOR FREE, 1 FOR ZMAT, 2 FOR      
     DIRECT INPUT IN ANGSTROMS, 3 FOR DIRECT INPUT IN ATOMIC UNITS.        
                                                                           
     IOP(6) IS THE BASIS SET: 0 FOR STO-NG, 1 FOR N-21G, 2 FOR N-31G,      
     3 FOR PULAY N-21G, 4 FOR N-311G, 7 FOR A GENERAL BASIS.               
                                                                           
     IOP(7) IS FOR D/F FUNCTIONS: 0 FOR NONE, 1 IF THE BASIS SET MAY       
     CONTAIN D OR F FUNCTIONS.                                             
                                                                           
     IOP(8) IS THE D/F FUNCTION TYPE: 0 FOR CARTESIAN 6D/10F ORBITALS,     
     1 FOR PURE 5D/7F ORBITALS. ONLY USED IF IOP(7) IS NON-ZERO.           
                                                                           
     IOP(9) IS THE SCF METHOD: 0 FOR CLOSED SHELL RHF, 1 FOR OPEN          
     SHELL UHF, 2 FOR OPEN SHELL RHF.                                      
                                                                           
1                                                                          
 27                         ROUTE GENERATION                               
                                                                           
                                                                           
                                                                           
     IOP(10) IS THE RUN TYPE: 0 FOR CHECK RUNS, 1 FOR SINGLE               
     CALCULATIONS, 2 FOR Z MATRIX OPTIMIZATIONS, 3 FOR SIMULTANEOUS        
     OPTIMIZATIONS, 4 FOR SURFACE SCANS AND 5 FOR PMO RESTARTS.            
                                                                           
     IOP(11) IS NORMALLY ZERO, BUT IS SET TO 1 FOR RHF OPEN SHELL          
     SHELL SINGLET CASES.                                                  
                                                                           
     IOP(12) IS NOT USED.                                                  
                                                                           
     IOP(13) TO IOP(60) ARE USED FOR THE INDIVIDUAL LINK OPTIONS.          
                                                                           
     IOP(61) TO IOP(92) ARE USED TO CONTROL WHAT LINKS ARE CALLED.         
                                                                           
     IOP(93) IS USED IN GROUPS 3 AND 4 AT THE START OF A CALCULATION       
     TO PASS THE NUMBER OF BASIS FUNCTIONS IN THE BASIS SET TO BE          
     PROJECTED.                                                            
     IT IS ALSO USED IN GROUP 9 TO PASS THE NUMBER OF TRANSFORMED MO.      
     IT IS ALSO USED TO PASS THE PRINT TIMING DATA FLAG BETWEEN            
     LINK 0101 AND ROUTINE CHAIN.                                          
                                                                           
     IOP(94) KEEPS TRACK OF THE ORIGIN OF THE LAST TOTAL ENERGY            
     (VARIABLE E3 IN COMMON /GEN/): A 0 MEANS THE ENERGY IS FROM           
     AN SCF CALCULATION (CLOSED SHELL, UHF, RHF, MC-SCF OR GVB),           
     A 1 MEANS THE ENERGY IS FROM A CI-SD (CI SINGLES AND DOUBLES)         
     CALCULATION, AND A 2 MEANS THE ENERGY IS FROM A CI-SDQ (CI            
     SINGLES, DOUBLES AND QUADRUPLES) CALCULATION.                         
     NOTE: AT PRESENT, ONE ELECTRON PROPERTIES ARE ONLY AVAILABLE          
     AT THE SCF LEVEL.                                                     
                                                                           
     IOP(95) TO IOP(99) ARE NOT USED.                                      
                                                                           
     TO THE PARTICULAR MOLECULE AT HAND                                    
                                                                           
     COMMON /A/ NATOMS,ICHARG,MULTIP,IAN(NA),NAE,NBE,NE,NBASIS,C(NA,3)     
                                                                           
     NATOMS ... NUMBER OF ATOMS.                                           
     ICHARG ... CHARGE ON THE MOLECULE.                                    
     MULTIP ... SPIN MULTIPLICITY OF THE MOLECULE:                         
     1 = SINGLET                                                           
     2 = DOUBLET                                                           
     AND SO FORTH.                                                         
     IAN ... ATOMIC NUMBERS OF THE ATOMS.                                  
     NAE ... NUMBER OF ELECTRONS WITH ALPHA SPIN.                          
     NBE ... NUMBER OF ELECTRONS WITH BETA SPIN.                           
     NE ... TOTAL NUMBER OF ELECTRONS  ( NAE + NBE ).                      
     NBASIS ... NUMBER OF BASIS FUNCTIONS (ATOMIC ORBITALS) EMPLOYED.      
     C ... COORDINATES OF THE MOLECULE.                                    
                                                                           
     SPECIFYING VARIOUS CONVERSION FACTORS:                                
                                                                           
     COMMON /A/ ANTOAU,DCONST,FCONV,FCCONV                                 
                                                                           
     ANTOAU ... CONVERTS ANGSTROMS TO ATOMIC UNITS                         
     DCONST ... CONVERTS DIPOLE MOMENT IN ATOMIC UNITS TO DEBYES           
     FCONV ... CONVERTS FORCES IN HARTREE/BOHR TO MDYNE                    
     FCCONV ... CONVERTS FORCE CONSTANTS IN HARTREE/ANGSTROM**2 TO         
                MDYNE/ANGSTROM                                             
                                                                           
1                                                                          
                            ROUTE GENERATION                             28
                                                                           
                                                                           
                                                                           
     PERTAINING TO THE GROUP STRUCTURE:                                    
                                                                           
     COMMON /A/ LNK(100),NLINK,JOP(10,30)                                  
                                                                           
     LNK ... CODED SEQUENCE OF LINKS AND JUMPS TO BE FOLLOWED.             
     NLINK ... COUNTER FOR LNK.                                            
     JOP ... OPTIONS FOR THE ENTIRE RUN STORED IN COMPRESSED FORM.         
                                                                           
1                                                                          
 29                         ROUTE GENERATION                               
                                                                           
                                                                           
                                                                           
     GENERATE THE DESIRED ROUTE FROM THE INFORMATION READ BY               
     LINK 0101 FROM THE *MOL, *PRT AND *PUN CARDS. THIS IS DONE BY         
     MODIFYING A BASIC ROUTE, GIVEN BELOW, DEPENDING MAINLY ON THE         
     RUN TYPE (ITYPE) AND THE PROPERTIES DESIRED.                          
                                                                           
     THE ROUTES THAT ARE RECOGNIZED ARE A SINGLE CALCULATION (ITYPE=1),    
     Z MATRIX GEOMETRY OPTIMIZATIONS (ITYPE=2), FORCE OPTIMIZATIONS        
     (ITYPE=3), SURFACE SCANS (ITYPE=4), PMO RESTARTS (ITYPE=5),           
     ENERGY DECOMPOSITION / BSSE (ITYPE=6), AND CHECK RUNS (ICHK=0).       
                                                                           
     IN THE BASIC ROUTE, THE GROUPS REQUIRED ARE INDICATED BY A *,         
     THE OPTIONAL ONES BY (*), AND BLANKS INDICATE THAT GROUP WILL         
     BE SUPRESSED LATER, UNLESS MODIFIED BY THE *IOP CONTROL CARDS.        
                                                                           
     SEQ  GROUP   SINGLE  ZMOPT  GBOPT  SCAN  PMO=R  ED/BS  CHECK          
                                              MRDCI                        
                                                                           
      1     2        *      *      *      *     *      *      *            
      2     3        *      *      *      *     *      *      *            
      3     4        *      *      *      *     *      *      *            
      4     5        *      *      *      *    (*)     *      *            
      5     6        *      *      *      *     *      *      *            
      6     8       (*)    (*)    (*)    (*)                 (*)           
      7     9       (*)    (*)    (*)    (*)                 (*)           
      8     7       (*)    (*)     *     (*)                 (*)           
      9     2               *             *                  (*)           
     10     3               *      *     (*)                               
     11     5               *      *      *                                
     12     6                             *                                
     13     8                            (*)                               
     14     9                            (*)                               
     15     7                      *     (*)                               
     16     2               *             *                                
     17     3              (*)    (*)                                      
     18     6               *      *                  (*)                  
     19     8              (*)    (*)                 (*)                  
     20     9              (*)    (*)                 (*)                  
     21     7              (*)                        (*)                  
1                                                                          
                                                                         30
                                                                           
                                                                           
                                                                           
 CHAPTER 3: IBM JCL AND DISK FILE USAGE.                                   
 **********                                                                
                                                                           
     IBM DATASETS NECESSARY FOR THE EXECUTION OF MONSTERGAUSS.             
                                                                           
     FT01F001 ... COEFFICIENTS/DENSITY INPUT FOR INITIAL GUESS             
     (DD DUMMY UNLESS ASSIGNED TO A DISK FILE).                            
                                                                           
     FT05F001 ... CONTROL CARDS PLUS DATA (DD *)                           
                                                                           
     FT06F001 ... PRINTED OUTPUT (DD SYSOUT=A)                             
                                                                           
     FT07F001 ... PUNCHED OUTPUT (DD SYSOUT=B)                             
                                                                           
     FT08F001 ... MATRIX SCRATCH FILE (DD UNIT=SYSDA,                      
     SPACE=(#IRECL,(#NBLOCK)),DCB=(DSORG=DA,RECFM=F,BLKSIZE=#IRECL) )      
     WHERE #NBLOCK IS THE TOTAL NUMBER OF BLOCKS DETERMINED BY             
     PROGRAM 'CONVERT2', WITH BLOCK SIZE #IRECL BYTES.                     
                                                                           
     FT09F001 ... TWO ELECTRON INTEGRALS (DD UNIT=SYSDA,                   
     SPACE=(12296,(200,50)),DCB=(DSORG=PS,RECFM=VS,BLKSIZE=12296,          
     LRECL=12292) )                                                        
     (NOTE: 200 BLOCKS IS OK FOR UP TO 50 AO).                             
                                                                           
     FT10F001 ... TRANSFORMED ONE AND TWO ELECTRON INTEGRALS (DD           
     UNIT=SYSDA,SPACE=(6232,(50,50)),DCB=(DSORG=PS,RECFM=VS,               
     BLKSIZE=6232,LRECL=6228) )                                            
                                                                           
     FT11F001 ... GSCF SCRATCH / CI / MRDCI (DD UNIT=SYSDA,                
     SPACE=(6232,(200,100)),DCB=(DSORG=PS,RECFM=VS,BLKSIZE=6232,           
     LRECL=6228) )                                                         
     FOR THE GSCF ROUTINE, THIS UNIT MUST BE ABLE TO CONTAIN               
     #NBB*#NF DOUBLEWORDS.                                                 
                                                                           
     FT12F001 ... GSCF SCRATCH / SORTED MO INTEGRALS (DD UNIT=SYSDA,       
     SPACE=(6232,(50,50)),DCB=(DSORG=PS,RECFM=VS,                          
     BLKSIZE=6232,LRECL=6228) )                                            
     FOR THE GSCF ROUTINE, THIS UNIT MUST BE ABLE TO CONTAIN               
     #NBB*#NF DOUBLEWORDS.                                                 
                                                                           
     FT13F001 ... MO INTEGRAL LABELS (DD UNIT=SYSDA,                       
     SPACE=(6232,(25,25)),DCB=(DSORG=PS,RECFM=VS,                          
     BLKSIZE=6232,LRECL=6228) )                                            
                                                                           
     FT14F001 ... COUPLING COEFFICIENTS (DD UNIT=SYSDA,                    
     SPACE=(6232,(30)),DCB=(DSORG=PS,RECFM=VS,                             
     BLKSIZE=6232,LRECL=6228) )                                            
                                                                           
     FT15F001 ... CI FORMULA TAPE (DD UNIT=SYSDA,                          
     SPACE=(6232,(3000,1000)),DCB=(DSORG=PS,RECFM=VS,                      
     BLKSIZE=6232,LRECL=6228) )                                            
                                                                           
     FT16F001 ... TWO ELECTRON INTEGRAL DERIVATIVES (DD UNIT=SYSDA,        
     SPACE=(12296,(200,50)),DCB=(DSORG=PS,RECFM=VS,BLKSIZE=12296,          
     LRECL=12292) )                                                        
                                                                           
     FT19F001 ... SETUP ROUTINE DEBUG OUTPUT (DD DUMMY FOR                 
     NORMAL OPERATION, DD SYSOUT=A FOR TESTING PURPOSES).                  
1                                                                          
 31                      IBM JCL AND DISK FILES                            
                                                                           
                                                                           
                                                                           
     NOTES:                                                                
     (1) THERE WAS NO ADVANTAGE TO DOUBLE BUFFERING (THE DEFAULT)          
     FOR THE FORTRAN H-EXTENDED VERSION, BUT THE BEST OPTION FOR           
     THE CURRENT VERSION (USING THE FORTRAN-VS COMPILER) HAS NOT BEEN      
     DETERMINED - IF YOU DO SOME TESTS, PLEASE INFORM THE AUTHORS OF       
     YOUR RESULTS SO FUTURE GENERATIONS WILL KNOW WHAT TO DO.              
     THIS IS SPECIFIED ADDING BUFNO=1 OR BUFNO=2 TO THE DCB FOR EACH       
     FILE (THE ASYNCHRONOUS I/O UNITS 'IMAT', 'ITWOEL' AND 'ITWODR'        
     SHOULD ALSO BE TESTED).                                               
                                                                           
     (2) THE BLOCK AND RECORD SIZES ON UNITS 10 THROUGH 15 ARE             
     (RELATIVELY) ARBITRARY:                                               
     APPARENTLY A REASONABLE BLOCK SIZE FOR IBM 3350 AND 3380 DISK         
     DRIVES IS 6233 BYTES (OR LESS) - THUS BLKSIZE=6232 AND                
     LRECL=BLKSIZE-4=6228 WERE CHOSEN, ALTHOUGH SOME EXPERIMENTATION       
     BY THE USER ON YOUR COMPUTER SYSTEM MAY YIELD BETTER VALUES. THE      
     PRIMARY ALLOCATIONS ARE GOOD FOR ABOUT 20 MO IN THE CI, BUT UP        
     TO 5 EXTENTS MAY BE NEEDED TO HANDLE 40 MO.                           
                                                                           
     (3) UNITS 11 AND 12 ARE ALSO REQUIRED IN THE GENERALIZED              
     SCF, LINK 0503. UNIT 11 IS USED TO STORE THE MRDCI DATA.              
                                                                           
     (4) UNIT 15 IS ALSO REQUIRED IN THE ENERGY DECOMPOSITION / BSSE       
     TO HOLD SELECTED 2-ELECTRON INTEGRALS, AND IN THE LMO FINITE          
     FIELD POLARIZABILITY CALCULATION.                                     
                                                                           
     (5) UNITS NOT NEEDED FOR A GIVEN CALCULATION MAY BE DEFINED AS        
     'FTXXF001 DD DUMMY'.                                                  
                                                                           
1                                                                          
                         IBM JCL AND DISK FILES                          32
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     DICTIONARY OF DISK FILES (LENGTH IN DOUBLEWORDS, FOLLOWED BY          
     THE ACTUAL RECORD NUMBERS (ON UNIT 8) USED ARE GIVEN IN BRACKETS).    
     ******************************************************************    
                                                                           
     THESE VALUES APPLY ONLY FOR THE FOLLOWING PARAMETER VALUES:           
     #NA     =      30 NUMBER OF ATOMS                                     
     #NB     =      80 NUMBER OF BASIS FUNCTIONS (A.O.'S)                  
     #NS     =      50 NUMBER OF SHELLS                                    
     #NP     =     180 NUMBER OF PRIMITIVE GAUSSIANS                       
     #NR     =      49 NUMBER OF OCCUPIED ORBITALS IN RHF                  
     #NF     =      50 NUMBER OF FOCK MATRICES IN RHF                      
     #NC     =      50 NUMBER OF CONFIGURATIONS IN RHF                     
     #NO     =     125 NUMBER OF OPTIMIZABLE PARAMETERS                    
     #NT     =      36 NUMBER OF TRANSFORMED ORBITALS (M.O.'S)             
     #NCON   =   13000 NUMBER OF CONFIGURATIONS IN CI                      
     #MA     =      10 NUMBER OF ACTIVE OCCUPIED MO IN CI                  
     #MV     =      34 NUMBER OF ACTIVE SUBSTITUTING MO IN CI              
     #IRECL  =    6144 RECORD SIZE IN BYTES                                
                                                                           
      1      OPTIMIZATION CONTROL AND RESTART (431: 120)                   
      2      SCALE FACTORS AND RAW COEFFICIENTS (410: 12)                  
      3      ERROR FUNCTION INTERPOLATION TABLE (7200: 1-10)               
      4      SCRATCH SCF/PMO/CI (6400: 74-82)                              
      5      EIGENVALUES AND RHF SAVE DATA (427: 83)                       
      6      BASIS SET (691: 11)                                           
      7      SURFACE SCAN INCREMENTS (114: 137)                            
      8      OVERLAP MATRIX S (3420: 13-17)                                
      9      CI CONFIGURATION SAVE DATA (1115: 134-135)                    
     10      OC/BFGS/VA05 SAVE DATA (1375: 121-122)                        
     11      OC/BFGS/VA05 SAVE DATA (8100: 125-135)                        
     12      INTEGRAL TRANSFORMATION SAVE DATA (54: 136)                   
     13      CORE HAMILTONIAN (T+V) (3240: 59-63)                          
     14      FORCES (1628: 154-156)                                        
     15      FOCK MATRIX  ALPHA SPIN OR CLOSED SHELL (3240: 64-68)         
     16      NOT USED                                                      
     17      FOCK MATRIX  BETA SPIN (3240: 69-73)                          
     18      NOT USED                                                      
     19      DENSITY MATRIX  ALPHA SPIN OR CLOSED SHELL (3240: 18-22)      
     20      NOT USED                                                      
     21      DENSITY MATRIX  BETA SPIN (3240: 23-27)                       
     22 - 24 NOT USED                                                      
     25      MO COEFFICIENTS  ALPHA SPIN OR CLOSED SHELL (6400: 84-92)     
     26      NOT USED                                                      
     27      MO COEFFICIENTS  BETA SPIN (6400: 93-101)                     
     28 - 30 NOT USED                                                      
     31 - 32 SCRATCH SCF/PMO/CI (EACH 8182: 28-38, 39-49)                  
     33      SCRATCH SCF/PMO/CI (6480: 50-58)                              
     34 - 36 X Y Z INTEGRALS (EACH 3240: 138-142, 143-147, 148-152)        
     37 - 39 NOT USED                                                      
     40      SCRATCH GSCF/LMO/ED/BSSE (6400: 102-110)                      
     41      ENERGY DECOMP / BSSE COEFFICIENTS (6400: 157-165)             
     42      SCRATCH GSCF/LMO/ED/BSSE (6400: 111-119)                      
     43      ENERGY DECOMP / BSSE COEFFICIENTS (6400: 166-174)             
     44      ENERGY DECOMP / BSSE SAVE DATA (108: 175)                     
     45      NOT USED                                                      
     46      ED / BSSE RHF SAVE DATA FOR A (427: 188)                      
     47      ED / BSSE RHF SAVE DATA FOR B (427: 189)                      
1                                                                          
 33                      IBM JCL AND DISK FILES                            
                                                                           
                                                                           
                                                                           
     48      NOT USED                                                      
     49      FUNDAMENTAL CONSTANTS AND OEP SAVE DATA (425: 153)            
     50      FORCE CONSTANTS (8100: 176-186)                               
     51 -100 NOT USED.                                                     
                                                                           
     TOTAL LENGTH IS 144384 DOUBLEWORDS (188 RECORDS OF 6144 BYTES).       
                                                                           
     FILES 4 AND 31 ARE USED FOR TEMPORARY STORAGE OF THE BASIS            
     SET AND OVERLAP MATRICES FOR PROJECTED INITIAL GUESSES.               
                                                                           
     FILE 32 IS USED FOR TEMPORARY STORAGE DURING RHF INITIAL GUESSES.     
                                                                           
     FILES 17, 21 AND 27 SAVE OVERLAP, FOCK AND COEFFICIENT MATRICES       
     DURING PMO RUNS.                                                      
                                                                           
     FILES 17, 21 AND 27 SAVE MO BASIS RESULTS DURING CLOSED               
     SHELL ENERGY DECOMPOSITION / BSSE RUNS.                               
                                                                           
     FILE 4 IS USED FOR TEMPORARY STORAGE DURING POLARIZATION RUNS.        
                                                                           
     FILE 42 IS USED TO STORE THE LMO 'T' MATRIX FOR RUNS WITH IOP(27)     
     SET IN LINK 0802.                                                     
     ******************************************************************    
1                                                                          
                                                                         34
                                                                           
                                                                           
                                                                           
 CHAPTER 4: GEOMETRY INPUT.                                                
 **********                                                                
                                                                           
 STANDARD GEOMETRY SETUP.                                                  
 ************************                                                  
                                                                           
     LINK 0201                                                             
                                                                           
     THIS PROGRAM ACCEPTS A CONDENSED FORM OF THE MOLECULAR CONNECTION     
     TABLE, WHICH INDICATES ALL THE BONDS AND THEIR TYPES, AND             
     CONSTRUCTS THE Z MATRIX FOR USE BY PROGRAM VGEOM. STANDARD BOND       
     LENGTHS AND ANGLES ARE ASSIGNED BASED ON THE LOCAL ATOM               
     ENVIRONMENTS, THEN ANY CHANGES REQUESTED BY THE USER ARE PROCESSED    
                                                                           
     AUTHOR: MIKE PETERSON, U OF T CHEMISTRY DEPT, TORONTO, CANADA.        
                                                                           
     ******************************************************************    
     INPUT REQUIRED TO BUILD A STANDARD GEOMETRICAL MODEL.                 
     ******************************************************************    
                                                                           
     NXPLCT (I4) ... THIS IS THE NUMBER OF ATOMS THAT HAVE BEEN            
     ASSIGNED EXPLICIT NUMBERS BY THE USER. ATOMS CONNECTED TO MORE        
     THAN ONE ATOM MUST BE GIVEN EXPLICIT NUMBERS, BUT MOST 'TERMINAL'     
     ATOMS NEED NOT BE ASSIGNED A NUMBER. THE EXPLICIT ATOMS WILL          
     APPEAR IN THE Z MATRIX IN NUMERICAL ORDER, AND THE REMAINDER ARE      
     NUMBERED IN THE ORDER THEY ARE ENCOUNTERED IN THE CONNECTION          
     TABLE (CT). THIS ENSURES THAT NO EXPLICIT ATOM EVER CHANGES ITS       
     POSITION (NUMBER) IN THE LIST OF ATOMS. THE FIRST ATOM IS ALWAYS      
     ATOM 1, SO NXPLCT MUST BE AT LEAST 1.                                 
     THE PROGRAM WILL HANDLE UP TO 30 ATOMS IN TOTAL.                      
                                                                           
     SETTING NXPLCT TO A NEGATIVE NUMBER CAUSES A DUMP OF THE CONTENTS     
     OF THE STANDARD BOND LENGTH TABLES - ABOUT 30 PAGES OF OUTPUT.        
     A -1 DUMPS JUST THE BOND LENGTH TABLES, WHILE -2 DUMPS EXTRA          
     TABLES USED IN THE DERIVATION OF THE BOND LENGTH TABLES.              
     IT ALSO CAUSES AN ERROR TO BE SIGNALED (BY IOP(1)=-2) SO THE          
     "CALCULATION" THAT REQUESTED A DUMP IS TERMINATED IMMEDIATELY.        
     THUS THE INPUT NEED ONLY BE THE *MOL CARD WITH THE GEOM=SG OPTION,    
     2 BLANK CARDS (FOR TITLE AND THE CHARGE/MULTIPLICITY), THEN A -1      
     OR -2 FOR NXPLCT.                                                     
                                                                           
     THE NEXT NXPLCT CARDS CONTAIN THE ATOM CONNECTION INFORMATION.        
     EACH CARD HAS THE GENERAL FORM                                        
                                                                           
     SF TA TR TW TX TY TZ $N                                               
                                                                           
     WHILE THE SF FIELD MAY START IN COLUMN 1 OF THE CARD, ALL OTHER       
     FIELDS MUST BE PRECEEDED AND FOLLOWED BY AT LEAST ONE BLANK.          
                                                                           
     IN THE FIRST FIELD, S IS THE CHEMICAL SYMBOL FOR THIS ATOM (1 OR      
     2 LETTERS). F IS THE FORMAL CHARGE: + FOR POSITIVE, - FOR             
     NEGATIVE OR BLANK FOR ZERO.                                           
                                                                           
     THE $N FIELD IS DISCUSSED BELOW IN DETAIL.                            
                                                                           
     THE REMAINING FIELDS ON THE CARD DEFINE THE CONNECTIONS TO THIS       
     ATOM. T IN EACH CASE IS THE TYPE OF BOND: - OR BLANK FOR SINGLE       
     BONDS, . FOR AROMATIC OR DELOCALIZED BONDS, = FOR DOUBLE BONDS        
1                                                                          
 35                          GEOMETRY INPUT                                
                                                                           
                                                                           
                                                                           
     AND : FOR TRIPLE BONDS, BASED ON SIMPLE ELECTRON DOT DIAGRAMS.        
     A, R, W, X, Y AND Z MAY BE EITHER AN EXPLICIT ATOM NUMBER (FROM 1     
     UP TO NXPLCT), OR A CHEMICAL SYMBOL (1 OR 2 LETTERS). IN THE          
     LATTER CASE, AN ATOM NUMBER IS ASSIGNED, WORKING FROM 'A' TO 'Z',     
     STARTING WITH THE FIRST AVAILABLE Z MATRIX POSITION. ATOMS            
     DEFINED THIS WAY MUST BE TERMINAL ATOMS - THEY ARE BONDED ONLY TO     
     ATOM S.                                                               
                                                                           
     A IS THE 'ATTACHMENT ATOM' - THE ATOM USED TO DEFINE THIS ATOM.       
     A MUST REFER TO AN ATOM *ALREADY DEFINED*, IE, THAT HAS AN            
     EXPLICIT ATOM NUMBER LOWER THAN THAT OF THE CURRENT ATOM (S).         
     THE ONLY EXCEPTION IS THE FIRST ATOM, WHERE A ALWAYS REFERS TO        
     ATOM NUMBER 2 (WHETHER ATOM 2 IS EXPLICITLY OR IMPLICITLY             
     DEFINED).                                                             
                                                                           
     R IS THE 'REFERENCE ATOM' - THIS ATOM IS USED IN TWO WAYS:            
                                                                           
     (1) TO ORIENT ATOM S WITH RESPECT TO THE ATTACHMENT ATOM OF ATOM      
     A - THE ATTACHMENT ATOM OF THE CURRENT ATOM IS USED TO DEFINE         
     THE LOCAL VALENCE ANGLES, AND THE ATTACHMENT ATOM OF ATOM A           
     (DENOTED A(A)) DEFINES THE DIHEDRAL ANGLE R-S-A-A(A). THE DEFAULT     
     DIHEDRAL ANGLE IS 0 DEGREES (IE ECLIPSED), BUT THE ENTIRE GROUP       
     CAN BE ROTATED - SEE BELOW. THE ONLY EXCEPTIONS TO USING A(A) AS      
     THE FOURTH ATOM IN THE DIHEDRAL ANGLE ARE:                            
     (I) IF S IS EITHER ATOM 1 OR 2, THEN THE REFERENCE ATOM R(A) IS       
     USED IN PLACE OF A(A) WHICH WOULD LEAVE THE GEOMETRY UNDEFINED,       
     SINCE A(A) IS SIMPLY ATOM S.                                          
     (II) AN EXPLICIT ATOM NUMBER TO BE USED IN PLACE OF A(A) WAS          
     SPECIFIED BY A FIELD $N ON THE CONNECTION CARD FOR ATOM A, WHERE      
     N IS THE ATOM NUMBER TO USE AS A(A). THIS SPECIAL FIELD IS            
     NEEDED WHENEVER THE ANGLE S-A-A(A) IS LINEAR.                         
                                                                           
     (2) THE ATOM R IS THEN USED TO DEFINE THE DIHEDRAL ANGLES OF          
     ATOMS OTHER THAN A AND R (IE W, X, Y AND Z) CONNECTED TO S, WHICH     
     ARE ALWAYS DEFINED BY THE DIHEDRAL ANGLES W-S-A-R, X-S-A-R,           
     Y-S-A-R AND Z-S-A-R, REGARDLESS OF WHETHER A REPLACEMENT WAS          
     GIVEN FOR ATOM A BY THE $N OPTION ABOVE. THUS ROTATION OF ATOM R      
     CAUSES A RIGID ROTATION OF ALL ATOMS ATTACHED TO S.                   
                                                                           
     ******************************************************************    
     CONTROL CARDS TO REQUEST CHANGES IN THE STANDARD MODEL.               
     ******************************************************************    
                                                                           
     THERE ARE TWO TYPES OF OPTION CARDS THAT MAY APPEAR AFTER THE         
     LAST CT CARD. THEY BOTH HAVE THE GENERAL FORM: CODE, I, J, A (IN      
     A4,2I4,F12.6 FORMAT) WHERE CODE IS 'ROTB', 'SETZ' OR '    '.          
     ROTB AND SETZ CARDS MAY BE USED AS OFTEN AS REQUIRED, IN ANY          
     ORDER. LEAVING THE CODE BLANK SIGNALS THE END OF THESE USER-          
     REQUESTED CHANGES (OR THAT NONE ARE REQUIRED).                        
                                                                           
     ROTB ... I AND J ARE ATOM NUMBERS WHICH WERE EXPLICITLY DEFINED.      
     THE I-J BOND IS ROTATED FROM ITS CURRENT POSITION BY A DEGREES        
     (COUNTERCLOCKWISE). THIS RESULTS IN RIGID ROTATION OF THE ENTIRE      
     GROUP ABOUT THE I-J BOND. NOTE: THE I-J BOND MUST HAVE BEEN USED      
     IN DEFINING THE GEOMETRY - IE I WAS GIVEN AS THE ATTACHMENT ATOM      
     FOR J (OR VICE VERSA) FOR THIS OPTION TO WORK.                        
                                                                           
1                                                                          
                             GEOMETRY INPUT                              36
                                                                           
                                                                           
                                                                           
     SETZ ... I IS THE *PARAMETER NUMBER* OF AN ELEMENT                    
     IN THE Z MATRIX, WHICH IS SET TO A (SEE PROGRAM VGEOM FOR DETAILS     
     ON THE NUMBERING SCHEME USED FOR THE Z MATRIX ELEMENTS). THIS         
     OPTION MUST BE USED TO FILL IN INFORMATION ABOUT ATOMS NOT            
     INCLUDED IN THE STANDARD TABLES. THE FIELD J IS IGNORED.              
                                                                           
     ******************************************************************    
     SPECIAL FEATURES AND NOTES.                                           
     ******************************************************************    
                                                                           
     1  THE LOCAL GEOMETRY IS DETERMINED FROM THE 'NUMBER OF NEIGHBOUR     
     EQUIVALENTS' (NONE), THE SUM OF THE NUMBER OF NEIGHBOURING ATOMS      
     PLUS THE NUMBER OF LONE PAIRS. SINGLE ELECTRONS, WHICH ARISE IN       
     RADICALS AND AROMATIC/DELOCALIZED SYSTEMS, ARE IGNORED. ANY LONE      
     ELECTRON PAIRS ON A CENTER, FOUND BY SUBTRACTING THE TOTAL            
     NUMBER OF ELECTRONS IN THE BONDS FROM THE NUMBER OF VALENCE           
     ELECTRONS (ADJUSTED FOR THE FORMAL CHARGE) ARE PLACED AT THE END      
     OF THE CONNECTION TABLE - FOR EXPLICIT CONTROL OVER THE ORDERING      
     OF THE ATOMS AT A CENTER, THE DESIGNATION 'E*' IS USED TO INDICATE    
     THAT AN ELECTRON PAIR IS TO OCCUPY THIS POSITION ('E*' IS USED AS     
     R, W, X, Y OR Z). IT WILL APPEAR AS A DUMMY ATOM IN THE Z MATRIX      
     (WITH A BOND LENGTH OF 1.0 ANGSTROMS), BUT HAS ATOMIC NUMBER 56       
     INSIDE THE STDGEO PROGRAM.                                            
                                                                           
     2  THE CONFIGURATION AT A CENTER IS DETERMINED BY THE ORDER           
     THE NEIGHBOURS APPEAR IN THE CT. ATOM A DEFINES THE 'PRINCIPLE        
     AXIS', AND R DEFINES A REFERENCE POINT NOT LYING ON THE LINE S-A      
     (EXCEPT FOR TRI-ATOMICS, WHICH MAY BE LINEAR). FOR LINEAR VALENCE     
     ANGLES, THIS REQUIRES AN EXPLICIT DUMMY ATOM (SYMBOL 'X') DEFINED     
     AS R AND THE USE OF THE $N OPTION. THE DEFAULT CHARACTERISTICS OF     
     'X' ARE A BOND LENGTH OF 1.0 ANGSTROMS AND A BOND ANGLE (R-S-A)       
     OF 90 DEGREES. 'X' ATOMS HAVE ATOMIC NUMBER 55 INSIDE THE STDGEO      
     PROGRAM, BUT ARE REPLACED BY DUMMY ATOMS IN THE Z MATRIX.             
     WITH R AND A ESTABLISHED, THE REMAINING ATOMS ARE DEFINED BY          
     THEIR DIHEDRAL ANGLE (MEASURED COUNTERCLOCKWISE) FROM R, WHEN         
     LOOKING ALONG THE S-A BOND FROM S TOWARDS A.                          
     FOR NONE=2 (LINEAR), THE ANGLE W-S-A IS 180 AND THE ANGLE W-S-A-R,    
     WHERE R IS X, IS ARBITRARY (IT IS SET TO 0).                          
     FOR NONE=3 (TRIGONAL), THE VALENCE ANGLES R-S-A AND W-S-A ARE         
     120, AND THE ANGLE W-S-A-R IS 180 (W, S, A AND R PLANAR).             
     FOR NONE=4 (TETRAHEDRAL), THE VALENCE ANGLES ARE 109.47, AND THE      
     DIHEDRAL ANGLES W-S-A-R AND X-S-A-R ARE 120 AND 240.                  
     FOR NONE=5 (TRIGONAL BIPYRAMIDAL), A IS TAKEN AS AXIAL, WITH R, W     
     AND X EQUATORIAL (VALENCE ANGLES OF 90 WITH A THROUGH S, AND          
     DIHEDRAL ANGLES W-S-A-R AND X-S-A-R OF 120 AND 240), AND Y            
     OCCUPIES THE REMAINING AXIAL POSITION.                                
     FOR NONE=6 (OCTAHEDRAL), ATOMS R, W, X AND Y ARE "EQUATORIAL"         
     (THE W, X AND Y DIHEDRAL ANGLES ARE 90, 180 AND 270 WITH RESPECT      
     TO R), AND Z OCCUPIES THE OTHER "AXIAL" POSITION (ON THE              
     PRINCIPLE AXIS).                                                      
     COORDINATION NUMBERS HIGHER THAN 6 CANNOT BE TREATED AS YET.          
     NOTE THAT WHILE 'E*' ATOMS ARE COUNTED IN THE DETERMINATION OF THE    
     LOCAL GEOMETRY, DUMMY ATOMS ARE NEVER COUNTED.                        
     NOTE ALSO THAT THE SYMBOL 'D*' IS ACCEPTED BY THE PROGRAM             
     AS A DUMMY ATOM, ALTHOUGH THE SYMBOL 'X' IS TO BE PREFERRED.          
                                                                           
1                                                                          
 37                          GEOMETRY INPUT                                
                                                                           
                                                                           
                                                                           
     3  THE LOCAL GEOMETRY MAY BE MODIFIED BY THE PRESENCE OF              
     NEIGHBOURING UNSATURATION - THE PRINCIPLE IS THAT IF CONJUGATION      
     OF AN ELECTRON PAIR WITH AN ADJACENT CENTER IS POSSIBLE, THE          
     GEOMETRY IS MODIFIED TO PERMIT IT. THIS MODIFICATION IS MADE ONLY     
     IF AT LEAST ONE ELECTRON PAIR WAS *NOT* DEFINED EXPLICITLY BY         
     THE USE OF 'E*', SINCE IF 'E*' IS EXPLICITLY INCLUDED IN THE CT,      
     THE PROGRAM ASSUMES IT WAS INCLUDED TO OBTAIN A DESIRED CONFORMER.    
     CURRENTLY, THIS IS IMPLEMENTED IN THE PROGRAM ONLY FOR THE CASE       
     NONE = 4 (TETRAHEDRAL), WHICH BECOMES TRIGONAL, BUT ONLY IF THERE     
     IS *ONLY 1* IMPLICIT ELECTRON PAIR ON THE ATOM - EG THE N ATOM IN     
     AN AMIDE.                                                             
                                                                           
     4  BONDS BETWEEN ATOMS OF OPPOSITE FORMAL CHARGE HAVE THE BOND        
     ORDER INCREASED BY ONE TO DETERMINE THE STANDARD BOND LENGTH. IN      
     THIS REGARD, BONDS SUCH AS S, P, AS AND SE TO TERMINAL O, AND         
     PHOSPHORUS YLIDS, ARE BETTER TREATED WHEN CONSIDERED AS DOUBLE        
     BONDS RATHER THAN AS DATIVE BONDS, EVEN WITH THE CHARGE TRANSFER      
     CORRECTION. HOWEVER DATIVE BONDS SHOULD BE USED FOR FIRST ROW         
     ATOMS (EG N-OXIDES) WHICH CANNOT HAVE MORE THAN 4 ELECTRON PAIRS      
     IN THE VALENCE SHELL.                                                 
                                                                           
     5  THE BOND LENGTH TABLES WILL TREAT ALL THE MAIN GROUP ATOMS         
     FROM H TO I, EXCLUDING THE TRANSITION METALS AND THE INERT GASES.     
     VALUES NOT KNOWN EXPERIMENTALLY ARE ESTIMATED FROM EITHER THE         
     MASTER TABLE OF SINGLE BOND LENGTHS, OR FROM COVALENT RADII, BY       
     THE USE OF MULTIPLYING FACTORS.                                       
                                                                           
     6  THE PROGRAM MAKES NO ATTEMPT TO SET STANDARD DIHEDRAL ANGLES,      
     ALTHOUGH IT IS IN PRINCIPLE SIMPLE, BECAUSE THIS COULD IMPLY THAT     
     THE CONFORMATION "SELECTED" BY THE STANDARD MODEL IS LIKELY TO BE     
     THE LOWEST IN ENERGY. HOWEVER, SOME BASIC RULES ARE:                  
     (I) USE STAGGERED CONFORMATIONS FOR SINGLE BONDS BETWEEN              
     SATURATED ATOMS.                                                      
     (II) USE ECLIPSED CONFORMATIONS FOR SINGLE BONDS WHEN EITHER END      
     IS UNSATURATED - IF ONE ATOM IS SATURATED, A BOND WILL ECLIPSE        
     THE UNSATURATION AT THE OTHER CENTER.                                 
     (III) CUMULATED SYSTEMS ARE ORTHOGONAL (STAGGERED) IF THE NUMBER      
     OF LINEAR ATOMS IS ODD (EG H2C=C=CH2), ELSE ECLIPSED.                 
                                                                           
     7  ALTHOUGH IT IS NOT NECESSARY, CONSTRUCTION OF THE CT IS            
     EASIEST IF THE EXPLICIT ATOMS ARE NUMBERED SEQUENTIALLY ALONG         
     BRANCHES OF THE MOLECULAR BACKBONE, OR AROUND RINGS. THE CHOICE       
     OF ATOM R IS IMPORTANT - IT IS THE REFERENCE POINT FOR THE LOCAL      
     GEOMETRY, AND R *MUST* BE DEFINED *BEFORE* ANY ATOMS ATTEMPT TO       
     USE IT. THUS R CANNOT BE GIVEN IMPLICITLY (BY ITS SYMBOL) IF          
     THERE ARE ANY EXPLICIT NEIGHBOURS OF S OTHER THAN A, SINCE ALL        
     EXPLICIT ATOMS ARE DEFINED FIRST IN THE Z MATRIX (IN THE Z MATRIX     
     ATOMS MUST BE DEFINED WITH RESPECT TO ATOMS THAT HAVE ALREADY         
     BEEN DEFINED). THIS MAY REQUIRE SOME TERMINAL ATOMS TO BE GIVEN       
     EXPLICIT NUMBERS IN SOME MOLECULES (SEE THE USE OF 'X' IN LINEAR      
     MOLECULES) IF A TERMINAL ATOM IS USED AS R.                           
                                                                           
     8  'X' AND 'E*' SHOULD NOT HAVE A BOND TYPE SPECIFIED (IF ONE IS,     
     IT IS IGNORED), AND MUST NEVER CARRY A FORMAL CHARGE.                 
     'X' MAY BE USED ONLY EXPLICITLY, AS ATOM R FOR LINEAR CASES.          
                                                                           
     ******************************************************************    
                                                                           
1                                                                          
                             GEOMETRY INPUT                              38
                                                                           
                                                                           
                                                                           
     SOME EXAMPLES ARE GIVEN HERE TO CLARIFY, HOPEFULLY, THE ABOVE         
     GENERAL COMMENTS.                                                     
                                                                           
     1,2-DIFLUOROETHANE (TRANS CONFORMER).                                 
                                                                           
        H      H                                                           
        !      !                                                           
     F--C(1)---C(2)--F                                                     
        !      !                                                           
        H      H                                                           
                                                                           
     THE TWO CARBON ATOMS ARE GIVEN EXPLICIT NUMBERS (1 AND 2) SINCE       
     THEY ARE BONDED TO MORE THAN ONE OTHER ATOM. ON EACH CARBON, THE      
     F ATOM WILL BE USED AS THE 'REFERENCE ATOM' R. THE STANDARD           
     GEOMETRY INPUT IS THEN:                                               
                                                                           
        2                                                                  
     C   2   F   H   H                                                     
     C   1   F   H   H                                                     
     ROTB   1   2 180.0                                                    
     (BLANK)                                                               
                                                                           
     THE FIRST CARD SPECIFIES THAT 2 ATOMS HAVE EXPLICIT NUMBERS.          
     ON THE SECOND CARD: THE ATOM TYPE IS 'C', AND '2' IS THE SECOND       
     ATOM (THE OTHER CARBON). 'F' IS THE REFERENCE ATOM R, AND THERE       
     ARE ALSO TWO 'H' ATOMS. ALL BOND TYPES ARE SINGLE BY DEFAULT.         
     ON THE THIRD CARD: THE ATOM IS 'C', AND THE 'ATTACHMENT ATOM' A       
     IS '1', THE OTHER CARBON. ATOM R IS 'F', AND THERE ARE ALSO TWO       
     'H' ATOMS. ALL BOND TYPES ARE SINGLE BY DEFAULT.                      
     THOSE TWO CARDS ARE SUFFICIENT TO DEFINE THE CIS CONFORMER, BUT       
     SINCE TRANS IS DESIRED, ROTATE BOND 1-2 BY 180 DEGREES. THE FOURTH    
     CARD PERFORMS THIS FUNCTION, AND THE FIFTH MEANS NO FURTHER           
     CHANGES ARE REQUIRED.                                                 
                                                                           
     DIBROMOHYDRAZINE (MESO ISOMER), WITH EXPLICIT USE OF THE ELECTRON     
     PAIRS TO CONTROL THE CONFORMATION.                                    
                                                                           
         H      H                                                          
         !      !                                                          
     E*--N(1)---N(2)--E*                                                   
         !      !                                                          
         BR     BR                                                         
                                                                           
        2                                                                  
     N    2   E*   -H  -BR                                                 
     N    1   E*  -BR   -H                                                 
     (BLANK)                                                               
                                                                           
     HERE THE TWO N ATOMS ARE NUMBERED EXPLICITLY, AND THE ELECTRON        
     PAIRS 'E*' ARE USED AS ATOM R. ALL BOND TYPES '-' ARE EXPLICITLY      
     GIVEN, BUT COULD BE OMITTED.                                          
     AT N(1), THE 'ATTACHMENT ATOM' A IS 2, AND R IS E*. THE N HAS         
     NONE=4 (TETRAHEDRAL) - SO IF E* IS ABOVE THE PLANE OF THE PAPER,      
     THE H AND BR ARE BELOW. LOOKING ALONG THE N(1)-A BOND (IE THE         
     N(1)-N(2) BOND) FROM THE N(1) END, THE H HAS A DIHEDRAL ANGLE OF      
     120 DEGREES WITH THE 'REFERENCE ATOM' R (E*), AND THE BR DIHEDRAL     
     ANGLE IS 240 DEGREES (MEASURED COUNTERCLOCKWISE FROM R).              
     AT N(2), LOOKING ALONG THE N(2)-A BOND (A IS NOW 1), THE DIHEDRAL     
1                                                                          
 39                          GEOMETRY INPUT                                
                                                                           
                                                                           
                                                                           
     ANGLES OF BR AND H WITH RESPECT TO R (E* ON 2) ARE NOW 120 AND        
     240 DEGREES. THUS, TAKING THE E*-E* DIHEDRAL ANGLE AS 0 (THE          
     DEFAULT), THE H ATOMS ARE ECLIPSED, AS ARE THE BR ATOMS. ONE OF       
     THE ENANTIOMERIC ISOMERS COULD BE OBTAINED BY SWITCHING THE ORDER     
     OF 'H' AND 'BR' ON ONE OF THE CT CARDS.                               
                                                                           
     BENZENE.                                                              
                                                                           
     ALTHOUGH NO DIAGRAM IS GIVEN, THE RING ATOMS ARE NUMBERED             
     CONSECUTIVELY AROUND THE RING, FROM '1' TO '6'.                       
                                                                           
        6                                                                  
     C  .2  .6   H                                                         
     C  .1  .3   H                                                         
     C  .2  .4   H                                                         
     C  .3  .5   H                                                         
     C  .4  .6   H                                                         
     C  .5  .1   H                                                         
     (BLANK)                                                               
                                                                           
     NOTE THE USE OF '.' AS THE BOND TYPE BETWEEN THE C ATOMS.             
     NOTE ALSO THAT THE 'H' ATOM COULD NOT BE USED AS ATOM R, SINCE W      
     WOULD THEN BE AN EXPLICITLY NUMBERED ATOM, TO BE DEFINED WITH         
     RESPECT TO R. BUT SINCE R IS AN IMPLICIT ATOM, IT IS DEFINED          
     *AFTER* ALL THE EXPLICIT ATOMS, AND THUS THE ANGLE W-S-A-R (USED      
     TO DEFINE W) IS UNDEFINED.                                            
     NO CHANGES ARE REQUIRED AS ALL DIHEDRAL ANGLES ARE 0 BY DEFAULT.      
                                                                           
     METHYLACETYLENE - AN EXAMPLE OF A LINEAR MOLECULE.                    
                                                                           
        X(3)          H                                                    
        !             !                                                    
     H--C(1):::C(2)---C(4)--H                                              
                      !                                                    
                      H                                                    
                                                                           
        4                                                                  
     C  :2   3   H                                                         
     C  :1   4      $3                                                     
     X   1                                                                 
     C   2   H   H   H                                                     
     (BLANK)                                                               
                                                                           
     FOR C(1), A DUMMY ATOM X IS DEFINED (WITH THE DEFAULT VALENCE         
     ANGLE OF 90 DEGREES) SO THE LINEAR ATOMS ARE HANDLED PROPERLY.        
     NOTE THAT THE H ATOM IS DEFINED BY H-1-2-3, SO THE X REFERENCE        
     '3' MUST OCCUPY THE 'REFERENCE' POSITION R IN THE CT ENTRIES FOR      
     C(1). IT MUST BE GIVEN AN EXPLICIT NUMBER SINCE OTHER ATOMS GIVEN     
     EXPLICIT NUMBERS WILL USE IT FOR DIHEDRAL ANGLE DEFINITIONS, AND      
     HENCE IT MUST BE DEFINED *BEFORE* IT IS USED.                         
     FOR C(2), THE SPECIAL FEATURE IS THE $3. ATOMS 3 AND 4 (X AND         
     C(4)) ARE DEFINED PROPERLY, AS IS THE H ON C(1).                      
     HOWEVER, DEFINING THE 'REFERENCE ATOM' R ON C(4) WOULD NORMALLY       
     USE THE DIHEDRAL ANGLE H-4-2-1 (R-S-A-A(A)), WHICH IS UNDEFINED       
     SINCE 4-2-1 IS LINEAR. THE DIFFICULTY IS AVOIDED BY REPLACING         
     A(A), WHEN A IS 2, BY 3 (X). THE $3 ON CARD 2 PERFORMS THIS           
     SUBSTITUTION. THE H ATOM AND THE X WILL BE ECLIPSED.                  
                                                                           
1                                                                          
                             GEOMETRY INPUT                              40
                                                                           
                                                                           
                                                                           
     CO2-NO2 NITROFORMATE ANION - DELOCALIZED BONDS AND FORMAL CHARGES.    
                                                                           
     O     O                                                               
     !     !                                                               
     C(1)--N(2)                                                            
     !     !                                                               
     O     O                                                               
                                                                           
        2                                                                  
     C-  2  .O  .O                                                         
     N   1  .O  .O                                                         
     (BLANK)                                                               
                                                                           
     THIS EXAMPLE ILLUSTRATES THE 2 MOST COMMON USES OF DELOCALIZED        
     BONDS, AND THE USE OF A FORMAL CHARGE. THE CO2(-) AND NO2 GROUPS      
     ARE ISOELECTRONIC (AS IS OZONE), AND ARE HANDLED THE SAME WAY:        
     EACH EXPLICIT ATOM HAS 2 DELOCALIZED BONDS TO O, PLUS A C-N BOND      
     PAIR. THE CARBOXYLATE CHARGE IS FORMALLY PRESENT ON THE C ATOM,       
     GIVING THE C AND N EACH 5 VALENCE ELECTRONS. EACH CENTRAL ATOM        
     HAS NONE=3 (TRIGONAL) SINCE THE C-N BOND PAIR USES 1 ELECTRON,        
     AND THE PAIR OF DELOCALIZED BONDS USES 3 ELECTRONS. THE REMAINING     
     ODD ELECTRON IS IGNORED.                                              
                                                                           
     ******************************************************************    
                                                                           
     OPTIONS ... IOP()  THERE ARE NO OPTIONS USED BY THIS PROGRAM.         
                                                                           
     ******************************************************************    
1                                                                          
 41                          GEOMETRY INPUT                                
                                                                           
                                                                           
                                                                           
 Z MATRIX GEOMETRY INPUT.                                                  
 ************************                                                  
                                                                           
     LINK 0202                                                             
                                                                           
     --------------                                                        
     U OF T VERSION                                                        
     JULY 1988                                                             
     --------------                                                        
                                                                           
     DETERMINATION AND OPTIMIZATION OF THE GEOMETRY OF ANY MOLECULE        
     WHICH MAY BE SPECIFIED BY A Z MATRIX, AND                             
     DIRECT INPUT OF ATOMIC COORDINATES.                                   
                                                                           
     *****************************************************************     
     EXPLANATION OF REQUIRED INPUT FOR Z MATRIX GEOMETRY                   
     *****************************************************************     
     SINGLE CALCULATION OR INITIAL POINT IN AN OPTIMIZATION OR             
     POTENTIAL SURFACE SCAN RUN                                            
     *****************************************************************     
                                                                           
     TITLE  (FREE FIELD)                                                   
     THE FIRST 40 LETTERS OF THE TITLE ARE USED TO IDENTIFY PUNCHED        
     OUTPUT DECKS (68 LETTERS ARE USED FOR Z MATRICES).                    
     CHARGE AND MULTIPLICITY  (2I2)                                        
     CONVENTION FOR MULTIPLICITY ... 1=SINGLET  2=DOUBLET  AND SO ON       
     Z MATRIX ELEMENTS                                                     
     NUMBER OF ATOMS ... NATOMS ... CARDS OF THE ABOVE FORMAT              
     THE LIST IS TERMINATED BY A BLANK CARD                                
                                                                           
     USERS NOT FAMILIAR WITH THE Z MATRIX GEOMETRY INPUT ARE               
     ENCOURAGED TO READ THE FREE FORMAT DESCRIPTION FOR MORE DETAILS.      
                                                                           
     DETAILS OF Z MATRIX INPUT (STANDARD FORMAT)                           
     I4, I4, F12.6, I4, F12.4, I4, F12.4, I4                               
     A   B   C      D   E      F   G      H                                
     WHERE:                                                                
     A: ATOMIC NUMBER OF ATOM                                              
     B: NUMBER OF ATOM IT IS ATTACHED TO                                   
     C: DISTANCE (IN ANGSTROMS) TO ATOM IN B                               
     IF H=0 (PLANE AND DIHEDRAL ANGLE)                                     
       D AND E: E IS THE ANGLE THIS ATOM - ATOM B - ATOM D                 
       F: LOOKING ALONG BOND FROM B TO D, F IS ATOM THAT DIHEDRAL ANGLE    
         IS MEASURED FROM (IN COUNTERCLOCKWISE DIRECTION)                  
       G: DIHEDRAL ANGLE OF THIS ATOM WITH RESPECT TO F (IN DEGREES)       
     IF H=+1 OR -1 (TWO EULER ANGLES)                                      
       D AND E: E IS THE ANGLE THIS ATOM - ATOM B - ATOM D                 
       F AND G: G IS THE ANGLE THIS ATOM - ATOM B - ATOM F                 
       H: SPECIFIES WHETHER THIS ATOM IS ABOVE OR BELOW PLANE B-D-F -      
         TAKE ATOMS IN ORDER B-D-F, A RIGHT HAND SCREW HAS THUMB IN +1     
         DIRECTION                                                         
                                                                           
     IF THE ATOM NUMBER D (OR F) IS NEGATIVE, THE ANGLE E (OR G) WILL      
     BE REPLACED BY THE EXACT TETRAHEDRAL ANGLE, AND D (OR F)              
     REPLACED BY ITS ABSOLUTE VALUE.                                       
                                                                           
1                                                                          
                             GEOMETRY INPUT                              42
                                                                           
                                                                           
                                                                           
     SOME INPUT EXAMPLES WILL HELP TO CLARIFY MATTERS                      
     ASSUME CARD COLUMNS ARE                                               
     123456789012345678901234567890123456789012345678901234567890123456    
                                                                           
     WATER MOLECULE                                                        
                                                                           
     H2O                                                                   
      0 1                                                                  
        8                                                                  
        1   1 0.96                                                         
        1   1 0.96          2 105.                                         
     BLANK CARD                                                            
                                                                           
     THE TITLE IS 'H2O'                                                    
     THE CHARGE IS ZERO AND THE MULTIPLICITY 1                             
     AFTER THE TITLE AND CHARGE AND MULTIPLICITY CARDS THE FIRST           
     Z MATRIX CARD NEEDS ONLY THE ATOMIC NUMBER                            
        8                                                                  
     TO DEFINE THE POSITION OF ATOM 1                                      
     THE SECOND                                                            
        1   1 0.96                                                         
     SPECIFIES THAT AN ATOM ... ATOM NUMBER 2 ... OF ATOMIC NUMBER 1       
     IS BONDED TO ATOM NUMBER 1 WITH A CONNECTING BOND LENGTH OF 0.96      
     ANGSTROMS                                                             
     THE NEXT ... AND LAST ... Z MATRIX CARD                               
        1   1 0.96          2 105.                                         
     SPECIFIES THAT ANOTHER ... ATOM NUMBER 3 ... HYDROGEN IS BONDED       
     TO ATOM 1 WITH A BONDLENGTH OF 0.96 ANGSTROMS                         
     AND FORMS AN ANGLE OF 105 DEGREES WITH ATOM NUMBER 2                  
                                                                           
     CONSIDER NOW THE METHANOL MOLECULE IN A STAGGERED CONFORMATION        
     AS A SECOND AND MORE DIFFICULT EXAMPLE                                
                                                                           
     CH3OH                                                                 
      0 1                                                                  
        6                                                                  
        8   1 1.43                                                         
        1   2 0.96          1 105.                                         
        1   1 1.09          2 109.5         3 180.          0              
        1   1 1.09          2 109.5         4 109.5        +1              
        1   1 1.09          2 109.5         4 109.5        -1              
     BLANK CARD                                                            
                                                                           
     THE FIRST THREE Z MATRIX CARDS ARE SIMILIAR TO THOSE OF THE H2O       
     EXAMPLE AND NEED NO FURTHER EXPLANATION                               
     THE FOURTH CARD                                                       
        1   1 1.09          2 109.5         3 180.          0              
     SPECIFIES THAT A HYDROGEN IS BONDED TO THE FIRST ATOM ... THE         
     CARBON ... WITH A BOND LENGTH OF 1.09 ANGSTROMS AND THAT IT FORMS     
     AN ANGLE WITH ATOM NUMBER 2 ... THE OXYGEN ... OF 109.5 DEGREES       
     ALSO ... AS SIGNIFIED BY A VALUE OF ZERO FOR THE H PARAMETER ...      
     IT FORMS A DIHEDRAL ANGLE WITH ATOM 3 OF 180 DEGREES INDICATING A     
     TRANS CONFORMATION                                                    
     THE FIFTH AND SIXTH CARDS                                             
        1   1 1.09          2 109.5         4 109.5        +1              
        1   1 1.09          2 109.5         4 109.5        -1              
     ARE IDENTICAL EXCEPT FOR THE SIGN OF THE H PARAMETER                  
     THESE HYDROGENS ARE BONDED TO ATOM 1 ... THE CARBON ... AND BOTH      
1                                                                          
 43                          GEOMETRY INPUT                                
                                                                           
                                                                           
                                                                           
     MAKE AN ANGLE OF 109.5 DEGREES WITH ATOM 2 ... THE OXYGEN             
     IN ADDITION ... AS SIGNIFIED BY VALUES OF + AND - 1 FOR THE H         
     PARAMETER ... THEY MAKE 109.5 DEGREE ANGLES WITH ATOM 4 ... THE       
     OTHER METHYL HYDROGEN                                                 
     A +1 VALUE FOR H SIGNIFIES THAT ATOM NUMBER 5 LIES ABOVE THE          
     PLANE FORMED BY ATOMS 1 2 AND 4                                       
     WHILE                                                                 
     A -1 ASSIGNS ATOM 6 TO LIE BELOW THIS PLANE                           
                                                                           
     A NEGATIVE ATOMIC NUMBER SIGNIFIES THE POSITION OF FLOATING           
     GAUSSIAN FUNCTIONS ('BOND' FUNCTIONS, THAT IS THEY ARE NOT            
     LOCATED ON AN ATOMIC CENTER LIKE THE USUAL MONSTERGAUSS ORBITALS).    
                                                                           
     THE GEOMETRY BUILDING ROUTINE, BUILDZ, PLACES THE FIRST ATOM AT       
     THE ORIGIN AND THE SECOND ALONG THE Z AXIS. NORMALLY THE              
     THIRD ATOM DEFINES THE XZ PLANE (IE. IT MAY NOT LIE ON THE Z          
     AXIS). THE SOLE EXCEPTION IS FOR 3 ATOM MOLECULES, WHICH MAY BE       
     LINEAR.                                                               
     ALL THE REMAINING ATOMS FOLLOW A RIGHT HANDED COORDINATE              
     SYSTEM.                                                               
                                                                           
     IN ORDER TO AID IN THE CONSTRUCTION OF DIFFICULT STRUCTURES           
     THE USE OF DUMMY ATOMS IS ENCOURAGED.                                 
     A 0 IN THE ATOMIC NUMBER FIELD SIGNIFIES THAT THE ATOM IS ONLY A      
     DUMMY ATOM. ALTHOUGH NEITHER DUMMY ATOMS NOR FLOATING ATOMS ARE       
     ACTUALLY USED IN THE CALCULATION, ONLY FLOATING ATOMS MAY HAVE        
     BASIS FUNCTIONS ASSOCIATED WITH THEM. BOTH ATOM TYPES ARE             
     RETAINED IN THE GEOMETRY SO THAT THE INPUT ATOM NUMBERS ARE USED      
     THROUGHOUT THE PROGRAM, AND TO FACILITATE THE TRANSFORMATION OF       
     THE FORCES TO INTERNAL COORDINATES. THEY ARE IDENTIFIED IN THE        
     OUTPUT AS 'X' AND 'BQ' RESPECTIVELY.                                  
     THERE MAY BE TROUBLE WITH THE FORCE OPTIMIZATION OF THE GEOMETRY      
     IF 2 'ATOMS' HAVE THE SAME INTERNAL COORDINATES - THIS WOULD          
     RESULT IF A DUMMY ATOM OR FLOATING FUNCTION WAS PLACED ON TOP         
     OF AN EXISTING ATOM, DUMMY ATOM OR FLOATING FUNCTION.                 
     THE LAST ATOM IN THE Z MATRIX CANNOT BE A DUMMY ATOM.                 
                                                                           
     ONE FURTHER EXAMPLE ... WITHOUT MUCH EXPLANATION ... TO ILLUSTRATE    
     THIS FEATURE                                                          
     THIS EXAMPLE WILL ALSO SERVE TO ILLUSTRATE THE PROCEDURE FOR THE      
     Z MATRIX OPTIMIZATION OF MOLECULAR GEOMETRY                           
                                                                           
     ETHYL CATION  H-BRIDGED STRUCTURE                                     
      1 1                                                                  
        6                                                                  
        6   1 1.5                                                          
        0   1 1.0           2 170.                                         
        0   2 1.0           1 170.          3 0.            0              
        0   1 1.0           3 90.           2 180.          0              
        0   2 1.0           4 90.           1 180.          0              
        1   1 1.08          3 60.           5 90.          +1              
        1   1 1.08          3 60.           5 90.          -1              
        1   2 1.08          4 60.           6 90.          +1              
        1   2 1.08          4 60.           6 90.          -1              
        0   1 0.75          3 170.          2 0.            0              
        1  11 1.2           1 90.           3 180.          0              
     BLANK CARD                                                            
                                                                           
1                                                                          
                             GEOMETRY INPUT                              44
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     FREE FORMAT Z MATRIX INPUT.                                           
     ******************************************************************    
                                                                           
     THE TITLE AND CHARGE/MULTIPLICITY CARDS ARE READ AS DESCRIBED         
     ABOVE. EACH Z MATRIX CARD HAS THE SAME STRUCTURE AS DESCRIBED         
     ABOVE FOR THE FIXED FORMAT INPUT:                                     
                                                                           
     ELEMENT, N1, BL, N2, ALPHA, N3, BETA, N4                              
                                                                           
     ELEMENT MAY BE THE ONE OR TWO CHARACTER CHEMICAL SYMBOL (E.G. C,      
     CL), THE ONE OR TWO CHARACTER CHEMICAL SYMBOL FOLLOWED                
     IMMEDIATELY BY AN IDENTIFYING INTEGER (E.G. C1, CL11), OR SIMPLY      
     THE ATOMIC NUMBER (E.G. 6, 17). DUMMY ATOMS ARE IDENTIFIED BY THE     
     SYMBOL 'X', FLOATING ATOMS BY 'BQ' (FLOATING ATOMS ARE GIVEN THE      
     ATOMIC NUMBER -1). A MAXIMUM OF 4 ALPHANUMERIC DIGITS IS              
     PERMITTED. IF A NUCLEUS IS TO REFERENCED BY LATER ATOMS, IT IS        
     NECESSARY THAT THE ALPHANUMERIC STRINGS BE UNIQUE - ONE WAY TO        
     ENSURE THIS IS TO APPEND THE ATOM NUMBER TO EACH CHEMICAL SYMBOL.     
     FOR COMPATIBILITY REASONS, THE CODE 'D*' MAY BE USED FOR              
     A DUMMY ATOM, AND THE CODE 'F*' MAY BE USED FOR A FLOATING ATOM,      
     ALTHOUGH MONSTERGAUSS WILL REFER TO SUCH ATOMS INTERNALLY AND         
     ON SOME OUTPUT AS 'X' AND 'BQ' RESPECTIVELY, SO THE USE OF            
     THE LATTER SYMBOLS IS STRONGLY RECOMMENDED.                           
                                                                           
     N1 SPECIFIES THE (PREVIOUSLY DEFINED) NUCLEUS TO WHICH THE            
     CURRENT ATOM (N) IS CONSIDERED TO BE ATTACHED. N1 MAY BE EITHER       
     AN ALPHANUMERIC STRING MATCHING THE ELEMENT FIELD OF A PREVIOUS       
     Z MATRIX CARD, OR SIMPLY THE NUMBER OF THE ATOM.                      
                                                                           
     BL IS THE BOND LENGTH IN ANGSTROMS FROM N TO N1, EXPRESSED AS         
     EITHER A STRING OF UP TO 8 ALPHANUMERIC CHARACTERS (CALLED A          
     VARIABLE), OR A FLOATING POINT NUMBER CONTAINING A DECIMAL POINT.     
                                                                           
     N2 SPECIFIES THE (PREVIOUSLY DEFINED) NUCLEUS FOR WHICH THE BOND      
     ANGLE N-N1-N2 WILL BE GIVEN. N2 MAY BE EITHER AN ALPHANUMERIC         
     STRING MATCHING THE ELEMENT FIELD OF A PREVIOUS Z MATRIX CARD, OR     
     SIMPLY THE NUMBER OF THE ATOM.                                        
                                                                           
     ALPHA IS THE N-N1-N2 BOND ANGLE IN DEGREES, EXPRESSED AS EITHER       
     A STRING OF UP TO 8 ALPHANUMERIC CHARACTERS (CALLED A VARIABLE),      
     OR A FLOATING POINT NUMBER CONTAINING A DECIMAL POINT.                
                                                                           
     THE INTERPRETATION OF THE REMAINING THREE FIELDS DEPENDS ON THE       
     VALUE OF N4, WHICH MUST BE AN INTEGER (NOT A VARIABLE).               
                                                                           
     N4 IS 0 OR OMITTED:                                                   
                                                                           
     N3 SPECIFIES THE (PREVIOUSLY DEFINED) NUCLEUS FOR WHICH THE           
     DIHEDRAL ANGLE N-N1-N2-N3 WILL BE GIVEN. N3 MAY BE EITHER AN          
     ALPHANUMERIC STRING MATCHING THE ELEMENT FIELD OF A PREVIOUS          
     Z MATRIX CARD, OR SIMPLY THE NUMBER OF THE ATOM.                      
                                                                           
     BETA IS THE N-N1-N2-N3 DIHEDRAL ANGLE IN DEGREES, EXPRESSED AS        
     EITHER A STRING OF UP TO 8 ALPHANUMERIC CHARACTERS (CALLED A          
     VARIABLE), OR A FLOATING POINT NUMBER CONTAINING A DECIMAL POINT.     
1                                                                          
 45                          GEOMETRY INPUT                                
                                                                           
                                                                           
                                                                           
     THE CONVENTION FOR THE SIGN OF BETA IS TO LOOK ALONG THE N1-N2        
     BOND FROM THE N1 END, WITH A POSITIVE DIHEDRAL ANGLE BEING A          
     COUNTERCLOCKWISE ROTATION OF N AWAY FROM N3.                          
                                                                           
     N4 IS +1 OR -1:                                                       
                                                                           
     N3 SPECIFIES THE (PREVIOUSLY DEFINED) NUCLEUS FOR WHICH THE BOND      
     ANGLE N-N1-N3 WILL BE GIVEN. N3 MAY BE EITHER AN ALPHANUMERIC         
     STRING MATCHING THE ELEMENT FIELD OF A PREVIOUS Z MATRIX CARD, OR     
     SIMPLY THE NUMBER OF THE ATOM.                                        
                                                                           
     BETA IS THE N-N1-N3 BOND ANGLE IN DEGREES, EXPRESSED AS EITHER A      
     STRING OF UP TO 8 ALPHANUMERIC CHARACTERS (CALLED A VARIABLE), OR     
     A FLOATING POINT NUMBER CONTAINING A DECIMAL POINT. IN THIS CASE,     
     THERE ARE TWO POSSIBILITIES FOR N4, +1 AND -1, WHICH SERVE TO         
     PLACE THE NEW ATOM ABOVE OR BELOW THE N1-N2-N3 PLANE. THE             
     CONVENTION IS TO WRAP THE FINGERS OF THE RIGHT HAND AROUND THE        
     ATOMS IN THE ORDER N1 TO N2 TO N3 - THE THUMB DEFINES THE +1          
     SIDE OF THE PLANE.                                                    
                                                                           
     IF NO VARIABLES HAVE BEEN USED IN THE BL, ALPHA OR BETA FIELDS,       
     THE Z MATRIX IS CONVERTED TO THE STANDARD FORM ABOVE. ALL FURTHER     
     LINKS WILL TREAT THIS EXACTLY AS A FIXED FORMAT INPUT RUN.            
                                                                           
     THE VALUES OF THE VARIABLES ARE GIVEN AFTER THE BLANK CARD IN TWO     
     SECTIONS ('OPTIMIZED VARIABLES' AND 'CONSTANTS'), IN THE FORM:        
     VARIABLE = VALUE                                                      
     WHERE VARIABLE IS AN UP TO 8 CHARACTER STRING USED IN THE BL,         
     ALPHA OR BETA FIELDS, AND VALUE IS A FLOATING POINT NUMBER.           
     ALTERNATIVELY, VALUE MAY BE THE STRING 'TETRA' TO INDICATE THAT       
     THE TETRAHEDRAL ANGLE IS TO BE SUBSTITUTED. THE LIST OF VARIABLES     
     TO BE OPTIMIZED IS TERMINATED BY A BLANK CARD, THEN THE LIST OF       
     VARIABLES TO BE HELD CONSTANT IS GIVEN, ALSO TERMINATED BY A          
     BLANK CARD. IF THERE ARE NO 'CONSTANTS', I.E. ALL THE VARIABLES       
     ARE TO BE OPTIMIZED, THEN THE BLANK CARD FOLLOWING THE LIST           
     OF CONSTANTS IS ALSO OMITTED (THIS MEANS THAT ALL THE VARIABLES       
     WERE SPECIFIED IN THE 'OPTIMIZE' SECTION).                            
     FOR NON-OPTIMIZATION RUNS, THE VARIABLES MAY STILL BE SPLIT           
     INTO 'OPTIMIZE' AND 'CONSTANT' SECTIONS, OR ALL THE VARIABLES         
     MUST BE SPECIFIED IN THE 'OPTIMIZE' SECTION (EVEN THOUGH THERE        
     IS NO OPTIMIZATION TO BE PERFORMED).                                  
                                                                           
     THE WATER AND METHANOL EXAMPLES MAY THUS BE WRITTEN:                  
                                                                           
     H2O                                                                   
      0 1                                                                  
     O1                                                                    
     H2  O1  ROH                                                           
     H3  O1  ROH  H2  ALPHA                                                
     (BLANK)                                                               
     ROH = 0.96                                                            
     ALPHA = 105.0                                                         
     (BLANK)                                                               
                                                                           
     CH3OH                                                                 
      0 1                                                                  
     C1                                                                    
     O2 C1 RCO                                                             
1                                                                          
                             GEOMETRY INPUT                              46
                                                                           
                                                                           
                                                                           
     H3 O2 ROH C1 COH                                                      
     H4 C1 RCH O2 OCH H3 180.0 0                                           
     H  C1 RCH O2 OCH H4 HCH   1                                           
     H  C1 RCH O2 OCH H4 HCH  -1                                           
     (BLANK)                                                               
     RCO = 1.43                                                            
     ROH = 0.96                                                            
     RCH = 1.09                                                            
     COH = 105.0                                                           
     OCH = TETRA                                                           
     HCH = TETRA                                                           
     (BLANK)                                                               
                                                                           
     CH3OH                                                                 
      0 1                                                                  
     C1                                                                    
     O2 C1 RCO                                                             
     H3 O2 ROH C1 COH                                                      
     H4 C1 RCH O2 OCH H3 TAUH4 0                                           
     H  C1 RCH O2 OCH H4 HCH   1                                           
     H  C1 RCH O2 OCH H4 HCH  -1                                           
     (BLANK)                                                               
     RCO = 1.43                                                            
     ROH = 0.96                                                            
     RCH = 1.09                                                            
     COH = 105.0                                                           
     OCH = TETRA                                                           
     HCH = TETRA                                                           
     (BLANK)                                                               
     TAUH4 = 180.0                                                         
     (BLANK)                                                               
                                                                           
     ADDITIONAL NOTES:                                                     
                                                                           
     1) VARIABLES USED IN ALPHA AND BETA FIELDS MAY BE PRECEEDED BY A      
     NEGATIVE SIGN TO INDICATE THAT THE NEGATIVE OF THE VALUE IS TO BE     
     USED. FOR EXAMPLE -TAU, WITH TAU=60.0, WOULD USE -60.0 FOR THAT       
     Z MATRIX PARAMETER.                                                   
                                                                           
     2) THE FREE FORMAT ENTRIES ARE NORMALLY SEPARATED BY ONE OR MORE      
     BLANKS, AND MAY CONTAIN NO IMBEDDED BLANKS. A COMMA MAY ALSO BE       
     USED TO SEPARATE THE Z MATRIX FIELDS, BUT IT MUST IMMEDIATELY         
     FOLLOW THE PARAMETER WITH NO INTERVENING BLANKS. FOR EXAMPLE 'C1,'    
     IS CORRECT, BUT 'C1 ,' IS NOT. LEADING BLANKS ARE ALWAYS IGNORED.     
     THE VARIABLE NAMES SHOULD BEGIN WITH A LETTER TO AVOID POSSIBLE       
     DIFFICULTIES.                                                         
                                                                           
     3) FOR GEOMETRY OPTIMIZATION RUNS, THE Z MATRIX CANNOT BE             
     PRINTED OR PUNCHED IN THE FREE FORMAT MODE IF THE OPTIMIZATION        
     CONSTRAINTS DO NOT AGREE WITH THE USE OF THE VARIABLES IN THE Z       
     MATRIX. CONSIDERING THE METHANOL CASE ABOVE, IF THE THREE CH          
     BOND LENGTHS (OR THE THREE OCH ANGLES, OR THE TWO HCH ANGLES) ARE     
     ALLOWED TO VARY INDEPENDENTLY, THE RCH (OR OCH OR HCH) VARIABLE       
     MAY END UP TRYING TO REPRESENT SEVERAL DIFFERENT VALUES               
     SIMULTANEOUSLY. IF THE OPTIMIZATION CONSTRAINTS DO NOT AGREE WITH     
     THE Z MATRIX VARIABLES, THE FINAL Z MATRIX IS NOT PRINTED/PUNCHED     
     IN FREE FORMAT. FOR THE METHANOL CASE, IF A COMPLETE OPTIMIZATION     
     IS DESIRED, THE LAST TWO CARDS COULD BE CHANGED TO:                   
1                                                                          
 47                          GEOMETRY INPUT                                
                                                                           
                                                                           
                                                                           
     H C1 RCH56 O2 OCH56 H4 HCH  1                                         
     H C1 RCH56 O2 OCH56 H4 HCH -1                                         
     WHICH WOULD RECOGNIZE THAT THE LATTER TWO H ATOMS ARE EQUIVALENT,     
     BUT DIFFERENT FROM H4. THIS SHOULD BE REFLECTED IN THE                
     OPTIMIZATION CONSTRAINTS GIVEN TO THE OPTIMIZATION LINKS. HOWEVER,    
     IF THE INTENTION IS TO OPTIMIZE THE METHYL GROUP MAINTAINING THE      
     LOCAL C3V SYMMETRY, THEN THE ORIGINAL Z MATRIX IS ACCEPTABLE.         
     NOTE THAT THE DEFAULT MODE OF OPERATION IS TO CONSTRAIN ALL THOSE     
     PARAMETERS USING THE SAME VARIABLE NAME TO BE OPTIMIZED TOGETHER,     
     AND TO FIX ALL PARAMETERS NOT USING A VARIABLE (IE. CONSTANTS).       
     THUS THE METHANOL EXAMPLE ABOVE WOULD GIVE A C3V CONSTRAINED          
     METHYL GROUP, WHILE THE MODIFIED VERSION WOULD GIVE THE ABSOLUTE      
     MINIMUM CS STRUCTURE, IF THE DEFAULT OPTIMIZATION CONSTRAINTS ARE     
     USED. THE DEFAULT CONSTRAINTS CAN ALWAYS BE OVER-RIDDEN BY USING      
     THE GOPT=READ OPTION ON THE *MOL CARD, AND SUPPLYING THE              
     OPTIMIZATION CONSTRAINT CARDS.                                        
                                                                           
     4) FOR THE FIRST ATOM, ONLY THE ELEMENT FIELD IS NEEDED. FOR THE      
     SECOND ATOM, THE ELEMENT, N1 AND BL FIELDS ARE REQUIRED. FOR THE      
     THIRD ATOM, THE ELEMENT, N1, BL, N2 AND ALPHA FIELDS ARE REQUIRED.    
     FOR THE REMAINING ATOMS, ALL FIELDS ARE REQUIRED, ALTHOUGH N4 MAY     
     BE OMITTED IF A 0 VALUE IS DESIRED.                                   
                                                                           
     5) ALTHOUGH IT IS NOT STRICTLY NECESSARY, THE INTERPRETATION OF       
     THE MOLECULAR ORBITAL SYMMETRIES IS SIMPLIFIED GREATLY IF             
     THE ORIGIN IS CHOSEN AS THE CENTER OF INVERSION (IF THE               
     MOLECULE POSSESSES ONE), THE Z (OR X OR Y) AXIS IS CHOSEN             
     AS THE PRINCIPAL AXIS OF ROTATION (IF THE MOLECULE POSSESSES          
     ONE), AND/OR ONE OF THE CARTESIAN PLANES (XY, XZ OR YZ) IS            
     USED AS THE MOLECULAR PLANE (IF THE MOLECULE POSSESSES ONE).          
     THUS THE WATER EXAMPLE (ABOVE) WOULD BE BETTER BUILT AS:              
                                                                           
     H2O                                                                   
      0 1                                                                  
     O1                                                                    
     X2  O1  1.0                                                           
     H2  O1  ROH  X2  ALPHA                                                
     H3  O1  ROH  X2  ALPHA  H3  180.0                                     
     (BLANK)                                                               
     ROH = 0.96                                                            
     ALPHA = 127.5                                                         
     (BLANK)                                                               
                                                                           
     WHERE THE Z AXIS IS NOW ONE OF THE C2 AXES (OTHERWISE THE             
     C2 AXIS WOULD HAVE POINTED OFF IN THE XZ PLANE).                      
                                                                           
1                                                                          
                             GEOMETRY INPUT                              48
                                                                           
                                                                           
                                                                           
     *****************************************************************     
     Z MATRIX OPTIMIZATION OF MOLECULAR GEOMETRY                           
     *****************************************************************     
                                                                           
     IN THE ETHYL CATION EXAMPLE ABOVE, THE GEOMETRICAL PARAMETERS ARE     
     THE BOND LENGTHS 1.5 TO 1.2  PARAMETER NUMBERS 1 TO 11                
     THE FIRST SET OF ANGLES 170. TO 90.  PARAMETER NUMBERS 12 TO 21       
     AND                                                                   
     THE LATTER SET 0. TO 180.  PARAMETER NUMBERS 22 TO 30                 
     OR                                                                    
     3 * NATOMS - 6 PARAMETERS IN ALL ... COUNTING DUMMY ATOMS THAT IS.    
     TO COMPLETELY DEFINE THE GEOMETRY OF THE SYMMETRICALLY BRIDGED        
     ... C2V SYMMETRY ... ETHYL CATION WE NEED ONLY THE FOLLOWING          
     PARAMETER SETS:                                                       
     1 AND 10                                                              
     6 7 8 AND 9                                                           
     11                                                                    
     12 13 AND 20                                                          
     AND                                                                   
     16 17 18 AND 19                                                       
                                                                           
     FOLLOWING THE SPECIFICATION OF THE INITIAL Z MATRIX VARIATIONS        
     MAY BE INTRODUCED IN THE FOLLOWING MANNER                             
     THERE ARE THREE POSSIBLE CASES                                        
                                                                           
     1  VARY A SINGLE PARAMETER                                            
     FOR EXAMPLE THE DISTANCE BETWEEN THE BRIDGING HYDROGEN AND THE        
     CARBON CARBON BOND                                                    
     PARAMETER NUMBER 11                                                   
     VARY BY 0.05 ANGSTROMS                                                
     REMEMBER THE CARD COLUMNS ARE NUMBERED                                
     123456789012345678901234567890123456789012345678901234567890123456    
      11                                          0.05                     
     THE PROGRAM WILL CALCULATE TWO ADDITIONAL POINTS ... THE ENERGY       
     CORRESPONDING TO THE ORIGINAL Z MATRIX HAS ALREADY BEEN EVALUATED     
     AND STORED ... AND FIT THEM TO A PARABOLA                             
     IF THE PROJECTED MINIMUM DOES NOT LIE INSIDE THE INTERVAL COVERED     
     BY THE THREE POINTS, THE PROGRAM WILL CONTINUE TO TRY TO BRACKET      
     THE PROJECTED MINIMUM BY CALCULATING MORE POINTS, SAVING AS MANY      
     PREVIOUS VALUES AS POSSIBLE, UP TO THE LIMIT GIVEN BY IOP(16).        
     IN THIS EXAMPLE THE FIRST POINT WILL BE 1.2+0.05 OR 1.25              
     IF THIS GIVES A BETTER ENERGY THAN THE ORIGINAL Z MATRIX THEN THE     
     NEXT ALTERATION TO THE Z MATRIX WILL BE IN THE SAME DIRECTION         
     1.2+0.05+0.05 OR 1.30                                                 
     IF HOWEVER IT GIVES A POORER ENERGY THEN THE PROCEDURE WILL           
     STEP BACKWARDS                                                        
     1.2-0.05 OR 1.15                                                      
     WHICHEVER HAPPENS ... A MINIMUM WILL BE PROJECTED AND IF THE          
     MINIMUM LIES WITHIN THE RANGE COVERED (EITHER 1.20-1.30 OR            
     1.15-1.25), THE ENERGY CORRESPONDING TO IT WILL BE CALCULATED.        
     IF NOT, EXTRA POINTS WILL BE CALCULATED UNTIL THE PROJECTED           
     MINIMUM DOES LIE WITHIN THE INTERVAL COVERED.                         
     THE PROGRAM IS THEN READY TO READ IN ADDITIONAL VARIATION CARDS       
                                                                           
     2  VARY A SET OF PARAMETERS SIMULTANEOUSLY ALL BY THE SAME AMOUNT     
     FOR EXAMPLE THE TWO HCH ANGLES ... OR IN PRACTICE THE FOUR            
     H-C-DUMMY ATOM ANGLES                                                 
      16 17 18 19                                 1.0                      
1                                                                          
 49                          GEOMETRY INPUT                                
                                                                           
                                                                           
                                                                           
     THE SAME PROCEDURE AS ABOVE WILL BE FOLLOWED                          
     THIS TIME HOWEVER THE FOUR GEOMETRICAL PARAMETERS WILL BE             
     DEALT WITH SIMULTANEOUSLY                                             
                                                                           
     3  VARY A SET OF PARAMETERS TOGETHER BUT BY DIFFERENT AMOUNTS         
     FOR EXAMPLE VARY THE CARBON CARBON BOND LENGTH MAKING CERTAIN AT      
     THE SAME TIME THAT THE BRIDGING HYDROGEN REMAINS IN THE MIDDLE        
       1999                                       0.02                     
      10                                          0.01                     
     IN THIS CASE PARAMETER 1 IS VARIED BY 0.02 AND AT THE SAME            
     TIME ... THE FACT THAT ADDITIONAL SIMULTANEOUS VARIATION CARDS        
     FOLLOW IS GIVEN BY THE 999 ... PARAMETER 10 IS TO BE VARIED BY        
     HALF OF THAT OR 0.01 ANGSTROMS THUS ASSURING THAT IT REMAINS IN       
     THE MIDDLE.  CAUTION ... ONLY 3 PARAMETER CARDS FOR SIMULTANEOUS      
     VARIATION ARE ALLOWED.                                                
                                                                           
     AS MANY VARIATION CARDS AS NEEDED MAY BE USED THE LIST BEING          
     TERMINATED BY A BLANK CARD (CARD FORMAT IS 15I3,F10.4).               
     THE VARIATION CARDS MUST BE SUPPLIED, EVEN FOR THE FREE FORMAT        
     Z MATRIX INPUT.                                                       
                                                                           
     THE Z MATRIX FOR THE FINAL OPTIMIZED GEOMETRY MAY BE PUNCHED IN       
     EITHER FREE FORMAT OR STANDARD FORMAT - SEE IOP(15).                  
                                                                           
1                                                                          
                             GEOMETRY INPUT                              50
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     RESTART OF Z MATRIX GEOMETRY OPTIMIZATION                             
     ******************************************************************    
                                                                           
     CONSIDER THE FOLLOWING JOB ... AN STO-3G OPTIMIZATION OF THE          
     METHYL RADICAL BY THE Z MATRIX METHOD:                                
                                                                           
     CARD COLUMNS                                                          
             1234567890123456789012345678901234567890123456789012345678    
                                                                           
    (1)      *MOLGOPT,METHOD=ZM,UHF                                        
    (2)      METHYL RADICAL                                                
    (3)       0 2                                                          
    (4)         6                                                          
    (5)         1   1 1.09                                                 
    (6)         1   1 1.09          2 118.                                 
    (7)         1   1 1.09          2 118.          3 118.          1      
    (8)      (BLANK)                                                       
    (9)        1  2  3                                    0.01             
   (10)        4  5  6                                    0.5              
   (11)      (BLANK)                                                       
                                                                           
     THIS JOB COULD PRODUCE THE FOLLOWING DECK AS PUNCHED OUTPUT ...       
     BUT ONLY IF RUN USING THE *IOP OPTION TO SET IOP(15)=2.               
                                                                           
     CARD COLUMNS                                                          
             1234567890123456789012345678901234567890123456789012345678    
                                                                           
    (1)                -39.0767558518                                      
    (2)        1  2  3                                        0.0100       
    (3)                -39.0760215884                                      
    (4)                -39.0770013045                                      
    (5)         6                                                          
    (6)         1   1    1.080000                                          
    (7)         1   1    1.080000   2    118.0000                          
    (8)         1   1    1.080000   2    118.0000   3    118.0000   1      
    (9)                                                                    
   (10)      ****                                                          
   (11)                -39.0770013534                                      
   (12)        4  5  6                                        0.5000       
   (13)                -39.0770048638                                      
   (14)                -39.0769567591                                      
   (15)         6                                                          
   (16)         1   1    1.080000                                          
   (17)         1   1    1.080000   2    118.2840                          
   (18)         1   1    1.080000   2    118.2840   3    118.2840   1      
   (19)                                                                    
   (20)      ****                                                          
   (21)                -39.0770096299                                      
                                                                           
     NOTE THE INFORMATION THAT WAS PUNCHED ... THE TOTAL ENERGY OF         
     EACH POINT, THE VARIATION CARDS USED, AND AT THE CONCLUSION           
     OF A PARAMETER OPTIMIZATION ... A NEW Z MATRIX WITH THE OPTIMUM       
     VALUE OF THAT PARAMETER INCLUDED, IN THE SAME FORMAT AS IT WAS        
     READ IN (SEE IOP(5)).                                                 
                                                                           
1                                                                          
 51                          GEOMETRY INPUT                                
                                                                           
                                                                           
                                                                           
     NOW SUPPOSE THE HCH ANGLE OPTIMIZATION WAS CLOBBERED AFTER            
     THE FIRST POINT WAS CALCULATED ... SUCH THAT RESTART CARDS 1-13       
     WERE PUNCHED.                                                         
     A RESTART DECK WOULD LOOK LIKE THIS ...                               
                                                                           
     CARD COLUMNS                                                          
             1234567890123456789012345678901234567890123456789012345678    
                                                                           
    (1)      *MOLGOPT,METHOD=ZM,UHF                                        
             *IOP                                                          
                1  14   1 RESTART OF Z MATRIX OPTIMIZATION                 
                0   0   0                                                  
    (2)      METHYL RADICAL   RESTART OF GEOMETRY OPTIMIZATION             
    (3)       0 2                                                          
    (4)         6                                                          
    (5)         1   1    1.080000                                          
    (6)         1   1    1.080000   2    118.0000                          
    (7)         1   1    1.080000   2    118.0000   3    118.0000   1      
    (8)                                                                    
    (9)                -39.0770013534                                      
   (10)        4  5  6                                        0.5000       
   (11)                -39.0770048638                                      
   (12)      ****                                                          
   (13)      (BLANK)                                                       
                                                                           
     EXPLANATION OF CARDS                                                  
                                                                           
     CARDS 1      CONTROL CARDS FOR RESTART.                               
     CARDS 4-8    RESTART CARDS 5-9                                        
     CARDS 9-11   RESTART CARDS 11-13                                      
     CARD 12      RESTART CARD 10 ... INDICATES THAT NO MORE ENERGY        
                  VALUES ARE TO BE EXPECTED ... THIS CARD IS USED AS       
                  A SEPARATOR IN THE PUNCHED RESTART CARDS FOR USER        
                  CONVENIENCE                                              
     CARD 13      IF ADDITIONAL VARIATION CARDS ARE DESIRED AS A           
                  CONTINUATION OF THE INTERRUPTED OPTIMIZATION RUN,        
                  INSERT THEM HERE BEFORE THE BLANK CARD.                  
                                                                           
     NOTE: FOR A RESTART UP TO 3 PREVIOUS ENERGIES MAY BE GIVEN.           
     SINCE THE OPTIMIZATION OF A SET OF PARAMETERS MAY USE MORE THAN       
     3 POINTS TO AVOID EXTRAPOLATION, READ IN ONLY THE POINTS              
     INDICATED BY THE OUTPUT AS BEING USEFUL.                              
     THE FORMAT FOR THE ENERGY RESTART CARDS IS (A4,F20.10).               
                                                                           
1                                                                          
                             GEOMETRY INPUT                              52
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     POTENTIAL SURFACE SCAN                                                
     ******************************************************************    
                                                                           
     AS AN EXAMPLE OF THIS FEATURE, CONSIDER THE FOLLOWING ... WE          
     DESIRE A GRID ON THE METHYLENE SURFACE FOR 3 DIFFERENT BOND           
     LENGTHS, AT 2 ANGLES.                                                 
                                                                           
     CARD COLUMNS                                                          
             1234567890123456789012345678901234567890123456789012345678    
                                                                           
    (1)      *MOLSS,UHF                                                    
    (2)      CH2   POTENTIAL SURFACE SCAN                                  
    (3)       0 3                                                          
    (4)         6                                                          
    (5)         1   1 1.09                                                 
    (6)         1   1 1.09          2 100.                                 
    (7)      (BLANK)                                                       
    (8)       3 2                                                          
    (9)        1  2                                       0.01             
   (10)        3                                          2.0              
                                                                           
     EXPLANATION OF CARDS                                                  
                                                                           
     CARDS 2-7    Z MATRIX INPUT (ORIGINAL FORMAT)                         
     CARD 8       NUMBER OF POINTS DESIRED FOR EACH PARAMETER SET - IN     
                  THIS CASE, 3 POINTS FOR PARAMETER SET 1, 2 FOR SET 2.    
                  THE CARD FORMAT IS (4I2).                                
     CARD 9       VARIATION CARD FOR FIRST PARAMETER SET.                  
     CARD 10      VARIATION CARD FOR SECOND PARAMETER SET.                 
                                                                           
     NOTE THAT THERE IS NO BLANK CARD FOLLOWING THE VARIATION CARDS.       
                                                                           
     THE SIX CALCULATED POINTS WILL HAVE (CH,HCH) = (1.09,100.),           
     (1.10,100.),(1.11,100.),(1.09,102.),(1.10,102.),(1.11,102.).          
                                                                           
     UP TO 4 PARAMETER SETS MAY BE SCANNED.                                
     EACH PARAMETER SET MAY CONTAIN UP TO 3 VARIATION CARDS - SEE          
     ABOVE FOR DETAILS CONCERNING VARIATION CARD TYPES.                    
                                                                           
     ******************************************************************    
     ELECTRIC FIELD SCAN                                                   
     ******************************************************************    
                                                                           
     TO IMPLEMENT THIS FEATURE, BOTH SS=F AND FI=E MUST BE SPECIFIED       
     ON THE *MOL CARD. THE SCAN IS OVER THE POLAR COORDINATES PHI          
     ( THE ANGLE FROM THE Z AXIS TO THE FIELD VECTOR ) , THETA ( THE       
     ANGLE FROM THE X AXIS TO THE PROJECTION OF THE FIELD VECTOR IN        
     THE X-Y PLANE ) AND R ( THE MAGNITUDE OF THE FIELD VECTOR ) .         
                                                                           
     INPUT REQUIRED                                                        
     CARD 1      NUMBER OF VALUES OF PHI, THETA , R FOR WHICH THE          
                 SCAN IS TO BE PERFORMED, AND IFILE (IN 4I2 FORMAT).       
                 IFILE IS THE UNIT NUMBER TO WHICH THE DATA MAY BE         
                 PUNCHED.  FOR EXAMPLE, IF IFILE IS 7 THE DATA WILL        
                 BE PUNCHED TO UNIT 7.  THE FILE SHOULD BE BLOCKED AND     
                 FORMATTED AS WITH UNIT "IPUNCH".  IF IFILE IS NOT         
                 SPECIFIED, OR GIVEN A VALUE OF ZERO, DATA WILL NOT BE     
1                                                                          
 53                          GEOMETRY INPUT                                
                                                                           
                                                                           
                                                                           
                 PUNCHED TO ANY FILE.                                      
     CARD 2      INITIAL VALUES OF THE POLAR COORDINATES. PHI AND          
                 THETA SHOULD BE IN DEGREES, WITH R IN VOLTS/CM .          
                 ( IN 3F12.0 FORMAT ).                                     
     CARD 3      INCREMENTS FOR PHI, THETA AND R. ( SAME UNITS AND         
                 FORMAT AS CARD 2 ).                                       
                                                                           
     FOR EXAMPLE                                                           
                                                                           
   (1)      *MOL SS=F,FI=E                                                 
   (2)      H2 ELECTRIC FIELD SCAN                                         
   (3)       0 1                                                           
   (4)      1                                                              
   (5)      1 1 1.00                                                       
   (6)                                                                     
   (7)       3 2 2                                                         
   (8)      0.00         0.00        5.142251E8                            
   (9)      45.0         90.0        5.142251E8                            
                                                                           
     IF CARD (7) IS SPECIFIED AS   3 2 2 7 THEN THE DATA IS PUNCHED        
     TO UNIT 7.                                                            
                                                                           
     NOTES: TO EVERY CARTESIAN POINT THERE MAY NOT BE A UNIQUE SET OF      
            POLAR COORDINATES. THUS, IT IS POSSIBLE THAT THE SAME          
            POINT IS CALCULATED MORE THAN ONCE. THIS IS LEFT TO THE        
            USERS DISCRETION. HOWEVER, RECURSIVE POINTS FROM PHI=0.00      
            OR 180.00 AT ANY VALUE OF THETA ARE REMOVED BY THE PROGRAM.    
            ALSO REMOVED ARE POINTS WITH R LESS THAN OR EQUAL TO ZERO.     
                                                                           
     RESULTS IN IFILE HAVE THE FOLLOWING FORMAT:                           
                                                                           
     CARD 1      HAS THE X, Y AND Z COMPONENTS OF THE ELECTRIC FIELD       
                 IN ATOMIC UNITS, AS WELL AS PHI (IN DEGREES), THETA       
                 (IN DEGREES), AND R (IN VOLTS/CM).                        
     CARD 2      HAS THE TOTAL ENERGY (IN HARTREES), EDIFF (IN             
                 HARTREES) WHICH IS THE DIFFERENCE BETWEEN THE             
                 ENERGY IN THE FIELD AND THE ZERO FIELD ENERGY, THE X,     
                 Y AND Z COMPONENTS OF THE DIPOLE MOMENTS (IN DEBYES),     
                 AND THE TOTAL DIPOLE MOMENT (IN DEBYES).                  
                                                                           
     ******************************************************************    
     SCRFT SCAN                                                            
     ******************************************************************    
                                                                           
     TO IMPLEMENT THIS OPTION, BOTH SS=F AND FI=S MUST BE SPECIFIED ON     
     THE *MOL CARD. THE SCAN IS OVER THE RADIUS ( IN ANGSTROMS )           
     AND THE DIELECTRIC CONSTANT.                                          
                                                                           
     INPUT REQUIRED                                                        
                                                                           
     CARD 1      NUMBER OF VALUES FOR THE RADIUS AND THE DIELECTRIC        
                 CONSTANT ( IN 2I2 ).                                      
     CARD 2      INITIAL VALUES FOR THE RADIUS AND THE DIELECTRIC          
                 CONSTANT ( IN 2F12.0 )                                    
     CARD 3      INCREMENT FOR THE RADIUS AND THE DIELECTRIC CONSTANT      
                 ( IN 2F12.0 ).                                            
                                                                           
     FOR EXAMPLE                                                           
1                                                                          
                             GEOMETRY INPUT                              54
                                                                           
                                                                           
                                                                           
   (1)      *MOL SS=F,FI=S                                                 
   (2)      H2 SCRFT SCAN                                                  
   (3)       0 1                                                           
   (4)      1                                                              
   (5)      1 1 1.00                                                       
   (6)                                                                     
   (7)       3 2                                                           
   (8)      0.500        1.00                                              
   (9)      0.100        1.00                                              
                                                                           
1                                                                          
 55                          GEOMETRY INPUT                                
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     DIRECT COORDINATE INPUT.                                              
     ******************************************************************    
                                                                           
     TITLE (FREE FIELD).                                                   
     CHARGE AND MULTIPLICITY (2I2) ... SEE CONVENTION ABOVE.               
     IAN,X,Y,Z (I4,3F20.10).                                               
     IAN IS THE ATOMIC NUMBER. X, Y AND Z ARE THE COORDINATES FOR THIS     
     ATOM. FLOATING ATOMS (SEE ABOVE) ARE PERMITTED, AND THE END OF        
     COORDINATE INPUT IS INDICATED BY AN ATOMIC NUMBER OF 0.               
                                                                           
     ******************************************************************    
                                                                           
1                                                                          
                             GEOMETRY INPUT                              56
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     APPLY AN EXTERNAL ELECTRIC FIELD                                      
     ******************************************************************    
                                                                           
     THE EXTERNAL FIELD TO BE APPLIED IS READ IN AFTER THE BLANK CARD      
     FOR THE GEOMETRY SPECIFICATION, AND CONSISTS OF ONE CARD WITH         
     THE X, Y AND Z COMPONENTS OF THE FIELD (IN VOLTS/CM), IN 3F12.0       
     FORMAT.                                                               
                                                                           
     FOR EXAMPLE, TO APPLY A FIELD OF 1000.0 V/CM IN THE +Y DIRECTION,     
     THE CARD                                                              
     0.0         1000.0      0.0                                           
     WOULD DO THE JOB.                                                     
                                                                           
     NOTE: THIS OPTION CAN NOT BE APPLIED TO A CHARGED SYSTEM.             
           IF THE OPTION SSCAN=FIELD IS USED, THIS INPUT IS NOT            
           USED. SEE ELECTRIC FIELD SCAN FOR DETAILS.                      
                                                                           
1                                                                          
 57                          GEOMETRY INPUT                                
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     SELF-CONSISTENT REACTION FIELD THEORY:                                
     CALCULATION OF A MOLECULE IN A SOLVENT                                
     ******************************************************************    
                                                                           
     TO APPLY THE SELF-CONSISTENT REACTION FIELD THEORY (SCRFT),           
     THE RADIUS OF THE CAVITY TO CONTAIN THE MOLECULE (IN ANGSTROMS),      
     AND THE DIELECTRIC CONSTANT OF THE SOLVENT ARE REQUIRED. THESE        
     VALUES ARE READ IN 2F12.0 FORMAT FROM A CARD WHICH FOLLOWS THE        
     BLANK CARD AT THE END OF THE GEOMETRY INPUT.                          
                                                                           
     FOR EXAMPLE, FOR A CAVITY OF RADIUS 5.0 ANGSTROMS AND DIELECTRIC      
     CONSTANT OF 15.0, THE FOLLOWING CARD WOULD BE REQUIRED:               
     5.0         15.0                                                      
                                                                           
     NOTE: THIS THEORY CAN NOT BE APPLIED TO A CHARGED SYSTEM.             
           IF THE OPTION SSCAN=FIELD IS USED, THIS INPUT IS NOT USED.      
           SEE SCRFT SCAN FOR DETAILS.                                     
                                                                           
1                                                                          
                             GEOMETRY INPUT                              58
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     REPLACEMENT ATOMIC MASSES.                                            
     ******************************************************************    
                                                                           
     THERE ARE TWO METHODS OF SPECIFYING REPLACEMENT ATOMIC MASSES:        
                                                                           
     1) SELECT A REPLACEMENT MASS NUMBER FOR ONLY A SPECIFIC ATOM          
        NUMBER. THIS IS DONE BY GIVING THE ATOM NUMBER FOLLOWED BY THE     
        DESIRED MASS NUMBER ON ONE INPUT LINE (FREE FORMAT). FOR           
        EXAMPLE, TO SELECT MASS NUMBER 2 FOR THE 7'TH ATOM, ENTER:         
        7 2                                                                
                                                                           
     2) SELECT A REPLACEMENT MASS NUMBER FOR ALL ATOMS WITH THE SAME       
        ATOMIC NUMBER SIMULTANEOUSLY. THIS IS DONE BY GIVING THE ATOM      
        SYMBOL FOLLOWED BY THE DESIRED MASS NUMBER ON ONE INPUT LINE       
        (FREE FORMAT). FOR EXAMPLE, TO SELECT MASS NUMBER 2 FOR            
        ALL HYDROGEN ATOMS, ENTER:                                         
        H 2                                                                
                                                                           
     THESE INPUT LINES IMMEDIATELY FOLLOW THE BLANK CARD AFTER THE         
     Z-MATRIX (AFTER THE VARIABLE VALUES IF ANY), OR AFTER THE             
     BLANK CARD FOR DIRECT COORDINATE INPUT.                               
                                                                           
     AS MANY REPLACEMENT LINES AS NEEDED MAY BE GIVEN, ENDING THE          
     LIST OF REPLACEMENTS WITH A BLANK CARD. THE LAST REPLACEMENT          
     MASS NUMBER GIVEN FOR EACH ATOM WILL BE USED.                         
                                                                           
1                                                                          
 59                          GEOMETRY INPUT                                
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     OPTIONS ... IOP( )                                                    
     ******************************************************************    
     IOP(13) ... INITIAL ENTRY OR CONTINUATION                             
     0  FIRST ENTRY (SINGLE CALCULATION, GEOMETRY OPT OR SURFACE SCAN)     
     1  CONTINUATION OF Z MATRIX GEOMETRY OPTIMIZATION RUN                 
     2  CONTINUATION OF POTENTIAL SURFACE SCAN                             
     3  FIRST ENTRY AFTER CALL TO STANDARD GEOMETRY.                       
                                                                           
     IOP(14) ... RESTART OF A Z MATRIX OPTIMIZATION.                       
     0  NORMAL RUN                                                         
     1  RESTART - IOP(18) MAY ALSO BE USED TO RECOVER THE OPTIMUM          
     GEOMETRY FOR THE LAST PARAMETER SET THAT WAS COMPLETED.               
                                                                           
     IOP(15) ... SHALL WE PUNCH RESTART CARDS                              
     0  NO (THIS IS USED FOR THE STANDARD ROUTE).                          
     1  PUNCH THE FINAL Z MATRIX ONLY.                                     
     2  YES.                                                               
                                                                           
     IOP(16) ... MAXIMUM NUMBER OF POINTS FOR THE OPTIMIZATION OF ONE      
                 SET OF PARAMETERS                                         
     N  ALLOW 2*N+6 POINTS TO BRACKET THE MINIMUM (IF N>6, N IS SET        
        TO 100000)                                                         
                                                                           
     IOP(17) ... READ INPUT GEOMETRY FORMAT FROM A CARD.                   
     0  NO - USE THE STANDARD FORMAT.                                      
     1  YES - READ A FORMAT STATEMENT FROM ONE CARD, INCLUDING THE         
     LEFT AND RIGHT PARENTHESES. FOR EXAMPLE, THE GAUSSIAN 70/76           
     Z MATRIX FORMAT CARD WOULD BE:                                        
     (I3,I4,F7.4,I4,F11.4,I4,F11.4,I4)                                     
     THIS FORMAT CARD IS INSERTED AFTER THE CHARGE/MULTIPLICITY CARD.      
     THIS OPTION IS NOT APPLICABLE TO FREE FORMAT OR STANDARD GEOMETRY     
     RUNS.                                                                 
                                                                           
     IOP(18) ... RESTART THE GEOMETRY FROM THE DISK FILE.                  
     0  NO.                                                                
     1  YES - THE GEOMETRY FOR THE ORIGINAL STARTING POINT IS READ AS      
     USUAL, THEN UPDATED FROM THE RESTART FILE (FILE 1) OF UNIT IMAT.      
     FOR Z MATRIX OPTIMIZATIONS, THE OPTIMUM GEOMETRY FROM THE LAST        
     PARAMETER SET COMPLETED IS RESTORED; FOR OTHER OPTIMIZATION           
     METHODS, THE LATEST GEOMETRY IS RESTORED.                             
                                                                           
     IOP(19) ... TYPE OF SURFACE SCAN TO BE PERFORMED.                     
     0  GEOMETRY SURFACE SCAN.                                             
     1  FIELD SCAN.                                                        
                                                                           
     IOP(20) ... NOT USED.                                                 
                                                                           
     IOP(21) ... PRINT CONTROL.                                            
     0  NORMAL PRINTING.                                                   
     1  ONLY PRINT INITIAL AND FINAL POINTS OF EACH PARAMETER              
     OPTIMIZATION. THIS IOP IS ALSO USED FROM GBOPT (LINK 0711) FOR        
     PRINT CONTROL IN BUILDZ.                                              
                                                                           
1                                                                          
                             GEOMETRY INPUT                              60
                                                                           
                                                                           
                                                                           
     IOP(22) ... CHOICE OF ATOMIC MASSES.                                  
     0  USE MASS OF MOST ABUNDANT ISOTOPE FOR EACH ATOM.                   
     1  USE ABUNDANCE-AVERAGED ATOMIC WEIGHTS FOR EACH ATOM.               
     2  SET MASS OF MOST ABUNDANT ISOTOPE FOR EACH ATOM, THEN READ         
        REPLACEMENT VALUES.                                                
                                                                           
     IOP(23) ... DUMP ATOMIC MASS TABLES (ROUTINE FILMAS).                 
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(24) ... PERMIT ELECTRIC FIELD CALCS ON CHARGED SYSTEMS.           
     0  NO.                                                                
     1  YES - IN THIS CASE, BOTH THE TOTAL ENERGY AND DIPOLE MOMENT        
        THAT ARE COMPUTED ARE NOT INVARIANT TO THE POSITION OF THE         
        MOLECULE IN 3D SPACE, BUT SOME DERIVED PROPERTIES (E.G.            
        THE POLARIZABILITY) ARE INVARIANT EVEN FOR CHARGED SYSTEMS.        
                                                                           
     IOP(25) TO IOP(60) ... NOT USED                                       
     ******************************************************************    
                                                                           
     NOTE THAT THE TITLE AND MULTIPLICITY WERE ACTUALLY READ IN LNK1.      
     THE MAXIMUM NUMBER OF ATOMS IS #NA.                                   
1                                                                          
 61                                                                        
                                                                           
                                                                           
                                                                           
 CHAPTER 5: BASIS SETS.                                                    
 **********                                                                
                                                                           
     LINK 0301                                                             
                                                                           
     --------------                                                        
     U OF T VERSION                                                        
     OCTOBER 1991                                                          
     --------------                                                        
                                                                           
     SETUP PROGRAM FOR THE GAUSSIAN INTEGRAL PACKAGE                       
                                                                           
     GENERAL INPUT DATA LIMITATIONS                                        
                                                                           
     #NS SHELLS ... SEE DEFINITION OF A SHELL IN COMMENT CARDS BELOW       
     TYPES S P SP D AND F ONLY                                             
     MAXIMUM OF 10 GAUSSIAN FUNCTIONS PER SHELL                            
     BUT                                                                   
     MAXIMUM OF #NP GAUSSIANS IN TOTAL                                     
     #NB ATOMIC ORBITALS                                                   
     #NA ATOMS (INCLUDING DUMMY AND FLOATING ATOMS).                       
                                                                           
     ******************************************************************    
                                                                           
     INTERNAL BASIS SETS AVAILABLE:                                        
                                                                           
     BASIS                     CODE    ATOMS                               
     ------------------------------------------------------------------    
     STO-NG,  N=1 TO 6         MN      H TO XE                             
     STO-NG*                   MN*     NA TO AR                            
                                                                           
     3-21G                     V3      H TO CA, GA TO SR, IN TO XE         
     3-21G*                    V3*     H TO CA, GA TO SR, IN TO XE         
     3-21G+                    V3+     H, LI TO F, NA TO AR                
     3-21G++                   V3++    H, LI TO F, NA TO AR                
                                                                           
     4-21G (PULAY)             P4      H, B TO F                           
                                                                           
     4-21G                     V4      H TO NE                             
     4-21G*                    V4*     H TO NE                             
     4-21G**                   V4**    H TO NE                             
                                                                           
     5-21G (IN PLACE OF 4-31G) E4      LI, BE                              
     5-21G*                    E4*     LI, BE                              
     5-21G**                   E4**    LI, BE                              
                                                                           
     6-21G                     V6      H TO AR                             
     6-21G*                    V6*     H TO AR                             
     6-21G**                   V6**    H TO AR                             
     6-21G+                    V6+     H, LI TO F, NA TO AR                
     6-21G++                   V6++    H, LI TO F, NA TO AR                
                                                                           
     4-31G                     E4      H TO NE, P, S, CL                   
     4-31G*                    E4*     H TO NE                             
     4-31G**                   E4**    H TO NE                             
     4-31G+                    E4+     H, LI TO F, P, S, CL                
     4-31G++                   E4++    H, LI TO F, P, S, CL                
                                                                           
1                                                                          
                               BASIS SETS                                62
                                                                           
                                                                           
                                                                           
     5-31G                     E5      C, N, O, F                          
     5-31G*                    E5*     C, N, O, F                          
     5-31G**                   E5**    C, N, O, F                          
                                                                           
     6-31G                     E6      H TO AR                             
     6-31G*                    E6*     H TO AR                             
     6-31G**                   E6**    H TO AR                             
     6-31G+                    E6+     H, LI TO F, NA TO AR                
     6-31G++                   E6++    H, LI TO F, NA TO AR                
                                                                           
     6-311G                    C6      H TO NE                             
     6-311G*                   C6*     H TO NE                             
     6-311G**                  C6**    H TO NE                             
     6-311G+                   C6+     H, LI TO F                          
     6-311G++                  C6++    H, LI TO F                          
                                                                           
1                                                                          
 63                            BASIS SETS                                  
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     OPTIONS ... IOP( )                                                    
     ******************************************************************    
     IOP(13) ... NUMBER OF GAUSSIAN FUNCTIONS                              
     N  STO-NG, N-M1G, N-M11G.                                             
        IF IOP(6)=0 AND IOP(13)=0, THE BASIS SET DEFAULTS TO STO-3G.       
        THE INTERNAL BASIS SET TYPES AVAILABLE ARE STO-NG (IOP(6)=0),      
        N-21G (IOP(6)=1), N-31G (IOP(6)=2), PULAY N-21G (IOP(6)=3) AND     
        N-311G (IOP(6)=4).                                                 
        FOR INPUT OF A GENERAL BASIS SET THIS OPTION IS IGNORED.           
                                                                           
     IOP(14) ... SCALING FACTORS (SEE NOTES BELOW)                         
     0  STANDARD RUN                                                       
     1  BASIS SET OPTIMIZATION RUN (SECOND AND SUBSEQUENT ENTRIES) THE     
        BASIS SET IS NOT REDEFINED.                                        
                                                                           
     IOP(15) ... HANDLING OF SMALL TWO ELECTRON INTEGRALS                  
     N  DISCARD IF MAGNITUDE LESS THAN 10**-(6+N).                         
     NOTE ... ACCURACY OF CALCULATED INTEGRALS SHOULD BE BETWEEN           
     10**-8 AND 10**-9 AU, AND NORMALLY IOP(15)=4 IS USED.                 
                                                                           
     IOP(16) ... PRINTING OF OVERLAP / CORE HAMILTONIAN INTEGRALS.         
     0  NO PRINTING.                                                       
     1  PRINT OVERLAP INTEGRALS.                                           
     2  PRINT OVERLAP AND CORE HAMILTONIAN (T+V) INTEGRALS.                
     3  PRINT CORE HAMILTONIAN INTEGRALS.                                  
     7  PRINT S AND H (T+V) INTEGRALS WITH EXTENDED PRECISION, AS WELL     
        AS NORMALLY.                                                       
                                                                           
     IOP(17) ... PRINTING OF DIPOLE MOMENT INTEGRALS.                      
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(18) ... PRINTING OF TWO ELECTRON INTEGRALS                        
     0  NO PRINTING.                                                       
     1  PRINT ... FOUR PER LINE WITH ASSOCIATED LABELS.                    
                                                                           
     IOP(19) ... PRINTING OF NORMALIZED COEFFICIENTS.                      
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(20) ... SET UP BASIS SET FOR PROJECTED INITIAL GUESS.             
     0  NOT USING PROJECTED INITIAL GUESS.                                 
     1  SET UP STO-3G.                                                     
     2  SET UP 3-21G.                                                      
     3  SET UP A GENERAL BASIS SET.                                        
     THIS OPTION SAVES THE DATA REQUIRED IN LINK 0401 ON DISK: THE         
     BASIS SET TO FILE 31, THE SELF-OVERLAP TO FILE 31 AND THE             
     OVERLAP BETWEEN THE BASES TO FILE 4.                                  
     THIS BASIS SET WILL ALWAYS USE 5D/7F TYPE ORBITALS IF REQUIRED.       
     IF PRINTED, THIS BASIS WILL BE BEFORE THE ACTUAL BASIS TO BE USED     
     IN THE CALCULATION. ANY FLOATING ATOMS WILL BE TREATED AS DUMMY       
     ATOMS FOR THE INTERNAL BASES, AND ANY FLOATING ATOMS AFTER THE        
     LAST REAL ATOM WILL NOT BE PRINTED SINCE THE BASIS SET IS PRINTED     
     BY SHELLS, NOT ATOMS.                                                 
                                                                           
1                                                                          
                               BASIS SETS                                64
                                                                           
                                                                           
                                                                           
     IOP(21) ... RESTART THE BASIS SET.                                    
     0  NO.                                                                
     1  YES - THE ORIGINAL BASIS SET IS READ IN, THEN UPDATED              
     FROM THE FILES ON UNIT IMAT.                                          
                                                                           
     IOP(22) ... COMPUTE S AND H INTEGRALS ON CHECK RUNS.                  
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(23) ... PRINT CONTROL.                                            
     0  ONLY PRINT IF NON-STANDARD SCALE FACTORS ARE USED.                 
     1  NO PRINTING OF BASIS SET TABLE OR 2-ELECTRON INTEGRAL              
     COUNTS. INTEGRAL PRINTING DETERMINED FROM IOP'S 16 - 18.              
     2  PRINT THE BASIS SET TABLE.                                         
                                                                           
     IOP(24) ... NORMALIZATION OF PRIMITIVE FUNCTIONS.                     
     0  CONTRACTION COEFFICIENTS REFER TO UN-NORMALIZED PRIMITIVES.        
     1  CONTRACTION COEFFICIENTS REFER TO NORMALIZED PRIMITIVES.           
     NOTE THAT THE CONTRACTED FUNCTIONS ARE ALWAYS NORMALIZED.             
     THIS OPTION DOES NOT APPLY TO THE BASIS SET TO BE PROJECTED - IT      
     IS ASSUMED TO HAVE UN-NORMALIZED PRIMITIVES.                          
                                                                           
     IOP(25) ... POLARIZATION FUNCTIONS ADDED TO INTERNAL BASIS SETS.      
     0  NONE.                                                              
     1  D ORBITALS ON NA-AR.                                               
     2  D ORBITALS ON LI-NE (FOR N-M1G/N-M11G BASES).                      
     3  COMBINATION OF 1 AND 2.                                            
     4  P ORBITALS ON H/HE (FOR N-M1G/N-M11G BASES).                       
     5  COMBINATION OF 1 AND 4.                                            
     6  COMBINATION OF 2 AND 4.                                            
     7  COMBINATION OF 1, 2 AND 4.                                         
     THIS OPTION IS APPLIED ONLY TO AN INTERNAL BASIS USED FOR             
     THE ACTUAL CALCULATION, NOT TO AN INTERNAL BASIS USED FOR A           
     PROJECTED INITIAL GUESS.                                              
                                                                           
     IOP(26) ... PRINT PROJECTED GUESS BASIS SET.                          
     0  NO.                                                                
     1  YES - PROJECTION FROM A GENERAL BASIS ALWAYS CAUSES PRINTING.      
                                                                           
     IOP(27) ... POLARIZATION FUNCTIONS ADDED TO INTERNAL BASIS SETS.      
     0  NONE.                                                              
     1  D ORBITALS ON K, CA, GA-KR (FOR N-M1G/N-M11G BASES).               
     2  D ORBITALS ON RB, SR, IN-XE (FOR N-M1G/N-M11G BASES).              
     3  COMBINATION OF 1 AND 2.                                            
     THIS OPTION IS APPLIED ONLY TO AN INTERNAL BASIS USED FOR             
     THE ACTUAL CALCULATION, NOT TO AN INTERNAL BASIS USED FOR A           
     PROJECTED INITIAL GUESS.                                              
                                                                           
     IOP(28) ... DIFFUSE FUNCTIONS ADDED TO INTERNAL BASIS SETS.           
     0  NONE.                                                              
     1  SP ORBITALS ON NA-AR (FOR N-M1G/N-M11G BASES).                     
     2  SP ORBITALS ON LI-NE (FOR N-M1G/N-M11G BASES).                     
     3  COMBINATION OF 1 AND 2.                                            
     4  S ORBITALS ON H/HE (FOR N-M1G/N-M11G BASES).                       
     5  COMBINATION OF 1 AND 4.                                            
     6  COMBINATION OF 2 AND 4.                                            
     7  COMBINATION OF 1, 2 AND 4.                                         
1                                                                          
 65                            BASIS SETS                                  
                                                                           
                                                                           
                                                                           
     THIS OPTION IS APPLIED ONLY TO AN INTERNAL BASIS USED FOR             
     THE ACTUAL CALCULATION, NOT TO AN INTERNAL BASIS USED FOR A           
     PROJECTED INITIAL GUESS.                                              
                                                                           
     IOP(29) ... DIFFUSE FUNCTIONS ADDED TO INTERNAL BASIS SETS.           
     0  NONE.                                                              
     1  SP ORBITALS ON K, CA, GA-KR (FOR N-M1G/N-M11G BASES).              
     2  SP ORBITALS ON RB, SR, IN-XE (FOR N-M1G/N-M11G BASES).             
     3  COMBINATION OF 1 AND 2.                                            
     THIS OPTION IS APPLIED ONLY TO AN INTERNAL BASIS USED FOR             
     THE ACTUAL CALCULATION, NOT TO AN INTERNAL BASIS USED FOR A           
     PROJECTED INITIAL GUESS.                                              
                                                                           
     IOP(30) ... INTEGRAL ACCURACY CUTOFFS.                                
     0  STANDARD CUTOFFS FOR 10**-8 INTEGRAL ACCURACY.                     
     1  NO CUTOFFS USED.                                                   
     2  USE OLD "SLOPPY" STO-3G CUTOFFS FOR 10**-6 ACCURACY.               
                                                                           
     IOP(31) ... USE "FAST" SPDF INTEGRAL ROUTINES.                        
     0  YES, IF POSSIBLE.                                                  
     1  NO.                                                                
                                                                           
     IOP(32) ... PRINTING OF S / H INTEGRALS AFTER ED/BSSE SELECTION.      
     0  NO PRINTING.                                                       
     1  PRINT OVERLAP INTEGRALS.                                           
     2  PRINT OVERLAP AND CORE HAMILTONIAN (T+V) INTEGRALS.                
     3  PRINT CORE HAMILTONIAN INTEGRALS.                                  
                                                                           
     IOP(33) ... PRINTING OF 2-E INTEGRALS AFTER ED/BSSE SELECTION.        
     0  NO PRINTING.                                                       
     1  PRINT ... FOUR PER LINE WITH ASSOCIATED LABELS.                    
                                                                           
     IOP(34) ... ENERGY DECOMPOSITION / BSSE CORRECTION.                   
     0  NO.                                                                
     1  ENERGY DECOMPOSITION ONLY.                                         
     2  BSSE CORRECTION ONLY.                                              
     3  ENERGY DECOMPOSITION AND BSSE CORRECTION.                          
                                                                           
     IOP(35) TO IOP(60) ... NOT USED                                       
     ******************************************************************    
                                                                           
1                                                                          
                               BASIS SETS                                66
                                                                           
                                                                           
                                                                           
     FOR THE STO-NG BASES THE SCALE FACTORS PERTAIN TO THE FOLLOWING       
     ORBITALS                                                              
     1S 2SP 3SP 3D 4S 4P 4D 5S 5P,    OR                                   
     1S 2SP 3SP 3D 4SP 4D 5SP                                              
     FOR K AND CA, THE 3D SCALE FACTOR IS INCLUDED IN THE LIST, BUT        
     NOT USED, AS THOSE BASES DO NOT INCLUDE 3D ORBITALS AT PRESENT.       
     FOR RB AND SR, THE 4D SCALE FACTOR IS INCLUDED IN THE LIST, BUT       
     NOT USED, AS THOSE BASES DO NOT INCLUDE 4D ORBITALS AT PRESENT.       
                                                                           
     FOR THE N-21G/N-31G SERIES OF BASES:                                  
     FOR HYDROGEN/HELIUM:                                                  
     1S' 1S" 2P(POL) 2S(DIFF)                                              
     FOR LITHIUM TO NEON:                                                  
     1S 2SP' 2SP" 3D(POL) 3SP(DIFF)                                        
     FOR SODIUM TO ARGON:                                                  
     1S 2SP 3SP' 3SP" 3D(POL) 4SP(DIFF)                                    
     FOR POTASSIUM TO KRYPTON:                                             
     1S 2SP 3SP 3D 4SP' 4SP" 4D(POL) 5SP(DIFF)                             
     FOR RUBIDIUM TO XENON:                                                
     1S 2SP 3SP 3D 4SP 4D 5SP' 5SP" 5D(POL) 6SP(DIFF)                      
                                                                           
     AND FOR THE N-311G SERIES OF BASES:                                   
     FOR H/HE:                                                             
     1S' 1S" 1S"' 2P(POL) 2S(DIFF)                                         
     FOR LI-NE:                                                            
     1S 2SP' 2SP" 2SP"' 3D(POL) 3SP(DIFF)                                  
     FOR NA-AR:                                                            
     1S 2SP 3SP' 3SP" 3SP"' 3D(POL) 4SP(DIFF)                              
                                                                           
1                                                                          
 67                            BASIS SETS                                  
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     STANDARD EXPONENTS                                                    
     ******************************************************************    
                                                                           
     FOR STO-NG BASIS--------------------------------------------------    
                                                                           
     ATOM  1S    2SP   3SP   3D    4SP   4S    4P    4D    5SP             
                                                                           
     H     1.24                                                            
     HE    1.69                                                            
     LI    2.69  0.80                                                      
     BE    3.68  1.15                                                      
     B     4.68  1.50                                                      
     C     5.67  1.72                                                      
     N     6.67  1.95                                                      
     O     7.66  2.25                                                      
     F     8.65  2.55                                                      
     NE    9.64  2.88                                                      
     NA   10.61  3.48  1.75                                                
     MG   11.59  3.90  1.70                                                
     AL   12.56  4.36  1.70                                                
     SI   13.53  4.83  1.75                                                
     P    14.50  5.31  1.90                                                
     S    15.47  5.79  2.05                                                
     CL   16.43  6.26  2.10                                                
     AR   17.40  6.74  2.33                                                
     K    18.61  7.26  2.75        1.43                                    
     CA   19.58  7.74  3.01        1.36                                    
     SC   20.56  8.22  3.21  1.10  1.60  1.16  1.05                        
     TI   21.54  8.70  3.44  1.90  1.70  1.20  1.10                        
     V    22.53  9.18  3.67  2.55  1.70  1.25  1.15                        
     CR   23.52  9.66  3.89  3.05  1.75  1.28  1.20                        
     MN   24.50 10.13  4.11  3.45  1.65  1.32  1.25                        
     FE   25.49 10.61  4.33  3.75  1.55  1.36  1.30                        
     CO   26.47 11.09  4.55  4.10  1.55  1.39  1.35                        
     NI   27.46 11.56  4.76  4.35  1.60  1.43  1.40                        
     CU   28.44 12.04  4.98  4.60  1.60  1.46  1.45                        
     ZN   29.43 12.52  5.19  4.90  1.90  1.49  1.50                        
     GA   30.42 12.99  5.26  5.26  1.80                                    
     GE   31.40 13.47  5.58  5.58  2.00                                    
     AS   32.39 13.94  5.90  5.90  2.12                                    
     SE   33.37 14.40  6.22  6.22  2.22                                    
     BR   34.36 14.87  6.54  6.54  2.38                                    
     KR   35.34 15.34  6.86  6.86  2.54                                    
     RB   36.32 15.81  7.18  7.18  3.02                    1.90            
     SR   37.31 16.28  7.49  7.49  3.16                    1.80            
     Y    38.29 16.72  7.97  7.97  3.29              1.40  1.80            
     ZR   39.27 17.19  8.21  8.21  3.48              1.95  1.90            
     NB   40.26 17.66  8.51  8.51  3.67              2.40  1.90            
     MO   41.24 18.12  8.82  8.82  3.87              2.70  1.95            
     TC   42.22 18.59  9.14  9.14  4.05              3.00  1.85            
     RU   43.21 19.05  9.45  9.45  4.24              3.20  1.75            
     RH   44.19 19.51  9.77  9.77  4.41              3.45  1.75            
     PD   45.17 19.97 10.09 10.09  4.59              3.60  1.80            
     AG   46.15 20.43 10.41 10.41  4.76              3.75  1.80            
     CD   47.14 20.88 10.74 10.74  4.93              3.95  2.10            
     IN   48.12 21.33 11.08 11.08  4.65              4.65  2.05            
     SN   49.10 21.79 11.39 11.39  4.89              4.89  2.15            
1                                                                          
                               BASIS SETS                                68
                                                                           
                                                                           
                                                                           
     SB   50.08 22.25 11.71 11.71  5.12              5.12  2.20            
     TE   51.07 22.71 12.03 12.03  5.36              5.36  2.28            
     I    52.05 23.17 12.35 12.35  5.59              5.59  2.42            
     XE   53.03 23.63 12.66 12.66  5.82              5.82  2.57            
                                                                           
     ATOMS H-AR:                                                           
     INNER SHELLS ARE BEST ATOM VALUES ... J.CHEM.PHYS. 38, 2686 (1963)    
     OUTER SHELL HAS BEEN SELECTED ON THE BASIS OF NUMEROUS                
     OPTIMIZATION STUDIES ON VARIED SMALL MOLECULES:                       
     H, LI-F: W.J. HEHRE, R.F. STEWART AND J.A. POPLE, JCP, 51,            
     2657 (1969). NA-CL: W.J. HEHRE, R. DITCHFIELD, R.F. STEWART AND       
     J.A. POPLE, JCP, 52, 2769 (1970).                                     
     ATOMS K, CA AND GA-KR USE A 3S=3P=3D/4S=4P BASIS:                     
     W.J. PIETRO, B.A. LEVI, W.J. HEHRE AND R.F. STEWART, INORG. CHEM.,    
     19, 2225 (1980).                                                      
     ATOM SC-ZN:                                                           
     W.J. PIETRO AND W.J. HEHRE, J. COMPUT. CHEM., 4, 241 (1983).          
     ATOMS SC-ZN 4S AND 4P ARE ATOM OPTIMIZED VALUES:                      
     E. CLEMENTI AND D.L. RAIMONDI, J.C.P., 38, 2686 (1963).               
     ATOMS RB, SR, IN-XE USE A 3S=3P=3D, 4S=4P=4D AND 5S=5P BASIS:         
     W.J. PIETRO, E.S. BLUROCK, R.F. HOUT, JR., W.J. HEHRE,                
     DEFREES AND R.F. STEWART, INORG. CHEM., 20, 3650 (1981).              
                                                                           
     ******************************************************************    
                                                                           
     FOR 3-21G, 4-21G AND 6-21G BASIS SETS.                                
                                                                           
     ALL SCALE FACTORS ARE 1.0, EXCEPT H WHICH ARE 1.10 FOR 1S AND 1S*.    
                                                                           
     REFERENCES:                                                           
     H-NE: J.S. BINKLEY, J.A. POPLE AND W.J. HEHRE,                        
     JACS, 102, 939 (1980).                                                
     NA-AR: M.S. GORDON, J.S. BINKLEY, J.A. POPLE, W.J. PIETRO             
     AND W.J. HEHRE, JACS, 104, 2797 (1982).                               
     K-XE (MAIN GROUP ONLY): K.D. DOBBS AND W.J. HEHRE, J. COMP. CHEM.,    
     7, 359-378 (1986).                                                    
                                                                           
     FOR THE PULAY 4-21G BASIS SET.                                        
                                                                           
     ALL SCALE FACTORS ARE UNITY.                                          
                                                                           
     REFERENCE: P. PULAY, G. FOGARASI, F. PANG AND J.E. BOGGS, JACS,       
     101, 2550 (1979).                                                     
     ******************************************************************    
                                                                           
     FOR N-31G BASIS ... ALSO N-31G*, N-31G**.                             
                                                                           
     HYDROGEN, HELIUM--------------------------------------------------    
                                                                           
            1S'   1S"                                                      
                                                                           
     H     1.20  1.15                                                      
     HE    1.00  1.00                                                      
                                                                           
     FIRST ROW ATOMS---------------------------------------------------    
                                                                           
     ATOM   1S   2SP'  2SP"                                                
                                                                           
1                                                                          
 69                            BASIS SETS                                  
                                                                           
                                                                           
                                                                           
     LI    1.00  1.03  1.12                                                
     BE    1.00  1.03  1.12                                                
     B     1.00  1.03  1.12                                                
     C     1.00  1.00  1.04                                                
     N     1.00  0.99  0.98                                                
     O     1.00  0.99  0.98                                                
     F     1.00  1.00  1.00                                                
     NE    1.00  1.00  1.00                                                
                                                                           
     SECOND ROW ATOMS (4-31G(**) ONLY)---------------------------------    
                                                                           
     ATOM   1S   2SP   3SP'  3SP"                                          
                                                                           
     SI    1.00  1.00  1.00  1.00                                          
     P     1.00  1.00  0.98  1.02                                          
     S     1.00  1.00  0.98  1.01                                          
     CL    1.00  1.00  1.00  1.01                                          
                                                                           
     INNER SHELLS LEFT AT BEST ATOM VALUES.                                
     AGAIN 4-31G(**) OUTER SCALE FACTORS CHOSEN ON THE BASIS OF            
     NUMEROUS OPTIMIZATION STUDIES ON SMALL MOLECULES:                     
     H, C-F: R. DITCHFIELD, W.J. HEHRE AND J.A. POPLE, JCP, 54,            
     724 (1971). W.J. HEHRE, R. DITCHFIELD AND J.A. POPLE, JCP,            
     56, 2257 (1972). B: W.J. HEHRE AND J.A. POPLE, JCP, 56,               
     4233 (1972). P-CL: W.J. HEHRE AND W.A. LATHAN, JCP, 56,               
     5255 (1972). LI, B: J.D. DILL AND J.A. POPLE, JCP, 62, 2921           
     (1975). BE: J.S. BINKLEY AND J.A. POPLE, JCP, 66, 879 (1977).         
     FOR 6-31G(**) NA TO AR ALL SCALE FACTORS ARE UNITY: M.M. FRANCL,      
     W.J. PIETRO, W.J. HEHRE, J.S. BINKLEY, M.S. GORDON, D.J. DEFREES      
     AND J.A. POPLE, J. CHEM. PHYS., 77, 3654 (1982).                      
     ******************************************************************    
                                                                           
     FOR THE 6-311G(**) BASIS SET.                                         
                                                                           
     ALL SCALE FACTORS ARE UNITY.                                          
                                                                           
     REFERENCE: R. KRISHNAN, J.S. BINKLEY, R. SEEGER AND J.A. POPLE,       
     J. CHEM. PHYS., 72, 650 (1980).                                       
                                                                           
1                                                                          
                               BASIS SETS                                70
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     STANDARD POLARIZATION FUNCTION EXPONENTS.                             
     ******************************************************************    
                                                                           
     STO-NG* BASIS (USES 5D):                                              
                                                                           
     NA,MG  0.09      AL-AR  0.39                                          
                                                                           
     REFERENCE: J.B. COLLINS, P.V.R. SCHLEYER, J.S. BINKLEY AND            
     J.A. POPLE, J.C.P., 64, 5142 (1976).                                  
     ******************************************************************    
                                                                           
     N-21G* BASIS (USES 6D):                                               
                                                                           
     H,HE   1.1 (2P)                                                       
     LI-NE  0.8 (3D)                                                       
     NA-AR  (SEE N-31G)                                                    
                                                                           
     REFERENCE FOR H-NE: GAUSSIAN 80.                                      
     FOR NA-AR: W.J. PIETRO, M.M. FRANCL, W.J. HEHRE, D.J. DEFREES,        
     J.A. POPLE AND J.S. BINKLEY, JACS, 104, 5039 (1982).                  
     K-XE (MAIN GROUP ONLY): K.D. DOBBS AND W.J. HEHRE, J. COMP. CHEM.,    
     7, 359-378 (1986).                                                    
     NOTE THAT THE STANDARD N-21G* BASIS SET PUTS D-TYPE POLARIZATION      
     FUNCTIONS ONLY ON ATOMS PAST NE, AND THAT N-21G** IS NOT A            
     STANDARD BASIS SET.                                                   
     ******************************************************************    
                                                                           
     N-31G* AND N-31G** BASIS (USES 6D):                                   
                                                                           
     H,HE   1.1 (2P)                                                       
     LI     0.2 (3D)                                                       
     BE     0.4 (3D)                                                       
     B      0.6 (3D)                                                       
     C-NE   0.8 (3D)                                                       
     NA     0.175 (3D)                                                     
     MG     0.175 (3D)                                                     
     AL     0.325 (3D)                                                     
     SI     0.45  (3D)                                                     
     P      0.55  (3D)                                                     
     S      0.65  (3D)                                                     
     CL     0.75  (3D)                                                     
     AR     0.85  (3D)                                                     
                                                                           
     REFERENCE: FOR H-NE: P.C. HARIHARAN AND J.A. POPLE, TCA, 28, 213      
                (1973).                                                    
                FOR NA-AR: M.M. FRANCL, W.J. PIETRO, W.J. HEHRE,           
                J.S. BINKLEY, M.S. GORDON, D.J. DEFREES AND                
                J.A. POPLE, J. CHEM. PHYS., 77, 3654 (1982).               
     ******************************************************************    
                                                                           
     6-311G* AND 6-311G** BASIS:                                           
                                                                           
     H,HE   0.750 (2P)                                                     
     LI     0.200 (3D)                                                     
     BE     0.255 (3D)                                                     
     B      0.401 (3D)                                                     
     C      0.626 (3D)                                                     
1                                                                          
 71                            BASIS SETS                                  
                                                                           
                                                                           
                                                                           
     N      0.913 (3D)                                                     
     O      1.292 (3D)                                                     
     F      1.750 (3D)                                                     
     NE     2.304 (3D)                                                     
                                                                           
     REFERENCE: R. KRISHNAN, J.S. BINKLEY, R. SEEGER AND J.A. POPLE,       
     J. CHEM. PHYS., 72, 650 (1980).                                       
                                                                           
     ******************************************************************    
1                                                                          
                               BASIS SETS                                72
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     STANDARD DIFFUSE FUNCTION EXPONENTS.                                  
     ******************************************************************    
                                                                           
     N-21+G, N-21++G, 6-31+G, 6-31++G, 6-311+G AND 6-311++G BASES:         
                                                                           
     H      0.0360 (1S)                                                    
     LI     0.0074 (2SP)                                                   
     BE     0.0207 (2SP)                                                   
     B      0.0315 (2SP)                                                   
     C      0.0438 (2SP)                                                   
     N      0.0639 (2SP)                                                   
     O      0.0845 (2SP)                                                   
     F      0.1076 (2SP)                                                   
     NA     0.0076 (3SP)                                                   
     MG     0.0146 (3SP)                                                   
     AL     0.0318 (3SP)                                                   
     SI     0.0331 (3SP)                                                   
     P      0.0348 (3SP)                                                   
     S      0.0405 (3SP)                                                   
     CL     0.0483 (3SP)                                                   
     AR     0.0554 (3SP)  (NOTE: THIS IS AN EXTRAPOLATED VALUE)            
                                                                           
     REFERENCES:                                                           
     FOR H, LI-F: T. CLARK, J. CHANDRASEKHAR, G.W. SPITZNAGEL AND          
     P.V.R. SCHLEYER, J. COMP. CHEM., 4, 294-301 (1983).                   
     FOR NA-AR: G.W. SPITZNAGEL, T. CLARK, P.V.R. SCHLEYER AND             
     W.J. HEHRE, J. COMP. CHEM., 8, 1109-1116 (1987).                      
     FOR 6-311+(+)G BASIS: M.J. FRISCH, J.A. POPLE AND                     
     J.S. BINKLEY, J. CHEM. PHYS., 80, 3265-3269 (1984).                   
     ******************************************************************    
                                                                           
     4-31+G AND 4-31++G BASIS:                                             
                                                                           
     H      0.0360 (1S)                                                    
     LI     0.0120 (2SP)                                                   
     BE     0.0260 (2SP)                                                   
     B      0.0340 (2SP)                                                   
     C      0.0400 (2SP)                                                   
     N      0.0530 (2SP)                                                   
     O      0.0680 (2SP)                                                   
     F      0.0900 (2SP)                                                   
                                                                           
     REFERENCE:                                                            
     FOR H, LI-F: J. CHANDRASEKHAR, J.G. ANDRADE AND                       
     P.V.R. SCHLEYER, J.A.C.S., 103, 5609-5612 (1981).                     
     ******************************************************************    
1                                                                          
 73                            BASIS SETS                                  
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     GENERAL BASIS INPUT                                                   
     ******************************************************************    
                                                                           
     INPUT OF A GENERAL BASIS SET OF GAUSSIAN FUNCTIONS.                   
     BASIS SET MAY BE FORMED FROM INTERNAL SETS OF GAUSSIAN FUNCTIONS      
     OR FROM FUNCTIONS READ IN FROM CARDS.                                 
     EXAMPLE OF CARD INPUT:                                                
     STO-3G CALCULATION OF ETHANE                                          
     STANDARD EXPONENTS                                                    
     ATOMS 1 AND 2 ARE CARBONS, ATOMS 4 TO 9 ARE HYDROGENS                 
     ASSUME CARD COLUMNS ARE                                               
     123.....                                                              
 1   330330D0303030303030E                      (72A1)                     
 2    1 2                                       (30I2)                     
 3    STO 1S  5.67                              (A4,2A2,F12.6)             
 4    STO 2SP 1.72                                                         
 5   ****                                                                  
 6    4 5 6 7 8 9                                                          
 7    STO 1S  1.24                                                         
 8   ****                                                                  
 9   (BLANK CARD)                                                          
                                                                           
     CARD 1                                                                
     ENTRY MAY BE 0, 1 TO 9, A, D OR E                                     
     1 TO 9 AND A SIGNIFY THE NUMBER OF GAUSSIANS IN THAT SHELL            
     (A IS HEXADECIMAL FOR 10),                                            
     GROUPED ENTRIES SIGNIFY SHELLS BELONGING TO THE SAME ATOM             
     ATOMS ARE SEPARATED BY AN ENTRY OF ZERO                               
     D SIGNIFIES A DUMMY ATOM (WHICH MUST NOT HAVE BASIS FUNCTIONS)        
     E SIGNIFIES THE END OF THE ATOMS                                      
     REPEAT THIS CARD AS OFTEN AS REQUIRED TO SPECIFY ALL CENTERS          
     IN THE ABOVE EXAMPLE ...                                              
     330 MEANS THAT FIRST ATOM HAS 2 SHELLS EACH CONTAINING                
     3 GAUSSIANS                                                           
                                                                           
     CARDS 2 AND 6                                                         
     CENTERS TO WHICH THE FORTHCOMING BASIS FUNCTIONS APPLY                
     IE  BASIS FUNCTIONS SPECIFIED BY CARDS 3 AND 4 WILL BE CENTERED       
     ON ATOMS 1 AND 2 AND THOSE SPECIFIED BY CARD 7 WILL BE CENTERED       
     ON ATOMS 4 TO 9                                                       
     ATOM 3 IS A DUMMY ATOM                                                
                                                                           
     CARDS 3 AND 4  AND CARD 7                                             
     SPECIFICATION OF BASIS FUNCTIONS                                      
     ENTRIES AS FOLLOWS                                                    
     BASIS SET . SHELL LABEL/TYPE . SCALE FACTOR                           
                                                                           
     BASIS SET                                                             
     INTERNAL TYPES: ONE OF 'STO ' (OR ' STO'), '3-21', '4-21',            
     '421P', '4-31', '5-31', '6-21', '6-31', '6311', WHERE                 
     '421P' DENOTES THE PULAY 4-21G BASIS SET AND '6311' DENOTES           
     THE 6-311G BASIS SET.                                                 
     OR, IF THIS FIELD IS BLANK FUNCTION WILL BE READ FROM CARDS:          
     EXAMPLE OF THIS FEATURE                                               
     READ IN FUNCTION CONSISTING OF SINGLE GAUSSIAN FUNCTION WITH          
     EXPONENT 1.0 AND S AND P COEFFICIENTS OF 0.1 AND 0.2                  
     RESPECTIVELY                                                          
1                                                                          
                               BASIS SETS                                74
                                                                           
                                                                           
                                                                           
     THE COEFFICIENTS WILL BE AUTOMATICALLY NORMALIZED                     
          2SP 1.00                                     (A4,2A2,F12.6)      
     1.0                 0.1                 0.2       (3F20.10)           
     THE EXPONENTS AND CONTRACTION COEFFICIENTS FOR D AND F SHELLS ARE     
     READ IN (2F20.10) FORMAT (IE. LIKE S SHELLS).                         
     IN ALL CASES, THE NUMBER OF PRIMITIVE GAUSSIANS IN THIS SHELL WAS     
     SPECIFIED ON CARD 1. THE SHELLS FOR AN ATOM (OR SET OF ATOMS)         
     MUST BE SPECIFIED IN THE ORDER GIVEN ON CARD 1 FOR THAT ATOM.         
                                                                           
     SHELL LABEL/TYPE                                                      
     THIS FIELD IS SPLIT INTO 2 PARTS, EACH OF LENGTH 2 CHARACTERS:        
     THE FIRST 2 CHARACTERS ARE USED AS THE SHELL 'NUMBER' FOR THIS        
     ATOM IN THE PRINT ROUTINE, AND SHOULD BE RIGHT JUSTIFIED (EG          
     ' 2'). THE SECOND FIELD IS THE SHELL TYPE, AND MUST BE ONE OF         
     'S ', 'P ', 'SP', 'D ' OR 'F '.                                       
                                                                           
     FOR THE INTERNAL STO BASIS, THE LABEL/TYPE MUST BE ONE OF:            
     ' 1S ', ' 2S ', ' 2SP', ' 3S ', ' 3P ', ' 3SP', ' 3D ', ' 3S*',       
     ' 3D*', ' 4S ', ' 4P ', ' 4SP', ' 4S*', ' 4D*' OR ' 5SP'.             
     THE SPECIAL CODES '3S*' AND '3D*' REFER TO THE SP AND D PORTIONS      
     RESPECTIVELY OF THE S=P=D STO-NG BASIS SETS FOR THE ATOMS GA-KR.      
     THE 3SP PORTION OF THIS S=P=D FIT IS ALSO USED FOR THE ATOMS K        
     AND CA.                                                               
     THE SP PART WILL BE LABELED SP* (NOT S*) IN THE BASIS SET TABLE.      
     SIMILARLY THE CODES '4S*' AND '4D*' REFER TO THE SP AND D PORTIONS    
     RESPECTIVELY OF THE S=P=D STO-NG BASIS SETS FOR THE ATOMS IN-XE.      
     THE 4SP PORTION OF THIS S=P=D FIT IS ALSO USED FOR THE ATOMS RB       
     AND SR.                                                               
     THE MAXIMUM NUMBER OF GAUSSIANS PER SHELL IS 6.                       
                                                                           
     FOR THE INTERNAL EXTENDED BASES, THE LABEL/TYPE MUST BE ONE OF:       
     ' 1S ' TO ' 5S ', ' 2SP' TO ' 8SP', '10SP', ' 3P ', ' 4P ',           
     ' 4D ' TO ' 7D ', OR ' 9D '.                                          
     THE SHELL LABEL/TYPE IS USED TO FIND THE PROPER EXPONENTS AND         
     COEFFICIENTS BY THE FOLLOWING LABEL CONVENTIONS:                      
                                                                           
     FOR THE N-M1G BASIS SETS:                                             
     H-HE: '1S' IS THE INNER VALENCE ORBITAL, '2S' IS THE OUTER VALENCE    
     ORBITAL, '3P' IS A P-TYPE POLARIZATION FUNCTION, AND '4S'             
     IS AN S-TYPE DIFFUSE FUNCTION.                                        
     LI-NE: '1S' IS THE 1S CORE, '2SP' IS THE INNER VALENCE, '3SP' IS      
     THE OUTER VALENCE ORBITALS, '4D' IS A D-TYPE POLARIZATION             
     FUNCTION, AND '5SP' IS AN SP-TYPE DIFFUSE FUNCTION.                   
     NA-AR: '1S' IS THE 1S CORE, '2SP' IS THE 2S/2P CORE, '3SP' IS         
     THE INNER VALENCE, '4SP' IS THE OUTER VALENCE ORBITALS, '5D'          
     IS A D-TYPE POLARIZATION FUNCTION, AND '6SP' IS AN SP-TYPE            
     DIFFUSE FUNCTION.                                                     
     K-KR: '1S' IS THE 1S CORE, '2SP' IS THE 2S/2P CORE, '3SP' IS          
     THE 3S/3P CORE, '4D' IS THE 3D ORBITALS (NOT USED FOR K/CA),          
     '5SP' IS THE INNER VALENCE, '6SP' IS THE OUTER VALENCE ORBITALS,      
     '7D' IS A D-TYPE POLARIZATION FUNCTION, AND '8SP' IS AN               
     SP-TYPE DIFFUSE FUNCTION.                                             
     RB-XE: '1S' IS THE 1S CORE, '2SP' IS THE 2S/2P CORE, '3SP' IS         
     THE 3S/3P CORE, '4D' IS THE 3D CORE, '5SP' IS THE 4S/4P CORE,         
     '6D' IS THE 4D ORBITALS (NOT USED FOR RB/XE), '7SP' IS THE INNER      
     VALENCE, '8SP' IS THE OUTER VALENCE ORBITALS, '9D' IS A               
     D-TYPE POLARIZATION FUNCTION, AND '10SP' IS AN SP-TYPE DIFFUSE        
     FUNCTION.                                                             
1                                                                          
 75                            BASIS SETS                                  
                                                                           
                                                                           
                                                                           
     FOR THE N-M11G BASIS SETS:                                            
     H-HE: '1S', '2S' AND '3S' ARE THE INNER, MIDDLE AND OUTER VALENCE     
     ORBITALS, '4P' IS A P-TYPE POLARIZATION FUNCTION, AND '5S' IS         
     AN S-TYPE DIFFUSE FUNCTION.                                           
     LI-NE: '1S' IS THE 1S CORE, '2SP', '3SP' AND '4SP' ARE THE INNER,     
     MIDDLE AND OUTER VALENCE ORBITALS, '5D' IS A D-TYPE                   
     POLARIZATION FUNCTION, AND '6SP' IS AN SP-TYPE DIFFUSE FUNCTION.      
                                                                           
     NOTE: ALL CENTERS ON THE CENTERS CARD MUST HAVE THE SAME              
     ATOMIC NUMBER.                                                        
                                                                           
     CARDS 5 AND 8                                                         
     **** IN COLUMNS 1 TO 4 TELLS THE PROGRAM TO PROCEED ON TO THE         
     SPECIFICATION OF ANOTHER SET OF CENTERS                               
                                                                           
     CARD 9                                                                
     A BLANK CARD SIGNIFIES THE END OF THE BASIS SET INPUT                 
                                                                           
     NOTE: IF THE S=P CONSTRAINT IS LIFTED, THEN THE SHELL CAN             
     CONTAIN ONLY 1 TYPE OF AO (IE S OR P).                                
     THUS A COMPLETELY NON-CONSTRAINED BASIS SET WITH                      
     THE SAME NUMBER OF AO'S WILL HAVE ABOUT TWICE AS MANY SHELLS          
     AS THE CONSTRAINED ONE, AND THE ONE ELECTRON INTEGRAL ROUTINES        
     CANNOT USE THE INTEGRALS OVER THE S FUNCTIONS THAT ARE ASSUMED TO     
     BE IN EACH P SHELL. THE TWO ELECTRON INTEGRAL ROUTINES WILL           
     EVALUATE AND KEEP ANY 'FREE' S INTEGRALS IN P SHELLS SO               
     THE S COEFFICIENTS MUST BE ZERO IN UNCONSTRAINED P SHELLS.            
     NOTE ... A D/F SHELL MAY NEVER CONTAIN S OR P BASIS FUNCTIONS.        
1                                                                          
                                                                         76
                                                                           
                                                                           
                                                                           
 CHAPTER 6: INITIAL GUESS.                                                 
 **********                                                                
                                                                           
     LINK 0401                                                             
                                                                           
     ******************************************************************    
     INPUT TO SPECIFY THE DESIRED STATE FOR RHF OPEN SHELL RUNS.           
     ******************************************************************    
                                                                           
     AUTHORS: M.R. PETERSON AND R.A. POIRIER, UNIVERSITY OF TORONTO,       
              DEPARTMENT OF CHEMISTRY, TORONTO.                            
     VERSION: JUNE 1987.                                                   
                                                                           
     (1)  LEVEL GROUP VECTOR IGRP (72A1).                                  
     (2)  LEVEL DEGENERACY VECTOR IDGEN (72I1).                            
     (3)  LEVEL ALPHA SPIN OCCUPANCY VECTOR IAOCC (72I1).                  
     (4)  LEVEL BETA SPIN OCCUPANCY VECTOR IBOCC (72I1).                   
     (5)  LEVEL DOUBLE OCCUPANCY VECTOR IDOCC - IF NECESSARY (72I1).       
     (6)  COULOMB COUPLING COEFFICIENTS - IF NECESSARY.                    
          I1,J1, 12,J2, ...                  (36I2)                        
     (7)  EXCHANGE COUPLING COEFFICIENTS - IF NECESSARY.                   
          I1,J1, I2,J2, ...                  (36I2)                        
     NOTE: THE COULOMB AND EXCHANGE COUPLING COEFFICIENTS ARE READ AS      
           TWO INTEGERS: A NUMERATOR (I'S) AND A DENOMINATOR (J'S).        
           COEFFICIENTS = I1/J1, I2/J2, ... NOPEN(NOPEN+1)/2 VALUES.       
           UPPER TRIANGLE ONLY, BY COLUMNS, SEE EXAMPLES BELOW.            
           NOTE THAT THE DENOMINATOR MAY NOT BE 0.                         
     (8)  PAIR EXCITATION CODES IF NECESSARY - SEE BELOW.                  
                                                                           
     NOTE THAT NBASIS ENTRIES IN EACH VECTOR ARE ALWAYS READ AND           
     INTERPRETED, EVEN IF THE NBASIS ORBITALS CAN BE DEFINED WITH          
     FEWER ENTRIES DUE TO LEVEL DEGENERACIES. THUS BASES WITH MORE         
     THAN 72, BUT UP TO 144, AO WILL REQUIRE 2 CARDS FOR EACH VECTOR,      
     145 TO 216 AO WILL REQUIRE 3 CARDS PER VECTOR, ETC.                   
                                                                           
     IGRP, IDGEN, IAOCC, IBOCC AND IDOCC DEFINE THE MO LEVELS:             
                                                                           
     IGRP(I) IS THE GROUP CODE ('F', 'D', 'S', 'A', 'V' OR ' ')            
     FOR ALL MO OF THIS LEVEL.                                             
     GROUP 'F' CONTAINS THE FROZEN CORE ORBITALS, WHICH ARE ALWAYS         
     DOUBLY OCCUPIED.                                                      
     GROUP 'D' CONTAINS THE ORBITALS THAT ARE DOUBLY OCCUPIED IN THE       
     ROOT CONFIGURATION, BUT WILL BE INVOLVED IN PAIR EXCITATIONS TO       
     THE GROUP 'S', OR IN GVB PAIRS WHERE ONE MO IN THE PAIR MUST          
     COME FROM GROUP 'D' AND THE OTHER FROM GROUP 'S'.                     
     GROUP 'S' CONTAINS THE ORBITALS THAT ARE UNOCCUPIED IN THE ROOT       
     CONFIGURATION, BUT WILL BE THE RECIPIENTS OF PAIR EXCITATIONS         
     FROM GROUP 'D', OR THE OTHER HALF OF GVB PAIRS.                       
     GROUP 'A' CONTAINS ALL THE OPEN SHELL ORBITALS.                       
     GROUP 'V' OR ' ' CONTAINS ALL THE VIRTUAL ORBITALS.                   
                                                                           
     IDGEN(I) IS THE NUMBER OF MO (0-9) IN THIS LEVEL. A 0 VALUE IS        
     INTERPRETED AS A 1, PROVIDED THIS LEVEL BELONGS TO THE VIRTUAL        
     GROUP (GROUP 'V'). TO ENSURE THE CORRECT OCCUPATION NUMBERS,          
     DEGENERATE OPEN SHELL MO SHOULD ALWAYS BE DEFINED AS ONE LEVEL.       
                                                                           
1                                                                          
 77                          INITIAL GUESS                                 
                                                                           
                                                                           
                                                                           
     IAOCC(I) AND IBOCC(I) GIVE THE NUMBER OF ALPHA AND BETA SPIN          
     ELECTRONS CONTAINED IN THIS LEVEL. IF BOTH ARE LEFT BLANK (OR         
     ZERO), THE FOLLOWING DEFAULTS ARE ASSUMED: FOR GROUPS 'F' AND 'D',    
     IAOCC(I) AND IBOCC(I) ARE SET TO IDGEN(I); FOR GROUP 'S', IAOCC(I)    
     AND IBOCC(I) ARE SET TO ZERO; FOR GROUP 'A', IAOCC(I) IS SET TO       
     IDGEN(I) AND IBOCC(I) IS SET TO ZERO; FOR GROUP 'V' (OR               
     GROUP ' '), IAOCC(I) AND IBOCC(I) ARE SET TO ZERO.                    
     IT IS PERMISSIBLE NOT TO FILL GROUP 'A' WITH EITHER ALPHA             
     OR BETA SPIN ELECTRONS, LEADING TO FRACTIONAL OCCUPANCIES -           
     FOR EXAMPLE, A GROUP COULD CONTAIN 3 MO BUT ONLY 1 (OR 2) ALPHA       
     SPIN ELECTRONS. FOR PARTIALLY OCCUPIED LEVELS, THE DESCRIPTION        
     OF THE LEVEL IN TERMS OF THE NUMBER OF DOUBLY OCCUPIED MO,            
     ALPHA SPIN MO, BETA SPIN MO AND EMPTY MO MAY NOT BE UNIQUE BASED      
     ONLY ON IDGEN(I), IAOCC(I) AND IBOCC(I). FOR EXAMPLE, IN THE CASE     
     OF 2 ALPHA SPIN ELECTRONS PLUS 1 BETA SPIN ELECTRON IN A TRIPLY       
     DEGENERATE LEVEL, THE FOLLOWING 2 CONFIGURATIONS ARE POSSIBLE:        
        A   A    B   AND   AB  A                                           
        --  --  --         --  --  --                                      
     THIS ROUTINE WILL ALWAYS GENERATE THE STATE WHICH HAS THE             
     HIGHEST ANGULAR MOMENTUM (FEWEST DOUBLY OCCUPIED ORBITALS IN          
     THE LEVEL) - THIS WOULD BE THE STATE ON THE LEFT ABOVE. THE           
     IDOCC VECTOR (SEE BELOW) MAY BE USED (BY SETTING IOP(14) TO 1 OR      
     3) TO SPECIFY THE NUMBER OF DOUBLY OCCUPIED MO IN THE LEVEL,          
     AND THUS GENERATE THE STATE ON THE RIGHT ABOVE.                       
     GENERALLY, MOLECULAR ORBITALS DECLARED AS DEGENERATE ARE NOT IN       
     FACT REQUIRED TO BE DEGENERATE - IT IS MERELY A CONVENIENT WAY OF     
     COLLECTING ADJACENT MO BELONGING TO THE SAME GROUP TOGETHER.          
     THIS IS ALWAYS TRUE FOR GROUPS 'F', 'D', 'S' AND 'V' (OR ' ').        
     HOWEVER, IF ANY OF THE 'A' LEVELS IS PARTIALLY OCCUPIED               
     (FRACTIONAL OCCUPANCY), THE DECLARED DEGENERACIES ARE VERY            
     IMPORTANT, BUT ONLY FOR THE 'A' LEVELS.                               
     IN THIS REGARD, THE CASES BELOW ARE VERY DIFFERENT:                   
                  B                                                        
                  -                                                        
                                                                           
                  A                             A  A  B                    
                  -                             -  -  -                    
                                                                           
                  A                                                        
                  -                                                        
     SINCE THE CASE ON THE LEFT WILL ENFORCE THE SPECIFIED                 
     OCCUPANCY ON EACH OPEN SHELL MO (TWO WILL BE OCCUPIED WITH A          
     SINGLE ALPHA SPIN ELECTRON, ONE WILL BE OCCUPIED WITH A SINGLE        
     BETA SPIN ELECTRON), WHILE THE RIGHT HAND CASE WILL AVERAGE           
     TWO SINGLE ALPHA SPIN ELECTRONS PLUS ONE BETA SPIN ELECTRON           
     OVER THE THREE MOLECULAR ORBITALS.                                    
     IN ADDITION, FOR THE FOLLOWING OCCUPATION SCHEME                      
                  A                                                        
                  -  -                                                     
                                                                           
                  A                                                        
                  -  -                                                     
     THE PROGRAM WILL AVERAGE THE FOLLOWING POSSIBLE CONFIGURATIONS        
     TO DETERMINE THE COUPLING CONSTANTS:                                  
                  A            A      A            A                       
                  -  -      -  -      -  -      -  -                       
                                                                           
1                                                                          
                             INITIAL GUESS                               78
                                                                           
                                                                           
                                                                           
                  A         A            A         A                       
                  -  -      -  -      -  -      -  -                       
     WHICH EFFECTIVELY RESULTS IN THE OCCUPATION OF EACH MO OF EACH        
     LEVEL BY HALF AN ELECTRON ON AVERAGE. THE SAME AVERAGING WILL         
     BE APPLIED TO ALL CASES WHERE THERE ARE DEGENERATE LEVELS.            
                                                                           
     IDOCC(I), READ ONLY IF IOP(14) IS SET TO 1 OR 3 WITH THE *IOP         
     INPUT COMMAND (SEE LINK 0100), ALLOWS THE USER TO SPECIFY THE         
     NUMBER OF DOUBLY OCCUPIED MO IN AN 'A' LEVEL. THE                     
     VALUE OF IDOCC(I) MUST BE LESS THAN OR EQUAL TO THE SMALLER OF        
     IAOCC(I) AND IBOCC(I). NORMALLY, THE ROUTINE SELECTS THE              
     OCCUPATION SCHEME WITH THE FEWEST NUMBER OF DOUBLY OCCUPIED           
     ORBITALS IN AN OPEN SHELL LEVEL. IDOCC(I) MUST BE ZERO FOR            
     GROUPS 'F', 'D', 'S' AND 'V' (OR ' ').                                
                                                                           
     DATA INPUT REQUIRED FOR IOP(14) = 2 OR 3.                             
                                                                           
     THE ADDITIONAL INPUT CONSISTS OF THE COUPLING COEFFICIENTS.           
                                                                           
     FFFFAAVA          OR             FA A                                 
     11111111                         4211                                 
     11111101                         4201                                 
     11110000                         4000                                 
      0 2 1 2 0 2 1 2 1 2 0 2          0 2 1 2 0 2 1 2 1 2 0 2             
      0 2 1 2 0 2 1 2 1 2 0 2          0 2 1 2 0 2 1 2 1 2 0 2             
                                                                           
     NOTE: THESE COUPLING CONSTANTS ARE THE SAME AS THE INTERNALLY         
     GENERATED CONSTANTS FOR THIS STATE.                                   
     THE RIGHT COLUMN ABOVE GIVES THE SAME RESULT, BUT USES THE            
     DEGENERACY CARD TO FULL ADVANTAGE.                                    
                                                                           
     DETERMINATION OF THE COUPLING COEFFICIENTS A(I,J) AND B(I,J).         
                                                                           
     THEY ARE DERIVED FROM E.R. DAVIDSON, CHEM. PHYS. LETTS., 21,          
     565 (1973), AND MANY EXAMPLES ARE GIVEN IN                            
     R. CARBO AND J.M. RIERA, LECTURE NOTES IN CHEMISTRY - A               
     GENERAL SCF THEORY, (SPRINGER-VERLAG, N.Y., 1978).                    
     NOTE THAT SOME OF THE EXAMPLES IN THE LATTER REFERENCE ARE            
     EITHER IN ERROR, OR INVOLVE PARTICULAR CONFIGURATIONS THAT            
     SHOULD PROBABLY BE AVERAGED TOGETHER TO PRODUCE THE CORRECT           
     COUPLING COEFFICIENTS. IN PARTICULAR, THE COUPLING CONSTANTS          
     FOR THE 5 ELECTRONS IN A TRIPLY DEGENERATE LEVEL (E.G. F ATOM),       
     ARE INCORRECT (THIS ROUTINE USES THE CORRECT VALUES).                 
                                                                           
     EXAMPLES                                                              
     (1) DOUBLY DEGENERATE STATES                                          
     SINGLET                                                               
     ...FA                                                                 
     ...12                                                                 
     ...11                                                                 
     ...11                                                                 
      0 1 1 2 0 1                                                          
      0 1-1 2 0 1                                                          
                                                                           
     (2) TRIPLY DEGENERATE STATES                                          
     TRIPLET                                                               
     ...FA                                                                 
     ...13                                                                 
1                                                                          
 79                          INITIAL GUESS                                 
                                                                           
                                                                           
                                                                           
     ...12                                                                 
     ...10                                                                 
      0 1 1 6 0 1 1 6 1 6 0 1                                              
      0 1 1 6 0 1 1 6 1 6 0 1                                              
                                                                           
     NOTE: THESE COUPLING CONSTANTS ARE THE SAME AS THE INTERNALLY         
     GENERATED CONSTANTS FOR THESE STATES.                                 
                                                                           
     PAIR EXCITATION CODE INPUT.                                           
                                                                           
     THE FIRST CARD CONTAINS THE MC-SCF CODE AND THE NUMBER OF             
     CONFIGURATIONS TO BE READ FROM CARDS:                                 
     CODE, NCONF (A4, I4 FORMAT)                                           
     WHERE CODE IS ONE OF 'PAIR', 'INDP', 'COMP' OR 'GVB '.                
                                                                           
     'PAIR': PAIR-WISE EXCITATIONS MC-SCF. NCONF CONFIGURATIONS ARE        
     READ IN AS DESCRIBED BELOW.                                           
                                                                           
     'INDP': PAIR-WISE EXCITATIONS MC-SCF. THE FIRST GROUP D               
     ORBITAL IS PAIRED WITH THE FIRST GROUP S ORBITAL, THE SECOND D        
     ORBITAL WITH THE SECOND S ORBITAL, ETC. NCONF MUST BE 0.              
                                                                           
     'COMP': COMPLETE PAIR-WISE EXCITATIONS MC-SCF. ALL POSSIBLE           
     EXCITATIONS FROM THE D ORBITALS TO THE S ORBITALS ARE INCLUDED.       
     NCONF MUST BE 0.                                                      
                                                                           
     'GVB ': GENERALIZED VALENCE BOND. IF NCONF IS 0, THE VALENCE          
     BOND PAIRS ARE TAKEN AS THE FIRST D ORBITAL WITH THE FIRST S          
     ORBITAL, THE SECOND D ORBITAL WITH THE SECOND S ORBITAL, ETC.         
     IF NCONF IS NON-ZERO, NCONF VALENCE BOND PAIRS ARE READ IN AS         
     DESCRIBED BELOW.                                                      
                                                                           
     THE NEXT CARD(S) CONTAIN NCONF CONFIGURATIONS (IF NCONF > 0) IN       
     THE FORM (IN FREE FORMAT)                                             
     L - U, L - U, L - U, ...                                              
     WHERE L IS THE ORBITAL NUMBER EXCITED FROM, AND U IS THE ORBITAL      
     NUMBER EXCITED TO. L AND U MUST BELONG TO THE D AND S ORBITAL         
     GROUPS RESPECTIVELY, AND REFER TO THE MO NUMBERS BEFORE THE           
     MO ARE SORTED BY GROUPS. THE D-U ENTRIES ARE SEPARATED BY A           
     COMMA. FOR EXAMPLE:                                                   
     INDP   3                                                              
     8-11, 9 - 13 , 10 -   12                                              
     IF THE LIST OF PAIR EXCITATIONS DOES NOT FIT ON ONE CARD, STOP        
     THE CARD AFTER A COMMA AND CONTINUE ONTO THE NEXT CARD(S).            
                                                                           
     NOTE: THE MAXIMUM NUMBER OF CONFIGURATIONS / GVB PAIRS IS #NC,        
     INCLUDING THE ROOT CONFIGURATION FOR ALL BUT GVB RUNS.                
                                                                           
     ****************                                                      
     IMPORTANT NOTES.                                                      
     ****************                                                      
                                                                           
     1) RESULTS CALCULATED FROM MO COEFFICIENTS (SPECIFICALLY LMO AND      
     OEP) WILL BE INCORRECT IN GENERAL, UNLESS EACH OPEN SHELL MO          
     CONTAINS ONLY ONE ALPHA SPIN ELECTRON, AND THERE ARE NO GROUP 'D'     
     OR 'S' ORBITALS.  ONE-ELECTRON PROPERTIES CALCULATED FROM THE         
     DENSITY (THE DEFAULT FOR RHF RUNS NOT REQUESTING INTEGRALS OVER       
     MO) ARE CORRECT FOR ALL CASES.                                        
1                                                                          
                             INITIAL GUESS                               80
                                                                           
                                                                           
                                                                           
     2) FOR ALL INITIAL GUESS TYPES EXCEPT GUESS=NONE, THE                 
     EIGENVALUES AND MC-SCF COEFFICIENTS IN THE DISK FILE WILL BE          
     DESTROYED, EVEN FOR CHECK RUNS. FOR GUESS=NONE RUNS,                  
     THE EIGENVALUES AND MC-SCF COEFFICIENTS ARE SAVED.                    
                                                                           
     3) FOR ALL NON-CHECK RUNS, THE ORDER OF THE MO VECTORS ON DISK        
     IS ALTERED TO CONSOLIDATE THE MO BY GROUPS.                           
                                                                           
     4) FOR GU=N RUNS, THE OPEN SHELL CONFIGURATION, AND THE LIST OF       
     CONFIGURATIONS FOR MC-SCF/GVB, ARE RECOVERED FROM DISK, AND           
     THEREFORE NO RHF INPUT DATA IS REQUIRED, AND NONE SHOULD BE           
     GIVEN. THE VALUE OF IOP(14) WILL BE IGNORED.                          
                                                                           
     5) FOR OPEN SHELL SINGLET CALCULATIONS, THE STATE SYMMETRY            
     MUST BE DIFFERENT FROM THAT OF THE GROUND STATE. THIS GENERALLY       
     REQUIRES THE OPEN SHELL MO TO BELONG TO DIFFERENT IRREDUCIBLE         
     REPRESENTATIONS OF THE POINT GROUP (E.G. A' AND A" IN CS),            
     AND THAT THE MOLECULE MUST HAVE SOME SYMMETRY. THUS, OPEN SHELL       
     SINGLET CALCULATIONS ON ASYMMETRIC MOLECULES ARE NOT VALID.           
                                                                           
1                                                                          
 81                          INITIAL GUESS                                 
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     OPTIONS ... IOP()     FOR LINK 0401                                   
     ******************************************************************    
     IOP(13) ... TYPE OF INITIAL GUESS.                                    
     0  EXTENDED HUCKEL GUESS (USE ONLY FOR INTERNAL STO-NG BASES).        
     1  PROJECTED HUCKEL GUESS.                                            
     2  DIAGONALIZE THE CORE HAMILTONIAN.                                  
     3  READ THE DENSITY MATRIX - THIS SETS IOP(26)=1.                     
     4  READ THE COEFFICIENT MATRIX - THIS SETS IOP(25)=1.                 
     5  NONE - USE C FROM DISK.                                            
     6  DIAGONALIZE SCALED HAMILTONIAN.                                    
     7  PMO RESTART - THIS SETS IOP'S 22, 23, 25 AND 27 TO 1.              
                                                                           
     IOP(14) ... READ EXTRA CONFIGURATION DATA.                            
     0  NO.                                                                
     1  READ IDOCC(I) VECTOR.                                              
     2  READ COULOMB/EXCHANGE COUPLING CONSTANTS.                          
     3  BOTH 1 AND 2.                                                      
                                                                           
     IOP(15) TO IOP(60) ... NOT USED - SEE LINK 0402.                      
     ******************************************************************    
1                                                                          
                             INITIAL GUESS                               82
                                                                           
                                                                           
                                                                           
 INITIAL COEFFICIENT/DENSITY MATRIX GUESS.                                 
 *****************************************                                 
                                                                           
     LINK 0402                                                             
                                                                           
     --------------                                                        
     U OF T VERSION                                                        
     APRIL 1987                                                            
     --------------                                                        
                                                                           
     THIS IS A PROGRAM WHICH PRODUCES AN INITIAL GUESS TO THE              
     SOLUTION OF THE SCF EQUATIONS. THIS GUESS IS IN THE FORM OF           
     MOLECULAR ORBITAL COEFFICIENTS AND/OR DENSITY MATRICES WHICH ARE      
     STORED ON THE APPROPRIATE READ-WRITE FILES.                           
     CURRENTLY THE CLOSED SHELL AND UHF OPEN SHELL SCF ROUTINES            
     REQUIRE DENSITY MATRICES, WHILE THE RHF OPEN SHELL ROUTINE            
     REQUIRES COEFFICIENTS.                                                
                                                                           
     THERE ARE SEVERAL WAYS IN WHICH THIS GUESS MAY BE PRODUCED.           
     ONE EASY WAY IS TO DIAGONALIZE THE CORE HAMILTONIAN. IN GENERAL,      
     THIS IS NOT A VERY GOOD GUESS, BUT IT IS APPLICABLE TO ANY BASIS      
     SET, AND IS AVAILABLE AS AN OPTION.                                   
                                                                           
     ANOTHER TYPE OF GUESS IS CALLED THE HUCKEL GUESS, WHICH IS            
     MODELED AFTER EXTENDED HUCKEL MO THEORY. ESSENTIALLY, THE             
     INITIAL GUESS IS FORMED FROM INTERNALLY STORED CONSTANTS (FOR         
     MORE DETAILS SEE SUBROUTINE HUCKEL). THESE CONSTANTS WERE             
     DETERMINED FROM STUDIES ON INTERNAL MINIMAL                           
     BASIS SETS (STO-NG(*)), SO THE USE OF THIS                            
     TYPE OF GUESS WITH BASES OTHER THAN THESE IS NOT RECOMMENDED.         
                                                                           
     THIS HUCKEL GUESS CAN BE APPLIED TO OTHER BASES IN THE                
     FOLLOWING WAY:  THE GUESS MO COEFFICIENTS ARE FORMED FROM             
     INTERNAL DATA AS IF THERE WERE A BASIS P ON THE MOLECULE, WHERE       
     P WOULD BE STO-NG. THE DEFAULT IS P = STO-3G.                         
     THE GUESS MO VECTORS IN THE DESIRED BASIS ARE THEN FORMED             
     BY CHOOSING THE VECTORS WHICH GIVE THE BEST (LEAST-SQUARES)           
     FIT TO THOSE DESCRIBED IN THE BASIS P. SINCE THIS WILL                
     USUALLY PRODUCE FEWER THAN NBASIS VECTORS, THE MO COEFFICIENT         
     MATRIX IS COMPLETED WITH ORTHONORMAL VECTORS OF THE PROPER            
     SYMMETRY. THE FULL MATRIX IS ACTUALLY ONLY REQUIRED FOR               
     THE RHF SCF ROUTINE USED IN MONSTERGAUSS. THIS PROCEDURE              
     IS CALLED A PROJECTED HUCKEL GUESS, AND IS APPLICABLE TO ANY          
     BASIS SET.                                                            
                                                                           
     A STILL BETTER TYPE OF GUESS, USUALLY, IS TO READ THE                 
     COEFFICIENT OR DENSITY MATRIX FROM CARDS. IF THE MATRIX READ IN       
     IS FOR A BASIS OTHER THAN THE ONE USED IN THE CURRENT RUN, THE        
     MATRIX CAN BE PROJECTED (BY A LEAST-SQUARES FIT) ONTO THE DESIRED     
     BASIS. THE PROJECTED MO VECTORS ARE ORTHONORMALIZED (AS THEY ARE      
     FOR A PROJECTED HUCKEL GUESS), OR THE PROJECTED DENSITY MATRIX        
     MAY BE MADE IDEMPOTENT.                                               
                                                                           
     THE OPTIONS WHICH DETERMINE THE INITIAL GUESS PROCEDURE               
     TO BE USED ARE DESCRIBED BELOW.                                       
                                                                           
     PARTS OF THIS LINK ARE LOOSELY BASED ON GAUSSIAN 80.                  
                                                                           
1                                                                          
 83                          INITIAL GUESS                                 
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     OPTIONS ... IOP()     FOR LINK 0402                                   
     ******************************************************************    
     IOP(13) ... TYPE OF INITIAL GUESS.                                    
     0  EXTENDED HUCKEL GUESS (USE ONLY FOR INTERNAL STO-NG BASES).        
     1  PROJECTED HUCKEL GUESS.                                            
     2  DIAGONALIZE THE CORE HAMILTONIAN.                                  
     3  READ THE DENSITY MATRIX - THIS SETS IOP(26)=1.                     
     4  READ THE COEFFICIENT MATRIX - THIS SETS IOP(25)=1.                 
     5  NONE - USE C FROM DISK.                                            
     6  DIAGONALIZE SCALED HAMILTONIAN.                                    
     7  PMO RESTART - THIS SETS IOP'S 22, 23, 25 AND 27 TO 1.              
                                                                           
     IOP(14) ... SEE LINK 0401.                                            
                                                                           
     IOP(15) ... BLOCKING OF OVERLAP MATRIX FOR HUCKEL-TYPE GUESSES.       
     0  BLOCK THE OVERLAP MATRIX. USE THIS OPTION TO REPRODUCE A RUN       
     FROM GAUSSIAN 70. IF IOP(13)=1, THE BASIS SET TO BE PROJECTED         
     (STO-NG) WILL BE BLOCKED. THE DIAGONAL ELEMENTS OF THE                
     HUCKEL MATRIX ARE SCANNED TO REMOVE ACCIDENTAL DEGENERACIES.          
     1  AS FOR IOP(15)=0, BUT THE DIAGONAL ELEMENTS OF THE HUCKEL          
     MATRIX ARE NOT SCANNED.                                               
     2  DO NOT BLOCK.                                                      
                                                                           
     IOP(16) ... PROJECTION OF DENSITY OR COEFFICIENTS.                    
     0  NO.                                                                
     1  PROJECT THE DENSITY OR COEFFICIENT MATRIX                          
     ONTO THE CURRENT BASIS (FOR IOP(13) = 1, 3, 4 OR 5).                  
     NOTE: FOR THIS OPTION TO WORK SUCCESSFULLY, THE BASIS SET             
     PROJECTED FROM MUST HAVE BEEN SET UP IN LINK 0301 - SEE IOP(20) OF    
     THAT LINK, AND GUESS=S (OR =V OR =G) ON THE *MOL CARD.                
     THE COEFFICIENTS TO BE PROJECTED MAY EITHER BE READ IN (ASSUMED       
     FOR GU=S/V/G), OR ALREADY ON DISK IN FILE 'IMAT' (TO USE              
     THIS OPTION, SPECIFY GU=S/V/G THEN SET OPTION 13 OF LINK 0402         
     TO 5 WITH THE FOLLOWING *IOP CARD:                                    
        3  13   5  SET GU=N IN LINK 0402 FOR PROJECTION FROM DISK          
     SEE LINK 0100A FOR DETAILS ON THE *IOP FEATURE).                      
     THE DENSITY TO BE PROJECTED GENERALLY COMES FROM CARDS.               
     TO PROJECT THE DENSITY ALREADY ON DISK, SET IOP(20) IN LINK 0301      
     APPROPRIATELY, GU=N, IOP(16)=1 AND IOP(26)=0 FROM THIS LINK.          
                                                                           
     IOP(17) ... SCALE FACTOR K/2 FOR OFF-DIAGONAL ELEMENTS.               
     0  USE DEFAULT VALUES OF 0.875 FOR MINIMAL (STO-NG) BASES             
     FOR EXTENDED HUCKEL GUESS (IOP(13)=0) AND DEFAULT VALUES              
     FOR SCALED HAMILTONIAN GUESS (IOP(13)=6).                             
     N  SCALE = 0.4375*N FOR HUCKEL.                                       
        SCALE = SCALE+0.1*N FOR SCALED HAMILTONIAN (SEE IOP(34)).          
                                                                           
     IOP(18) ... ALTERATION OF CONFIGURATION.                              
     0  NO.                                                                
     1  READ IN (72I1) NBASIS VALUES FOR THE OCCUPATION LEVEL              
     OF EACH MO. NORMALLY ONLY VALUES OF 0 AND 1 ARE USED, TO INDICATE     
     EMPTY AND OCCUPIED MO. LARGER INTEGERS MAY BE USED TO PARTIALLY       
     OCCUPY AN MO (OCCUPANCY=1/N). NOTE THAT IF THIS IS AN OPEN SHELL      
     RUN, GUESS WILL EXPECT TWO SETS OF DATA, ONE FOR THE ALPHA SPIN       
     ORBITALS, AND THE SECOND FOR THE BETA SPIN ORBITALS. THESE CARDS      
     FOLLOW ANY MATRICES TO BE READ (SEE IOP'S 22-28).                     
     THIS OPTION CAN NOT BE USED FOR RHF / MC-SCF RUNS.                    
1                                                                          
                             INITIAL GUESS                               84
                                                                           
                                                                           
                                                                           
     IOP(19) ... ADJUSTMENT OF FRACTIONAL OCCUPANCY.                       
     0  NO.                                                                
     1  ADJUST THE FRACTIONAL OCCUPANCY OF DEGENERATE MO'S FOR EQUAL       
     OCCUPANCY (ONLY IF IOP(18)=0). THIS OPTION WAS THE DEFAULT            
     MODE OF OPERATION IN GAUSSIAN 70, BUT IS SELDOM REQUIRED.             
                                                                           
     IOP(20) ... PRINTING OF GUESS COEFFICIENT/DENSITY MATRIX.             
     0  NO.                                                                
     1  PRINT C.                                                           
     2  PRINT C AND D.                                                     
     3  PRINT D.                                                           
                                                                           
     IOP(21) ... PRINT SCALED HAMILTONIAN (FOCK MATRIX)                    
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(22) ... INPUT OF THE S MATRIX.                                    
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(23) ... INPUT OF THE H MATRIX.                                    
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(24) ... INPUT OF THE DIPOLE MOMENT INTEGRALS.                     
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(25) ... INPUT OF THE COEFFICIENTS AND ORBITAL ENERGIES.           
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(26) ... INPUT OF THE DENSITY MATRIX.                              
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(27) ... INPUT OF THE FOCK MATRIX.                                 
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(28) ... INPUT OF THE LMO COEFFICIENTS.                            
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(29) ... UNIT NUMBER FOR MATRIX DATA INPUT (IOP'S 22-28, 35).      
     0  READ FROM THE INPUT STREAM (UNIT IN FROM COMMON /IO/).             
     N  READ THE MATRICES FROM UNIT N.                                     
                                                                           
     IOP(30) ... MAXIMUM NUMBER OF ITERATIONS TO MAKE D IDEMPOTENT.        
     0  DO NOT MAKE DENSITY IDEMPOTENT.                                    
     N  25*N ITERATIONS.                                                   
                                                                           
     IOP(31) ... POLARIZATION FUNCTIONS ADDED TO INTERNAL BASIS SETS.      
     0  NONE (THIS IS FORCED FOR PROJECTED HUCKEL GUESSES).                
     1  D ORBITALS ON NA-AR.                                               
     2  D ORBITALS ON LI-NE (FOR N-M1G/N-M11G BASES).                      
     3  COMBINATION OF 1 AND 2.                                            
     4  P ORBITALS ON H/HE (FOR N-M1G/N-M11G BASES).                       
1                                                                          
 85                          INITIAL GUESS                                 
                                                                           
                                                                           
                                                                           
     5  COMBINATION OF 1 AND 4.                                            
     6  COMBINATION OF 2 AND 4.                                            
     7  COMBINATION OF 1, 2 AND 4.                                         
     THIS IOP APPLIES ONLY TO EXTENDED HUCKEL GUESSES. SINCE ONLY          
     STO-NG(*) BASES MAY USE THE EXTENDED HUCKEL GUESS, THE ONLY           
     VALUES OF IOP(31) CURRENTLY SUPPORTED ARE 0 AND 1.                    
                                                                           
     IOP(32) ... PERFORM INITIAL GUESS ON CHECK RUNS.                      
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(33) ... READ REPLACEMENT EXTENDED HUCKEL MATRIX ELEMENTS.         
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(34) ... FOR SCALED HAMILTONIAN GUESS (ONLY IF IOP(17).NE.0).      
     0  USE  N (INCREASE SCALE FACTOR).                                    
     1  USE -N (DECREASE SCALE FACTOR).                                    
                                                                           
     IOP(35) ... INPUT OF THE LMO 'T' MATRIX.                              
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(36) TO IOP(60) ... NOT USED.                                      
     ******************************************************************    
                                                                           
     FOR A PROJECTED INITIAL GUESS, NO MATRICES SHOULD BE READ, EXCEPT     
     THE DENSITY OR COEFFICIENTS FOR BASIS SET P WHEN P IS PROJECTED       
     ONTO THE CURRENT BASIS (IOP(13) IS 3 OR 4 AND IOP(16)=1).             
                                                                           
     NOTE THAT THE INPUT MATRICES MUST BE IN THE ORDER GIVEN ABOVE,        
     NAMELY, S, H, XYZ, C, D, F AND L. FOR C, D, F AND L, THERE MUST       
     BE 2 MATRICES (ONE ALPHA, ONE BETA) FOR UHF OPEN SHELL RUNS.          
     FOR RHF OPEN SHELL RUNS, THERE ARE TWO D AND L MATRICES (ONE          
     ALPHA, ONE BETA) AND ONE C AND F MATRIX.                              
     THE ONLY F MATRIX READ FOR RHF RUNS IS FOR THE CLOSED SHELL GROUP.    
     DETAILS MAY BE FOUND IN ROUTINE READER.                               
                                                                           
     FOR RHF OPEN SHELL RUNS, THE CONTROL CARDS SPECIFYING THE             
     OCCUPANCY AND GROUPS PRECEED ANY MATRICES READ. SEE ROUTINE RHFIN     
     FOR DETAILS (LINK 0401).                                              
1                                                                          
                                                                         86
                                                                           
                                                                           
                                                                           
 CHAPTER 7: SCF OPTIONS.                                                   
 **********                                                                
                                                                           
     LINK 0501                                                             
                                                                           
     --------------                                                        
     U OF T VERSION                                                        
     JULY 1987                                                             
     --------------                                                        
                                                                           
     SOLUTION OF THE ROOTHAAN EQUATIONS FOR A CLOSED SHELL SYSTEM          
     REV. MOD. PHYS. 23, 69 (1951).                                        
                                                                           
     ******************************************************************    
     OPTIONS ... IOP( )                                                    
     ******************************************************************    
     IOP(13) ... CONVERGENCE ON THE DENSITY MATRIX.                        
     N  10**(-(5+N)).                                                      
     NOTE: THE DENSITY CONVERGENCE FOR CLOSED SHELL OR UHF SCF IS          
     NORMALLY SET TO 10**(-9) (IOP(13)=4), AND SET TO 10**(-6)             
     (IOP(13)=1) FOR RHF OPEN SHELL SCF, TO ENSURE THAT THE SCF            
     WAVEFUNCTION IS SUITABLE FOR FIRST AND SECOND DERIVATIVE              
     AND/OR CI CALCULATIONS, ESPECIALLY ON LARGE SYSTEMS OR WITH           
     LARGE BASIS SETS.                                                     
                                                                           
     IOP(14) ... MAXIMUM NUMBER OF CYCLES.                                 
     N  30+20*(N+1) CYCLES                                                 
                                                                           
     IOP(15) ... PRINTING OF COEFFICIENT MATRIX (LINKS 0501-0503).         
     0  NO PRINTING                                                        
     1  PRINT EACH CYCLE.                                                  
                                                                           
     IOP(16) ... PRINTING OF DENSITY MATRIX (LINKS 0501-0503).             
     0  NO PRINTING                                                        
     1  PRINT EACH CYCLE.                                                  
                                                                           
     IOP(17) ... SCF EXTRAPOLATION TECHNIQUE TO AID CONVERGENCE.           
     0  USE POPLE 3- AND 4-POINT EXTRAPOLATION.                            
     1  USE DEWAR EXTRAPOLATION.                                           
     2  NOT USED.                                                          
     3  NO EXTRAPOLATION.                                                  
                                                                           
     IOP(18) ... 3-PT. EXTRAPOLATION FOR POPLE EXTRAPOLATION METHOD.       
     0  USE                                                                
     1  DO NOT USE                                                         
                                                                           
     IOP(19) ... FOCK MATRIX SAVED ON DISK.                                
     0  NO                                                                 
     1  YES                                                                
                                                                           
     IOP(20) ... TOLERANCE IN DEWAR EXTRAPOLATION.                         
     N  DO NOT EXTRAPOLATE IF THE DIFFERENCE BETWEEN SUCCESSIVE            
     'LAMBDA' VALUES IS LARGER THAN 0.06*(N+1).                            
     IF N=7, EXTRAPOLATE EVERY THIRD ITERATION REGARDLESS.                 
                                                                           
     IOP(21) ... PRINT CONTROL (EXCEPT FOR ED/BSSE RUNS).                  
     0  NORMAL PRINTING.                                                   
     1  NO PRINTING.                                                       
1                                                                          
 87                           SCF OPTIONS                                  
                                                                           
                                                                           
                                                                           
     IOP(22) ... TERMINATION OF THE RUN FOR A NON-CONVERGED SCF.           
     0  YES.                                                               
     N  NO, PROVIDED THE LAST CHANGE IN ENERGY IS NOT LARGER THAN          
     10**(-8+N).                                                           
                                                                           
     IOP(23) TO IOP(30) ... USED IN GENERAL SCF ONLY (LINK 0503).          
                                                                           
     IOP(31) ... DEBUG PRINTING (LINKS 0501-0503).                         
     0   NO.                                                               
     N   PRINT ALL DEBUG OUPUT FROM LEVEL 1 TO LEVEL N INCLUSIVE.          
                                                                           
     IOP(32) ... DEBUG PRINTING FOR ED/BSSE (LINKS 0505-0507).             
     0   NO.                                                               
     N   PRINT ALL DEBUG OUPUT FROM LEVEL 1 TO LEVEL N INCLUSIVE.          
                                                                           
     IOP(33) ... PRINTING OF COEFFICIENT MATRIX (LINKS 0505-0507).         
     0  NO PRINTING                                                        
     1  PRINT EACH CYCLE.                                                  
                                                                           
     IOP(34) ... PRINTING OF DENSITY MATRIX (LINKS 0505-0507).             
     0  NO PRINTING                                                        
     1  PRINT EACH CYCLE.                                                  
                                                                           
     IOP(35) ... PRINT CONTROL (ED/BSSE RUNS).                             
     0  NORMAL PRINTING.                                                   
     1  NO PRINTING.                                                       
     NOTE: FOR FRAGMENT A, FRAGMENT B, AND THE A+B SUPERMOLECULE,          
     THE SCF PRINTING OPTION IS CONTROLLED BY IOP(21).                     
                                                                           
     IOP(36) TO IOP(60) ... NOT USED.                                      
     ******************************************************************    
1                                                                          
                              SCF OPTIONS                                88
                                                                           
                                                                           
                                                                           
     LINK 0502                                                             
                                                                           
     --------------                                                        
     U OF T VERSION                                                        
     MAY 1990                                                              
     --------------                                                        
                                                                           
     SOLUTION OF THE POPLE-NESBET EQUATIONS FOR SPIN-UNRESTRICTED          
     (UHF) OPEN SHELL SYSTEMS.                                             
     J.CHEM.PHYS. 22, 571 (1954)                                           
                                                                           
     ******************************************************************    
     OPTIONS ... IOP( )                                                    
     ******************************************************************    
     SEE SUBROUTINE CLOSED, LINK 0501.                                     
     ******************************************************************    
1                                                                          
 89                           SCF OPTIONS                                  
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     GENERAL SCF: RHF OPEN SHELL, MC-SCF AND GVB.                          
     ******************************************************************    
                                                                           
     LINK 0503                                                             
                                                                           
     --------------                                                        
     U OF T VERSION                                                        
     MAY 1990                                                              
     --------------                                                        
                                                                           
     SOLUTION OF GENERAL SCF EQUATION, INCLUDING RESTRICTED HARTREE-       
     FOCK, PAIR-TYPE MCSCF, AND GVB.                                       
                                                                           
     MODIFIED FROM ROUTINE GSCF (AUTHOR: K. MOROKUMA ET AL) BY             
     MIKE PETERSON AND RAY POIRIER.                                        
                                                                           
     THIS PROGRAM USES 2 OF THE CI FILES (THE SEVENTH AND EIGHTH IN        
     COMMON /IO/) FOR SCRATCH.                                             
                                                                           
     ******************************************************************    
     OPTIONS ... IOP( )                                                    
     ******************************************************************    
     IOP(13) TO IOP(22) ... SEE LINK 0501.                                 
                                                                           
     IOP(23) ... CI EXTRAPOLATION TECHNIQUE TO AID CONVERGENCE.            
     0   USE POPLE 3- AND 4-POINT EXTRAPOLATION.                           
     1   USE DEWAR EXTRAPOLATION.                                          
     2   NOT USED.                                                         
     3   NO EXTRAPOLATION.                                                 
                                                                           
     IOP(24) ... MAXIMUM NUMBER OF CI CYCLES.                              
     0   20 CYCLES.                                                        
     N   2**(N-1) CYCLES.                                                  
     NOTE: ONLY 1 CI CYCLE IS ALLOWED FOR PURE RHF RUNS.                   
                                                                           
     IOP(25) ... CONVERGENCE CRITERION FOR ORBITALS.                       
     0   5*10**(-5) FOR ALL BUT THE LAST SCF ITERATION, WHICH USES A       
         CONVERGENCE CRITERION WHICH MATCHES THE DENSITY CONVERGENCE       
         (SET BY IOP(13), WHICH IS NORMALLY 1 FOR 10**-6 CONVERGENCE).     
     N   10**(-N).                                                         
                                                                           
     IOP(26) ... HOW TO SOLVE MCSCF EQUATION.                              
     0   TWO BY TWO ROTATION (LIMITED MIXING REGION).                      
     1   TWO BY TWO ROTATION (ALL REGIONS ARE MIXED).                      
     NOTE: DO NOT SPECIFY IOP(26)=1 FOR CLOSED SHELL MOLECULES.            
                                                                           
     IOP(27) ... ROOT NUMBER IN THE MC-SCF.                                
     0   LOWEST EIGENVALUE.                                                
     N   N-TH EIGENVALUE.                                                  
                                                                           
     IOP(28) ... PRINTING OF FINAL LAGRANGE MULTIPLIERS MATRIX.            
     0   NO.                                                               
     1   YES.                                                              
                                                                           
     IOP(29) ... TREATMENT OF LARGE ROTATIONS IN ROTSCF.                   
     0   CUT THE SCALE FACTOR AND TRY AGAIN, WITH NO RESET TO              
         ITS PREVIOUS VALUE FOR THE NEXT SCF ITERATION IF THE DENSITY      
1                                                                          
                              SCF OPTIONS                                90
                                                                           
                                                                           
                                                                           
         CONVERGENCE IS GREATER THAN 'SCRIT'. IF THE D CONVERGENCE         
         IS LESS THAN OR EQUAL TO 'SCRIT', THE SCALE FACTOR WILL BE        
         INCREASED FOR EACH SUCCESSIVE ITERATION (WITH AN UPPER LIMIT      
         OF 'SLIMUP').                                                     
     1   CUT THE SCALE FACTOR AND TRY AGAIN, BUT RESET TO ITS              
         INITIAL VALUE FOR THE NEXT SCF ITERATION.                         
     2   CUT THE SCALE FACTOR AND TRY AGAIN, WITH NO RESET TO              
         ITS INITIAL VALUE FOR THE NEXT SCF ITERATION.                     
     3   OMIT THE ROTATION, PRINT A MESSAGE AND CONTINUE.                  
     NOTE: FOR IOP(29)=2 (NORESET MODE), WHEN THE SCF CONVERGES THE        
     FIRST TIME, IT WILL BE RESTARTED WITH IOP(29)=1 (RESET MODE)          
     TO ENSURE THE SCF COEFFICIENTS ARE REALLY CONVERGED.                  
     ONCE RESET/INCREASE MODE IS SET, IT WILL REMAIN IN EFFECT FOR THE     
     REMAINDER OF THE CI ITERATION, BUT WILL BE SET BACK TO ITS            
     INITIAL VALUE AT THE START OF EACH NEW CI CYCLE.                      
     THE SCALE FACTOR IS MODIFIED ACCORDING TO:                            
     SCALE' = FACTDN * SCALE, WITH A LOWER LIMIT OF 'SLIMDN' FOR           
     CUTTING THE SCALE FACTOR, AND                                         
     SCALE' = FACTUP * SCALE, WITH AN UPPER LIMIT OF 'SLIMUP' FOR          
     INCREASING THE SCALE FACTOR.                                          
     THE VALUES OF 'FACTDN', 'FACTUP', 'SLIMDN', 'SLIMUP', 'SCALST'        
     THE INITIAL SCALE FACTOR) AND 'SCRIT' ARE GIVEN IN A DATA             
     STATEMENT.                                                            
                                                                           
     IOP(30) ... PRINTING OF VECTOR COUPLING COEFFICIENTS.                 
     0   NO.                                                               
     1   YES.                                                              
                                                                           
     IOP(31) ... SEE LINK 0501.                                            
                                                                           
     IOP(32) TO IOP(35) ... USED IN ED/BSSE ONLY (LINKS 0505-0507).        
                                                                           
     IOP(36) TO IOP(60) ... NOT USED.                                      
     ******************************************************************    
1                                                                          
 91                           SCF OPTIONS                                  
                                                                           
                                                                           
                                                                           
     LINK 0505                                                             
                                                                           
     --------------                                                        
     U OF T VERSION                                                        
     JULY 1987                                                             
     --------------                                                        
                                                                           
     SOLUTION OF THE ROOTHAAN EQUATIONS FOR A CLOSED SHELL SYSTEM          
     FOR ENERGY DECOMPOSITION / BSSE (MODIFIED VERSION OF CLOSED).         
                                                                           
     ORIGINAL VERSION: K. MOROKUMA, APRIL 1973.                            
     MODIFIED: K. KITAURA, FEBRUARY 1975.                                  
     MODIFIED: H. UMEYAMA, DECEMBER 1975.                                  
     MODIFIED: R. CAMMI, U. OF PARMA, DECEMBER 1985 / OCTOBER 1986.        
     RE-WRITTEN: M. PETERSON, U. OF TORONTO CHEMISTRY DEPARTMENT,          
     JUNE 1987.                                                            
                                                                           
     ******************************************************************    
     OPTIONS ... IOP( )                                                    
     ******************************************************************    
     SEE SUBROUTINE CLOSED, LINK 0501.                                     
     ******************************************************************    
1                                                                          
                                                                         92
                                                                           
                                                                           
                                                                           
 CHAPTER 8: MULLIKEN POPULATION ANALYSIS.                                  
 **********                                                                
                                                                           
     LINK 0601                                                             
                                                                           
     --------------                                                        
     U OF T VERSION                                                        
     AUGUST 1991                                                           
     --------------                                                        
                                                                           
     MULLIKEN POPULATION ROUTINE                                           
                                                                           
     ******************************************************************    
     OPTIONS ... IOP( )                                                    
     ******************************************************************    
     IOP(13) ... CALCULATE DIPOLE MOMENT.                                  
     0  NO.                                                                
     1  YES, AND PRINT THE RESULTS.                                        
     2  YES, AND PERFORM THE DECOMPOSITION OF CHARGE DISTRIBUTION IN       
        TERMS OF ATOMIC MONOPOLES AND ATOMIC DIPOLES, AND PRINT THE        
        RESULTS. REFERENCE: W.A. SOKOLSKI AND R.A. POIRIER, CHEM.          
        PHYS. LETT., 98, 86-92 (1983).                                     
     3  YES, BUT DO NOT PRINT (SAVE INTERNALLY IN COMMON /GEN/).           
                                                                           
     IOP(14) ... NUMBER OF VIRTUAL ORBITALS PRINTED.                       
     N  10+10*N, ROUNDED UP TO THE NEXT MULTIPLE OF 10. PRINTING IS        
        AUTOMATICALLY LIMITED TO NBASIS, THE NUMBER OF AO'S.               
     7  PRINT ALL VIRTUAL ORBITAL COEFFICIENTS.                            
                                                                           
     IOP(15) ... GEOMETRY CHECK PRINTING.                                  
     0  NONE.                                                              
     1  DISTANCE MATRIX, BOND ANGLES AND TORSION ANGLES.                   
     2  DISTANCE MATRIX ONLY.                                              
                                                                           
     IOP(16) ... PRINTING OF MO COEFFICIENTS AND ORBITAL ENERGIES.         
     0  YES.                                                               
     1  NO.                                                                
     2  YES - IN ADDITION, PRINT THE COEFFICIENTS IN SCIENTIFIC            
     NOTATION (8 FIGURES).                                                 
                                                                           
     IOP(17) ... PRINTING OF DENSITY MATRIX.                               
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(18) ... MULLIKEN POPULATION ANALYSIS AND BOND ORDER PRINTING.     
     0  ONLY ATOM POPULATION MATRIX, ATOMIC CHARGES, BOND ORDERS AND       
        ATOMIC VALENCES PRINTED.                                           
     1  ALL RESULTS PRINTED.                                               
     2  NO POPULATION ANALYSIS OR BOND ORDERS.                             
                                                                           
     IOP(19) ... PUNCH OVERLAP MATRIX.                                     
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(20) ... PUNCH CORE HAMILTONIAN MATRIX.                            
     0  NO.                                                                
     1  YES.                                                               
                                                                           
1                                                                          
 93                       POPULATION ANALYSIS                              
                                                                           
                                                                           
                                                                           
     IOP(21) ... PUNCH DIPOLE MOMENT INTEGRALS.                            
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(22) ... PUNCH MO COEFFICIENTS AND ORBITAL ENERGIES.               
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(23) ... PUNCH DENSITY MATRIX.                                     
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(24) ... PUNCH FOCK MATRIX.                                        
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(25) ... UNIT FOR PUNCHED OUTPUT.                                  
     0  STANDARD PUNCH UNIT (IPUNCH IN COMMON /IO/).                       
     N  PUNCH TO UNIT N.                                                   
                                                                           
     IOP(26) ... CUT-OFF DISTANCE FOR GEOMETRY CHECK.                      
     0  3.5 ANGSTROMS.                                                     
     N  N ANGSTROMS.                                                       
     THIS VALUE IS USED AS AN ARBITRARY INDICATION OF BONDED ATOMS.        
     FOR GENERAL BOND ANGLE REQUESTS BOTH THE I-J AND J-K DISTANCES        
     MUST NOT EXCEED THE CUT-OFF VALUE. FOR GENERAL TORSION ANGLE          
     REQUESTS THE I-J, J-K AND K-L DISTANCES MUST NOT EXCEED THE           
     CUT-OFF VALUE.                                                        
                                                                           
     IOP(27) ... PRINT FINAL DENSITY CONVERGENCE AND SPIN.                 
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(28) ... PREPARE MRDCI DATA FILE (UNIT 11).                        
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(29) ... ENERGY DECOMPOSITION / BSSE CORRECTION.                   
     0  NO.                                                                
     1  ENERGY DECOMPOSITION ONLY.                                         
     2  BSSE CORRECTION ONLY.                                              
     3  ENERGY DECOMPOSITION AND BSSE CORRECTION.                          
                                                                           
     IOP(30) ... PRINTING OF MO COEFFICIENTS FOR ED/BSSE RUNS.             
     0  YES.                                                               
     1  NO (THIS IS THE DEFAULT ONCE THE FRAGMENT A, FRAGMENT B, AND       
        A+B SUPERMOLECULE HAVE BEEN COMPLETED).                            
     NOTE: FOR FRAGMENT A, FRAGMENT B, AND THE A+B SUPERMOLECULE,          
     THE COEFFICIENT PRINTING OPTION IS CONTROLLED BY IOP(16).             
                                                                           
     IOP(31) ... POPULATION ANALYSIS PRINTING FOR ED/BSSE RUNS.            
     0  ONLY ATOM POPULATION MATRIX, ATOMIC CHARGES, BOND ORDERS AND       
        ATOMIC VALENCES PRINTED.                                           
     1  ALL RESULTS PRINTED.                                               
     2  NO POPULATION ANALYSIS OR BOND ORDERS (THIS IS THE DEFAULT         
        ONCE THE FRAGMENT A, FRAGMENT B AND A+B SUPERMOLECULE HAVE         
1                                                                          
                          POPULATION ANALYSIS                            94
                                                                           
                                                                           
                                                                           
        BEEN COMPLETED).                                                   
     NOTE: FOR FRAGMENT A, FRAGMENT B, AND THE A+B SUPERMOLECULE,          
     THE POPULATION ANALYSIS OPTION IS CONTROLLED BY IOP(18).              
                                                                           
     IOP(32) ... FINITE FIELD PHASE MATCHING ON THE CMO MATRIX.            
     0  NONE.                                                              
     1  NONE.                                                              
     2  READ MO SWITCH DATA AND THE ZERO FIELD CMO, THEN PHASE MATCH       
        THE FINITE FIELD MO'S TO THE ZERO FIELD MO'S.                      
     NOTE: THIS IS NOT A "BLACK BOX" FACILITY, AND IS INTENDED TO BE       
     USED IN CONJUNCTION WITH THE LMO POLARIZABILITY CHANGES IN LINK       
     0801.                                                                 
                                                                           
     IOP(33) ... UNIT NUMBER FOR ZERO FIELD CMO (FOR IOP(32)=2).           
     N  READ FROM UNIT N (SET TO 1 BY THE STANDARD ROUTE).                 
                                                                           
     IOP(34) ... DEBUG PRINTING FOR CMO PHASE MATCHING.                    
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(35) TO IOP(60) ... NOT USED.                                      
     ******************************************************************    
                                                                           
     GEOMETRY CHECK INPUT                                                  
                                                                           
     THE INPUT FOR THE GEOMETRY CHECK OPTION (IOP(15)=1) ALLOWS TWO        
     TYPES OF REQUESTS: SPECIFIC AND GENERAL. FOR THE SPECIFIC             
     REQUESTS, THE ATOM NUMBERS DEFINING THE PARTICULAR ANGLE DESIRED      
     ARE READ: I-J-K FOR BOND ANGLES, I-J-K-L FOR TORSION ANGLES. EG.      
      3 1 811                         (FORMAT IS 4I2)                      
     WOULD PRINT THE TORSION ANGLE 3-1-8-11. IN A GENERAL REQUEST, ONE     
     OR TWO OF THE ATOM NUMBERS ARE 0 - THEN ALL POSSIBLE ATOM NUMBERS     
     WILL BE SUBSTITUTED IN THOSE POSITIONS, SUBJECT TO THE CUT-OFF        
     DEFINED BY IOP(26) TO HELP CONSERVE PAPER. THUS                       
      0 3 7                           (FORMAT IS 3I2)                      
     WOULD PRINT THE THE BOND ANGLES 1-3-7, 2-3-7, 4-3-7, ...              
     NATOMS-3-7.                                                           
                                                                           
     THE BOND ANGLE REQUESTS ARE READ FIRST (GENERAL AND SPECIFIC          
     REQUESTS MAY BE MIXED IN ANY ORDER), UNTIL A CARD WITH I=J=K=0 IS     
     FOUND. THEN THE TORSION ANGLE REQUESTS (GENERAL AND SPECIFIC)         
     ARE READ UNTIL A CARD WITH I=J=K=L=0 IS FOUND. NOTE THAT THE          
     CUT-OFF (IOP(26)) IS APPLIED ONLY FOR GENERAL REQUESTS.               
     IF A GIVEN ANGLE IS NOT PRINTED WHEN REQUESTED, THEN IT IS NOT        
     PROPERLY DEFINED - EG. ONE BOND IS VERY SHORT, TWO ATOMS ARE THE      
     SAME, THREE ATOMS ARE COLINEAR FOR TORSION ANGLES, ETC.               
                                                                           
     FOR ED/BSSE RUNS, THE GEOMETRY CHECK IS PERFORMED ONLY DURING         
     THE FIRST PASS.                                                       
                                                                           
     BOND ORDERS AND ATOMIC VALENCES.                                      
                                                                           
     BOND ORDERS AND ATOMIC VALENCES ARE CALCULATED ACCORDING TO:          
     I. MAYER, CHEM. PHYS. LETTERS, 97, 270 (1983) AND                     
     I. MAYER, I.J.Q.C., 29, 477-483 (1986).                               
                                                                           
     LMO-POLARIZABILITY INPUT.                                             
                                                                           
1                                                                          
 95                       POPULATION ANALYSIS                              
                                                                           
                                                                           
                                                                           
     FOR JOBS WITH LMO=2 (WHICH SETS IOP(32)=2), IT MAY BE NECESSARY       
     TO SWITCH MO'S IN DEGENERATE CASES. TO ALLOW FOR THIS, A LINE IS      
     READ (IN I4 FORMAT) WHICH CONTAINS THE NUMBER OF SWITCHES TO BE       
     MADE. IF THAT NUMBER IS NON-ZERO, THEN THAT MANY LINES ARE READ       
     WHERE EACH LINE CONTAINS A PAIR OF NUMBERS (IN 2I4 FORMAT) WHICH      
     ARE THE MO NUMBERS TO BE INTERCHANGED.                                
1                                                                          
                                                                         96
                                                                           
                                                                           
                                                                           
 CHAPTER 9: PERTURBATIONAL MOLECULAR ORBITAL ANALYSIS.                     
 **********                                                                
                                                                           
     LINK 0602                                                             
                                                                           
     --------------                                                        
     U OF T VERSION                                                        
     APRIL 1990                                                            
     --------------                                                        
                                                                           
     SETUP PROGRAM FOR PMO ANALYSIS.                                       
                                                                           
     FOR DETAILS OF THE QUANTITATIVE PMO ANALYSIS SEE:                     
     M.-H. WHANGBO, H.B. SCHLEGEL AND S. WOLFE, J. AM. CHEM. SOC., 99,     
     1296 (1977). D. KOST, H.B. SCHLEGEL, D.J. MITCHELL AND S. WOLFE,      
     CAN. J. CHEM., 57, 729 (1979).                                        
                                                                           
     THE TYPE OF ANALYSIS TO BE PERFORMED IS SPECIFIED BY ONE CARD         
                                                                           
     TYPE . MOLNO . TRANSF . BODY3 . EPART  (A4,4I4)                       
                                                                           
     WHERE                                                                 
                                                                           
     TYPE IS ONE OF ...                                                    
     FRAG ... FRAGMENT ORBITAL ANALYSIS FROM FOCK MATRIX PARTITIONING      
     FSEP ... FRAGMENT ORBITAL ANALYSIS FROM SEPARATE MOLECULES            
     PERT ... PERTURBATION ANALYSIS (BASED ON SEPARATE MOLECULES)          
     FSTD ... FRAGMENT ORBITAL ANALYSIS FROM 'STANDARD' MOLECULES          
                                                                           
     MOLNO ... MOLECULE INDEX NUMBER                                       
     FOR FRAG MOLNO IS IGNORED                                             
     FOR FSEP MOLNO IS 1 FOR THE FIRST MOLECULAR FRAGMENT, 2 FOR           
     THE SECOND, AND 3 FOR THE THIRD (IF PRESENT), AND 0 FOR THE           
     COMPOSITE MOLECULE                                                    
     FOR PERT MOLNO IS 1 FOR THE UNPERTURBED MOLECULE, 2 FOR THE           
     PERTURBED MOLECULE                                                    
     FOR FSTD MOLNO IS 1 FOR THE A-H FRAGMENT, 2 FOR THE B-H FRAGMENT,     
     AND 0 FOR THE A-B COMPOSITE                                           
                                                                           
     TRANSF ... FRAGMENT ORBITAL TRANSFORMATION                            
     0  NO TRANSFORMATION REQUIRED                                         
     1  TRANSFORMATION REQUIRED ... ONE CARD CONTAINING M . N . NORB       
        (3I4) IS READ PER PAIR OF ORBITALS TO BE TRANSFORMED. IF NORB      
        IS 0, THE OVERLAP OF ORBITAL M WITH ALL OTHER FRAGMENT             
        ORBITALS IS MINIMIZED. IF NORB IS NON-ZERO, THE OVERLAP OF         
        ORBITAL M WITH ORBITAL NORB IS MINIMIZED. TERMINATE THE            
        TRANSFORMATIONS WITH A BLANK CARD.                                 
                                                                           
     BODY3 ... 3 BODY INTERACTIONS NEEDED (IE THERE ARE 3 FRAGMENTS)       
     0  NO                                                                 
     1  YES                                                                
                                                                           
     EPART ... PERFORM ENERGY PARTITIONING                                 
     0  NO                                                                 
     1  YES                                                                
                                                                           
1                                                                          
 97                               PMO                                      
                                                                           
                                                                           
                                                                           
     THE INPUT SEQUENCE IS                                                 
     1  INFORMATION CARD                                                   
     2  FRAGMENT SPECIFICATION (FOR FRAG AND FSTD)                         
     3  TRANSFORMATION CARDS (IF TRANSF IS 1)                              
                                                                           
     NOTE THAT THE FOCK MATRIX MUST BE SAVED IN FILE 15 OF UNIT IMAT       
     ... SEE IOP(19) OF LINK 0501 (CLOSED).                                
                                                                           
     PMO ANALYSIS IS POSSIBLE ONLY FOR CLOSED SHELL MOLECULES.             
                                                                           
     ******************************************************************    
     OPTIONS ... IOP()                                                     
     ******************************************************************    
     IOP(13) TO IOP(60) ... NOT USED                                       
     ******************************************************************    
                                                                           
1                                                                          
                                  PMO                                    98
                                                                           
                                                                           
                                                                           
 FRAGMENT ANALYSIS.                                                        
 ******************                                                        
                                                                           
     PROGRAM ADDITION TO MONSTERGAUSS TO PERMIT FRAGMENT                   
     ORBITAL ANALYSIS OF RHF-SCF MO CALCULATIONS BY A FOCK                 
     MATRIX PARTITIONING PROCEDURE.                                        
                                                                           
     INPUT CONSISTS OF LFRG(I) (I=1,NBASIS)  (36I2)                        
     WHERE LFRG(I) SPECIFIES THE FRAGMENT ATOMIC ORBITAL I BELONGS TO -    
     THE FRAGMENTS MUST BE NUMBERED SEQUENTIALLY: 1, 2 (AND                
     OPTIONALLY 3). E.G.,                                                  
     FOR CH3OH DISSECTED INTO CH3...OH, USING AN STO-NG BASIS SET AND      
     WITH THE ATOMS READ INTO THE Z-MATRIX IN THE ORDER C H H H O H        
                           123456789012345678901234567890123456...         
     CARD INPUT WOULD BE    1 1 1 1 1 1 1 1 2 2 2 2 2 2                    
                                                                           
     AUTHORS  M.-H. WHANGBO, H.B. SCHLEGEL AND D.J. MITCHELL               
              QUEEN'S UNIVERSITY, KINGSTON, ONTARIO, CANADA                
     EXTENSIVELY MODIFIED BY M.R. PETERSON, UNIVERSITY OF TORONTO,         
     TORONTO, ONTARIO, CANADA                                              
                                                                           
1                                                                          
 99                               PMO                                      
                                                                           
                                                                           
                                                                           
 ANALYSIS BASED ON SEPARATE MOLECULES.                                     
 *************************************                                     
                                                                           
     PROGRAM ADDITION TO MONSTERGAUSS TO PERMIT FRAGMENT AND               
     PERTURBATION ANALYSES OF RHF-SCF MO CALCULATIONS                      
     BASED UPON THE SEPARATE CONSTITUENT MOLECULES                         
                                                                           
     FRAGMENT ANALYSIS BASED UPON SEPARATE MOLECULES (IP(5)=0)             
     REFERS TO A SITUATION WHERE A MOLECULAR COMPLEX IS DISSECTED          
     INTO THE COMPONENT MOLECULES, E.G.,                                   
                         H3BCO ---> BH3 + CO                               
                                                                           
 PERTURBATIONAL ANALYSIS.                                                  
 ************************                                                  
                                                                           
     PERTURBATION ANALYSIS BASED UPON SEPARATE MOLECULES (IP(5)=1)         
     REFERS TO A MOLECULAR SYSTEM UNDERGOING A GEOMETRY CHANGE             
     E.G.,             NH3(PLANAR) ---> NH3(PYRAMIDAL)                     
                                                                           
     AUTHORS  M.-H. WHANGBO, H.B. SCHLEGEL AND D.J. MITCHELL               
              QUEEN'S UNIVERSITY, KINGSTON, ONTARIO, CANADA                
     EXTENSIVELY MODIFIED BY M.R. PETERSON, UNIVERSITY OF TORONTO,         
     TORONTO, ONTARIO, CANADA                                              
                                                                           
1                                                                          
                                  PMO                                   100
                                                                           
                                                                           
                                                                           
 ANALYSIS BASED ON 'STANDARD' FRAGMENTS.                                   
 ***************************************                                   
                                                                           
     PROGRAM ADDITION TO MONSTERGAUSS TO PERMIT FRAGMENT ORBITAL           
     ANALYSIS OF A COMPOSITE MOLECULE A-B IN TERMS OF FRAGMENTS            
     OBTAINED BY FOCK MATRIX PARTITIONING OF A-H AND B-H, WHICH            
     ARE USED AS MODELS OF 'STANDARD' FRAGMENTS 'A' AND 'B'.               
                                                                           
     INPUT CONSISTS OF LFAB(I) (I=1,ISUM) (36I2) WHERE ISUM IS THE         
     TOTAL NUMBER OF BASIS FUNCTIONS FOR A-H AND B-H                       
     THIS SPECIFIES HOW THE BASIS ORBITALS ARE TO BE DIVIDED INTO THE      
     REQUIRED FRAGMENTS, USING A 1 FOR FRAGMENT 1, 2 FOR FRAGMENT 2,       
     AND A 0 TO INDICATE ORBITALS (I.E. THE H ORBITALS FROM A-H AND        
     B-H) TO BE DROPPED, E.G.,                                             
     FOR CH3-OH CONSTRUCTED FROM CH3-H AND HO-H, USING AN STO-NG BASIS     
     SET AND THE ATOMS DEFINED IN THE ORDER C H H H H H O H                
                           123456789012345678901234567890123456...         
     CARD INPUT WOULD BE    1 1 1 1 1 1 1 1 0 2 2 2 2 2 2 0                
                                                                           
     AUTHORS  M.-H. WHANGBO, H.B. SCHLEGEL AND D.J. MITCHELL               
              QUEEN'S UNIVERSITY, KINGSTON, ONTARIO, CANADA                
     EXTENSIVELY MODIFIED BY M.R. PETERSON, UNIVERSITY OF TORONTO,         
     TORONTO, ONTARIO, CANADA                                              
1                                                                          
 101                                                                       
                                                                           
                                                                           
                                                                           
 CHAPTER 10: ENERGY DECOMPOSITION / BSSE.                                  
 ***********                                                               
                                                                           
     LINK 0603                                                             
                                                                           
     --------------                                                        
     U OF T VERSION                                                        
     JULY 1987                                                             
     --------------                                                        
                                                                           
     ENERGY DECOMPOSITION / BSSE CONTROL ROUTINE.                          
                                                                           
     ORIGINAL: R. CAMMI, U. OF PARMA, NOVEMBER 1985.                       
     RE-WRITTEN: M. PETERSON, U. OF TORONTO CHEMISTRY DEPARTMENT,          
     JULY 1987.                                                            
                                                                           
     REFERENCES FOR ENERGY DECOMPOSITION:                                  
     1) K. KITAURA AND K. MOROKUMA, I.J.Q.C., 10, 325-340 (1976).          
     2) K. MOROKUMA, ACCTS. CHEM. RES., 10, 294-300 (1977).                
     3) K. MOROKUMA AND K. KITAURA, IN "CHEMICAL APPLICATIONS OF           
     ATOMIC AND MOLECULAR ELECTROSTATIC POTENTIALS", P. POLITZER AND       
     D.G. TRUHLAR (EDS), PLENUM, NEW YORK (1981), PP 215-242.              
                                                                           
     REFERENCE FOR BASIS SET SUPERPOSITION ERROR CORRECTION:               
     1) R. CAMMI, R. BONACCORSI AND J. TOMASI, THEOR. CHIM. ACTA,          
     68, 271-283 (1985).                                                   
                                                                           
     ******************************************************************    
     REQUIRED INPUT (FOR FIRST ENTRY INTO THIS ROUTINE ONLY)               
     ******************************************************************    
                                                                           
     (1)  (IAMAP(I),I=1,NATOMS)            (36I2 FORMAT)                   
     WHERE IAMAP IS SET TO 1 OR 2 TO INDICATE WHICH MOLECULE               
     ATOM I BELONGS TO, AND NATOMS IS THE NUMBER OF                        
     ATOMS IN THE SUPERMOLECULE (I.E. MOLECULE A (OR 1) +                  
     MOLECULE B (OR 2)). DUMMY ATOMS MAY BE ASSIGNED TO EITHER             
     MOLECULE AT WILL.                                                     
                                                                           
     (2)  ICHARA, MULTA                    (2I2 FORMAT)                    
     WHERE ICHARA AND MULTA ARE THE CHARGE AND MULTIPLICITY                
     FOR MOLECULE A.                                                       
                                                                           
     (3)  ICHARB, MULTB                    (2I2 FORMAT)                    
     WHERE ICHARB AND MULTB ARE THE CHARGE AND MULTIPLICITY                
     FOR MOLECULE B.                                                       
                                                                           
1                                                                          
                      ENERGY DECOMPOSITION / BSSE                       102
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     INPUT ORDER FOR ED/BSSE RUNS                                          
     ******************************************************************    
                                                                           
     (1)  *MOL ... WITH 'ED' AND/OR 'BSSE' OPTIONS SPECIFIED.              
     OTHER ROUTE CONTROL CARDS (*PRT, *PUN, *IOP AND/OR *CON)              
     MAY ALSO BE USED.                                                     
                                                                           
     (2)  TITLE / CHARGE-MULTIPLICITY / GEOMETRY OF SUPERMOLECULE A+B.     
                                                                           
     (3)  SUPERMOLECULE A+B BASIS SET INPUT (IF GENERAL BASIS).            
                                                                           
     (4)  ED/BSSE CONTROL DATA (SEE ABOVE).                                
                                                                           
     (5)  MOLECULE A BASIS SET INPUT (IF GENERAL BASIS).                   
                                                                           
     (6)  RHF INPUT FOR MOLECULE A (IF RHF), OR ALTERATION OF              
     CONFIGURATION DATA FOR MOLECULE A (IF NECESSARY).                     
                                                                           
     (7)  MOLECULE B BASIS SET INPUT (IF GENERAL BASIS).                   
                                                                           
     (8)  RHF INPUT FOR MOLECULE B (IF RHF), OR ALTERATION OF              
     CONFIGURATION DATA FOR MOLECULE B (IF NECESSARY).                     
                                                                           
     (9)  SUPERMOLECULE A+B BASIS SET INPUT (IF GENERAL BASIS).            
     THIS MEANS THE A+B BASIS SET MUST BE INPUT TWICE, UNFORTUNATELY.      
                                                                           
     (10)  RHF INPUT FOR SUPERMOLECULE A+B (IF RHF). NOTE THAT THE         
     ORBITAL ORDER WILL BE PRE-DETERMINED BY THE MO'S FROM THE             
     MOLECULE CALCULATIONS, WITH ALL FROZEN ORBITALS FIRST, THEN           
     ALL OPEN SHELL ORBITALS, THEN ALL VIRTUAL ORBITALS. WITHIN            
     EACH GROUP, THE MO'S FROM MOLECULE A WILL PRECEED THOSE FROM          
     MOLECULE B.                                                           
                                                                           
1                                                                          
 103                  ENERGY DECOMPOSITION / BSSE                          
                                                                           
                                                                           
                                                                           
     ROUTE STRUCTURE EMPLOYED FOR ENERGY DECOMPOSITION /                   
     BASIS SET SUPERPOSITION ERROR CORRECTION:                             
                                                                           
                                      PHASE                                
       LINKS      1   2   3   4   5   6   7   8   9  10  11  12            
     ---------    -   -   -   -   -   -   -   -   -  --  --  --            
        0202      *                                                        
        0301      *   *   *   *                                            
        0302          *   *   *           *      (*)  *      (*)           
        0303         (*) (*) (*)         (*)     (*) (*)     (*)           
     0306-0308        *   *   *                                            
        0311                          *                                    
        0401         (*) (*) (*)                                           
        0402          *   *                                                
        0403                  *   *   *   *   *   *   *   *   *            
     0501-0503        *   *   *       *                                    
     0505-0507                    *       *   *   *   *   *   *            
        0601          *   *   *  (*) (*) (*) (*) (*) (*) (*) (*)           
        0603      *   *   *   *   *   *   *   *   *   *   *   *            
                                                                           
     ED ONLY      *   *   *   *   *   *                                    
     BSSE ONLY    *   *   *   *                   *           *            
     ED + BSSE    *   *   *   *   *   *   *   *   *   *   *   *            
                                                                           
     WHERE * INDICATES THAT THE LINK IS REQUIRED, AND (*) INDICATES        
     THAT THE LINK IS OPTIONAL (DEPENDING ON OTHER OPTIONS USED).          
                                                                           
     STEP         FUNCTION                                                 
     ----         -----------------------------------------------------    
       1          A+B GEOMETRY, BASIS SET, GENERAL SETUP.                  
       2          MOLECULE A SCF (MOLECULE A BASIS).                       
       3          MOLECULE B SCF (MOLECULE B BASIS).                       
       4          A+B SUPERMOLECULE SCF (A+B BASIS).                       
       5          A+B SUPERMOLECULE SCF FOR CT INTERATION.                 
       6          A+B SUPERMOLECULE SCF, NO EXCHANGE INTERACTION.          
       7          A+B SUPERMOLECULE SCF, CT(A) BSSE.                       
       8          A+B SUPERMOLECULE SCF, EX(A) BSSE.                       
       9          A+B SUPERMOLECULE SCF, BSSE FOR MOLECULE A.              
      10          A+B SUPERMOLECULE SCF, CT(B) BSSE.                       
      11          A+B SUPERMOLECULE SCF, EX(B) BSSE.                       
      12          A+B SUPERMOLECULE SCF, BSSE FOR MOLECULE B.              
                                                                           
1                                                                          
                      ENERGY DECOMPOSITION / BSSE                       104
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     OPTIONS ... IOP( )                                                    
     ******************************************************************    
     IOP(13) TO IOP(60) ... SEE LINK 0601.                                 
     ******************************************************************    
1                                                                          
 105                                                                       
                                                                           
                                                                           
                                                                           
 CHAPTER 11: OPTIMIZATION METHODS.                                         
 ***********                                                               
                                                                           
     LINK 0711,  VERSION: NOVEMBER 1990.                                   
                                                                           
     THIS LINK PRINTS THE ENERGY DERIVATIVES FOR THE NUCLEI AND/OR         
     BASIS SET, TRANSFORMS THEM TO NEW COORDINATE SYSTEMS, AND             
     CONTROLS THE OPTIMIZATION OF THE DESIRED PARAMETERS.                  
                                                                           
     AUTHOR: MIKE PETERSON, U OF T CHEMISTRY DEPT, TORONTO, CANADA.        
                                                                           
     ******************************************************************    
     OPTIONS ... IOP()                                                     
     ******************************************************************    
     IOP(13) ... ENTRY MODE.                                               
     0  INITIAL ENTRY (READS VARIATION CARDS).                             
     1  SUBSEQUENT ENTRIES.                                                
     2  RESTART OF FORCE OPTIMIZATION - THE VARIATION CARDS ARE *NOT*      
     READ, BUT THE OPTIMIZATION CONTROL CARDS ARE READ. THE HESSIAN        
     FROM DISK IS USED AUTOMATICALLY.                                      
                                                                           
     IOP(14) ... OPTIMIZATION METHOD.                                      
     0  NO OPTIMIZATION (ONLY CALCULATE FORCES).                           
     1  BROYDEN-FLETCHER-GOLDFARB-SHANNO METHOD (GRADIENT).                
     2  OPTIMALLY CONDITIONED (OC) METHOD OF DAVIDON (GRADIENT).           
     3  VA05 SOLUTION OF THE GRADIENT EQUATIONS.                           
     4  OPTIMALLY CONDITIONED (DOC) METHOD OF DAVIDON (NON-GRADIENT).      
     NOTE: WHILE THE BFGS, OC AND DOC METHODS WILL HANDLE #NO              
     OPTIMIZABLE PARAMETERS, THE VA05 METHOD IS LIMITED TO #NV.            
                                                                           
     IOP(15) ... OPTIMIZATION OF THE GEOMETRY.                             
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(16) ... TYPE OF COORDINATES FOR GEOMETRY OPTIMIZATION.            
     0  INTERNAL COORDINATES.                                              
     1  CARTESIAN COORDINATES (NO CONSTRAINTS POSSIBLE).                   
                                                                           
     IOP(17) ... OPTIMIZATION OF THE BASIS SET.                            
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(18) ... READ GEOMETRY CONSTRAINTS FOR FREE FORMAT GEOMETRIES.     
     0  NO - USE CONSTRAINTS IMPLICIT IN THE Z MATRIX VARIABLES.           
     1  YES.                                                               
                                                                           
     IOP(19) ... PUNCHING OF THE FINAL GEOMETRY.                           
     0  NO.                                                                
     1  YES, IN STANDARD FORMAT (SEE LINK 0202).                           
                                                                           
     IOP(20) ... INTEGRAL ACCURACY CUTOFFS.                                
     0  STANDARD CUTOFFS FOR 10**-8 INTEGRAL ACCURACY.                     
     1  NO CUTOFFS USED.                                                   
     2  USE OLD "SLOPPY" STO-3G CUTOFFS FOR 10**-6 ACCURACY.               
                                                                           
1                                                                          
                          OPTIMIZATION METHODS                          106
                                                                           
                                                                           
                                                                           
     IOP(21) ... PRINT CONTROL.                                            
     0  PRINT ONLY THE TOTAL DERIVATIVES.                                  
     1  NO PRINTING ON SUBSEQUENT ENTRIES (IOP(13)=1).                     
     2  PRINT THE DERIVATIVE COMPONENTS (GEOMETRY AND/OR BASIS SET).       
                                                                           
     IOP(22) ... PRINTING OF THE B MATRIX.                                 
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(23) ... INITIAL FORCE CONSTANT GUESS.                             
     0  INTERNAL GUESS: FOR INTERNAL COORDINATES, USE BADGER'S RULE        
     FOR BOND STRETCHES, 1.0 FOR BOND ANGLES, 0.5 FOR TORSIONS. FOR        
     DUMMY ATOM STRETCHES, AND FOR CARTESIAN COORDINATES, USE 10.0.        
     1  READ REPLACEMENT CONSTANTS FOR BOND ANGLES, TORSIONS AND           
     CARTESIAN COORDINATES FORCE CONSTANTS,                                
     IN 3F12.0 FORMAT (UNITS ARE MDYNE/ANGSTROM).                          
     NOTE: FOR OPTIMIZATION RESTARTS, THIS OPTION IS IGNORED, AND          
     THE REPLACEMENT CONSTANTS CARD SHOULD NOT BE SUPPLIED.                
                                                                           
     IOP(24) ... FOR EACH SHELL (OPTIMIZED).                               
     0  OPTIMIZATION OF ALL COEFFICIENTS IN THE BASIS SET OPTIMIZATION.    
     1  OMISSION OF THE FIRST COEFFICIENT, OPTIMIZATION OF THE             
        REMAINING COEFFICIENTS. (TRY AT YOUR OWN RISK!)                    
                                                                           
     IOP(25) ... STRUCTURE CONTAINS A RING.                                
     0  NO.                                                                
     1  YES - SET THE BOND STRETCH INITIAL GUESS FORCE CONSTANTS TO AT     
     LEAST 7.5, THE BOND ANGLE BEND AND DIHEDRAL INITIAL GUESS             
     FORCE CONSTANTS TO 5.0, THE OC EXTRAPOLATION CONSTANT TO 3.0,         
     AND THE VA05 STEP SIZE TO 0.01 AS AN AID TO CONVERGING MOLECULES      
     CONTAINING RINGS.                                                     
                                                                           
     IOP(26) ... USE "FAST" SPDF INTEGRAL ROUTINES.                        
     0  YES, IF POSSIBLE.                                                  
     1  NO.                                                                
                                                                           
     IOP(27) TO IOP(60) ... NOT USED                                       
     ******************************************************************    
                                                                           
     ******************************************************************    
     INPUT FOR INITIAL ENTRY OF OPTIMIZATION RUNS.                         
     ******************************************************************    
                                                                           
     FOR OPTIMIZATION RUNS, INCLUDING OPTIMIZATION CHECK RUNS, THE         
     GEOMETRY AND BASIS SET VARIATION CARDS ARE READ IN.                   
     FOR RESTART RUNS, THE VARIATION CARDS ARE NOT READ IN, NOR ARE        
     REPLACEMENT FORCE CONSTANTS (SEE IOP(23)).                            
                                                                           
     GEOMETRY OPTIMIZATION.                                                
                                                                           
     FOR INTERNAL COORDINATES, THE GEOMETRY VARIATION CARDS PERMITTED      
     ARE DESCRIBED IN DETAIL IN VGEOM (LINK 0202). THE MAJOR               
     DIFFERENCE IS THAT PARAMETERS *NOT* SPECIFIED ARE OPTIMIZED           
     AUTOMATICALLY, WHILE AN INCREMENT OF 0.0 IS ALLOWED TO HOLD A         
     PARAMETER (OR SET OF PARAMETERS) FIXED. SEVERAL PARAMETERS MAY BE     
     OPTIMIZED TOGETHER AS A SET: THE GRADIENT COMPONENTS ARE SIMPLY       
     ADDED (AFTER MULTIPLICATION BY THE INCREMENT), AND THE NET FORCE      
     CONSTANT IS THE SUM OF THE INDIVIDUAL FORCE CONSTANTS WEIGHTED        
1                                                                          
 107                      OPTIMIZATION METHODS                             
                                                                           
                                                                           
                                                                           
     BY THE SQUARE OF THE RESPECTIVE INCREMENTS. THE FIRST INCREMENT       
     IS ALWAYS SET TO 1.0, AND THE OTHER INCREMENTS SCALED FROM THAT.      
     THE GEOMETRY PARAMETERS ARE DEFINED IN THE ORDER USED BY THE Z        
     MATRIX: BOND LENGTHS, THEN ALPHA ANGLES, THEN BETA ANGLES.            
     A SET OF PARAMETERS WILL BE REFERENCED BY THE NUMBER OF THE           
     FIRST PARAMETER OF THE SET.                                           
     SEVERAL PRECAUTIONS CONCERNING LINEAR BOND ANGLES HAVE BEEN           
     TAKEN, AND MOST LINEAR GEOMETRIES SHOULD BE HANDLED PROPERLY.         
     HOWEVER, A CHECK RUN (WHICH CHECKS THE TRANSFORMATION FROM            
     CARTESIAN TO INTERNAL COORDINATES) IS *ALWAYS* RECOMMENDED.           
     THE LIST OF GEOMETRY VARIATION CARDS IS FOLLOWED BY A BLANK CARD.     
     NO VARIATION CARDS ARE READ IF THE GEOMETRY IS NOT OPTIMIZED.         
                                                                           
     FOR FREE FORMAT Z MATRIX RUNS, THE DEFAULT MODE IS TO APPLY THE       
     CONSTRAINTS IMPLICITLY GIVEN BY THE VARIABLES USED IN THE Z           
     MATRIX: Z MATRIX PARAMETERS USING THE SAME VARIABLE ARE               
     CONSTRAINED TO BE OPTIMIZED TOGETHER, PARAMETERS DEFINED BY           
     CONSTANTS ARE FIXED. CONSTRAINT CARDS ARE READ ONLY IF NO             
     VARIABLES WERE USED, OR IF GOPT=READ WAS SPECIFIED ON THE *MOL        
     CARD.                                                                 
                                                                           
     FOR CARTESIAN COORDINATES, NO CONSTRAINTS ARE POSSIBLE, AND NO        
     VARIATION CARDS ARE READ.                                             
                                                                           
     BASIS SET OPTIMIZATION.                                               
                                                                           
     FOR BASIS SET OPTIMIZATION, THERE ARE TWO TYPES OF VARIATION CARDS    
     1  A CARD IN 15I2 FORMAT IS READ, GIVING THE CENTER NUMBER(S) TO      
     BE OPTIMIZED (TOGETHER). NOTE THAT THE BASIS SETS FOR ALL CENTERS     
     ON THIS CARD MUST BE *IDENTICAL* IN ALL RESPECTS - TYPE, SCALE        
     FACTOR, EXPONENTS, COEFFICIENTS - ELSE YOU ARE IN BIG TROUBLE.        
     2  AFTER THE CENTERS CARD, THERE IS A SET OF CARDS, ONE FOR EACH      
     SHELL ON THE CENTER(S), IN 4I2 FORMAT. THE FOUR VALUES ON EACH        
     CARD REFER TO THE SCALE FACTOR, THE EXPONENTS, THE S/D/F              
     COEFFICIENTS, AND THE P COEFFICIENTS. A 0 WILL CAUSE THAT             
     PARAMETER TO BE OPTIMIZED, WHILE A 1 WILL HOLD IT FIXED. THUS         
     ' 0 0 0 0' OPTIMIZES ALL PARAMETERS FOR THIS SHELL, AND ' 0 0 1 1'    
     OPTIMIZES ONLY THE SCALE FACTOR AND THE EXPONENTS.                    
     THE S/D/F COEFFICIENT VALUE IS IGNORED FOR PURE P SHELLS, AND THE     
     P COEFFICIENT VALUE IS USED ONLY FOR SP OR P SHELLS.                  
                                                                           
     THE BASIS SET PARAMETERS ARE NUMBERED IN THE ORDER GIVEN BY THE       
     CENTERS CARDS, AND WITHIN A SET OF CENTERS, BY SHELLS. WITHIN A       
     SHELL, THE ORDER IS SCALE FACTOR, THEN BY PRIMITIVES (EXPONENT,       
     S/D/F COEFFICIENT, P COEFFICIENT).                                    
                                                                           
     ANY CENTERS NOT SPECIFIED ON A CENTERS CARD ARE HELD FIXED.           
     DUMMY ATOMS MAY NOT BE OPTIMIZED. TERMINATE THE LIST OF BASIS SET     
     VARIATION CARDS WITH A BLANK CARD. NO VARIATION CARDS ARE READ IF     
     THE BASIS SET IS NOT OPTIMIZED.                                       
                                                                           
     INPUT ORDER.                                                          
                                                                           
     1  GEOMETRY VARIATION CARDS, IF REQUIRED.                             
     2  BASIS SET VARIATION CARDS, IF REQUIRED.                            
     3  REPLACEMENT DIAGONAL FORCE CONSTANTS, IF IOP(23)=1.                
     4  DATA REQUIRED BY THE PARTICULAR OPTIMIZATION METHOD (SEE THE       
     INDIVIDUAL PROGRAMS FOR DETAILS).                                     
1                                                                          
                          OPTIMIZATION METHODS                          108
                                                                           
                                                                           
                                                                           
 OPTIMALLY CONDITIONED (OC) METHOD, WITH GRADIENTS.                        
 **************************************************                        
                                                                           
     OPTCOND ... DAVIDON'S OPTIMALLY CONDITIONED OPTIMIZATION METHOD,      
     WITH DERIVATIVES.                                                     
     (VERSION: JUL 13, 1988)                                               
                                                                           
     AUTHORS: W.C. DAVIDON AND L. NAZARETH, ARGONNE NATIONAL               
     LABORATORIES TECHNICAL MEMOS 303 AND 306, ARGONNE, ILLINOIS 60439.    
     THE ALGORITHM IS DESCRIBED IN W.C. DAVIDON, MATHEMATICAL              
     PROGRAMMING, 9, 1 (1975).                                             
     MODIFIED: MIKE AND KATHY PETERSON, U OF TORONTO CHEMISTRY DEPT,       
     CANADA.                                                               
                                                                           
     INPUT (INITIAL ENTRY OR RESTART):                                     
                                                                           
     MAXIT,IPRINT,MODE,ITYPE (4I4).                                        
     MAXIT IS THE MAXIMUM NUMBER OF ITERATIONS.                            
     A TRACE WILL BE PRINTED EVERY IPRINT ITERATIONS (0 FOR NO TRACE).     
     MODE IS 0 TO SET THE INITIAL INVERSE HESSIAN                          
     FACTOR INTERNALLY, 1 TO READ THE DIAGONAL ELEMENTS OF THE             
     HESSIAN MATRIX - IT IS CONVERTED TO THE INVERSE FACTOR FORM           
     INTERNALLY. MODE IS IGNORED FOR RESTARTS SINCE THE HESSIAN FACTOR     
     FROM DISK IS ALWAYS USED.                                             
     NOTE THAT 'MODE' AS READ FROM CARDS IS NOT THE SAME AS THE USAGE      
     IN THE PROGRAM ITSELF.                                                
     ITYPE IS USED ONLY FOR RESTARTS: 0 FOR A NORMAL RESTART (CONTINUE     
     WITH THE CURRENT ITERATION), 1 TO START A NEW ITERATION WITH THE      
     CURRENT POINT. IF THE LAST STEP OF THE PREVIOUS JOB WAS A 'RESET      
     TO BEST PARAMETERS', NEW VALUES OF ACC AND EPS WILL BE IGNORED        
     FOR EXACT RESTARTS.                                                   
                                                                           
     FMIN,ACC,EPS,FL0 (4F12.6) ... FMIN IS A GUARANTEED LOWER BOUND ON     
     THE FUNCTION VALUE. ACC IS THE REQUIRED MEAN GRADIENT LENGTH.         
     EPS IS THE TOLERANCE FOR THE FUNCTION VALUES, USED IN                 
     CONVERGENCE AND OTHER TESTS - IT SHOULD BE LARGER THAN THE            
     ACCURACY OF THE FUNCTION VALUES, BUT A LITTLE SMALLER THAN THE        
     ACCURACY DESIRED IN THE FUNCTION VALUES. FL0 IS THE EXTRAPOLATION     
     LIMIT.                                                                
     THE DEFAULT FOR ACC IS 5.0D-4 IF ONLY THE GEOMETRY IS OPTIMIZED,      
     ELSE 1.0D-4.                                                          
     THE DEFAULT FOR EPS IS 1.0D-8.                                        
     THE DEFAULT FOR FL0 IS 10.0, OR 3.0 IF IOP(25) IS SET TO 1            
     ('RING' OPTION).                                                      
     IF THE INITIAL ENERGY IS BELOW FMIN, FMIN IS RESET AS DESCRIBED       
     BELOW.                                                                
     NOTE: THE DEFAULT FL0 VALUE MAY ALLOW THE OPTIMIZATION TO TAKE        
     LARGE STEPS AWAY FROM THE INITIAL PARAMETER VALUES - TO FORCE         
     THE OPTIMIZATION TO STAY IN THE IMMEDIATE REGION OF THE               
     INITIAL POINT, FL0 SHOULD BE DECREASED TO 2.0 OR 3.0.                 
     NOTE: EPS SHOULD NOT BE CHANGED FOR EXACT RESTARTS.                   
                                                                           
     DIAGM(I),I=1,N (6F12.6) ... N DIAGONAL ELEMENTS OF THE                
     HESSIAN MATRIX, ONLY IF MODE=1 AND THIS IS NOT AN EXACT RESTART.      
     THE UNITS FOR THE HESSIAN MATRIX ARE MDYNE/ANGSTROM FOR               
     GEOMETRICAL PARAMETERS. ONLY THE POSITIVE DIAGONAL ELEMENT            
1                                                                          
 109                      OPTIMIZATION METHODS                             
                                                                           
                                                                           
                                                                           
     VALUES WILL REPLACE THE CORRESPONDING INTERNAL GUESS VALUE -          
     THIS PROVIDES A METHOD OF SUPPLYING ONLY CERTAIN DIAGONAL             
     ELEMENTS, USING THE INTERNAL GUESS FOR THE REMAINDER.                 
                                                                           
     THIS SUBROUTINE SEEKS A LOCAL MINIMUM OF A NON-LINEAR FUNCTIONAL      
     IN N UNKNOWNS, USING DAVIDON'S OPTIMALLY CONDITIONED METHOD. THE      
     IMPLEMENTATION USES FUNCTION VALUES AND FIRST DERIVATIVES.            
                                                                           
     THIS IS A BASIC IMPLEMENTATION OF THE ALGORITHM, DESIGNED TO          
     INCORPORATE A NUMBER OF INTERESTING IDEAS AND TO AID FURTHER          
     RESEARCH INTO THE ALGORITHM. WE EMPHASIZE THAT THE CURRENT            
     IMPLEMENTATION IS NOT A 'BLACK-BOX' ROUTINE.                          
                                                                           
     PARAMETERS (PASSED IN COMMON MOSTLY):                                 
                                                                           
     GROUP 1: MAIN INPUT PARAMETERS DEFINING PROBLEM.                      
                                                                           
     N ... IS THE NUMBER OF VARIABLES (MAXIMUM #NO).                       
     X ... CONTAINS THE STARTING POINT (N VALUES).                         
     ACC ... ROUTINE WILL TERMINATE WHEN MEAN GRADIENT LENGTH IS LESS      
     THAN OR EQUAL TO ACC. USED IN STEP 2A FOR CONVERGENCE TEST.           
     EPS ... IS THE ACCURACY SOUGHT IN THE FUNCTION. THE USER IS           
     CAUTIONED NOT TO SPECIFY AN ACCURACY BELOW THAT WHICH THE             
     FUNCTION CAN BE CALCULATED.                                           
     THE ROUTINE EXITS FROM ITS NORMAL CYCLE OF ITERATIONS WHEN THE        
     REDUCTION IN FUNCTION VALUE PREDICTED BY THE MODEL IS LESS THAN       
     EPS. TWO SUCCESSIVE STEPS WITH A FUNCTION REDUCTION LESS THAN         
     EPS WILL CAUSE TERMINATION.                                           
                                                                           
     GROUP 2: PARAMETERS TO SET INITIAL HESSIAN INVERSE (VARIANCE)         
     APPROXIMATION. THE ROUTINE MAINTAINS THIS IN FACTORED FORM            
     (FJ)(FJ)', AND KEEPS ONLY FJ AS A LOWER TRAPEZOIDAL MATRIX,           
     STORED IN A ONE DIMENSIONAL ARRAY.                                    
                                                                           
     MODE ... SPECIFIES HOW THE FACTOR FJ OF THE INITIAL HESSIAN           
     INVERSE APPROXIMATION IS OBTAINED.                                    
     MODE=0 THEN FJ IS SET BY THE USER.                                    
     MODE=1 THEN THE DIAGONAL ELEMENTS OF FJ ARE SET TO ROUGH ESTIMATES    
     FOR THE STANDARD DEVIATIONS IN THE PARAMETERS SPECIFIED BY THE        
     USER IN DIAGM. THE REST OF FJ IS SET TO ZERO. THE USER IS             
     ENCOURAGED TO USE HIS KNOWLEDGE OF THE PROBLEM TO INITIALIZE FJ       
     TO SOME VALUE OTHER THAN THE IDENTITY. AT THE VERY LEAST FJ SHOULD    
     INITIALIZED TO SOME MULTIPLE OF THE IDENTITY BY SETTING ALL           
     ELEMENTS OF DIAGM TO THIS MULTIPLE.                                   
     M ... IS THE DIMENSION OF THE SUBSPACE TO WHICH THE SEARCH IS         
     CONSTRAINED TO LIE. IF THERE ARE NO EQUALITY CONSTRAINTS, THEN        
     M SHOULD BE SET TO N. SEE ALSO FJ BELOW.                              
     DIAGM ... SPECIFIES THE UNCERTAINTIES IN THE PARAMETERS WHEN          
     MODE=1. WHEN MODE=0, THIS IS A DUMMY VECTOR.                          
     FJ ... CONTAINS THE LOWER TRAPEZOIDAL MATRIX, S.T. THE  HESSIAN       
     INVERSE APPROXIMATION IS GIVEN BY (FJ)(FJ)'. IF MODE=0, THEN FJ       
     MUST BE INITIALIZED BY THE USER. ON TERMINATION, THE FINAL            
     APPROXIMATION TO THE INVERSE HESSIAN (VARIANCE) MATRIX MAY BE         
     OBTAINED FROM (FJ)(FJ)' IF M<N THEN THE INITIAL FJ MUST BE CHOSEN     
     SO THAT ITS COLUMNS SPAN THE SUBSPACE TO WHICH THE                    
     SEARCH IS CONSTRAINED TO LIE.                                         
                                                                           
     GROUP 3: PARAMETERS WHICH GUIDE THE SEARCH.                           
1                                                                          
                          OPTIMIZATION METHODS                          110
                                                                           
                                                                           
                                                                           
     FMIN ... A GUARANTEED LOWER BOUND ON THE FUNCTION VALUE, EVEN IF      
     SIGNIFICANTLY MORE NEGATIVE THAN THE GREATEST LOWER BOUND. IN         
     THE EVENT THAT NOT EVEN A CRUDE ESTIMATE IS AVAILABLE, CHOOSE         
     -1.0D50.                                                              
     IN THE CURRENT IMPLEMENTATION, FMIN IS RESET TO                       
        ENERGY - 0.01 - 0.5*SUM(G(X)**2/H(X,X))                            
     WHERE G(X) AND H(X,X) ARE THE GRADIENT COMPONENTS AND DIAGONAL        
     HESSIAN ELEMENT GUESSES, IF THE ENERGY GOES BELOW THE LOWER           
     BOUND FOR GEOMETRY OPTIMIZATIONS.                                     
     FOR BASIS SET (OR MIXED GEOMETRY / BASIS SET) OPTIMIZATIONS, FMIN     
     IS RESET TO                                                           
        ENERGY-0.0119701-0.144386*N*GL**3                                  
     WHERE GL IS THE CURRENT GRADIENT LENGTH (WITH GL SET TO 1.0 IF        
     GL > 1.0), IF THE ENERGY GOES BELOW THE LOWER BOUND.                  
     FL0 ... EXTRAPOLATION CONSTANT USED IN SEARCH. DEFAULT SET ABOVE.     
     IPRINT ... IF IPRINT=K, WHERE K>0, THE ROUTINE WILL PRINT OUT A       
     TRACE AFTER EACH SET OF K ITERATIONS. THE FORMAT FOR THE TRACE        
     AND THE LEGEND FOR INTERPRETING IT ARE GIVEN UNDER THE HEADING        
     'TRACE' BELOW. IF IPRINT=0, THEN NO TRACE IS OUTPUT.                  
     IRSTBD ... IF THE ALGORITHM TERMINATES WITH ICONV=2, THEN IT IS       
     RESTARTED IRSTBD TIMES WITH THE DIAGONAL ELEMENTS OF FJ SET TO        
     DIAGM IF MODE=1, AND TO UNITY OTHERWISE. IF IRSTBD .LE. 0 THEN        
     NO RESTARTING IS DONE.                                                
                                                                           
     GROUP 4: OUTPUT VARIABLES.                                            
                                                                           
     X0 ... FINAL ESTIMATE OF THE SOLUTION.                                
     F0 ... FUNCTION VALUE AT X0.                                          
     G0 ... GRADIENT AT X0.                                                
     FK0 ... EUCLIDEAN GRADIENT AT X0.                                     
                                                                           
     GROUP 5: WORKING ARRAYS.                                              
                                                                           
     FK,FN,FM,P,Q,S ... M DIMENSIONAL VECTORS.                             
     G,WORK,V ... N DIMENSIONAL VECTORS.                                   
     ITRACE ... ARRAY OF DIMENSION 20.                                     
                                                                           
     TRACE INFORMATION.                                                    
     THE LEGEND FOR THE TRACE LETTERS IS AS FOLLOWS:                       
     U ... INITIAL STEP .EQ. 1 (STEP 2A OF DRVOCR).                        
     T ... PREDICTED REDUCTION IN FUNCTION VALUE IN DIRECTION OF           
     SEARCH .LT. EPS (STEP 2 OF DSRCH).                                    
     H ... BISECT (STEP 2 OF DSRCH).                                       
     B ... MINIMUM BOUNDED (STEP 3 OF DSRCH).                              
     P ... DIRECTIONAL DERIVATIVE POSITIVE (STEP 3 OF DSRCH).              
     E ... EXTRAPOLATION STEP GREATER THAN FL0.                            
     N ... N**2 .LT. EPS (STEP 1 OF FORMPQ).                               
     R ... RESET TO FULL VECTORS (STEP 3 OF FORMPQ).                       
     1 ... RANK 1 UPDATE (STEP 4 OF FORMPQ).                               
     X ... INDICATION THAT CONDITION NUMBER OF HESSIAN INVERSE             
     APPROXIMATION MAY BE IN REGION OF OVERFLOW THRESHOLD                  
     (STEP 1 OF MODCON).                                                   
     C ... FJ ALTERED (STEP 3 OF MODCON).                                  
1                                                                          
 111                      OPTIMIZATION METHODS                             
                                                                           
                                                                           
                                                                           
 OPTIMALLY CONDITIONED (DOC) METHOD, WITHOUT GRADIENTS.                    
 ******************************************************                    
                                                                           
     OCOPTR ... DAVIDON'S OPTIMALLY CONDITIONED OPTIMIZATION METHOD,       
     WITHOUT DERIVATIVES.                                                  
     (VERSION: DEC 04, 1988)                                               
                                                                           
     AUTHORS: W.C. DAVIDON AND L. NAZARETH, ARGONNE NATIONAL               
     LABORATORIES TECHNICAL MEMOS 303 AND 306, ARGONNE, ILLINOIS 60439.    
     THE ALGORITHM IS DESCRIBED IN W.C. DAVIDON, MATHEMATICAL              
     PROGRAMMING, 9, 1 (1975).                                             
     MODIFIED: MIKE AND KATHY PETERSON, U OF TORONTO CHEMISTRY DEPT,       
     CANADA.                                                               
                                                                           
     IMPORTANT NOTE: THIS METHOD IS INTENDED TO BE USED ONLY WHEN THE      
     MORE EFFICIENT GRADIENT METHODS CAN NOT BE APPLIED, OR WHEN ONLY      
     A *VERY* SMALL SUBSET OF ALL THE PARAMETERS IS BEING OPTIMIZED.       
     THIS METHOD IS STILL UNDER DEVELOPMENT AND THE VALUES OF H AND        
     EPS MAY AFFECT THE EFFICIENCY SUBSTANTIALLY. THE CURRENT DEFAULT      
     VALUES ARE INTENDED AS A GUIDE ONLY. THIS METHOD IS NOT               
     GUARANTEED TO BE BETTER THAN THE Z MATRIX OPTIMIZATION METHOD.        
                                                                           
     INPUT (INITIAL ENTRY OR RESTART):                                     
                                                                           
     MAXIT,IPRINT,MODE,ITYPE (4I4).                                        
     MAXIT IS THE MAXIMUM NUMBER OF ITERATIONS.                            
     A TRACE WILL BE PRINTED EVERY IPRINT ITERATIONS (0 FOR NO TRACE).     
     MODE IS 0 TO SET THE INITIAL INVERSE HESSIAN                          
     FACTOR INTERNALLY, 1 TO READ THE DIAGONAL ELEMENTS OF THE             
     HESSIAN MATRIX - IT IS CONVERTED TO THE INVERSE FACTOR FORM           
     INTERNALLY. MODE IS IGNORED FOR RESTARTS SINCE THE HESSIAN FACTOR     
     FROM DISK IS ALWAYS USED.                                             
     NOTE THAT 'MODE' AS READ FROM CARDS IS NOT THE SAME AS THE USAGE      
     IN THE PROGRAM ITSELF.                                                
     ITYPE IS USED ONLY FOR RESTARTS: 0 FOR A NORMAL RESTART (CONTINUE     
     WITH THE CURRENT ITERATION), 1 TO START A NEW ITERATION WITH THE      
     CURRENT POINT. IF THE LAST STEP OF THE PREVIOUS JOB WAS THE           
     'SPECIAL ITERATION' OR 'RESET TO BEST PARAMETERS', NEW VALUES OF      
     H AND EPS WILL BE IGNORED FOR EXACT RESTARTS.                         
                                                                           
     FMIN,H,EPS,FL0 (4F12.6) ... FMIN IS A GUARANTEED LOWER BOUND ON       
     THE FUNCTION VALUE. H IS THE STEP LENGTH USED TO ESTIMATE THE         
     GRADIENT COMPONENTS BY FINITE DIFFERENCES.                            
     EPS IS THE TOLERANCE FOR THE FUNCTION VALUES, USED IN                 
     CONVERGENCE AND OTHER TESTS - IT SHOULD BE LARGER THAN THE            
     ACCURACY OF THE FUNCTION VALUES, BUT A LITTLE SMALLER THAN THE        
     ACCURACY DESIRED IN THE FUNCTION VALUES. FL0 IS THE EXTRAPOLATION     
     LIMIT.                                                                
     IF THE INITIAL ENERGY IS BELOW FMIN, FMIN IS RESET AS DESCRIBED       
     BELOW.                                                                
     THE DEFAULT FOR H IS 0.001.                                           
     THE DEFAULT FOR EPS IS 1.0D-8.                                        
     THE DEFAULT FOR FL0 IS 10.0, OR 3.0 IF IOP(25) IS SET TO 1            
     ('RING' OPTION).                                                      
     NOTE: THE DEFAULT FL0 VALUE MAY ALLOW THE OPTIMIZATION TO TAKE        
     LARGE STEPS AWAY FROM THE INITIAL PARAMETER VALUES - TO FORCE         
1                                                                          
                          OPTIMIZATION METHODS                          112
                                                                           
                                                                           
                                                                           
     THE OPTIMIZATION TO STAY IN THE IMMEDIATE REGION OF THE               
     INITIAL POINT, FL0 SHOULD BE DECREASED TO 2.0 OR 3.0.                 
     NOTE: H AND EPS SHOULD NOT BE CHANGED FOR EXACT RESTARTS.             
                                                                           
     DIAGM(I),I=1,N (6F12.6) ... N DIAGONAL ELEMENTS OF THE                
     HESSIAN MATRIX, ONLY IF MODE=1 AND THIS IS NOT A RESTART RUN.         
     THE UNITS FOR THE HESSIAN MATRIX ARE HARTREE/ANGSTROM**2 FOR          
     GEOMETRICAL PARAMETERS. ONLY THE POSITIVE DIAGONAL ELEMENT            
     VALUES WILL REPLACE THE CORRESPONDING INTERNAL GUESS VALUE -          
     THIS PROVIDES A METHOD OF SUPPLYING ONLY CERTAIN DIAGONAL             
     ELEMENTS, USING THE INTERNAL GUESS FOR THE REMAINDER.                 
                                                                           
     THIS SUBROUTINE SEEKS A LOCAL MINIMUM OF A NON-LINEAR FUNCTIONAL      
     IN N UNKNOWNS, USING DAVIDON'S OPTIMALLY CONDITIONED METHOD. THE      
     IMPLEMENTATION USES FUNCTION VALUES ONLY.                             
                                                                           
     THIS IS A BASIC IMPLEMENTATION OF THE ALGORITHM, DESIGNED TO          
     INCORPORATE A NUMBER OF INTERESTING IDEAS AND TO AID FURTHER          
     RESEARCH INTO THE ALGORITHM. WE EMPHASIZE THAT THE CURRENT            
     IMPLEMENTATION IS NOT A 'BLACK-BOX' ROUTINE.                          
                                                                           
     PARAMETERS (PASSED IN COMMON MOSTLY):                                 
                                                                           
     GROUP 1: MAIN INPUT PARAMETERS DEFINING PROBLEM.                      
                                                                           
     N ... IS THE NUMBER OF VARIABLES (MAXIMUM #NO).                       
     X ... CONTAINS THE STARTING POINT (N VALUES).                         
     H ... STEP LENGTH USED TO ESTIMATE GRADIENT COMPONENTS BY             
     FINITE DIFFERENCES.                                                   
     EPS ... IS THE ACCURACY SOUGHT IN THE FUNCTION. THE USER IS           
     CAUTIONED NOT TO SPECIFY AN ACCURACY BELOW THAT WHICH THE             
     FUNCTION CAN BE CALCULATED IN THE USER SUPPLIED ROUTINE FEVAL.        
     THE ROUTINE EXITS FROM ITS NORMAL CYCLE OF ITERATIONS WHEN THE        
     REDUCTION IN FUNCTION VALUE PREDICTED BY THE MODEL IS LESS THAN       
     EPS. TWO SUCCESSIVE STEPS WITH A FUNCTION REDUCTION LESS THAN         
     EPS WILL CAUSE TERMINATION.                                           
                                                                           
     GROUP 2: PARAMETERS TO SET INITIAL HESSIAN INVERSE (VARIANCE)         
     APPROXIMATION. THE ROUTINE MAINTAINS THIS IN FACTORED FORM            
     (FJ)(FJ)', AND KEEPS ONLY FJ AS A LOWER TRAPEZOIDAL MATRIX,           
     STORED IN A ONE DIMENSIONAL ARRAY.                                    
                                                                           
     MODE ... SPECIFIES HOW THE FACTOR FJ OF THE INITIAL HESSIAN           
     INVERSE APPROXIMATION IS OBTAINED.                                    
     MODE=0 THEN FJ IS SET BY THE USER.                                    
     MODE=1 THEN THE DIAGONAL ELEMENTS OF FJ ARE SET TO ROUGH ESTIMATES    
     FOR THE STANDARD DEVIATIONS IN THE PARAMETERS SPECIFIED BY THE        
     USER IN DIAGM. THE REST OF FJ IS SET TO ZERO. THE USER IS             
     ENCOURAGED TO USE HIS KNOWLEDGE OF THE PROBLEM TO INITIALIZE FJ       
     TO SOME VALUE OTHER THAN THE IDENTITY. AT THE VERY LEAST FJ SHOULD    
     INITIALIZED TO SOME MULTIPLE OF THE IDENTITY BY SETTING ALL           
     ELEMENTS OF DIAGM TO THIS MULTIPLE.                                   
     M ... IS THE DIMENSION OF THE SUBSPACE TO WHICH THE SEARCH IS         
     CONSTRAINED TO LIE. IF THERE ARE NO EQUALITY CONSTRAINTS, THEN        
     M SHOULD BE SET TO N. SEE ALSO FJ BELOW.                              
     DIAGM ... SPECIFIES THE UNCERTAINTIES IN THE PARAMETERS WHEN          
     MODE=1. WHEN MODE=0, THIS IS A DUMMY VECTOR.                          
     FJ ... CONTAINS THE LOWER TRAPEZOIDAL MATRIX, S.T. THE HESSIAN        
1                                                                          
 113                      OPTIMIZATION METHODS                             
                                                                           
                                                                           
                                                                           
     INVERSE APPROXIMATION IS GIVEN BY (FJ)(FJ)'. IF MODE=0, THEN FJ       
     MUST BE INITIALIZED BY THE USER. ON TERMINATION, THE FINAL            
     APPROXIMATION TO THE INVERSE HESSIAN (VARIANCE) MATRIX MAY BE         
     OBTAINED FROM (FJ)(FJ)' IF M<N THEN THE INITIAL FJ MUST BE CHOSEN     
     APPROXIMATELY SO THAT ITS COLUMNS SPAN THE SUBSPACE TO WHICH THE      
     SEARCH IS CONSTRAINED TO LIE.                                         
                                                                           
     GROUP 3: PARAMETERS WHICH GUIDE THE SEARCH.                           
                                                                           
     FMIN ... A GUARANTEED LOWER BOUND ON THE FUNCTION VALUE, EVEN IF      
     SIGNIFICANTLY MORE NEGATIVE THAN THE GREATEST LOWER BOUND. IN         
     THE EVENT THAT NOT EVEN A CRUDE ESTIMATE IS AVAILABLE, CHOOSE         
     -1.0D50.                                                              
     IN THE CURRENT IMPLEMENTATION, FMIN IS RESET TO                       
        ENERGY-0.0119701-11.9655*N*GL**3                                   
     WHERE GL IS THE CURRENT GRADIENT LENGTH (WITH GL SET TO 0.23 IF       
     GL > 0.23), IF THE ENERGY GOES BELOW THE LOWER BOUND.                 
     NOTE: THIS IS THE SAME AS FOR THE OC METHOD, EXCEPT THE GRADIENT      
     IS NOW IN UNITS OF HARTREE/ANGSTROM INSTEAD OF MDYNE.                 
     FL0 ... EXTRAPOLATION CONSTANT USED IN SEARCH. DEFAULT SET ABOVE.     
     IPRINT ... IF IPRINT=K, WHERE K>0, THE ROUTINE WILL PRINT OUT A       
     TRACE AFTER EACH SET OF K ITERATIONS. THE FORMAT FOR THE TRACE        
     AND THE LEGEND FOR INTERPRETING IT ARE GIVEN UNDER THE HEADING        
     'TRACE' BELOW. IF IPRINT=0, THEN NO TRACE IS OUTPUT.                  
     IRSTBD ... IF THE ALGORITHM TERMINATES WITH ICONV=-1, THEN IT IS      
     RESTARTED IRSTBD TIMES WITH THE DIAGONAL ELEMENTS OF FJ SET TO        
     DIAGM IF MODE=1, AND TO UNITY OTHERWISE. IF IRSTBD .LE. 0 THEN        
     NO RESTARTING IS DONE.                                                
                                                                           
     GROUP 4: OUTPUT VARIABLES.                                            
                                                                           
     X0 ... FINAL ESTIMATE OF THE SOLUTION (N DIMENSIONAL VECTOR).         
     F0 ... FUNCTION VALUE AT X0.                                          
                                                                           
     GROUP 5: WORKING ARRAYS.                                              
                                                                           
     FK,FN,FM,P,Q,FS,GR ... M DIMENSIONAL VECTORS.                         
     WORK,V ... N DIMENSIONAL VECTORS.                                     
     ITRACE ... ARRAY OF DIMENSION 20.                                     
                                                                           
     TRACE INFORMATION.                                                    
     THE LEGEND FOR THE TRACE LETTERS IS AS FOLLOWS:                       
     U ... INITIAL STEP .EQ. 1 (STEP 2B OF OCOPTR).                        
     T ... PREDICTED REDUCTION IN FUNCTION VALUE IN DIRECTION OF           
     SEARCH .LT. EPS (STEP 1 OF SEARCH).                                   
     H ... BISECT (STEP 1 OF SEARCH).                                      
     E ... EXTRAPOLATION (STEP 2 OF SEARCH).                               
     M ... EXTRAPOLATION (STEP 3 OF SEARCH).                               
     N ... N**2 .LT. EPS (STEP 1 OF FORMPQ).                               
     R ... RESET TO FULL VECTORS (STEP 3 OF FORMPQ).                       
     1 ... RANK 1 UPDATE (STEP 4 OF FORMPQ).                               
     X ... INDICATION THAT CONDITION NUMBER OF HESSIAN INVERSE             
     APPROXIMATION MAY BE IN REGION OF OVERFLOW THRESHOLD                  
     (STEP 1 OF MODCON).                                                   
     C ... FJ ALTERED (STEP 3 OF MODCON).                                  
1                                                                          
                          OPTIMIZATION METHODS                          114
                                                                           
                                                                           
                                                                           
 BROYDEN-FLETCHER-GOLDFARB-SHANNO (BFGS) METHOD, WITH GRADIENTS.           
 ***************************************************************           
                                                                           
     BFGS ... BROYDEN-FLETCHER-GOLDFARB-SHANNO OPTIMIZATION ROUTINE.       
     THIS ROUTINE IS A MODIFIED VERSION OF HARWELL ROUTINE VA13AD.         
     VERSION: APR  2, 1989.                                                
                                                                           
     AUTHOR: MJD POWELL, AERE, HARWELL, ENGLAND.                           
     THE BFGS ALGORITHM IS DESCRIBED IN R. FLETCHER, COMPUTER J.,          
     13, 317 (1970).                                                       
     MODIFIED: MIKE PETERSON, U OF T CHEMISTRY DEPT, TORONTO, CANADA.      
                                                                           
     INPUT (INITIAL ENTRY OR RESTART):                                     
                                                                           
     MAXIT,IPRINT,MODE,ITYPE (4I4).                                        
     MAXIT IS THE MAXIMUM NUMBER OF ITERATIONS.                            
     THE PARAMETERS AND GRADIENT WILL BE PRINTED EVERY IPRINT              
     ITERATIONS (0 FOR NO PRINTING).                                       
     MODE IS 0 TO SET THE INITIAL HESSIAN APPROXIMATION INTERNALLY,        
     1 TO READ THE DIAGONAL ELEMENTS OF THE HESSIAN FROM CARDS.            
     NOTE THAT FOR A RESTART, THE NUMBER OF ITERATIONS CONTINUES           
     FROM THE PREVIOUS VALUE AND THE PREVIOUS HESSIAN APPROXIMATION IS     
     USED AUTOMATICALLY (FROM DISK) REGARDLESS OF THE VALUE OF MODE.       
     ITYPE IS USED ONLY FOR RESTARTS: 0 FOR A NORMAL RESTART (CONTINUE     
     THE CURRENT ITERATION), 1 TO START A NEW ITERATION WITH THE           
     CURRENT POINT. IF THE LAST STEP OF THE PREVIOUS JOB WAS 'RESET        
     TO BEST PARAMETERS', NEW VALUES OF ACC AND GRLEN WILL BE IGNORED      
     FOR EXACT RESTARTS. IF THE PREVIOUS OPTIMIZATION STOPPED DUE TO       
     EXCEEDING THE ITERATION LIMIT, A CONVERGED GRADIENT LENGTH, OR        
     CONVERGED STEP LENGTH, A RESTART WITH ITYPE = 0 WILL BE CONVERTED     
     AUTOMATICALLY TO A RESTART WITH ITYPE = 1, AND A NEW ITERATION        
     WILL BE STARTED.                                                      
                                                                           
     SCALE,ACC,GRLEN (3F12.6) ... SCALE IS A SUITABLE CHANGE TO MAKE       
     IN THE X'S IN THE INITIAL STEP. ABOUT 10% OF THE TOTAL EXPECTED       
     CHANGE IN THE X'S IS OFTEN A GOOD CHOICE. THE SAME VALUE IS USED      
     FOR ALL THE PARAMETERS, BUT IF THE VALUE IS 0.0, N INDIVIDUAL         
     VALUES ARE READ FROM THE FOLLOWING CARD(S). ACC DEFINES THE           
     REQUIRED ACCURACY: THE OPTIMIZATION IS TERMINATED WHEN CHANGES IN     
     X(I) OF SIZE ACC*SCALE(I) DO NOT REDUCE F. GRLEN IS THE DESIRED       
     EUCLIDEAN GRADIENT LENGTH. CONVERGENCE MAY OCCUR FROM EITHER          
     CRITERION. THE DEFAULT FOR ACC IS 1.0D-4. FOR GRLEN, THE DEFAULT      
     IS 5.0D-4 IF ONLY THE GEOMETRY IS OPTIMIZED, ELSE 1.0D-4.             
     0.01 IS USUALLY A SUITABLE VALUE FOR SCALE.                           
                                                                           
     SCALE(I),I=1,N (6F12.6) ... N VALUES FOR SCALE, IF SCALE ABOVE        
     IS ZERO (6 PER CARD). THE VALUES SHOULD REFLECT THE RELATIVE          
     SIZES OF THE PARAMETERS.                                              
                                                                           
     D(I),I=1,N (6F12.6) ... N VALUES OF THE DIAGONAL ELEMENTS OF THE      
     HESSIAN APPROXIMATION, IF MODE=1 AND THIS IS NOT AN EXACT RESTART.    
     THE UNITS FOR THE HESSIAN MATRIX ARE MDYNE/ANGSTROM FOR               
     GEOMETRICAL PARAMETERS. ONLY THE POSITIVE DIAGONAL ELEMENT            
     VALUES WILL REPLACE THE CORRESPONDING INTERNAL GUESS VALUE -          
     THIS PROVIDES A METHOD OF SUPPLYING ONLY CERTAIN DIAGONAL             
     ELEMENTS, USING THE INTERNAL GUESS FOR THE REMAINDER.                 
1                                                                          
 115                      OPTIMIZATION METHODS                             
                                                                           
                                                                           
                                                                           
 VA05 METHOD FOR GENERAL CRITICAL POINTS, WITH GRADIENTS.                  
 ********************************************************                  
                                                                           
     VA05 ... MINIMIZE A SUM OF SQUARES OF M FUNCTIONS (TERMS) EACH OF     
     N VARIABLES WITHOUT PARTIAL DERIVATIVES, USING A COMBINATION OF       
     NEWTON-RAPHSON, STEEPEST DESCENT AND MARQUARDT ALGORITHMS.            
     THIS ALGORITHM IS SIMILAR TO ROUTINE NS01AD BY M.J.D. POWELL, IN      
     NUMERICAL METHODS FOR NONLINEAR ALGEBRAIC EQUATIONS, P.               
     RABINOWITZ (ED.), GORDON AND BREACH, LONDON (1970), P. 87.            
                                                                           
     FOR MONSTERGAUSS PURPOSES, THE TERMS OF THE SUM OF SQUARES ARE        
     GRADIENT COMPONENTS, AND THE SUM OF SQUARES IS RELATED TO THE         
     GRADIENT LENGTH.                                                      
     (VERSION: MAR  8, 1987)                                               
                                                                           
     AUTHOR: M J D POWELL, AERE, HARWELL.                                  
     MODIFIED: MIKE PETERSON, U OF T CHEMISTRY DEPT, TORONTO, CANADA.      
                                                                           
     INPUT (INITIAL ENTRY OR RESTART):                                     
                                                                           
     MAXIT,IPRINT,MODE,IPUNCH,ISYM,IREST (6I4).                            
     MAXIT: MAXIMUM NUMBER OF ITERATIONS (NOTE THAT FOR RESTART RUNS       
     THE ITERATION COUNT CONTINUES FROM THE PREVIOUS VALUE).               
     IPRINT: PRINT RESULTS EVERY IPRINT ITERATIONS (0 FOR NO PRINTING).    
     MODE: 0 TO USE THE INTERNAL DIAGONAL HESSIAN APPROXIMATION EXCEPT     
     FOR THOSE VARIABLES LISTED BELOW; 1 TO CALCULATE THE ENTIRE           
     HESSIAN MATRIX BY FINITE DIFFERENCES USING ONE-SIDED STEPS (THIS      
     WILL REQUIRE N ADDITIONAL GRADIENT EVALUATIONS, WHERE N IS THE        
     NUMBER OF VARIABLES BEING OPTIMIZED). A VALUE OF 2 FOR MODE           
     USES USER-SUPPLIED DIAGONAL ELEMENTS EXCEPT FOR THOSE VARIABLES       
     LISTED BELOW; 3 TO READ THE ENTIRE HESSIAN MATRIX FROM CARDS.         
     A VALUE OF 4 CALCULATES THE ENTIRE HESSIAN MATRIX BY                  
     TWO-SIDED FINITE DIFFERENCES FOR INCREASED ACCURACY AND TO            
     REDUCE THE ANHARMONICITY EFFECTS - NOTE THAT THIS WILL TAKE           
     TWICE AS LONG AS THE ONE-SIDED STEP CALCULATION (MODE=1).             
     FOR RESTARTS, THE HESSIAN FROM DISK IS USED AUTOMATICALLY, AND        
     THE NUMBER OF ITERATIONS CONTINUES FROM THE PREVIOUS VALUE.           
     MODE IS SET TO -1 WHEN THE HESSIAN MATRIX EVALUATION IS COMPLETE.     
     IPUNCH: NON-ZERO TO PUNCH THE FORCE CONSTANT MATRIX TO                
     UNIT IPUNCH.                                                          
     ISYM: 0 TO SYMMETRIZE THE FORCE CONSTANTS MATRIX AT EACH              
     APPROPRIATE OPPORTUNITY, 1 TO OMIT THE SYMMETRIZATION.                
     IREST: RESTART TYPE (USED ONLY FOR RESTART RUNS). THE POSSIBLE        
     VALUES ARE: 0 TO LET VA05MP DECIDE HOW TO RESTART;                    
     1 TO RECOVER THE LAST SET OF NEW PARAMETERS THAT WAS REQUESTED        
     AND CONTINUE FROM THERE (THIS SHOULD ONLY BE ATTEMPTED WHEN THE       
     PREVIOUS OPTIMIZATION WAS STOPPED BECAUSE THE MAXIMUM NUMBER          
     OF ITERATIONS WAS EXCEEDED); 2 TO START A NEW OPTIMIZATION WITH       
     THE CURRENT PARAMETERS AND HESSIAN MATRIX (THIS SHOULD BE USED        
     TO CONTINUE RUNS THAT TERMINATED NORMALLY, OR FOR RUNS THAT           
     TERMINATED DUE TO LOSS OF RANK IN THE HESSIAN);                       
     3 FOR AN EXACT RESTART (THIS SHOULD ONLY BE USED FOR RUNS THAT        
     WERE ABORTED BY THE USER/OPERATOR, OR JOBS LOST IN SYSTEM             
     CRASHES).                                                             
     NOTE: MODE CAN NOT BE CHANGED FOR RESTART RUNS.                       
                                                                           
1                                                                          
                          OPTIMIZATION METHODS                          116
                                                                           
                                                                           
                                                                           
     DSTEP,DMAX,ACC (3F12.6).                                              
     DSTEP: INCREMENT FOR ESTIMATION OF THE JACOBIAN BY FINITE             
     DIFFERENCES (THE DEFAULT IS 0.02, UNLESS IOP(25)=1 WHEN THE           
     DEFAULT IS 0.01).                                                     
     DMAX: GENEROUS ESTIMATE OF THE EUCLIDIAN DISTANCE BETWEEN THE         
     STARTING POINT AND THE OPTIMIZED POINT (THE DEFAULT IS 0.1).          
     ACC: REQUIRED ACCURACY IN THE GRADIENT LENGTH (THE DEFAULT IS         
     5.0D-4).                                                              
     NOTE: DSTEP AND DMAX SHOULD NOT BE CHANGED FOR RESTART RUNS.          
                                                                           
     LIST(I) (18I4).                                                       
     LIST IS A LIST OF VARIABLE NUMBERS (*NOT* Z MATRIX PARAMETER          
     NUMBERS - SEE THE MAP BETWEEN THE OPTIMIZED VARIABLES AND THE Z       
     MATRIX PARAMETERS) FOR WHICH THE HESSIAN MATRIX ELEMENTS ARE TO       
     BE CALCULATED BY ONE-SIDED FINITE DIFFERENCES. THIS LIST NORMALLY     
     CONSISTS ONLY OF THE FEW INTERNAL COORDINATES STRONGLY INVOLVED       
     ALONG THE PROPOSED REACTION COORDINATE IN TRANSITION STATE            
     OPTIMIZATIONS, BUT THIS FEATURE IS OFTEN HELPFUL WHEN OPTIMIZING      
     CYCLIC STRUCTURES, WHOSE INTERNAL BOND AND DIHEDRAL ANGLES ARE        
     STRONGLY COUPLED. THE REMAINING DIAGONAL HESSIAN ELEMENTS ARE         
     TAKEN FROM THE INTERNAL OR USER-SUPPLIED VALUES. THE LIST OF          
     VARIABLE NUMBERS, 18 PER CARD, MAY BE CONTINUED ONTO FURTHER          
     CARDS IF NECESSARY - A ZERO VALUE TERMINATES THE LIST. FOR            
     EXAMPLE, TO COMPUTE THE HESSIAN MATRIX ELEMENTS FOR OPTIMIZATION      
     VARIABLES 2, 3 AND 7, THE FOLLOWING CARD WOULD DO THE TRICK:          
        2   3   7   0                                                      
     THE HESSIAN (H) IS NORMALLY COMPUTED BY ROWS, SO OFF-DIAGONAL         
     ELEMENTS H(I,J) ARE OBTAINED TWICE, AS THE CHANGE IN THE I'TH         
     GRADIENT COMPONENT WHEN THE J'TH VARIABLE IS INCREMENTED AND          
     VICE VERSA. WHEN ONE OF H(I,I) AND H(J,J) WAS APPROXIMATED AND        
     THE OTHER COMPUTED (BECAUSE IT WAS ON THE LIST), BOTH OFF-            
     DIAGONAL ELEMENTS ARE SET TO THE COMPUTED VALUE (ELSE ONE WOULD       
     BE ZERO).                                                             
     THE EASIEST WAY TO GET THE VARIABLE NUMBERS CORRESPONDING TO          
     THE Z MATRIX PARAMETERS IS TO DO A CHECK JOB WITH THE LIST            
     CARD BLANK. THEN ANOTHER CHECK CAN BE DONE WITH THE LIST              
     SET USING THE MAP BETWEEN OPTIMIZED VARIABLES AND Z MATRIX            
     PARAMETERS (OR BASIS SET PARAMETERS).                                 
     NOTE: OMIT FOR RESTART RUNS.                                          
                                                                           
     WC(I),I=1,N (6F12.6).                                                 
     WC: N DIAGONAL ELEMENTS FOR THE JACOBIAN MATRIX, 6 PER CARD           
     (ONLY IF MODE=2). NOTE THAT N VALUES MUST BE SUPPLIED.                
     THE UNITS FOR THE HESSIAN MATRIX ARE MDYNE/ANGSTROM FOR               
     GEOMETRICAL PARAMETERS. ONLY THE NON-ZERO DIAGONAL ELEMENT            
     VALUES WILL REPLACE THE CORRESPONDING INTERNAL GUESS VALUE -          
     THIS PROVIDES A METHOD OF SUPPLYING ONLY CERTAIN DIAGONAL             
     ELEMENTS, USING THE INTERNAL GUESS FOR THE REMAINDER.                 
     NOTE: OMIT FOR RESTART RUNS.                                          
                                                                           
     WJ(I,J),I=1,N FOR J=1,N (6F12.6).                                     
     WJ: FORCE CONSTANT MATRIX (HESSIAN) BY COLUMNS, 6 PER CARD,           
     EACH COLUMN STARTING ON A NEW CARD (ONLY IF MODE=3).                  
     THE UNITS FOR THE HESSIAN MATRIX ARE MDYNE/ANGSTROM FOR               
     GEOMETRICAL PARAMETERS.                                               
     NOTE: OMIT FOR RESTART RUNS.                                          
1                                                                          
 117                                                                       
                                                                           
                                                                           
                                                                           
 CHAPTER 12: LOCALIZED ORBITALS.                                           
 ***********                                                               
                                                                           
     LINK 0801                                                             
                                                                           
     THIS PROGRAM PERFORMS BOYS LOCALIZATION AND SIZE CALCULATIONS.        
     VERSION: AUGUST 1991.                                                 
                                                                           
     THE LMO COEFFICIENTS WILL BE SAVED ON DISK:                           
     ALPHA OR CLOSED SHELL IN FILE 40, BETA IN FILE 42.                    
                                                                           
     ******************************************************************    
     OPTIONS ... IOP()                                                     
     ******************************************************************    
                                                                           
     IOP(13) = 0 USE 0.08 AS CRITICAL TOLERANCE TO FIND BONDS IN FBOND     
             = N USE 0.02*N AS THE CRITICAL TOLERANCE TO FIND BONDS        
                                                                           
     IOP(14) = 0 SIZES ARE NOT CALCULATED                                  
             = 1 LMO SIZES ARE CALCULATED                                  
                                                                           
     IOP(15) = 0 NO PUNCHING OF THE L.C.A.O.-L.O. MATRIX                   
             = 1 PUNCH OF THE L.C.A.O.-L.O. MATRIX                         
                                                                           
     IOP(16) = N MAXIMUM NUMBER OF ITERATIONS = (300 + 50*N)               
                                                                           
     IOP(17) = N LOCALIZATION CRITERIUM THRESHOLD EQUALS 10**-N            
             = 0 5*10**-6 IS ASSUMED                                       
                                                                           
     IOP(18) = 0 DO NOT PRINT SECOND MOMENT INTEGRALS FOR SIZE CALC.       
             = 1 PRINT SECOND MOMENT INTEGRALS FROM SIZE CALCULATION       
                                                                           
     IOP(19) = 0 DO NOT PUNCH 'SIZE' CARDS.                                
               1 PUNCH 'SIZE' CARDS FOR CORRELATION ENERGY FITS.           
                 THE CARDS WILL CONTAIN THE SIZE (R), THE ELLIPSOID        
                 AXIS LENGTHS, AND THE CENTROID OF CHARGE (ALL IN          
                 ANGSTROMS, WITH FORMAT 7F10.5) FOR EACH LMO.              
               2 PUCH SIZE DATA ( AS IN 1 ) AND SECOND MOMENT MATRIX       
                 EVALUATED AT THE CENTROID OF CHARGE. FORMAT USE IS        
                 XX,YY,ZZ,XY,XZ,YZ.                                        
                                                                           
     IOP(20) TO IOP(22) ARE USED BY THE ONE ELECTRON PROPERTIES            
             PROGRAM (LINK 0802).                                          
                                                                           
     IOP(23) = 0 DO NOT READ LOCALIZATION CONTROL CARD(S).                 
             = 1 READ LOCALIZATION CONTROL CARD(S) - SEE BELOW.            
                                                                           
     IOP(24) IS USED BY THE ONE ELECTRON PROPERTIES PROGRAM                
             (LINK 0802).                                                  
                                                                           
     IOP(25) IS USED BY THE ONE ELECTRON PROPERTIES PROGRAM                
             (LINK 0802), AND THE POLARIZABILITY ESTIMATE PROGRAM          
             (LINK 0803).                                                  
                                                                           
     IOP(26) = 0 NO PUNCHING OF THE L.C.A.O.-L.O. MATRIX.                  
             = 1 PUNCH THE L.C.A.O.-L.O. TRANSFORMATION MATRIX.            
                                                                           
1                                                                          
                           LOCALIZED ORBITALS                           118
                                                                           
                                                                           
                                                                           
     IOP(27) IS USED BY THE ONE ELECTRON PROPERTIES PROGRAM                
             (LINK 0802).                                                  
                                                                           
     IOP(28) = 0 USE STANDARD BOYS LOCALIZATION.                           
               1 ZERO FIELD LMO POLARIZABILITY CASE: SAVE LMO              
                 ROTATION DATA TO UNIT IFORMT.                             
               2 FINITE FIELD LMO POLARIZABILITY CASE: READ LMO            
                 ROTATION DATA FROM UNIT IFORMT.                           
                                                                           
     IOP(29) = 0 NO DEBUG PRINTING FOR LMO POLARIZABILITY.                 
             = 1 DO DEBUG PRINTING FOR LMO POLARIZABILITY.                 
                                                                           
     IOP(30) TO IOP(60) ARE NOT USED.                                      
     ******************************************************************    
                                                                           
     LOCALIZATION CONTROL CARDS MAY BE USED TO LOCALIZE THE CMO IN         
     SUBSETS - EG TO SEPARATE SIGMA AND PI TYPE ORBITALS, OR BY            
     SYMMETRIES. THE CARD FORMAT IS 36I2, WHERE EACH ENTRY GIVES THE       
     SUBSET NUMBER EACH MO BELONGS TO. THE SUBSETS MUST BE NUMBERED        
     SEQUENTIALLY FROM 1. TWO SETS OF CONTROL CARDS ARE REQUIRED FOR       
     OPEN SHELL MOLECULES - ONE FOR THE ALPHA SPIN MO, ONE FOR BETA.       
     NOTE THAT ONLY NAE, THE NUMBER OF OCCUPIED (ALPHA) MO, CONTROL        
     CARD ENTRIES ARE READ, NOT THE TOTAL NUMBER OF ATOMIC ORBITALS.       
     NBE ENTRIES ARE READ FOR THE OCCUPIED BETA SPIN ORBITALS FOR OPEN     
     SHELL MOLECULES. E.G. THE CARD                                        
      1 1 1 2 1 2 3                                                        
     WOULD LOCALIZE MO 1, 2, 3 AND 5 AS A GROUP, THEN 4 AND 6              
     TOGETHER, AND MO 7 IS ALONE IN THE THIRD GROUP.                       
                                                                           
     NOTE THAT MOST RHF OPEN SHELL STATES WILL NOT LOCALIZE PROPERLY       
     AS THEY ARE NOT REPRESENTABLE BY A SINGLE DETERMINANT.                
                                                                           
     LOCAL IS AN EXTENSIVELY MODIFIED VERSION OF BOYLOC, QCPE 10, 330      
     (1975) BY D. PEETERS                                                  
1                                                                          
 119                                                                       
                                                                           
                                                                           
                                                                           
 CHAPTER 13: ONE ELECTRON PROPERTIES.                                      
 ***********                                                               
                                                                           
     LINK 0802                                                             
                                                                           
     THIS PROGRAM CALCULATES ONE ELECTRON PROPERTIES                       
                                                                           
     AUTHORS: ROY KARI AND RAY POIRIER,                                    
     DEPARTMENT OF CHEMISTRY, LAURENTIAN UNIVERSITY, SUDBURY, CANADA.      
     ADAPTED TO MONSTERGAUSS BY MIKE PETERSON AND RAY POIRIER.             
     VERSION: OCTOBER 1990.                                                
                                                                           
     INPUT REQUIREMENTS                                                    
                                                                           
     MPROP,ICM,LABEL,ISAVE,(CPROP(K),K=1,3)  (2I4,A4,I4,3F12.0)            
                                                                           
     MPROP IS THE INDEX OF REQUIRED PROPERTY:                              
      -1  PROPERTIES 1, 2 AND 3                                            
      -2  PROPERTIES 4, 5, 6, 7 AND 8                                      
      -3  PROPERTIES 4, 7 AND 8 (FOR ATOMIC MULTIPOLE DECOMPOSITION,       
          NEEDS UNIT ISAVE)                                                
       1  MAGNETIC SHIELDING (INCLUDING THE POTENTIAL)                     
       2  ELECTRIC FIELD                                                   
       3  FIELD GRADIENT                                                   
       4  DIPOLE MOMENT                                                    
       5  QUADRUPOLE MOMENT                                                
       6  OCTUPOLE MOMENT                                                  
       7  SECOND MOMENT                                                    
       8  THIRD MOMENT                                                     
       9  CHARGE DENSITY                                                   
      10  LINE DENSITY                                                     
      11  PLANAR DENSITY                                                   
      12  OVERLAP                                                          
      13  DIAMAGNETIC SUSCEPTIBILITY                                       
      14  OPTICAL ROTATORY STRENGTH (DIPOLE VELOCITY AND                   
          MAGNETIC MOMENT)                                                 
      15  SPIN DENSITY AT A POINT                                          
      16  SPIN DENSITY ON A LINE                                           
      17  SPIN DENSITY ON A PLANE                                          
      NOTE: NO MO COMPONENTS ARE PRINTED FOR PROPERTIES 15, 16 OR 17.      
     ICM = 0 PROPERTY CALCULATED AT COORDINATE CPROP.                      
         = N PROPERTY CALCULATED AT COORDINATES OF ATOM N.                 
         =-1 PROPERTY CALCULATED AT CENTER OF MASS.                        
         =-2 PROPERTY CALCULATED AT A GRID OF POINTS, BASED AT CPROP.      
       PROPERTIES -1, 1, 2 AND 3 ARE USUALLY EVALUATED AT EACH             
       NON-EQUIVALENT ATOM.                                                
       PROPERTIES -2, 4, 5, 6, 7, 8, 13 AND 14 ARE USUALLY EVALUATED       
       AT THE CENTER OF MASS.                                              
       PROPERTY 12 IS INDEPENDENT OF THE POINT OF EVALUATION.              
       PROPERTIES 9, 10 AND 11 ARE EVALUATED FOR ANY DESIRED POINT,        
       LINE OR PLANE RESPECTIVELY.                                         
       PROPERTIES 15, 16 AND 17 ARE EVALUATED FOR ANY DESIRED POINT,       
       LINE OR PLANE RESPECTIVELY, FOR OPEN SHELL WAVEFUNCTIONS.           
     LABEL IS AN ARBITRARY LABEL FOR THE REFERENCE POINT.                  
     ISAVE IS NON-ZERO TO SAVE THE AO INTEGRALS FOR THIS PROPERTY ON       
       UNIT ISAVE. THE INTEGRALS ARE PRECEEDED BY 2 HEADER LINES:          
       MPROP,NT,LABEL,CPROP,LPROP,ITITLE                                   
       IN (I4,I4,A4,3F12.6/6A4,10A4) FORMAT WHERE                          
1                                                                          
                        ONE ELECTRON PROPERTIES                         120
                                                                           
                                                                           
                                                                           
       'MPROP' IS THE PROPERTY INDEX NUMBER (I4),                          
       'NT' IS THE TOTAL NUMBER OF COMPONENTS FOR THIS PROPERTY (I4),      
       'LABEL' IS THE 4 CHARACTER LABEL SUPPLIED BY THE USER (A4),         
       'CPROP' ARE THE COORDINATES IN ANGSTROMS (3F12.6),                  
       'LPROP' IS THE 24 CHARACTER PROPERTY NAME (A24), AND                
       'ITITLE' ARE THE PROPERTY COMPONENT TITLES (10A4).                  
       THE NEXT LINES CONTAIN:                                             
       K,L,(VAL(I),I=1,NT)                                                 
       IN (2I4,4D14.7/8X,4D14.7/8X,2D14.7) FORMAT WHERE                    
       'K' AND 'L' ARE THE ATOMIC ORBITAL NUMBERS (2I4), AND               
       'VAL' IS THE INTEGRAL VALUES FOR EACH OF THE 'NT' COMPONENTS        
       (4 PER LINE, AS MANY LINES AS NECESSARY).                           
       THE INTEGRALS ARE FOLLOWED BY A LINE CONTAINING '*' IN COLUMN       
       1 FOR EASY SEPARATION OF VARIOUS SETS OF INTEGRALS.                 
       UNIT ISAVE SHOULD BE ASSIGNED TO A BLOCKED, FORMATTED FILE          
       (E.G. THE PUNCH FILE, UNIT 'IPUNCH' - NORMALLY 7), BUT FOR          
       USE WITH LINK 0907 (PROPERTY TRANSFORMATION TO THE MO BASIS)        
       UNIT ISAVE MUST NOT BE ASSIGNED TO THE PUNCH FILE, BECAUSE          
       MOST COMPUTER SYSTEMS WILL NOT ALLOW THE PUNCHED OUTPUT FILE        
       TO BE REWOUND OR READ.                                              
       FOR MPROP=-3, ISAVE MUST BE SPECIFIED.                              
       FOR GRID GENERATION (ICM=-2), THE RESULTS ARE WRITTEN TO UNIT       
       ISAVE ONLY, NOT PRINTED.                                            
     CPROP: COORDINATES OF REFERENCE POINT IN ANGSTROMS (IF ICM IS         
       0 OR -2.                                                            
                                                                           
     REPEAT FOR EACH PROPERTY DESIRED, SETTING MPROP TO 0 TO STOP.         
                                                                           
     FOR OPTIMIZATION RUNS WITH THE FP OPTION, OR FOR SURFACE SCANS,       
     THE SET OF PROPERTIES REQUESTED IS SAVED ON DISK AND RE-USED          
     FOR SUBSEQUENT POINTS.                                                
                                                                           
1                                                                          
 121                    ONE ELECTRON PROPERTIES                            
                                                                           
                                                                           
                                                                           
     EXTRA CARDS REQUIRED FOR GRID GENERATION (ICM=-2).                    
                                                                           
     NX,NY,NZ  (3I4)  ONLY IF ICM=-2.                                      
                                                                           
     NX, NY AND NZ ARE THE NUMBER OF POINTS IN THE GRID FOR THE X, Y       
     AND Z DIRECTIONS (A 0 IS INTERPRETED AS A 1). AT MOST TWO             
     DIRECTIONS MAY BE SCANNED SIMULTANEOUSLY.                             
                                                                           
     XINC,YINC,ZINC  (3F12.0)  ONLY IF ICM=-2.                             
                                                                           
     XINC, YINC AND ZINC ARE THE INCREMENTS TO BE USED IN THE X, Y         
     AND Z DIRECTIONS OF THE GRID (IN ANGSTROMS). THE INCREMENT IS         
     IGNORED FOR DIRECTIONS NOT BEING SCANNED, AND MUST BE NON-ZERO        
     FOR DIRECTIONS BEING SCANNED. THE STARTING POINT OF THE GRID IS       
     THE COORDINATES CONTAINED IN CPROP.                                   
                                                                           
     NOTES ON GRID GENERATION.                                             
                                                                           
     ALL PRINTING IS TURNED OFF DURING THE GRID GENERATION - THUS          
     ISAVE *MUST* BE USED TO SAVE THE RESULTS OF THE SCANS.                
                                                                           
     AT EACH POINT, THE GRID VALUES ARE PRECEEDED BY 2 HEADER LINES:       
     MPROP,NT,LABEL,CPROP,LPROP,ITITLE                                     
     IN (I4,I4,A4,3F12.6/6A4,10A4) FORMAT WHERE                            
     'MPROP' IS THE PROPERTY INDEX NUMBER (I4),                            
     'NT' IS THE TOTAL NUMBER OF COMPONENTS FOR THIS PROPERTY (I4),        
     'LABEL' IS THE 4 CHARACTER LABEL SUPPLIED BY THE USER (A4),           
     'CPROP' ARE THE COORDINATES IN ANGSTROMS (3F12.6),                    
     'LPROP' IS THE 24 CHARACTER PROPERTY NAME (A24), AND                  
     'ITITLE' ARE THE PROPERTY COMPONENT TITLES (10A4).                    
     THE NEXT 1 OR 2 LINES CONTAIN:                                        
     (VAL(I),I=1,NT)                                                       
     IN (5D14.7/5D14.7) FORMAT WHERE                                       
     'VAL' IS THE INTEGRAL VALUES FOR EACH OF THE 'NT' COMPONENTS          
     (5 PER LINE, AS MANY LINES AS NECESSARY).                             
                                                                           
     DO NOT COMBINE GRID GENERATION AND OTHER USES OF THE SAME ISAVE       
     UNIT NUMBER IN ONE OEP RUN, UNLESS YOU ARE PREPARED FOR A MESSY       
     UNSORTING JOB LATER.                                                  
     EXAMPLE: TO GENERATE CHARGE DENSITIES IN THE XZ PLANE FOR AN          
     51 X 51 GRID (X: -5.0 TO 5.0 BY 0.2, Z: -5.0 TO 5.0 BY 0.2),          
     THE INPUT CARDS WOULD BE:                                             
        9  -2 XZ    7-5.0        0.0         -5.0                          
       51   0  51                                                          
     0.2         0.0         0.2                                           
     THE RESULTS OF THE 2601 POINTS ARE WRITTEN ON UNIT 7. OTHER           
     PROPERTY CARDS MAY PRECEED OR FOLLOW THIS GROUP OF 3 CARDS.           
                                                                           
     ******************************************************************    
     IOP() ... OPTIONS.                                                    
     ******************************************************************    
     IOP(13) TO IOP(19) ... USED BY LINK 0801.                             
                                                                           
     IOP(20) = 0 LMO COEFFICIENTS FROM DISK (FROM LINK 0801)               
             = 1 MO  COEFFICIENTS FROM DISK                                
             = 2 USE DENSITY MATRIX ON DISK (NO COMPONENTS OVER MO         
                 CALCULATED)                                               
                                                                           
1                                                                          
                        ONE ELECTRON PROPERTIES                         122
                                                                           
                                                                           
                                                                           
     IOP(21) = 0 DO NOT PRINT AO INTEGRALS                                 
             = 1 PRINT AO INTEGRALS                                        
                                                                           
     IOP(22) = 0 DO NOT PRINT MO RESULTS.                                  
               1 PRINT PROPERTY COMPONENTS OVER OCCUPIED MO.               
                                                                           
     IOP(23) ... USED BY LINK 0801.                                        
                                                                           
     IOP(24) = 0 READ PROPERTY INPUT FROM UNIT 'IN'.                       
               1 READ PROPERTY INPUT FROM UNIT 'IN' AND SAVE ON DISK.      
               2 RECOVER PROPERTY INPUT FROM DISK.                         
                                                                           
     IOP(25) = 0 O.E.P. CALCULATIONS.                                      
               1 ESTIMATE OF DIPOLE POLARIZABILITY CALCULATIONS.           
               2 O.E.P. CALCULATIONS WITH ESTIMATE OF DIPOLE               
                 POLARIZABILITY CALCULATIONS.                              
                                                                           
     IOP(26) ... USED BY LINK 0801.                                        
                                                                           
     IOP(27) = 0 DO NOT READ LMO 'T' MATRIX FROM DISK.                     
               1 READ LMO 'T' MATRIX FROM DISK (UNIT IMAT, FILE 42).       
                                                                           
     IOP(28) ... USED BY LINK 0801.                                        
                                                                           
     IOP(29) ... USED BY LINK 0801.                                        
                                                                           
     IOP(30) TO IOP(60) ... NOT USED.                                      
     ******************************************************************    
                                                                           
     FOR RHF RUNS WITH IOP(20)=1 AND IOP(22)=0, THE PROPERTIES ARE         
     CALCULATED USING THE DENSITY (IOP(20) IS SET TO TO 2).                
                                                                           
     USING IOP(27)=1 ONLY MAKES SENSE FOR IOP(20) = 0 OR 1, AND WILL BE    
     IGNORED IF IOP(20)=2. THIS OPTION IS INTENDED TO PERMIT EVALUATION    
     OF PROPERTY COMPONENTS FOR WAVE FUNCTIONS WITH AN APPLIED EXTERNAL    
     ELECTRIC FIELD, BUT FIRST THE MO'S ARE TRANSFORMED BY THE LMO 'T'     
     MATRIX FOUND FOR THE NO-FIELD CASE. THIS MAY PERMIT REASONABLE        
     EVALUATION OF THE COMPONENTS OF A PROPERTY LIKE POLARIZABILITY        
     OVER LMO'S (BY DIPOLE MOMENT CHANGES WITH EXTERNAL FIELD STRENGTH     
     AND DIRECTION). THE PROBLEM WITH JUST RECOMPUTING THE LMO'S WITH      
     THE APPLIED FIELD IS THAT THE LMO'S ARE PERTURBED BY THE FIELD AT     
     THE SAME TIME AS THE DIPOLE MOMENT IS PERTURBED; USING IOP(27)        
     MAY ALLOW THE LMO PERTURBATION EFFECT TO BE REDUCED FAR ENOUGH        
     SO IT CAN BE IGNORED.                                                 
     THE PROCEDURE IS TO RUN THE NO-FIELD CASE WITH THE LMO OPTION,        
     PUNCHING THE LMO 'T' MATRIX AND SAVING IT (USING IOP(26) IN LINK      
     0801). THEN SUBSEQUENT RUNS ARE MADE WITH APPLIED FIELDS, AND         
     THE NO-FIELD LMO 'T' MATRIX IS READ BACK (USING IOP(35) OF LINK       
     0402) AND APPLIED TO THE CMO'S IN THE ONE ELECTRON PROPERTY           
     PACKAGE (USING IOP(27) OF LINK 0802).                                 
     THESE JOBS ILLUSTRATE THE BASIC IDEA; FIRST JOB:                      
     *MOL LMO, OEP=L                                                       
     *PRT MOINT=Y                                                          
     *IOP                                                                  
        6  26   1  PUNCH LMO 'T' MATRIX                                    
                                                                           
1                                                                          
 123                    ONE ELECTRON PROPERTIES                            
                                                                           
                                                                           
                                                                           
     TITLE                                                                 
      0 1                                                                  
     ... REST OF Z MATRIX                                                  
     ... ONE ELECTRON PROPERTY INPUT                                       
                                                                           
     SUBSEQUENT JOB(S):                                                    
     *MOL OEP=C, FIELD=E                                                   
     *PRT MOINT=Y                                                          
     *IOP                                                                  
        3  35   1  READ LMO 'T' MATRIX FROM UNIT 1                         
        6  27   1  APPLY LMO 'T' MATRIX                                    
                                                                           
     TITLE                                                                 
      0 1                                                                  
     ... REST OF Z MATRIX                                                  
     ... ELECTRIC FIELD INPUT                                              
     ... ONE ELECTRON PROPERTY INPUT                                       
                                                                           
     THIS OPTION IS AVAILABLE ONLY FOR CLOSED SHELL SYSTEMS.               
1                                                                          
                        ONE ELECTRON PROPERTIES                         124
                                                                           
                                                                           
                                                                           
     LINK 0803                                                             
                                                                           
     THIS PROGRAM ESTIMATES COMPONENTS OF DIPOLE POLARIZABILITY            
     BASED ON :                                                            
                                                                           
           1) THE CLOSURE APPROXIMATION OF THE DIPOLE POLARIZABILITY       
              EQUATION FROM SECOND ORDER PERTURBATION THEORY,              
                                                                           
           2) KOOPMAN'S THEOREM, USING THE ELECTRONIC ORBITAL ENERGIES     
              AS ESTIMATES OF IONIZATION ENERGIES.                         
                                                                           
     AUTHOR: MAURICE SYLVAIN,                                              
     DEPARTMENT OF CHEMISTRY, UNIVERSITY OF TORONTO ,TORONTO, CANADA.      
     VERSION: JANUARY 1987.                                                
                                                                           
     ******************************************************************    
     IOP() ... OPTIONS.                                                    
     ******************************************************************    
     IOP(13) TO IOP(19) ... USED BY LINK 0801.                             
                                                                           
     IOP(20) TO IOP(24) ... USED BY LINK 0802.                             
                                                                           
     IOP(25) = 0 NORMAL O.E.P. CALCULATIONS.                               
               1 ESTIMATE POLARIZABILITY.                                  
               2 ESTIMATE POLARIZABILITY AND DO O.E.P. CALCULATIONS.       
                                                                           
     IOP(26) TO IOP(60) ... NOT USED.                                      
     ******************************************************************    
1                                                                          
 125                                                                       
                                                                           
                                                                           
                                                                           
 CHAPTER 14: CONFIGURATION INTERACTION.                                    
 ***********                                                               
                                                                           
     LINK 0901                                                             
                                                                           
     INTEGRAL TRANSFORMATION FROM THE AO TO MO BASIS.                      
                                                                           
     AUTHOR: R.A. POIRIER, DEPT. OF CHEMISTRY, U OF TORONTO, CANADA.       
                                                                           
     THIS PROGRAM SORTS THE MO VECTORS BY USER-SPECIFIED GROUPS, THEN      
     TRANSFORMS THE OVERLAP (S), CORE HAMILTONIAN (H) AND 2-ELECTRON       
     INTEGRALS TO THE MO BASIS. THE H AND 2-E INTEGRALS ARE SAVED ON       
     UNIT IMOINT. THE FIRST RECORD IS THE H MATRIX, WRITTEN BY             
     COLUMNS OF THE UPPER TRIANGLE. THE S MATRIX IS NOT SAVED.             
     THE REMAINING RECORDS ARE ALL THE 2-ELECTRON INTEGRALS, IN BLOCKS     
     OF 900, WRITTEN IN STANDARD ORDER WITH NO LABELS.                     
     UNIT ISCRCH IS USED FOR SCRATCH.                                      
                                                                           
     THE NUMBER OF TRANSFORMED MO IS SAVED IN IOP(93).                     
                                                                           
     THE INTEGRAL TRANSFORMATION ONLY USES THE ALPHA SPIN MO               
     VECTORS (COEFFICIENTS) - THUS IT WILL WORK FOR CLOSED SHELL CASES,    
     AND FOR RHF OPEN SHELL CASES, BUT NOT FOR UHF WAVEFUNCTIONS.          
                                                                           
     INPUT REQUIREMENTS                                                    
                                                                           
     IGROUP(I),I=1,NBASIS  (36I2).                                         
     IGROUP IS USED TO REARRANGE THE MO VECTORS AND ORBITAL ENERGIES.      
     FIRST, ALL THE MO WITH IGROUP(I)=1 ARE COLLECTED, THEN THOSE WITH     
     IGROUP(I)=2, ETC. WITHIN EACH GROUP, THE MO ARE ORDERED BY            
     INCREASING ORBITAL ENERGY. IGROUP(I)=0 MAY BE USED TO ELIMINATE       
     MO I COMPLETELY. THE VALUES USED IN IGROUP NEED NOT BE SEQUENTIAL.    
     FOR USE WITH THE CI PROGRAM, THE GROUPS ARE THE IRREDUCIBLE           
     REPRESENTATIONS OF THE MOLECULAR POINT GROUP (C1, CS, C2, CI,         
     C2V, C2H, D2 OR D2H), AND *ALL* THE OCCUPIED MO MUST PRECEDE          
     *ALL* THE VIRTUAL ORBITALS.                                           
                                                                           
1                                                                          
                       CONFIGURATION INTERACTION                        126
                                                                           
                                                                           
                                                                           
     THE GROUP CODES FOR THE VARIOUS POINT GROUP IRREDUCIBLE               
     REPRESENTATIONS ARE:                                                  
                                                                           
     POINT GROUP   IRRED. REP.   OCCUPIED MO   VIRTUAL MO                  
     -----------   -----------   -----------   ----------                  
                                                                           
         C1             A             1             2 (OR 1)               
                                                                           
         CS             A'            1             3                      
                        A"            2             4                      
                                                                           
         C2             A             1             3                      
                        B             2             4                      
                                                                           
         CI             AG            1             3                      
                        AU            2             4                      
                                                                           
         C2V            A1            1             5                      
                        A2            2             6                      
                        B1            3             7                      
                        B2            4             8                      
                                                                           
         C2H            AG            1             5                      
                        AU            2             6                      
                        BG            3             7                      
                        BU            4             8                      
                                                                           
         D2             A             1             5                      
                        B1            2             6                      
                        B2            3             7                      
                        B3            4             8                      
                                                                           
         D2H            AG            1             9                      
                        AU            2            10                      
                        B1G           3            11                      
                        B1U           4            12                      
                        B2G           5            13                      
                        B2U           6            14                      
                        B3G           7            15                      
                        B3U           8            16                      
                                                                           
     AS AN EXAMPLE, CONSIDER WATER (IN C2V SYMMETRY) WITH THE              
     FOLLOWING MO:                                                         
     A1 A1 B2 A1 B1 A1 B2 B1 A1 B2 A1 B2 A1 A1.                            
     NOTE THAT ONLY THE FIRST 5 MO ARE OCCUPIED. TO SORT THE OCCUPIED      
     AND VIRTUAL ORBITALS INDEPENDENTLY BY SYMMETRY, IGROUP COULD BE:      
      1 1 4 1 3 5 8 7 5 8 5 8 5 0                                          
     WHERE GROUP 1 IS THE OCCUPIED A1 MO, 2 IS THE (NON-EXISTANT)          
     OCCUPIED A2 MO, 3 IS THE OCCUPIED B1 MO, 4 IS THE OCCUPIED B2 MO,     
     5 IS THE VIRTUAL A1 MO, 6 IS THE (NON-EXISTANT) VIRTUAL A2 MO,        
     7 IS THE VIRTUAL B1 MO AND 8 IS THE VIRTUAL B2 MO. MO 14 IS TO        
     BE DROPPED FROM THE TRANSFORMATION. THE RESULTING MO ORDER IS:        
     1 2 4 3 5 6 9 11 13 7 10 12 8.                                        
     NOTE THAT IF NBASIS IS GREATER THAN 36, 2 OR MORE CARDS MUST BE       
     SUPPLIED FOR IGROUP (36 VALUES PER CARD).                             
                                                                           
1                                                                          
 127                   CONFIGURATION INTERACTION                           
                                                                           
                                                                           
                                                                           
     ******************************************************************    
     OPTIONS ... IOP()                                                     
     ******************************************************************    
     IOP(13) ... CALCULATION OF ELECTRONIC ENERGY AFTER TRANSFORMATION.    
     0  NO.                                                                
     1  YES.                                                               
     NOTE: THIS OPTION SHOULD NOT BE USED IF ANY CORE MO ARE DELETED,      
     OR ANY VIRTUAL MO PRECEDE ANY OCCUPIED MO AFTER SORTING,              
     OR FOR OPEN SHELL WAVEFUNCTIONS.                                      
                                                                           
     IOP(14) ... PRINTING OF TRANSFORMED INTEGRALS.                        
     0  NO.                                                                
     1  YES - PRINT S, H AND 2-ELECTRON INTEGRALS.                         
                                                                           
     IOP(15) ... DUMP OF CI COUPLING COEFFICIENTS (LINK 0902).             
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(16) ... ENTRY TYPE.                                               
     0  INITIAL ENTRY - DATA READ FROM CARDS.                              
     1  SUBSEQUENT ENTRY - DATA READ FROM DISK.                            
                                                                           
     IOP(17) ... PRINT CI FOCK MATRICES (LINK 0904).                       
     0  NO.                                                                
     1  YES.                                                               
                                                                           
     IOP(18) ... STORE CI ENERGY FOR USE IN OPTIMIZATIONS.                 
     0  NO.                                                                
     1  YES - SAVE TOTAL SINGLES AND DOUBLES CI ENERGY.                    
     2  YES - SAVE ESTIMATED CI ENERGY FOR SINGLES, DOUBLES AND            
     QUADRUPLES.                                                           
                                                                           
     IOP(19) ... PRINT CONTROL.                                            
     0  NORMAL.                                                            
     1  ONLY PRINT FINAL CI ENERGIES.                                      
     2  NO PRINTING.                                                       
     NOTE: THIS OPTION DOES NOT OVER-RIDE OPTIONS 13, 14, 15, 17 OR 21.    
                                                                           
     IOP(20) ... ONE ELECTRON PROPERTIES.                                  
     0  TRANSFORM AO INTEGRALS TO MO INTEGRALS FOR OEP.                    
     1  PERFORM AN ATOMIC MULTIPOLE DECOMPOSITION.                         
                                                                           
     IOP(21) ... PRINT CI EXPANSION COEFFICIENTS.                          
     0  PRINT ONLY C0 (COEFFICIENT OF ROOT CONFIGURATION).                 
     N  PRINT ONLY COEFFICIENTS LARGER THAN 10**-N, FOR N=1,2,3,4,5,6.     
     7  PRINT ALL COEFFICIENTS.                                            
     NOTE THAT THE COEFFICIENTS ARE PRINTED WITHOUT IDENTIFYING WHAT       
     CONFIGURATION THEY REFER TO - THIS OPTION IS ONLY REALLY USEFUL       
     FOR VERY SMALL CI EXPANSIONS, WHERE THE CONFIGURATIONS ARE KNOWN      
     FROM FIRST PRINCIPLES.                                                
                                                                           
     IOP(22) TO IOP(60) ... NOT USED.                                      
     ******************************************************************    
1                                                                          
                       CONFIGURATION INTERACTION                        128
                                                                           
                                                                           
                                                                           
     LINK 0903                                                             
                                                                           
     CONFIGURATION GENERATOR                                               
     AUTHORS: N.C. HANDY, J.D. GODDARD AND H.F. SCHAEFER, BERKELEY.        
     MODIFIED BY R.A. POIRIER AND M.R. PETERSON,                           
     UNIVERSITY OF TORONTO CHEMISTRY DEPT., TORONTO, ONTARIO, CANADA.      
     OPEN SHELL SINGLET ADDED BY P.S. MARTIN AND M.R. PETERSON,            
     UNIVERSITY OF TORONTO CHEMISTRY DEPT., TORONTO, ONTARIO, CANADA.      
                                                                           
     THIS PROGRAM GENERATES CONFIGURATIONS BY DOING SINGLE AND DOUBLE      
     EXCITATIONS WITH RESPECT TO A SINGLE REFERENCE CONFIGURATION.         
     THIS VERSION DOES CLOSED SHELL SINGLET AND OPEN SHELL SINGLET,        
     DOUBLET, TRIPLET AND QUARTET STATES.                                  
     THE CONFIGURATION DATA IS PUT IN SCRATCH FILES 31 AND 32 ON           
     UNIT IMAT, AND ON UNIT IFINT.                                         
                                                                           
     INPUT REQUIREMENTS                                                    
                                                                           
     1. NS (I4)                                                            
        NS = NUMBER OF IRREDUCIBLE REPRESENTATIONS IN THE POINT GROUP      
           = 1   C1 (NO SYMMETRY)                                          
           = 2   CS, C2 OR CI                                              
           = 4   C2V, C2H OR D2                                            
           = 8   D2H                                                       
                                                                           
     2. ZIA(I),IA(I,J),J=1,3 (REPEAT NS TIMES) (A4,3I4)                    
        ZIA(I)  = LABEL (SYMMETRY)                                         
        IA(I,1) = NUMBER OF MO OF THAT SYMMETRY                            
        IA(I,2) = NUMBER OF OCCUPIED MO OF THAT SYMMETRY                   
        IA(I,3) = NUMBER OF MO OF THAT SYMMETRY TO BE FROZEN OFF THE       
                  TOP (HIGHEST)                                            
                                                                           
     3. IB(I),I=1,NT (NT= NUMBER OF OCCUPIED MO'S) (36I2)                  
        IB(I) =   OCCUPANCY OF MO I                                        
              = 0 FROZEN AND DOUBLY OCCUPIED                               
              = 1 SINGLY OCCUPIED                                          
              = 2 DOUBLY OCCUPIED                                          
                                                                           
     NOTE THAT THE OCCUPIED MO VECTORS (AND ORBITAL ENERGIES) MUST BE      
     SORTED BY SYMMETRY TYPES (SEE LINK 0901), AND THAT IB REFERS TO       
     THE OCCUPIED MO BY SYMMETRY TYPE (IE. ALL TYPE 1 OCCUPIED, THEN       
     ALL TYPE 2 OCCUPIED, ETC). ALL VIRTUAL ORBITALS, ALSO SORTED BY       
     SYMMETRY, MUST FOLLOW ALL OCCUPIED ORBITALS.                          
                                                                           
     THE ORDER OF THE IRREDUCIBLE REPRESENTATIONS FOR THE EIGHT            
     POSSIBLE POINTS GROUPS IS:                                            
     C1: A.                                                                
     CS: A', A".                                                           
     C2: A, B.                                                             
     CI: AG, AU.                                                           
     C2V: A1, A2, B1, B2.                                                  
     C2H: AG, AU, BG, BU.                                                  
     D2: A, B1, B2, B3.                                                    
     D2H: AG, AU, B1G, B1U, B2G, B2U, B3G, B3U.                            
1                                                                          
 129                                                                       
                                                                           
                                                                           
                                                                           
 CHAPTER 15: ONE ELECTRON PROPERTY TRANSFORMATION.                         
 ***********                                                               
                                                                           
     LINK 0907                                                             
                                                                           
     THIS PROGRAM TRANSFORMS THE AO INTEGRALS OF ONE ELECTRON              
     PROPERTIES TO MO INTEGRALS.                                           
                                                                           
     AUTHOR: R. A. POIRIER,                                                
     DEPARTMENT OF CHEMISTRY,                                              
     UNIVERSITY OF TORONTO, TORONTO, CANADA.                               
                                                                           
     INPUT REQUIREMENTS                                                    
                                                                           
     IUNIT,NPROP,ICODE (3I4)                                               
                                                                           
     IUNIT IS THE UNIT WHERE THE AO INTEGRALS ARE TO BE READ.              
     NPROP IS THE SEQUENCE NUMBER OF THE PROPERTY ON UNIT IUNIT.           
     ICODE = 0 IF THE SAME ORBITALS ARE TO BE TRANSFORMED AS WAS           
               SPECIFIED BY IGROUP IN THE INTEGRAL TRANSFORMATION          
               (GL0901)                                                    
           = 1 TRANSFORM ALL MO'S (IGNORE IGROUP).                         
     *NOTE* IF NO INTEGRAL TRANSFORMATION WAS PERFORMED THEN THE           
               PROGRAM RUNS AS IF ICODE=1.                                 
                                                                           
     REPEAT FOR EACH PROPERTY TRANSFORMATION DESIRED.                      
                                                                           
     SET IUNIT TO ZERO TO INDICATE THE END OF THE TRANSFORMATIONS.         
                                                                           
     IOP(20) ... ONE ELECTRON PROPERTIES.                                  
     0  INTEGRAL TRANSFORMATION                                            
     1  ATOMIC MULTIPOLE DECOMPOSITION                                     
1                                                                          
                         O.E.P. TRANSFORMATION                          130
                                                                           
                                                                           
                                                                           
     THIS PROGRAM DECOMPOSES THE MOLECULAR MULTIPOLES INTO ATOMIC          
     MONOPOLES, DIPOLES, QUADRUPOLES AND OCTUPOLES.                        
                                                                           
     AUTHOR: W. A. SOKOLSKI                                                
             INSTITUTE OF ORGANIC AND PHYSICAL CHEMISTRY                   
             WYSPIANSKIEGO 27                                              
             50-370 WROCLAW, POLAND                                        
                                                                           
     INPUT REQUIREMENTS:                                                   
                                                                           
     IUNIT (I4)                                                            
                                                                           
     IUNIT IS THE UNIT WHERE THE AO INTEGRALS ARE TO BE READ.              
                                                                           
     NOTE:                                                                 
     BECAUSE OF RECURSIVE CHARACTER OF UTILIZED FORMULA THE FOLLOWING      
     ORDER OF CALCULATIONS HAS TO BE RETAINED IN GL0802 AND IN GL0907      
     NPROP=1  (DIPOLE MOMENT, MPROP=4)                                     
     NPROP=2  (QUADRUPOLE MOMENT, MPROP=5 OR 7)                            
     NPROP=3  (OCTUPOLE MOMENT, MPROP=6 OR 8)                              
     THIS CAN BE DONE BY SPECIFYING MPROP=-3 IN GL0802.                    
