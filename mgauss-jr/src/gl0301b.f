C     GL0301B      08 APR 87                                         MRP
      SUBROUTINE GBASIS(LA,MXSHLL)
C
C1GENERAL-BASIS
C     LINK 0301
C*
C     --------------
C     U OF T VERSION
C     APRIL 1987
C     --------------
C=BASIS SETS
C     ******************************************************************
C     GENERAL BASIS INPUT
C     ******************************************************************
C
C     INPUT OF A GENERAL BASIS SET OF GAUSSIAN FUNCTIONS.
C     BASIS SET MAY BE FORMED FROM INTERNAL SETS OF GAUSSIAN FUNCTIONS
C     OR FROM FUNCTIONS READ IN FROM CARDS.
C     EXAMPLE OF CARD INPUT:
C     STO-3G CALCULATION OF ETHANE
C     STANDARD EXPONENTS
C     ATOMS 1 AND 2 ARE CARBONS, ATOMS 4 TO 9 ARE HYDROGENS
C     ASSUME CARD COLUMNS ARE
C     123.....
C 1   330330D0303030303030E                      (72A1)
C 2    1 2                                       (30I2)
C 3    STO 1S  5.67                              (A4,2A2,F12.6)
C 4    STO 2SP 1.72
C 5   ****
C 6    4 5 6 7 8 9
C 7    STO 1S  1.24
C 8   ****
C 9   (BLANK CARD)
C*
C     CARD 1
C     ENTRY MAY BE 0, 1 TO 9, A, D OR E
C     1 TO 9 AND A SIGNIFY THE NUMBER OF GAUSSIANS IN THAT SHELL
C     (A IS HEXADECIMAL FOR 10),
C     GROUPED ENTRIES SIGNIFY SHELLS BELONGING TO THE SAME ATOM
C     ATOMS ARE SEPARATED BY AN ENTRY OF ZERO
C     D SIGNIFIES A DUMMY ATOM (WHICH MUST NOT HAVE BASIS FUNCTIONS)
C     E SIGNIFIES THE END OF THE ATOMS
C     REPEAT THIS CARD AS OFTEN AS REQUIRED TO SPECIFY ALL CENTERS
C     IN THE ABOVE EXAMPLE ...
C     330 MEANS THAT FIRST ATOM HAS 2 SHELLS EACH CONTAINING
C     3 GAUSSIANS
C*
C     CARDS 2 AND 6
C     CENTERS TO WHICH THE FORTHCOMING BASIS FUNCTIONS APPLY
C     IE  BASIS FUNCTIONS SPECIFIED BY CARDS 3 AND 4 WILL BE CENTERED
C     ON ATOMS 1 AND 2 AND THOSE SPECIFIED BY CARD 7 WILL BE CENTERED
C     ON ATOMS 4 TO 9
C     ATOM 3 IS A DUMMY ATOM
C*
C     CARDS 3 AND 4  AND CARD 7
C     SPECIFICATION OF BASIS FUNCTIONS
C     ENTRIES AS FOLLOWS
C     BASIS SET . SHELL LABEL/TYPE . SCALE FACTOR
C*
C     BASIS SET
C     INTERNAL TYPES: ONE OF 'STO ' (OR ' STO'), '3-21', '4-21',
C     '421P', '4-31', '5-31', '6-21', '6-31', '6311', WHERE
C     '421P' DENOTES THE PULAY 4-21G BASIS SET AND '6311' DENOTES
C     THE 6-311G BASIS SET.
C     OR, IF THIS FIELD IS BLANK FUNCTION WILL BE READ FROM CARDS:
C     EXAMPLE OF THIS FEATURE
C     READ IN FUNCTION CONSISTING OF SINGLE GAUSSIAN FUNCTION WITH
C     EXPONENT 1.0 AND S AND P COEFFICIENTS OF 0.1 AND 0.2
C     RESPECTIVELY
C     THE COEFFICIENTS WILL BE AUTOMATICALLY NORMALIZED
C          2SP 1.00                                     (A4,2A2,F12.6)
C     1.0                 0.1                 0.2       (3F20.10)
C     THE EXPONENTS AND CONTRACTION COEFFICIENTS FOR D AND F SHELLS ARE
C     READ IN (2F20.10) FORMAT (IE. LIKE S SHELLS).
C     IN ALL CASES, THE NUMBER OF PRIMITIVE GAUSSIANS IN THIS SHELL WAS
C     SPECIFIED ON CARD 1. THE SHELLS FOR AN ATOM (OR SET OF ATOMS)
C     MUST BE SPECIFIED IN THE ORDER GIVEN ON CARD 1 FOR THAT ATOM.
C*
C     SHELL LABEL/TYPE
C     THIS FIELD IS SPLIT INTO 2 PARTS, EACH OF LENGTH 2 CHARACTERS:
C     THE FIRST 2 CHARACTERS ARE USED AS THE SHELL 'NUMBER' FOR THIS
C     ATOM IN THE PRINT ROUTINE, AND SHOULD BE RIGHT JUSTIFIED (EG
C     ' 2'). THE SECOND FIELD IS THE SHELL TYPE, AND MUST BE ONE OF
C     'S ', 'P ', 'SP', 'D ' OR 'F '.
C
C     FOR THE INTERNAL STO BASIS, THE LABEL/TYPE MUST BE ONE OF:
C     ' 1S ', ' 2S ', ' 2SP', ' 3S ', ' 3P ', ' 3SP', ' 3D ', ' 3S*',
C     ' 3D*', ' 4S ', ' 4P ', ' 4SP', ' 4S*', ' 4D*' OR ' 5SP'.
C     THE SPECIAL CODES '3S*' AND '3D*' REFER TO THE SP AND D PORTIONS
C     RESPECTIVELY OF THE S=P=D STO-NG BASIS SETS FOR THE ATOMS GA-KR.
C     THE 3SP PORTION OF THIS S=P=D FIT IS ALSO USED FOR THE ATOMS K
C     AND CA.
C     THE SP PART WILL BE LABELED SP* (NOT S*) IN THE BASIS SET TABLE.
C     SIMILARLY THE CODES '4S*' AND '4D*' REFER TO THE SP AND D PORTIONS
C     RESPECTIVELY OF THE S=P=D STO-NG BASIS SETS FOR THE ATOMS IN-XE.
C     THE 4SP PORTION OF THIS S=P=D FIT IS ALSO USED FOR THE ATOMS RB
C     AND SR.
C     THE MAXIMUM NUMBER OF GAUSSIANS PER SHELL IS 6.
C
C     FOR THE INTERNAL EXTENDED BASES, THE LABEL/TYPE MUST BE ONE OF:
C     ' 1S ' TO ' 5S ', ' 2SP' TO ' 8SP', '10SP', ' 3P ', ' 4P ',
C     ' 4D ' TO ' 7D ', OR ' 9D '.
C     THE SHELL LABEL/TYPE IS USED TO FIND THE PROPER EXPONENTS AND
C     COEFFICIENTS BY THE FOLLOWING LABEL CONVENTIONS:
C
C     FOR THE N-M1G BASIS SETS:
C     H-HE: '1S' IS THE INNER VALENCE ORBITAL, '2S' IS THE OUTER VALENCE
C     ORBITAL, '3P' IS A P-TYPE POLARIZATION FUNCTION, AND '4S'
C     IS AN S-TYPE DIFFUSE FUNCTION.
C     LI-NE: '1S' IS THE 1S CORE, '2SP' IS THE INNER VALENCE, '3SP' IS
C     THE OUTER VALENCE ORBITALS, '4D' IS A D-TYPE POLARIZATION
C     FUNCTION, AND '5SP' IS AN SP-TYPE DIFFUSE FUNCTION.
C     NA-AR: '1S' IS THE 1S CORE, '2SP' IS THE 2S/2P CORE, '3SP' IS
C     THE INNER VALENCE, '4SP' IS THE OUTER VALENCE ORBITALS, '5D'
C     IS A D-TYPE POLARIZATION FUNCTION, AND '6SP' IS AN SP-TYPE
C     DIFFUSE FUNCTION.
C     K-KR: '1S' IS THE 1S CORE, '2SP' IS THE 2S/2P CORE, '3SP' IS
C     THE 3S/3P CORE, '4D' IS THE 3D ORBITALS (NOT USED FOR K/CA),
C     '5SP' IS THE INNER VALENCE, '6SP' IS THE OUTER VALENCE ORBITALS,
C     '7D' IS A D-TYPE POLARIZATION FUNCTION, AND '8SP' IS AN
C     SP-TYPE DIFFUSE FUNCTION.
C     RB-XE: '1S' IS THE 1S CORE, '2SP' IS THE 2S/2P CORE, '3SP' IS
C     THE 3S/3P CORE, '4D' IS THE 3D CORE, '5SP' IS THE 4S/4P CORE,
C     '6D' IS THE 4D ORBITALS (NOT USED FOR RB/XE), '7SP' IS THE INNER
C     VALENCE, '8SP' IS THE OUTER VALENCE ORBITALS, '9D' IS A
C     D-TYPE POLARIZATION FUNCTION, AND '10SP' IS AN SP-TYPE DIFFUSE
C     FUNCTION.
C
C     FOR THE N-M11G BASIS SETS:
C     H-HE: '1S', '2S' AND '3S' ARE THE INNER, MIDDLE AND OUTER VALENCE
C     ORBITALS, '4P' IS A P-TYPE POLARIZATION FUNCTION, AND '5S' IS
C     AN S-TYPE DIFFUSE FUNCTION.
C     LI-NE: '1S' IS THE 1S CORE, '2SP', '3SP' AND '4SP' ARE THE INNER,
C     MIDDLE AND OUTER VALENCE ORBITALS, '5D' IS A D-TYPE
C     POLARIZATION FUNCTION, AND '6SP' IS AN SP-TYPE DIFFUSE FUNCTION.
C
C     NOTE: ALL CENTERS ON THE CENTERS CARD MUST HAVE THE SAME
C     ATOMIC NUMBER.
C*
C     CARDS 5 AND 8
C     **** IN COLUMNS 1 TO 4 TELLS THE PROGRAM TO PROCEED ON TO THE
C     SPECIFICATION OF ANOTHER SET OF CENTERS
C*
C     CARD 9
C     A BLANK CARD SIGNIFIES THE END OF THE BASIS SET INPUT
C*
C     NOTE: IF THE S=P CONSTRAINT IS LIFTED, THEN THE SHELL CAN
C     CONTAIN ONLY 1 TYPE OF AO (IE S OR P).
C     THUS A COMPLETELY NON-CONSTRAINED BASIS SET WITH
C     THE SAME NUMBER OF AO'S WILL HAVE ABOUT TWICE AS MANY SHELLS
C     AS THE CONSTRAINED ONE, AND THE ONE ELECTRON INTEGRAL ROUTINES
C     CANNOT USE THE INTEGRALS OVER THE S FUNCTIONS THAT ARE ASSUMED TO
C     BE IN EACH P SHELL. THE TWO ELECTRON INTEGRAL ROUTINES WILL
C     EVALUATE AND KEEP ANY 'FREE' S INTEGRALS IN P SHELLS SO
C     THE S COEFFICIENTS MUST BE ZERO IN UNCONSTRAINED P SHELLS.
C     NOTE ... A D/F SHELL MAY NEVER CONTAIN S OR P BASIS FUNCTIONS.
C==
C*
C/
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C#
C     PARAMETER (NA=#NA, NB=#NB)
C     PARAMETER (NS=#NS, NP=#NP)
C##
      PARAMETER (NA= 36, NB=200)
      PARAMETER (NS=120, NP=300)
C###
      PARAMETER (ZERO=0.0D0)
C
      INTEGER SHELLA,SHELLN,SHELLT,AOS,SHELLC
C
      COMMON /A/ IOP(99)
      COMMON /A/ NATOMS,ICHARG,MULTIP,IAN(NA),NAE,NBE,NE,NBASIS,C(NA,3)
      COMMON /A/ CDUM(4),ICDUM(401)
C
      COMMON/B/IXYZ(NS),SHELLA(NS),SHELLN(NS),SHELLT(NS),
     1 SHELLC(NS),AOS(NS),NSHLL,MAXTYP,EXX(NP),C1(NP),C2(NP)
      COMMON/SCAL/SCALE(NS),C1S(NP),C2S(NP)
      COMMON /BSINFC/ NSH(NB), LAO(NB), LABEL(NS), LSHELL(NS),
     1 BLABEL
      COMMON/IO/IN,IOUT,IODUM(215)
C
      CHARACTER ICODE*1,ZNS*1,LSHELL*2,NSTO*2,LORB*2,ISHELL*72,NSH*2
      CHARACTER*4 LA,LAO,LABEL,JBASIS,IBASIS,JORB,ISPAST,IORB
      CHARACTER BLABEL*200
C*
      DIMENSION JBASIS(12),JORB(7),ICENT(30)
      DIMENSION ICODE(13),NSTO(10),E(10),CS(10),CP(10),LA(44)
      DIMENSION NM1G(10,5,5), NM11G(10,5,5)
      DIMENSION JCENT(NA)
C
      DATA JBASIS/'3-21','4-31','5-31','6-31','421P','6-21','4-21',
     1 '6311','STO ',' STO','    ','****'/
      DATA JORB/'S   ','P   ','SP  ','D   ','F   ','S*  ','D*  '/
      DATA NSTO/' 1', ' 2', ' 3', ' 4', ' 5', ' 6', ' 7', ' 8', ' 9',
     1 '10'/
      DATA ISPAST/'SP* '/
      DATA ICODE/'1', '2', '3', '4', '5', '6', '7',
     1 '8', '9', 'A', '0', 'D', 'E'/
C
C     NM1G(LORB,IORB,ROW) AND NM11G(LORB,IORB,ROW) ARE 3-DIMENSIONAL
C     ARRAYS CONTAINING ALL THE COMBINATIONS OF LORB (SHELL LABEL OR
C     NUMBER), IORB (SHELL TYPE) AND ROW (ROW OF THE PERIODIC TABLE).
C     LEGAL COMBINATIONS ARE INDICATED BY 0, ILLEGAL ONES BY 1.
C
      DATA NM1G/
C     ROW 1    S                    P                    SP
     1 0,0,1,0,1,1,1,1,1,1, 1,1,0,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1,
C     ROW 1    D                    F
     2 1,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1,
C     ROW 2    S                    P                    SP
     3 0,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1, 1,0,0,1,0,1,1,1,1,1,
C     R0W 2    D                    F
     4 1,1,1,0,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1,
C     ROW 3    S                    P                    SP
     5 0,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1, 1,0,0,0,1,0,1,1,1,1,
C     ROW 3    D                    F
     6 1,1,1,1,0,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1,
C     ROW 4    S                    P                    SP
     7 0,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1, 1,0,0,1,0,0,1,0,1,1,
C     ROW 4    D                    F
     8 1,1,1,0,1,1,0,1,1,1, 1,1,1,1,1,1,1,1,1,1,
C     ROW 5    S                    P                    SP
     9 0,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1, 1,0,0,1,0,1,0,0,1,0,
C     ROW 5    D                    F
     A 1,1,1,0,1,0,1,1,0,1, 1,1,1,1,1,1,1,1,1,1/
C
      DATA NM11G/
C     ROW 1    S                    P                    SP
     1 0,0,0,1,0,1,1,1,1,1, 1,1,1,0,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1,
C     ROW 1    D                    F
     2 1,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1,
C     ROW 2    S                    P                    SP
     3 0,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1, 1,0,0,0,1,0,1,1,1,1,
C     R0W 2    D                    F
     4 1,1,1,1,0,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1,
C     ROW 3    S                    P                    SP
     5 1,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1,
C     ROW 3    D                    F
     6 1,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1,
C     ROW 4    S                    P                    SP
     7 1,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1,
C     ROW 4    D                    F
     8 1,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1,
C     ROW 5    S                    P                    SP
     9 1,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1,
C     ROW 5    D                    F
     A 1,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1/
C*
 1000 FORMAT(A72)
 1005 FORMAT(30I2)
 1010 FORMAT(A4,2A2,F12.6)
 1020 FORMAT(3F20.10)
 1030 FORMAT('0CENTER',I3,' SPECIFIED TWICE')
 1040 FORMAT('0ILLEGAL SHELL TYPE ',2A2,' FOR BASIS SET TYPE ',A4,
     1 ' FOR CENTERS:'/1X,30I3)
 1050 FORMAT('0ILLEGAL BASIS SET TYPE ',A4,' FOR ',A4,2A2,F12.6)
 1060 FORMAT('0BASIS FUNCTIONS FOR CENTER',I3,' OMITTED')
 1070 FORMAT('0BASIS SET ERROR - P SHELL FOR CENTER',I3,
     1 ' CONTAINS S BASIS FUNCTIONS')
 1080 FORMAT('0BASIS IS NOT G* BUT D/F SHELL TYPE FOUND FOR CENTERS:'/
     1 1X,30I3)
 1090 FORMAT('0ERROR ON SHELL SPECIFICATION CARD AT COLUMN',I3,' :'/
     1 1X,A72)
 1100 FORMAT('0NUMBER OF GAUSSIANS PER SHELL NOT SAME FOR CENTERS:'/
     1 1X,30I3)
 1110 FORMAT('0',I4,' CENTERS SPECIFIED ON SHELL CARD BUT NATOMS IS',I3)
 1120 FORMAT('0FOR CENTER',I3,', MORE SHELLS DEFINED THAN WERE ',
     1 'SPECIFIED ON THE SHELL CARD')
 1130 FORMAT('0FOR CENTER',I3,', A SHELL SPECIFIED ON THE SHELL CARD ',
     1 'WAS NOT DEFINED')
 1140 FORMAT('0CENTER',I3,' IS A DUMMY ATOM - NO BASIS FUNCTIONS ',
     1 'PERMITTED')
 1150 FORMAT('0BASIS SET ERROR - S/D/F SHELL FOR CENTER',I3,
     1 ' CONTAINS P BASIS FUNCTION COEFFICIENTS')
 1160 FORMAT('0TOO MANY GAUSSIANS IN ',2A2,' SHELL FOR CENTERS:'/
     1 1X,30I3)
 1170 FORMAT('0BASIS SET ',A4,' IS NOT AVAILABLE FOR CENTERS:'/1X,30I3)
 1180 FORMAT('0ATOMIC NUMBERS ARE NOT THE SAME FOR BASIS SET ',A4,
     1 ' FOR CENTERS:'/1X,30I3)
 1190 FORMAT('0NUMBER OF GAUSSIANS PER SHELL NOT SAME AS ON SHELL ',
     1 'CARD FOR BASIS ',A4,' SHELL ',2A2,' FOR CENTERS:'/1X,30I3)
 1200 FORMAT('0TOO MANY SHELLS - MAXIMUM IS',I4)
 1210 FORMAT('0ATOM NUMBER',I3,' DOES NOT EXIST.')
C*
C     SET POINTERS INTO AO LABEL ARRAY FOR D/F ORBITALS.
      ND=6-IOP(8)
      NF=10-3*IOP(8)
      LDIND=4
      LFIND=10
      IF(IOP(8).EQ.0)GO TO 900
      LDIND=28
      LFIND=33
  900 NCENT=0
      NSHELL=0
      MM=1
C     KN HAS THE FIRST SHELL NUMBER FOR THE CURRENT CENTER
      KN=1
C     JCENT CONTAINS THE FIRST SHELL NUMBERS FOR THE CENTERS, ZERO IT
      DO 1 I=1,NATOMS
    1 JCENT(I)=0
C     IXYZ IS USED TO ENSURE ALL SHELLS ARE DEFINED:
C     IXYZ(I) = 0  SHELL NOT TO BE USED.
C               N  SHELL HAS BEEN DEFINED ON CENTER N.
C              -N  SHELL TO BE DEFINED ON CENTER N.
      DO 2 I=1,MXSHLL
    2 IXYZ(I)=0
C     IZ IS A FLAG FOR THE LAST SHELL SPECIFICATION READ
C     IZ = 1  0 WAS READ LAST
C     IZ = 0  NUMBER (1-A) WAS READ LAST
C     IZ =-1  DUMMY ATOM WAS READ LAST
      IZ=1
    3 READ (IN,1000) ISHELL
      DO 10 I=1,72
      ZNS=ISHELL(I:I)
      CALL UPPER (ZNS)
      DO 4 J=1,13
      IF(ZNS.EQ.ICODE(J))GO TO 6
    4 CONTINUE
      GO TO 5
    6 IF(J.EQ.13)GO TO 11
      IF(J.LE.10)GO TO 8
      IF(J.EQ.12)GO TO 7
C     ZERO FOUND
C     ARE THERE 2 ZEROES IN A ROW
      IF(IZ.EQ.1)GO TO 5
      NCENT=NCENT+1
C     WAS PREVIOUS ATOM A DUMMY
      IF(IZ.EQ.0)JCENT(NCENT)=KN
      KN=NSHELL+1
      IZ=1
      GO TO 10
C     DUMMY ATOM
    7 IF(IZ.NE.1)GO TO 5
      ICC = NCENT + 1
      IF (IAN(ICC) .NE. 0) GO TO 5
      IZ=-1
      GO TO 10
C     GET NUMBER OF GAUSSIANS IN A SHELL.
    8 IF(IZ.EQ.-1)GO TO 5
      ICC = NCENT + 1
      IF (IAN(ICC) .EQ. 0) GO TO 310
      NSHELL=NSHELL+1
      IF(NSHELL.GT.MXSHLL)GO TO 340
      IXYZ(NSHELL)=-ICC
      SHELLA(NSHELL)=MM
      SHELLN(NSHELL)=J
      MM=MM+J
      IZ=0
   10 CONTINUE
      GO TO 3
C
   11 IF(IZ.NE.1)GO TO 5
      IF(NCENT.EQ.NATOMS)GO TO 12
      WRITE(IOUT,1110)NCENT,NATOMS
      IOP(1)=-2
      RETURN
C     SHELL SPECIFICATION CARD ERROR.
    5 WRITE(IOUT,1090)I,ISHELL
      IOP(1)=-2
      RETURN
C*
C     READ CENTERS AND BASIS FUNCTIONS.
C*
   12 READ (IN,1005) ICENT
      IF(ICENT(1).LE.0)GO TO 180
      DO 30 I=1,30
      ICC=ICENT(I)
      IF(ICC.LE.0)GO TO 40
      IF(ICC.GT.NATOMS)GO TO 350
      IF(JCENT(ICC).LE.0)GO TO 260
   30 NCENT=I
C     KN COUNTS SHELLS ON THE CURRENT CENTERS.
   40 KN=0
   45 READ (IN,1010) IBASIS,LORB,IORB,SC
      CALL UPPER (IBASIS)
      CALL UPPER (IORB)
      IF(IBASIS.NE.JBASIS(12))GO TO 50
C     END OF FUNCTION SPECIFICATION FOR THESE CENTERS
C     ZERO THE JCENT VALUES FOR THESE CENTERS
      DO 49 I=1,NCENT
      ICC=ICENT(I)
   49 JCENT(ICC)=0
      GO TO 12
C     MAKE SURE ALL CENTERS HAVE THE SAME NUMBER OF GAUSSIANS
C     SPECIFIED FOR THIS SHELL.
   50 ICC=ICENT(1)
      JCC=JCENT(ICC)
      NGAUSS=SHELLN(JCC+KN)
      DO 60 I=1,NCENT
      ICC=ICENT(I)
      JCC=JCENT(ICC)
      IF(JCC.LE.0)GO TO 300
C     ENSURE THIS SHELL BELONGS TO THIS CENTER.
      IF(IXYZ(JCC+KN).NE.-ICC)GO TO 300
      IF(SHELLN(JCC+KN).NE.NGAUSS)GO TO 290
   60 CONTINUE
      IF(IBASIS.NE.JBASIS(11))GO TO 70
C     READ EXPONENTS AND COEFFICIENTS.
      READ (IN,1020) (E(I),CS(I),CP(I),I=1,NGAUSS)
C     CHECK SHELL TYPE.
      DO 65 I=1,5
      ITYPE=I
      IF(IORB.EQ.JORB(I))GO TO 150
   65 CONTINUE
      GO TO 85
C     GET INTERNAL BASIS SET CODE, AND SHELL TYPE.
   70 DO 71 IBCODE=1,10
      IF(IBASIS.EQ.JBASIS(IBCODE))GO TO 75
   71 CONTINUE
      GO TO 250
   75 IF(NGAUSS.GT.6)GO TO 330
      DO 80 I=1,7
      ITYPE=I
      IF(IORB.EQ.JORB(I))GO TO 90
   80 CONTINUE
   85 WRITE(IOUT,1040)LORB,IORB,IBASIS,(ICENT(I),I=1,NCENT)
      IOP(1)=-2
      RETURN
   90 DO 95 I=1,NGAUSS
      E(I)=ZERO
      CS(I)=ZERO
   95 CP(I)=ZERO
      IF(IBCODE.LE.8)GO TO 500
C*
C     INTERNAL STO-NG BASIS SET.
C*
      GO TO (101,110,120,130,85,140,145),ITYPE
C     S TYPE.
  101 IF(LORB.NE.NSTO(1))GO TO 102
      CALL S1S(E,CS,NGAUSS)
      GO TO 150
  102 IF(LORB.NE.NSTO(2))GO TO 103
      CALL S2S(E,CS,NGAUSS)
      GO TO 150
  103 IF(LORB.NE.NSTO(3))GO TO 104
      CALL S3S(E,CS,NGAUSS)
      GO TO 150
  104 IF(LORB.NE.NSTO(4))GO TO 85
      CALL S4S(E,CS,NGAUSS)
      GO TO 150
C     P TYPE.
  110 IF(LORB.NE.NSTO(2))GO TO 111
      CALL S2P(E,CP,NGAUSS)
      GO TO 150
  111 IF(LORB.NE.NSTO(3))GO TO 112
      CALL S3P(E,CP,NGAUSS)
      GO TO 150
  112 IF(LORB.NE.NSTO(4))GO TO 85
      CALL S4P(E,CP,NGAUSS)
      GO TO 150
C     SP TYPE.
  120 IF(LORB.NE.NSTO(2))GO TO 121
      IF(NGAUSS.EQ.1)GO TO 515
      CALL S2SP(E,CS,CP,NGAUSS)
      GO TO 150
  121 IF(LORB.NE.NSTO(3))GO TO 122
      CALL S3SP(E,CS,CP,NGAUSS)
      GO TO 150
  122 IF(LORB.NE.NSTO(4))GO TO 123
      IF(NGAUSS.EQ.1)GO TO 515
      CALL S4SP(E,CS,CP,NGAUSS)
      GO TO 150
  123 IF(LORB.NE.NSTO(5))GO TO 85
      IF(NGAUSS.EQ.1)GO TO 515
      CALL S5SP(E,CS,CP,NGAUSS)
      GO TO 150
C     D TYPE.
  130 IF(LORB.NE.NSTO(3))GO TO 85
      CALL S3D(E,CS,NGAUSS)
      GO TO 150
C     SP FROM SPD.
  140 IF(LORB.NE.NSTO(3))GO TO 141
      IF(NGAUSS.EQ.1)GO TO 515
      CALL S3SPD1(E,CS,CP,NGAUSS)
      IORB=ISPAST
      GO TO 150
  141 IF(LORB.NE.NSTO(4))GO TO 85
      IF(NGAUSS.EQ.1)GO TO 515
      CALL S4SPD1(E,CS,CP,NGAUSS)
      IORB=ISPAST
      GO TO 150
C     D FROM SPD.
  145 IF(LORB.NE.NSTO(3))GO TO 146
      IF(NGAUSS.EQ.1)GO TO 515
      CALL S3SPD2(E,CS,NGAUSS)
      GO TO 150
  146 IF(LORB.NE.NSTO(4))GO TO 85
      IF(NGAUSS.EQ.1)GO TO 515
      CALL S4SPD2(E,CS,NGAUSS)
      GO TO 150
C*
C     INTERNAL EXTENDED BASIS SET.
C*
  500 IF(ITYPE.GE.6)GO TO 85
C     ENSURE ALL ATOMIC NUMBERS ARE IDENTICAL FOR THESE CENTERS.
      I=ICENT(1)
      ICC=IAN(I)
      DO 510 J=1,NCENT
      I=ICENT(J)
      IF(ICC.EQ.IAN(I))GO TO 510
      WRITE(IOUT,1180)IBASIS,(ICENT(I),I=1,NCENT)
      IOP(1)=-2
      RETURN
  510 CONTINUE
      IF((ICC.GT.0.AND.ICC.LE.20) .OR. (ICC.GE.31.AND.ICC.LE.38) .OR.
     1 (ICC.GE.49.AND.ICC.LE.54)) GO TO 520
  515 WRITE(IOUT,1170)IBASIS,(ICENT(I),I=1,NCENT)
      IOP(1)=-2
      RETURN
C     INTERPRET LORB AS A SHELL NUMBER.
  520 DO 530 JSHELL=1,10
      IF(LORB.EQ.NSTO(JSHELL))GO TO 540
  530 CONTINUE
      GO TO 85
C     BRANCH DEPENDING ON ATOMIC NUMBER.
  540 IF(ICC.GT.2)GO TO 550
C     H-HE.
      IF(IBCODE.NE.8.AND.NM1G(JSHELL,ITYPE,1).NE.0)GO TO 85
      IF(IBCODE.EQ.8.AND.NM11G(JSHELL,ITYPE,1).NE.0)GO TO 85
      CALL EZERO(E,CS,CP,ICC,IBCODE,JSHELL,NG)
      GO TO 600
C     LI-NE.
  550 IF(ICC.GT.10)GO TO 560
      IF(IBCODE.NE.8.AND.NM1G(JSHELL,ITYPE,2).NE.0)GO TO 85
      IF(IBCODE.EQ.8.AND.NM11G(JSHELL,ITYPE,2).NE.0)GO TO 85
      CALL EONE(E,CS,CP,ICC,IBCODE,JSHELL,NG)
      GO TO 600
C     NA-AR.
  560 IF (ICC .GT. 18) GO TO 570
      IF(IBCODE.NE.8.AND.NM1G(JSHELL,ITYPE,3).NE.0)GO TO 85
      IF(IBCODE.EQ.8.AND.NM11G(JSHELL,ITYPE,3).NE.0)GO TO 85
      CALL ETWO(E,CS,CP,ICC,IBCODE,JSHELL,NG)
      GO TO 600
C     K-KR.
  570 IF (ICC .GT. 36) GO TO 580
      IF(IBCODE.NE.8.AND.NM1G(JSHELL,ITYPE,4).NE.0)GO TO 85
      IF(IBCODE.EQ.8.AND.NM11G(JSHELL,ITYPE,4).NE.0)GO TO 85
      CALL ETHREE(E,CS,CP,ICC,IBCODE,JSHELL,NG)
      GO TO 600
C     RB-XE.
  580 IF(IBCODE.NE.8.AND.NM1G(JSHELL,ITYPE,5).NE.0)GO TO 85
      IF(IBCODE.EQ.8.AND.NM11G(JSHELL,ITYPE,5).NE.0)GO TO 85
      CALL EFOUR(E,CS,CP,ICC,IBCODE,JSHELL,NG)
C     ENSURE NUMBER OF GAUSSIANS PER SHELL MATCHES THAT ON SHELL CARD.
  600 IF(NG.EQ.NGAUSS)GO TO 150
      WRITE(IOUT,1190)IBASIS,LORB,IORB,(ICENT(I),I=1,NCENT)
      IOP(1)=-2
      RETURN
C     CONVERT ITYPE INTO SHELL TYPE.
  150 GO TO (410,420,420,430,440,420,430),ITYPE
  410 ITYPE=0
      GO TO 450
  420 ITYPE=1
      GO TO 450
  430 ITYPE=2
      IF(IOP(7).EQ.0)GO TO 280
      GO TO 450
  440 ITYPE=3
      IF(IOP(7).EQ.0)GO TO 280
  450 DO 170 I=1,NCENT
      ICC=ICENT(I)
      JCC=JCENT(ICC)+KN
C     IF THIS IS THE LAST SHELL ON THIS CENTER (AS DETERMINED FROM THE
C     SHELL CARD), ZERO JCENT.
      IF(IXYZ(JCC+1).NE.-ICC)JCENT(ICC)=0
      SC2=SC*SC
      DO 160 J=1,NGAUSS
      J1=SHELLA(JCC)+J-1
      EXX(J1)=E(J)*SC2
      C1(J1)=CS(J)
  160 C2(J1)=CP(J)
      IXYZ(JCC)=ICC
      SHELLT(JCC)=ITYPE
      SCALE(JCC)=SC
      SHELLC(JCC)=0
      LSHELL(JCC)=LORB
  170 LABEL(JCC)=IORB
      KN=KN+1
      GO TO 45
C     SEE IF ALL CENTERS SPECIFIED
  180 DO 185 ICC=1,NATOMS
      IF(JCENT(ICC).EQ.0)GO TO 185
      WRITE(IOUT,1060)ICC
      IOP(1)=-2
  185 CONTINUE
      IF(IOP(1).LT.0)RETURN
C     SEE IF ALL SHELLS HAVE BEEN DEFINED.
      DO 190 I=1,NSHELL
      IF(IXYZ(I).GT.0)GO TO 190
      ICC=-IXYZ(I)
      WRITE(IOUT,1130)ICC
      IOP(1)=-2
  190 CONTINUE
      IF(IOP(1).LT.0)RETURN
C     SETUP CORRELATION TABLE BETWEEN SHELLS AND ATOMIC ORBITALS
C     THERE IS A PITFALL AT THIS POINT
C     THE INTEGRAL PACKAGE INSISTS ON DOING INTEGRALS FOR P SHELLS NOT
C     ONLY OVER THE FUNCTIONS REQUESTED, BUT ALSO ANY INTEGRALS
C     OVER FUNCTIONS OF LOWER QUANTUM NUMBER
C     THUS IF REQUEST P ... ROUTINE WILL DO S AND P
C     BUT IF REQUEST D OR F ... ROUTINE WILL DO JUST D OR F.
C     AND
C     WILL EXPECT THE FIRST AO OF A P SHELL TO BE OF S TYPE, SO
C     IF ONLY P TYPE IS DESIRED THEN WE MUST TRICK THE INTEGRAL PACKAGE
C     SO THAT THE P FUNCTION WILL BE THE FIRST AO.
C     ALSO INSERT THE AO LABELS IN COMMON /BSINFC/.
      NSTART=1
      DO 224 I=1,NSHELL
      AOS(I)=NSTART
      ITYPE=SHELLT(I)+1
      GO TO (200,205,210,215),ITYPE
  200 KN=1
      IZ=0
      GO TO 220
  205 KN=4
      IZ=0
      IF(LABEL(I).NE.JORB(2))GO TO 220
C     P SHELL, NO S FUNCTION INCLUDED.
      SHELLC(I)=1
      AOS(I)=AOS(I)-1
      KN=3
      IZ=1
      GO TO 220
  210 KN=ND
      IZ=LDIND
      GO TO 220
  215 KN=NF
      IZ=LFIND
  220 NM1=NSTART-1
      DO 222 J=1,KN
      NSH(NM1+J)=LSHELL(I)
  222 LAO(NM1+J)=LA(IZ+J)
  224 NSTART=NSTART+KN
      NBASIS=NSTART-1
C     IF S=P CONSTRAINT HAS BEEN LIFTED, ENSURE P SHELLS
C     CONTAIN NO S TYPE ORBITALS
      DO 240 I=1,NSHELL
C     P SHELLS MAY CONTAIN S SHELLS IF S=P CONSTRAINT IN EFFECT
      IF(SHELLC(I).EQ.0)GO TO 230
C     ALL S COEFFICIENTS MUST BE ZERO FOR P SHELLS
      MM=SHELLA(I)
      NORB=MM+SHELLN(I)-1
      DO 225 J=MM,NORB
      IF(C1(J).NE.ZERO)GO TO 270
  225 CONTINUE
C     CHECK THAT S/D/F SHELLS CONTAIN NO P FUNCTIONS.
  230 IF(SHELLT(I).EQ.1)GO TO 240
      MM=SHELLA(I)
      NORB=MM+SHELLN(I)-1
      DO 235 J=MM,NORB
      IF(C2(J).NE.ZERO)GO TO 320
  235 CONTINUE
  240 CONTINUE
C     COPY NUMBER OF SHELLS INTO COMMON B - SAVED SEPARATELY AS A
C     SAFETY FEATURE IN CASE NSHELL BECOMES TOO LARGE.
      NSHLL=NSHELL
      RETURN
C
C     BASIS FUNCTION TYPE NOT LEGAL.
  250 WRITE(IOUT,1050)IBASIS,IBASIS,LORB,IORB,SC
      IOP(1)=-2
      RETURN
C     CENTER ICC SPECIFIED TWICE, UNLESS IT IS A DUMMY ATOM.
  260 IF(IAN(ICC).EQ.0)GO TO 310
      WRITE(IOUT,1030)ICC
      IOP(1)=-2
      RETURN
C     UNCONSTRAINED BASIS SET CONTAINS MIXED SHELLS
  270 WRITE(IOUT,1070)IXYZ(I)
      IOP(1)=-2
      RETURN
C     D/F SHELL TYPE FOUND BUT IOP(7)=0.
  280 WRITE(IOUT,1080)(ICENT(I),I=1,NCENT)
      IOP(1)=-2
      RETURN
C     NUMBER OF GAUSSIANS SPECIFIED NOT SAME FOR ALL CENTERS.
  290 WRITE(IOUT,1100)(ICENT(I),I=1,NCENT)
      IOP(1)=-2
      RETURN
C     ATTEMPT TO PUT TOO MANY SHELLS ON A CENTER.
  300 WRITE(IOUT,1120)ICC
      IOP(1)=-2
      RETURN
C     BASIS SET SPECIFIED FOR A DUMMY ATOM.
  310 WRITE(IOUT,1140)ICC
      IOP(1)=-2
      RETURN
C     S/D/F SHELL CONTAINS P FUNCTIONS.
  320 WRITE(IOUT,1150)IXYZ(I)
      IOP(1)=-2
      RETURN
C     TOO MANY GAUSSSIANS FOR STO TYPE ORBITAL.
  330 WRITE(IOUT,1160)LORB,IORB,(ICENT(I),I=1,NCENT)
      IOP(1)=-2
      RETURN
C     TOO MANY SHELLS.
  340 WRITE(IOUT,1200)MXSHLL
      IOP(1)=-2
      RETURN
C     ILLEGAL CENTER NUMBER.
  350 WRITE(IOUT,1210)ICC
      IOP(1)=-2
      RETURN
      END
      SUBROUTINE S1S(EXX,CS,NGAUSS)
C*
C     --------------
C     QCPE VERSION
C     DECEMBER 1971
C     --------------
C*
C     LEAST SQUARES FITS TO SLATER 1S FUNCTIONS
C     BY GAUSSIAN 1S FUNCTIONS
C*
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      DIMENSION EXX(6),CS(6)
C*
      GO TO (1,2,3,4,5,6),NGAUSS
C     *****************************************************************
    1 CONTINUE
C*****************      STO(1S---1(1S))
C*********           ER1 4.3191E-02
      EXX(1)= 2.709498091D-01
      CS(1)= 1.000000000D 00
      RETURN
C     *****************************************************************
    2 CONTINUE
C*****************      STO(1S---2(1S))
C*********           ER1 3.1606E-03
      EXX(1)= 8.518186635D-01
      CS(1)= 4.301284983D-01
      EXX(2)= 1.516232927D-01
      CS(2)= 6.789135305D-01
      RETURN
C     *****************************************************************
    3 CONTINUE
C*****************      STO(1S---3(1S))
C*********           ER1 3.3053E-04
      EXX(1)= 2.227660584D 00
      CS(1)= 1.543289673D-01
      EXX(2)= 4.057711562D-01
      CS(2)= 5.353281423D-01
      EXX(3)= 1.098175104D-01
      CS(3)= 4.446345422D-01
      RETURN
C     *****************************************************************
    4 CONTINUE
C*****************      STO(1S---4(1S))
C*********           ER1 4.3763E-05
      EXX(1)= 5.216844534D 00
      CS(1)= 5.675242080D-02
      EXX(2)= 9.546182760D-01
      CS(2)= 2.601413550D-01
      EXX(3)= 2.652034102D-01
      CS(3)= 5.328461143D-01
      EXX(4)= 8.801862774D-02
      CS(4)= 2.916254405D-01
      RETURN
C     *****************************************************************
    5 CONTINUE
C*****************      STO(1S---5(1S))
C*********           ER1 6.8840E-06
      EXX(1)= 1.130563696D 01
      CS(1)= 2.214055312D-02
      EXX(2)= 2.071728178D 00
      CS(2)= 1.135411520D-01
      EXX(3)= 5.786484833D-01
      CS(3)= 3.318161484D-01
      EXX(4)= 1.975724573D-01
      CS(4)= 4.825700713D-01
      EXX(5)= 7.445271746D-02
      CS(5)= 1.935721966D-01
      RETURN
C     *****************************************************************
    6 CONTINUE
C*****************      STO(1S---6(1S))
C*********           ER1 1.2372E-06
      EXX(1)= 2.310303149D 01
      CS(1)= 9.163596280D-03
      EXX(2)= 4.235915534D 00
      CS(2)= 4.936149294D-02
      EXX(3)= 1.185056519D 00
      CS(3)= 1.685383049D-01
      EXX(4)= 4.070988982D-01
      CS(4)= 3.705627997D-01
      EXX(5)= 1.580884151D-01
      CS(5)= 4.164915298D-01
      EXX(6)= 6.510953954D-02
      CS(6)= 1.303340841D-01
      RETURN
      END
      SUBROUTINE S2S(EXX,CS,NGAUSS)
C*
C     --------------
C     QCPE VERSION
C     DECEMBER 1971
C     --------------
C*
C     LEAST SQUARES FITS TO SLATER 2S FUNCTIONS
C     BY GAUSSIAN 1S FUNCTIONS
C*
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      DIMENSION EXX(6),CS(6)
C*
      GO TO (1,2,3,4,5,6),NGAUSS
C     *****************************************************************
    1 CONTINUE
C*****************      STO(2S---1(1S))
C*********           ER1 6.2923E-03
      EXX(1)= 1.012151084D-01
      CS(1)= 1.000000000D 00
      RETURN
C     *****************************************************************
    2 CONTINUE
C*****************      STO(2S---2(1S))
C*********           ER1 2.6728E-03
      EXX(1)= 1.292278611D-01
      CS(1)= 7.470867124D-01
      EXX(2)= 4.908584205D-02
      CS(2)= 2.855980556D-01
      RETURN
C     *****************************************************************
    3 CONTINUE
C*****************      STO(2S---3(1S))
C*********           ER1 6.8661E-05
      EXX(1)= 2.581578398D 00
      CS(1)=-5.994474934D-02
      EXX(2)= 1.567622104D-01
      CS(2)= 5.960385398D-01
      EXX(3)= 6.018332272D-02
      CS(3)= 4.581786291D-01
      RETURN
C     *****************************************************************
    4 CONTINUE
C*****************      STO(2S---4(1S))
C*********           ER1 2.6974E-05
      EXX(1)= 1.161525551D 01
      CS(1)=-1.198411747D-02
      EXX(2)= 2.000243111D 00
      CS(2)=-5.472052539D-02
      EXX(3)= 1.607280687D-01
      CS(3)= 5.805587176D-01
      EXX(4)= 6.125744532D-02
      CS(4)= 4.770079976D-01
      RETURN
C     *****************************************************************
    5 CONTINUE
C*****************      STO(2S---5(1S))
C*********           ER1 2.7009E-06
      EXX(1)= 8.984956862D 00
      CS(1)=-1.596349096D-02
      EXX(2)= 1.673710636D 00
      CS(2)=-5.685884883D-02
      EXX(3)= 1.944726668D-01
      CS(3)= 3.698265599D-01
      EXX(4)= 8.806345634D-02
      CS(4)= 5.480512593D-01
      EXX(5)= 4.249068522D-02
      CS(5)= 1.472634893D-01
      RETURN
C     *****************************************************************
    6 CONTINUE
C******************     STO(2S---6(1S))
C*********           ER1 3.2726E-07
      EXX(1)= 2.768496241D 01
      CS(1)=-4.151277819D-03
      EXX(2)= 5.077140627D 00
      CS(2)=-2.067024148D-02
      EXX(3)= 1.426786050D 00
      CS(3)=-5.150303337D-02
      EXX(4)= 2.040335729D-01
      CS(4)= 3.346271174D-01
      EXX(5)= 9.260298399D-02
      CS(5)= 5.621061301D-01
      EXX(6)= 4.416183978D-02
      CS(6)= 1.712994697D-01
      RETURN
      END
      SUBROUTINE S2P(EXX,CS,NGAUSS)
C*
C     --------------
C     QCPE VERSION
C     DECEMBER 1971
C     --------------
C*
C     LEAST SQUARES FITS TO SLATER 2P FUNCTIONS
C     BY GAUSSIAN 2P FUNCTIONS
C*
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      DIMENSION EXX(6),CS(6)
C*
      GO TO (1,2,3,4,5,6),NGAUSS
C     *****************************************************************
    1 CONTINUE
C*****************      STO(2P---1(2P))
C*********           ER1 4.8232E-02
      EXX(1)= 1.759666885D-01
      CS(1)= 1.000000000D 00
      RETURN
C     *****************************************************************
    2 CONTINUE
C******************     STO(2P---2(2P))
C*********           ER1 3.0947E-03
      EXX(1)= 4.323908358D-01
      CS(1)= 4.522627513D-01
      EXX(2)= 1.069439065D-01
      CS(2)= 6.713122642D-01
      RETURN
C     *****************************************************************
    3 CONTINUE
C*****************      STO(2P---3(2P))
C*********           ER1 2.6858E-04
      EXX(1)= 9.192379002D-01
      CS(1)= 1.623948553D-01
      EXX(2)= 2.359194503D-01
      CS(2)= 5.661708862D-01
      EXX(3)= 8.009805746D-02
      CS(3)= 4.223071752D-01
      RETURN
C     *****************************************************************
    4 CONTINUE
C*****************      STO(2P---4(2P))
C*********           ER1 2.9037E-05
      EXX(1)= 1.798260992D 00
      CS(1)= 5.713170255D-02
      EXX(2)= 4.662622228D-01
      CS(2)= 2.857455515D-01
      EXX(3)= 1.643718620D-01
      CS(3)= 5.517873105D-01
      EXX(4)= 6.543927065D-02
      CS(4)= 2.632314924D-01
      RETURN
C     *****************************************************************
    5 CONTINUE
C*****************      STO(2P---5(2P))
C*********           ER1 3.7171E-06
      EXX(1)= 3.320386533D 00
      CS(1)= 2.079051117D-02
      EXX(2)= 8.643257633D-01
      CS(2)= 1.235472099D-01
      EXX(3)= 3.079819284D-01
      CS(3)= 3.667738886D-01
      EXX(4)= 1.273309895D-01
      CS(4)= 4.834930290D-01
      EXX(5)= 5.606243164D-02
      CS(5)= 1.653444074D-01
      RETURN
C     *****************************************************************
    6 CONTINUE
C*****************      STO(2P---6(2P))
C*********           ER1 5.4444E-07
      EXX(1)= 5.868285913D 00
      CS(1)= 7.924233646D-03
      EXX(2)= 1.530329631D 00
      CS(2)= 5.144104825D-02
      EXX(3)= 5.475665231D-01
      CS(3)= 1.898400060D-01
      EXX(4)= 2.288932733D-01
      CS(4)= 4.049863191D-01
      EXX(5)= 1.046655969D-01
      CS(5)= 4.012362861D-01
      EXX(6)= 4.948220127D-02
      CS(6)= 1.051855189D-01
      RETURN
      END
      SUBROUTINE S2SP(EXX,CS,CP,NGAUSS)
C*
C     --------------
C     QCPE VERSION
C     DECEMBER 1971
C     --------------
C*
C     SIMULTANEOUS LEAST SQUARES FITS TO SLATER 2S AND 2P FUNCTIONS
C     BY GAUSSIAN 1S AND 2P FUNCTIONS
C     COMMON GAUSSIAN EXPONENTS
C*
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      DIMENSION EXX(6),CS(6),CP(6)
C*
      GO TO (1,2,3,4,5,6),NGAUSS
C     *****************************************************************
    1 CONTINUE
C*****************      STO(2S---1(1S),2P---1(2P))
      EXX(1)=0.0D0
      CS(1)=0.0D0
      CP(1)=0.0D0
      RETURN
C     *****************************************************************
    2 CONTINUE
C*****************      STO(2S---2(1S),2P---2(2P))
C*********           ER1 5.5955E-03      ER2 3.4793E-03
      EXX(1)= 3.842442531D-01
      CS(1)= 4.947176920D-02
      CP(1)= 5.115407076D-01
      EXX(2)= 9.745448900D-02
      CS(2)= 9.637824081D-01
      CP(2)= 6.128198961D-01
      RETURN
C     *****************************************************************
    3 CONTINUE
C*****************      STO(2S---3(1S),2P---3(2P))
C*********           ER1 6.4229E-04      ER2 3.6036E-04
      EXX(1)= 9.942027296D-01
      CS(1)=-9.996722919D-02
      CP(1)= 1.559162750D-01
      EXX(2)= 2.310313333D-01
      CS(2)= 3.995128261D-01
      CP(2)= 6.076837186D-01
      EXX(3)= 7.513856000D-02
      CS(3)= 7.001154689D-01
      CP(3)= 3.919573931D-01
      RETURN
C     *****************************************************************
    4 CONTINUE
C*****************      STO(2S---4(1S),2P---4(2P))
C*********           ER1 7.9474E-05      ER2 4.8191E-05
      EXX(1)= 2.323503675D 00
      CS(1)=-6.220714565D-02
      CP(1)= 4.368434884D-02
      EXX(2)= 5.029886906D-01
      CS(2)= 2.976804596D-05
      CP(2)= 2.863793984D-01
      EXX(3)= 1.635406719D-01
      CS(3)= 5.588549221D-01
      CP(3)= 5.835753141D-01
      EXX(4)= 6.281044213D-02
      CS(4)= 4.977673218D-01
      CP(4)= 2.463134378D-01
      RETURN
C     *****************************************************************
    5 CONTINUE
C*****************      STO(2S---5(1S),2P---5(2P))
C*********           ER1 1.1708E-05      ER2 7.2753E-06
      EXX(1)= 5.036294248D 00
      CS(1)=-2.940855088D-02
      CP(1)= 1.255609128D-02
      EXX(2)= 1.032503477D 00
      CS(2)=-6.532746883D-02
      CP(2)= 1.075576962D-01
      EXX(3)= 3.290598322D-01
      CS(3)= 1.289973181D-01
      CP(3)= 3.735975367D-01
      EXX(4)= 1.279200125D-01
      CS(4)= 6.122899938D-01
      CP(4)= 5.102395637D-01
      EXX(5)= 5.449486448D-02
      CS(5)= 3.461205655D-01
      CP(5)= 1.568281801D-01
      RETURN
C     *****************************************************************
    6 CONTINUE
C*****************      STO(2S---6(1S),2P---6(2P))
C*********           ER1 2.0132E-06      ER2 1.2173E-06
      EXX(1)= 1.030869372D 01
      CS(1)=-1.325278809D-02
      CP(1)= 3.759696623D-03
      EXX(2)= 2.040359519D 00
      CS(2)=-4.699171014D-02
      CP(2)= 3.767936984D-02
      EXX(3)= 6.341422177D-01
      CS(3)=-3.378537151D-02
      CP(3)= 1.738967435D-01
      EXX(4)= 2.439773685D-01
      CS(4)= 2.502417861D-01
      CP(4)= 4.180364347D-01
      EXX(5)= 1.059595374D-01
      CS(5)= 5.951172526D-01
      CP(5)= 4.258595477D-01
      EXX(6)= 4.856900860D-02
      CS(6)= 2.407061763D-01
      CP(6)= 1.017082955D-01
      RETURN
      END
      SUBROUTINE S3S(EXX,CS,NGAUSS)
C*
C     --------------
C     QCPE VERSION
C     DECEMBER 1971
C     --------------
C*
C     LEAST SQUARES FITS TO SLATER 3S FUNCTIONS
C     BY GAUSSIAN 1S FUNCTIONS
C*
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      DIMENSION EXX(6),CS(6)
C*
      GO TO (1,2,3,4,5,6),NGAUSS
C     *****************************************************************
    1 CONTINUE
C*****************      STO(3S---1(1S))
C*********           ER1 1.6764E-02
      EXX(1)= 5.296881757D-02
      CS(1)= 1.000000000D 00
      RETURN
C     *****************************************************************
    2 CONTINUE
C*****************      STO(3S---2(1S))
C*********           ER1 7.6424E-04
      EXX(1)= 6.694095822D-01
      CS(1)=-1.529645716D-01
      EXX(2)= 5.837135094D-02
      CS(2)= 1.051370110D 00
      RETURN
C     *****************************************************************
    3 CONTINUE
C*****************      STO(3S---3(1S))
C*********           ER1 8.0718E-05
      EXX(1)= 5.641487709D-01
      CS(1)=-1.782577972D-01
      EXX(2)= 6.924421391D-02
      CS(2)= 8.612761663D-01
      EXX(3)= 3.269529097D-02
      CS(3)= 2.261841969D-01
      RETURN
C     ******************************************************************
    4 CONTINUE
C*****************      STO(3S---4(1S))
C*********           ER1 1.7254E-06
      EXX(1)= 1.513265591D 00
      CS(1)=-3.295496352D-02
      EXX(2)= 4.262497508D-01
      CS(2)=-1.724516959D-01
      EXX(3)= 7.643320863D-02
      CS(3)= 7.518511194D-01
      EXX(4)= 3.760545063D-02
      CS(4)= 3.589627317D-01
      RETURN
C     ******************************************************************
    5 CONTINUE
C*****************      STO(3S---5(1S))
C*********           ER1 7.9816E-07
      EXX(1)= 4.275877914D 00
      CS(1)=-3.920358850D-03
      EXX(2)= 1.132409433D 00
      CS(2)=-4.168430506D-02
      EXX(3)= 4.016256968D-01
      CS(3)=-1.637440990D-01
      EXX(4)= 7.732370620D-02
      CS(4)= 7.419373723D-01
      EXX(5)= 3.800708627D-02
      CS(5)= 3.724364929D-01
      RETURN
C     ******************************************************************
    6 CONTINUE
C*****************      STO(3S---6(1S))
C*********           ER1 4.0662E-08
      EXX(1)= 3.273031938D 00
      CS(1)=-6.775596947D-03
      EXX(2)= 9.200611311D-01
      CS(2)=-5.639325779D-02
      EXX(3)= 3.593349765D-01
      CS(3)=-1.587856086D-01
      EXX(4)= 8.636686991D-02
      CS(4)= 5.534527651D-01
      EXX(5)= 4.797373812D-02
      CS(5)= 5.015351020D-01
      EXX(6)= 2.724741144D-02
      CS(6)= 7.223633674D-02
      RETURN
      END
      SUBROUTINE S3P(EXX,CS,NGAUSS)
C*
C     --------------
C     QCPE VERSION
C     DECEMBER 1971
C     --------------
C*
C     LEAST SQUARES FITS TO SLATER 3P FUNCTIONS
C     BY GAUSSIAN 2P FUNCTIONS
C*
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      DIMENSION EXX(6),CS(6)
C*
      GO TO (1,2,3,4,5,6),NGAUSS
C     ******************************************************************
    1 CONTINUE
C*****************      STO(3P---1(2P))
C*********           ER1 1.2745E-02
      EXX(1)= 9.113614253D-02
      CS(1)= 1.000000000D 00
      RETURN
C     ******************************************************************
    2 CONTINUE
C*****************      STO(3P---2(2P))
C*********           ER1 2.3771E-04
      EXX(1)= 1.458620964D-01
      CS(1)= 5.349653144D-01
      EXX(2)= 5.664210742D-02
      CS(2)= 5.299607212D-01
      RETURN
C     ******************************************************************
    3 CONTINUE
C*****************      STO(3P---3(2P))
C*********           ER1 1.3487E-04
      EXX(1)= 2.692880368D 00
      CS(1)=-1.061945788D-02
      EXX(2)= 1.489359592D-01
      CS(2)= 5.218564264D-01
      EXX(3)= 5.739585040D-02
      CS(3)= 5.450015143D-01
      RETURN
C     ******************************************************************
    4 CONTINUE
C*****************      STO(3P---4(2P))
C*********           ER1 2.9785E-06
      EXX(1)= 1.853180239D 00
      CS(1)=-1.434249391D-02
      EXX(2)= 1.915075719D-01
      CS(2)= 2.755177589D-01
      EXX(3)= 8.655487938D-02
      CS(3)= 5.846750879D-01
      EXX(4)= 4.184253862D-02
      CS(4)= 2.144986514D-01
      RETURN
C     *****************************************************************
    5 CONTINUE
C*****************      STO(3P---5(2P))
C*********           ER1 1.3387E-06
      EXX(1)= 6.466803859D 00
      CS(1)=-2.329023747D-03
      EXX(2)= 1.555914802D 00
      CS(2)=-1.357395221D-02
      EXX(3)= 1.955925255D-01
      CS(3)= 2.632185383D-01
      EXX(4)= 8.809647701D-02
      CS(4)= 5.880427024D-01
      EXX(5)= 4.234835707D-02
      CS(5)= 2.242794445D-01
      RETURN
C     *****************************************************************
    6 CONTINUE
C*****************      STO(3P---6(2P))
C*********           ER1 7.9285E-08
      EXX(1)= 5.077973607D 00
      CS(1)=-3.329929840D-03
      EXX(2)= 1.340786940D 00
      CS(2)=-1.419488340D-02
      EXX(3)= 2.248434849D-01
      CS(3)= 1.639395770D-01
      EXX(4)= 1.131741848D-01
      CS(4)= 4.485358256D-01
      EXX(5)= 6.076408893D-02
      CS(5)= 3.908813050D-01
      EXX(6)= 3.315424265D-02
      CS(6)= 7.411456232D-02
      RETURN
      END
      SUBROUTINE S3SP(EXX,CS,CP,NGAUSS)
C*
C     --------------
C     QCPE VERSION
C     DECEMBER 1971
C     --------------
C*
C     SIMULTANEOUS LEAST SQUARES FITS TO SLATER 3S AND 3P FUNCTIONS
C     BY GAUSSIAN 1S AND 2P FUNCTIONS
C     COMMON GAUSSIAN EXPONENTS
C*
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      DIMENSION EXX(6),CS(6),CP(6)
C*
      GO TO (1,2,3,4,5,6),NGAUSS
C     *****************************************************************
    1 CONTINUE
C*****************      STO(3S---1(1S),3P---1(2P))
C*********           ER1 5.2955E-02      ER2 4.1793E-02
      EXX(1)= 7.163507065D-02
      CS(1)= 1.000000000D 00
      CP(1)= 1.000000000D 00
      RETURN
C     *****************************************************************
    2 CONTINUE
C*****************      STO(3S---2(1S),3P---2(2P))
C*********           ER1 7.3952E-03      ER2 1.0928E-03
      EXX(1)= 1.939790354D-01
      CS(1)=-2.983986044D-01
      CP(1)= 3.480471912D-01
      EXX(2)= 6.655227113D-02
      CS(2)= 1.227982887D 00
      CP(2)= 7.222523221D-01
      RETURN
C     *****************************************************************
    3 CONTINUE
C*****************      STO(3S---3(1S),3P---3(2P))
C*********           ER1 3.1253E-04      ER2 2.7910E-04
      EXX(1)= 4.828540806D-01
      CS(1)=-2.196203690D-01
      CP(1)= 1.058760429D-02
      EXX(2)= 1.347150629D-01
      CS(2)= 2.255954336D-01
      CP(2)= 5.951670053D-01
      EXX(3)= 5.272656258D-02
      CS(3)= 9.003984260D-01
      CP(3)= 4.620010120D-01
      RETURN
C     *****************************************************************
    4 CONTINUE
C*****************      STO(3S---4(1S),3P---4(2P))
C*********           ER1 2.2403E-05      ER2 2.8610E-05
      EXX(1)= 9.217072439D-01
      CS(1)=-8.529019644D-02
      CP(1)=-2.504945181D-02
      EXX(2)= 2.534730123D-01
      CS(2)=-2.132074034D-01
      CP(2)= 1.686604461D-01
      EXX(3)= 9.976476472D-02
      CS(3)= 5.920843928D-01
      CP(3)= 6.409553151D-01
      EXX(4)= 4.439990833D-02
      CS(4)= 6.115584746D-01
      CP(4)= 2.779508957D-01
      RETURN
C     *****************************************************************
    5 CONTINUE
C*****************      STO(3S---5(1S),3P---5(2P))
C*********           ER1 1.9857E-06      ER2 3.5565E-06
      EXX(1)= 1.709113496D 00
      CS(1)=-2.662203391D-02
      CP(1)=-1.566883448D-02
      EXX(2)= 4.654245585D-01
      CS(2)=-1.603484072D-01
      CP(2)= 7.214920506D-03
      EXX(3)= 1.785129144D-01
      CS(3)=-4.779473307D-02
      CP(3)= 3.170854762D-01
      EXX(4)= 8.067420191D-02
      CS(4)= 7.275158441D-01
      CP(4)= 5.818821382D-01
      EXX(5)= 3.914669014D-02
      CS(5)= 4.123846408D-01
      CP(5)= 1.701799824D-01
      RETURN
C     *****************************************************************
    6 CONTINUE
C*****************      STO(3S---6(1S),3P---6(2P))
C*********           ER1 2.2088E-07      ER2 4.9043E-07
      EXX(1)= 3.080165240D 00
      CS(1)=-7.943126362D-03
      CP(1)=-7.139358907D-03
      EXX(2)= 8.248959202D-01
      CS(2)=-7.100264172D-02
      CP(2)=-1.829277070D-02
      EXX(3)= 3.093447349D-01
      CS(3)=-1.785026925D-01
      CP(3)= 7.621621428D-02
      EXX(4)= 1.384683897D-01
      CS(4)= 1.510635058D-01
      CP(4)= 4.145098597D-01
      EXX(5)= 6.852094951D-02
      CS(5)= 7.354914767D-01
      CP(5)= 4.889621471D-01
      EXX(6)= 3.531333690D-02
      CS(6)= 2.760593123D-01
      CP(6)= 1.058816521D-01
      RETURN
      END
      SUBROUTINE S3D(EXX,CD,NGAUSS)
C*
C     --------------
C     U OF T VERSION
C     JANUARY 1980
C     --------------
C*
C     LEAST SQUARES FITS TO SLATER 3D FUNCTIONS.
C     R. F. STEWART, J. CHEM. PHYS., 52, 431 (1970).
C*
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      DIMENSION EXX(6),CD(6)
C*
      GO TO (1,2,3,4,5,6),NGAUSS
    1 CONTINUE
C     ER1=5.0728E-02
      EXX(1)=1.302270363D-01
      CD(1) =1.0D 00
      RETURN
    2 CONTINUE
C     ER1=2.9834E-03
      EXX(1)=2.777427345D-01
      CD(1) =4.666137923D-01
      EXX(2)=8.336507714D-02
      CD(2) =6.644706516D-01
      RETURN
    3 CONTINUE
C     ER1=2.2687E-04
      EXX(1)=5.229112225D-01
      CD(1) =1.686596060D-01
      EXX(2)=1.639595876D-01
      CD(2) =5.847984817D-01
      EXX(3)=6.386630021D-02
      CD(3) =4.056779523D-01
      RETURN
    4 CONTINUE
C     ER1=2.1116E-05
      EXX(1)=9.185846715D-01
      CD(1) =5.799057705D-02
      EXX(2)=2.920461109D-01
      CD(2) =3.045581349D-01
      EXX(3)=1.187568890D-01
      CD(3) =5.601358038D-01
      EXX(4)=5.286755896D-02
      CD(4) =2.432423313D-01
      RETURN
    5 CONTINUE
C     ER1=2.3115E-06
      EXX(1)=1.539033958D 00
      CD(1) =2.020869128D-02
      EXX(2)=4.922090297D-01
      CD(2) =1.321157923D-01
      EXX(3)=2.029756928D-01
      CD(3) =3.911240346D-01
      EXX(4)=9.424112917D-02
      CD(4) =4.779609701D-01
      EXX(5)=4.569058269D-02
      CD(5) =1.463662294D-01
      RETURN
    6 CONTINUE
C     ER1=2.8899E-07
      EXX(1)=2.488296923D 00
      CD(1) =7.283828112D-03
      EXX(2)=7.981487853D-01
      CD(2) =5.386799363D-02
      EXX(3)=3.311327490D-01
      CD(3) =2.072139149D-01
      EXX(4)=1.559114463D-01
      CD(4) =4.266269092D-01
      EXX(5)=7.877734732D-02
      CD(5) =3.843100204D-01
      EXX(6)=4.058484363D-02
      CD(6) =8.902827546D-02
      RETURN
      END
      SUBROUTINE S3SPD1(EXX,CS,CP,NGAUSS)
C*
C     --------------
C     U OF T VERSION
C     FEBRUARY 1981
C     --------------
C*
C     SIMULTANEOUS LEAST SQUARES FITS TO SLATER 3S, 3P AND 3D FUNCTIONS.
C     THIS ROUTINE HANDLES ONLY THE 3SP PORTION OF THE BASIS - SEE
C     ROUTINE S3SPD2 FOR THE 3D PORTION.
C*
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      DIMENSION EXX(6),CS(6),CP(6)
C*
      GO TO (1,2,3,4,5,6),NGAUSS
    1 CONTINUE
C*****************      STO(3S---1(1S),3P---1(2P))
      EXX(1)= 0.0D0
      CS(1)= 0.0D0
      CP(1)= 0.0D0
      RETURN
    2 CONTINUE
C*****************      STO(3S---2(1S),3P---2(2P))
      EXX(1)= 2.23602D-1
      CS(1)=-3.12172D-1
      CP(1)= 2.94003D-1
      EXX(2)= 6.91573D-2
      CS(2)= 1.22540D0
      CP(2)= 7.80042D-1
      RETURN
    3 CONTINUE
C*****************      STO(3S---3(1S),3P---3(2P))
      EXX(1)= 4.55950D-1
      CS(1)=-2.27764D-1
      CP(1)= 4.95151D-3
      EXX(2)= 1.39079D-1
      CS(2)= 2.17544D-1
      CP(2)= 5.77766D-1
      EXX(3)= 5.36612D-2
      CS(3)= 9.16677D-1
      CP(3)= 4.84646D-1
      RETURN
    4 CONTINUE
C*****************      STO(3S---4(1S),3P---4(2P))
      EXX(1)= 8.64219D-1
      CS(1)=-8.88886D-2
      CP(1)=-2.58036D-2
      EXX(2)= 2.58758D-1
      CS(2)=-2.02619D-1
      CP(2)= 1.59141D-1
      EXX(3)= 1.02634D-1
      CS(3)= 5.45089D-1
      CP(3)= 6.28412D-1
      EXX(4)= 4.56280D-2
      CS(4)= 6.51702D-1
      CP(4)= 3.00984D-1
      RETURN
    5 CONTINUE
C*****************      STO(3S---5(1S),3P---5(2P))
      EXX(1)= 1.56001D0
      CS(1)=-2.99608D-2
      CP(1)=-1.66512D-2
      EXX(2)= 4.58958D-1
      CS(2)=-1.54905D-1
      CP(2)=-9.09022D-3
      EXX(3)= 1.81819D-1
      CS(3)=-5.89327D-2
      CP(3)= 2.98563D-1
      EXX(4)= 8.29517D-2
      CS(4)= 7.04419D-1
      CP(4)= 5.83201D-1
      EXX(5)= 4.00949D-2
      CS(5)= 4.44530D-1
      CP(5)= 1.86709D-1
      RETURN
    6 CONTINUE
C*****************      STO(3S---6(1S),3P---6(2P))
      EXX(1)= 2.73051D0
      CS(1)=-9.73740D-3
      CP(1)=-8.10494D-3
      EXX(2)= 7.86247D-1
      CS(2)=-7.26588D-2
      CP(2)=-1.71548D-2
      EXX(3)= 3.09251D-1
      CS(3)=-1.71616D-1
      CP(3)= 7.36979D-2
      EXX(4)= 1.41338D-1
      CS(4)= 1.28978D-1
      CP(4)= 3.96515D-1
      EXX(5)= 7.03391D-2
      CS(5)= 7.28861D-1
      CP(5)= 4.97808D-1
      EXX(6)= 3.61235D-2
      CS(6)= 3.01332D-1
      CP(6)= 1.17483D-1
      RETURN
      END
      SUBROUTINE S3SPD2(EXX,CD,NGAUSS)
C*
C     --------------
C     U OF T VERSION
C     FEBRUARY 1981
C     --------------
C*
C     LEAST SQUARES FITS TO SLATER 3S, 3P AND 3D FUNCTIONS.
C     THIS ROUTINE HANDLES ONLY THE 3D PORTION OF THE BASIS - SEE
C     ROUTINE S3SPD1 FOR THE 3SP PART.
C*
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      DIMENSION EXX(6),CD(6)
C*
      GO TO (1,2,3,4,5,6),NGAUSS
    1 CONTINUE
      EXX(1)=0.0D0
      CD(1) =0.0D0
      RETURN
    2 CONTINUE
      EXX(1)=2.23602D-1
      CD(1) =6.00604D-1
      EXX(2)=6.91573D-2
      CD(2) =5.29204D-1
      RETURN
    3 CONTINUE
      EXX(1)=4.55950D-1
      CD(1) =2.19768D-1
      EXX(2)=1.39079D-1
      CD(2) =6.55547D-1
      EXX(3)=5.36612D-2
      CD(3) =2.86573D-1
      RETURN
    4 CONTINUE
      EXX(1)=8.64219D-1
      CD(1) =6.92077D-2
      EXX(2)=2.58758D-1
      CD(2) =3.72816D-1
      EXX(3)=1.02634D-1
      CD(3) =5.66409D-1
      EXX(4)=4.56280D-2
      CD(4) =1.58595D-1
      RETURN
    5 CONTINUE
      EXX(1)=1.56001D0
      CD(1) =2.12997D-2
      EXX(2)=4.58958D-1
      CD(2) =1.57672D-1
      EXX(3)=1.81819D-1
      CD(3) =4.48517D-1
      EXX(4)=8.29517D-2
      CD(4) =4.49537D-1
      EXX(5)=4.00949D-2
      CD(5) =9.12249D-2
      RETURN
    6 CONTINUE
      EXX(1)=2.73051D0
      CD(1) =6.63343D-3
      EXX(2)=7.86247D-1
      CD(2) =5.95818D-2
      EXX(3)=3.09251D-1
      CD(3) =2.40195D-1
      EXX(4)=1.41338D-1
      CD(4) =4.64811D-1
      EXX(5)=7.03391D-2
      CD(5) =3.43409D-1
      EXX(6)=3.61235D-2
      CD(6) =5.38906D-2
      RETURN
      END
      SUBROUTINE S4S(EXX,CS,NGAUSS)
C*
C     --------------
C     U OF T VERSION
C     JANUARY 1980
C     --------------
C*
C     LEAST SQUARES FITS TO SLATER 4S FUNCTIONS.
C     R. F. STEWART, J. CHEM. PHYS., 52, 431 (1970).
C*
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      DIMENSION EXX(6),CS(6)
C*
      GO TO (1,2,3,4,5,6),NGAUSS
    1 CONTINUE
C     ER1=4.1760E-02
      EXX(1)=3.264600274D-02
      CS(1)= 1.0D 00
      RETURN
    2 CONTINUE
C     ER1=1.7480E-04
      EXX(1)=2.441785453D-01
      CS(1)=-3.046656896D-01
      EXX(2)=4.051097664D-02
      CS(2) =1.146877294D 00
      RETURN
    3 CONTINUE
C     ER1=1.6867E-05
      EXX(1)=2.267938753D-01
      CS(1)=-3.349048323D-01
      EXX(2)=4.448178019D-02
      CS(2)= 1.056744667D 00
      EXX(3)=2.195294664D-02
      CS(3)= 1.256661680D-01
      RETURN
    4 CONTINUE
C     ER1=8.4105E-07
      EXX(1)=3.242212833D-01
      CS(1)=-1.120682822D-01
      EXX(2)=1.663217177D-01
      CS(2)=-2.845426863D-01
      EXX(3)=5.081097451D-02
      CS(3)= 8.909873788D-01
      EXX(4)=2.829066600D-02
      CS(4)= 3.517811205D-01
      RETURN
    5 CONTINUE
C     ER1=6.0273E-08
      EXX(1)=2.980263783D 00
      CS(1)= 1.513948997D-03
      EXX(2)=3.792228833D-01
      CS(2)=-7.316801548D-02
      EXX(3)=1.789717224D-01
      CS(3)=-3.143703799D-01
      EXX(4)=5.002110360D-02
      CS(4)= 9.032615169D-01
      EXX(5)=2.789361681D-02
      CS(5)= 3.294210848D-01
      RETURN
    6 CONTINUE
C     ER1=5.9700E-09
      EXX(1)=3.232838646D 00
      CS(1)= 1.374817488D-03
      EXX(2)=3.605788802D-01
      CS(2)=-8.666390043D-02
      EXX(3)=1.717905487D-01
      CS(3)=-3.130627309D-01
      EXX(4)=5.277666487D-02
      CS(4)= 7.812787397D-01
      EXX(5)=3.163400284D-02
      CS(5)= 4.389247988D-01
      EXX(6)=1.874093091D-02
      CS(6)= 2.487178756D-02
      RETURN
      END
      SUBROUTINE S4P(EXX,CP,NGAUSS)
C*
C     --------------
C     U OF T VERSION
C     JANUARY 1980
C     --------------
C*
C     LEAST SQUARES FITS TO SLATER 4P FUNCTIONS.
C     R. F. STEWART, J. CHEM. PHYS., 52, 431 (1970).
C*
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      DIMENSION EXX(6),CP(6)
C*
      GO TO (1,2,3,4,5,6),NGAUSS
    1 CONTINUE
C     ER1=3.9516E-03
      EXX(1)=5.578350235D-02
      CP(1)= 1.0D 00
      RETURN
    2 CONTINUE
C     ER1=2.1579E-03
      EXX(1)=6.190052680D-02
      CP(1)= 8.743116767D-01
      EXX(2)=2.648418407D-02
      CP(2) =1.513640107D-01
      RETURN
    3 CONTINUE
C     ER1=1.2621E-05
      EXX(1)=4.859692220D-01
      CP(1)=-6.147823411D-02
      EXX(2)=7.430216918D-02
      CP(2)= 6.604172234D-01
      EXX(3)=3.653340923D-02
      CP(3)= 3.932639495D-01
      RETURN
    4 CONTINUE
C     ER1=5.4740E-06
      EXX(1)=1.492607880D 00
      CP(1)=-6.035216774D-03
      EXX(2)=4.327619272D-01
      CP(2)=-6.013310874D-02
      EXX(3)=7.553156064D-02
      CP(3)= 6.451518200D-01
      EXX(4)=3.706272183D-02
      CP(4)= 4.117923820D-01
      RETURN
    5 CONTINUE
C     ER1=1.3595D-07
      EXX(1)=1.091977298D 00
      CP(1)=-1.143929558D-02
      EXX(2)=3.719985051D-01
      CP(2)=-6.322651538D-02
      EXX(3)=8.590019352D-02
      CP(3)= 4.398907721D-01
      EXX(4)=4.786503860D-02
      CP(4)= 5.245859166D-01
      EXX(5)=2.730479990D-02
      CP(5)= 1.017072253D-01
      RETURN
    6 CONTINUE
C     ER1=1.3897E-08
      EXX(1)=2.389722618D 00
      CP(1)=-1.665913575D-03
      EXX(2)=7.960947826D-01
      CP(2)=-1.657464971D-02
      EXX(3)=3.415541380D-01
      CP(3)=-5.958513378D-02
      EXX(4)=8.847434525D-02
      CP(4)= 4.053115554D-01
      EXX(5)=4.958248334D-02
      CP(5)= 5.433958189D-01
      EXX(6)=2.816929784D-02
      CP(6)= 1.204970491D-01
      RETURN
      END
      SUBROUTINE S4SP(EXX,CS,CP,NGAUSS)
C*
C     --------------
C     U OF T VERSION
C     JANUARY 1981
C     --------------
C*
C     LEAST SQUARES FITS TO SLATER 4S AND 4P FUNCTIONS
C     BY GAUSSIAN 1S AND 2P FUNCTIONS WITH COMMON EXPONENTS.
C*
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      DIMENSION EXX(6),CS(6),CP(6)
      GO TO (1,2,3,4,5,6),NGAUSS
C     *****************************************************************
    1 CONTINUE
C*****************      STO(4S---1(1S),4P---1(2P))
      EXX(1)=0.0D0
      CS(1)=0.0D0
      CP(1)=0.0D0
      RETURN
C     *****************************************************************
    2 CONTINUE
C*****************      STO(4S---2(1S),4P---2(2P))
C*********           ER1 5.1660D-03      ER2 4.1650D-03
      EXX(1)= 1.242349951D-01
      CS(1)=-6.615603018D-01
      CP(1)= 1.309890515D-01
      EXX(2)= 4.999746691D-02
      CS(2)= 1.510754134D 00
      CP(2)= 8.946431268D-01
      RETURN
C     *****************************************************************
    3 CONTINUE
C*****************      STO(4S---3(1S),4P---3(2P))
C*********           ER1 1.6710D-04      ER2 2.9851D-04
      EXX(1)= 2.464581400D-01
      CS(1)=-3.088441215D-01
      CP(1)=-1.215468600D-01
      EXX(2)= 9.095855374D-02
      CS(2)= 1.960641166D-02
      CP(2)= 5.715227604D-01
      EXX(3)= 4.016825636D-02
      CS(3)= 1.131034442D 00
      CP(3)= 5.498949471D-01
      RETURN
C     *****************************************************************
    4 CONTINUE
C*****************      STO(4S---4(1S),4P---4(2P))
C*********           ER1 1.5073D-05      ER2 1.6717D-05
      EXX(1)= 4.389527791D-01
      CS(1)=-5.893559813D-02
      CP(1)=-7.180522657D-02
      EXX(2)= 1.624449952D-01
      CS(2)=-4.289230261D-01
      CP(2)= 3.726863425D-02
      EXX(3)= 6.983976374D-02
      CS(3)= 5.472998468D-01
      CP(3)= 6.965842249D-01
      EXX(4)= 3.469204610D-02
      CS(4)= 7.853692030D-01
      CP(4)= 3.310236850D-01
      RETURN
C     *****************************************************************
    5 CONTINUE
C*****************      STO(4S---5(1S),4P---5(2P))
C*********           ER1 1.6981D-06      ER2 1.1140D-06
      EXX(1)= 7.857764224D-01
      CS(1)=-1.628249797D-03
      CP(1)=-2.399519595D-02
      EXX(2)= 2.685947984D-01
      CS(2)=-2.138931336D-01
      CP(2)=-8.118321551D-02
      EXX(3)= 1.155680976D-01
      CS(3)=-3.039583456D-01
      CP(3)= 2.238628944D-01
      EXX(4)= 5.839870334D-02
      CS(4)= 8.491175450D-01
      CP(4)= 6.726900408D-01
      EXX(5)= 3.082651925D-02
      CS(5)= 5.164147260D-01
      CP(5)= 2.003802746D-01
      RETURN
C     *****************************************************************
    6 CONTINUE
C*****************      STO(4S---6(1S),4P---6(2P))
C*********           ER1 ??????????      ER2 ??????????
      EXX(1)= 1.36535D0
      CS(1)= 3.77506D-3
      CP(1)=-7.05208D-3
      EXX(2)= 4.39321D-1
      CS(2)=-5.58597D-2
      CP(2)=-5.25951D-2
      EXX(3)= 1.87707D-1
      CS(3)=-3.19295D-1
      CP(3)=-3.77345D-2
      EXX(4)= 9.36027D-2
      CS(4)=-2.76478D-2
      CP(4)= 3.87477D-1
      EXX(5)= 5.05226D-2
      CS(5)= 9.04920D-1
      CP(5)= 5.79167D-1
      EXX(6)= 2.80935D-2
      CS(6)= 3.40626D-1
      CP(6)= 1.22182D-1
      RETURN
      END
      SUBROUTINE S4SPD1(EXX,CS,CP,NGAUSS)
C*
C     --------------
C     U OF T VERSION
C     FEBRUARY 1983
C     --------------
C*
C     SIMULTANEOUS LEAST SQUARES FITS TO SLATER 4S, 4P AND 4D FUNCTIONS.
C     THIS ROUTINE HANDLES ONLY THE 4SP PORTION OF THE BASIS - SEE
C     ROUTINE S4SPD2 FOR THE 4D PORTION.
C*
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      DIMENSION EXX(6),CS(6),CP(6)
C*
      GO TO (1,2,3,4,5,6),NGAUSS
    1 CONTINUE
C*****************      STO(4S---1(1S),4P---1(2P))
      EXX(1)= 0.0D0
      CS(1)= 0.0D0
      CP(1)= 0.0D0
      RETURN
    2 CONTINUE
C*****************      STO(4S---2(1S),4P---2(2P))
      EXX(1)= 1.26011D-1
      CS(1)=-6.56197D-1
      CP(1)= 1.27008D-1
      EXX(2)= 5.00901D-2
      CS(2)= 1.50354D0
      CP(2)= 8.98533D-1
      RETURN
    3 CONTINUE
C*****************      STO(4S---3(1S),4P---3(2P))
      EXX(1)= 2.33486D-1
      CS(1)=-3.30610D-1
      CP(1)=-1.28393D-1
      EXX(2)= 9.09182D-2
      CS(2)= 5.76110D-2
      CP(2)= 5.85205D-1
      EXX(3)= 4.00224D-2
      CS(3)= 1.11558D0
      CP(3)= 5.43944D-1
      RETURN
    4 CONTINUE
C*****************      STO(4S---4(1S),4P---4(2P))
      EXX(1)= 4.50425D-1
      CS(1)=-5.84688D-2
      CP(1)=-6.74634D-2
      EXX(2)= 1.60793D-1
      CS(2)=-4.39804D-1
      CP(2)= 2.07793D-2
      EXX(3)= 7.16348D-2
      CS(3)= 5.31922D-1
      CP(3)= 6.88454D-1
      EXX(4)= 3.51148D-2
      CS(4)= 8.10747D-1
      CP(4)= 3.51482D-1
      RETURN
    5 CONTINUE
C*****************      STO(4S---5(1S),4P---5(2P))
      EXX(1)= 8.14733D-1
      CS(1)=-1.62523D-3
      CP(1)=-2.25272D-2
      EXX(2)= 2.73043D-1
      CS(2)=-2.02142D-1
      CP(2)=-8.33081D-2
      EXX(3)= 1.19670D-1
      CS(3)=-3.15702D-1
      CP(3)= 2.02471D-1
      EXX(4)= 5.98104D-2
      CS(4)= 8.08210D-1
      CP(4)= 6.76431D-1
      EXX(5)= 3.14652D-2
      CS(5)= 5.57217D-1
      CP(5)= 2.18597D-1
      RETURN
    6 CONTINUE
C*****************      STO(4S---6(1S),4P---6(2P))
      EXX(1)= 1.37434D0
      CS(1)= 3.71377D-3
      CP(1)=-6.87731D-3
      EXX(2)= 4.46516D-1
      CS(2)=-5.21220D-2
      CP(2)=-5.08511D-2
      EXX(3)= 1.92451D-1
      CS(3)=-3.07763D-1
      CP(3)=-4.20645D-2
      EXX(4)= 9.58282D-2
      CS(4)=-6.45125D-2
      CP(4)= 3.65240D-1
      EXX(5)= 5.16642D-2
      CS(5)= 8.98078D-1
      CP(5)= 5.91591D-1
      EXX(6)= 2.85894D-2
      CS(6)= 3.69096D-1
      CP(6)= 1.34413D-1
      RETURN
      END
      SUBROUTINE S4SPD2(EXX,CD,NGAUSS)
C*
C     --------------
C     U OF T VERSION
C     FEBRUARY 1983
C     --------------
C*
C     LEAST SQUARES FITS TO SLATER 4S, 4P AND 4D FUNCTIONS.
C     THIS ROUTINE HANDLES ONLY THE 4D PORTION OF THE BASIS - SEE
C     ROUTINE S4SPD1 FOR THE 4SP PART.
C*
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      DIMENSION EXX(6),CD(6)
C*
      GO TO (1,2,3,4,5,6),NGAUSS
    1 CONTINUE
      EXX(1)=0.0D0
      CD(1) =0.0D0
      RETURN
    2 CONTINUE
      EXX(1)=1.26011D-1
      CD(1) =5.43275D-1
      EXX(2)=5.00901D-2
      CD(2) =5.42087D-1
      RETURN
    3 CONTINUE
      EXX(1)=2.33486D-1
      CD(1) =1.25066D-1
      EXX(2)=9.09182D-2
      CD(2) =6.68679D-1
      EXX(3)=4.00224D-2
      CD(3) =3.05247D-1
      RETURN
    4 CONTINUE
      EXX(1)=4.50425D-1
      CD(1) =3.86994D-3
      EXX(2)=1.60793D-1
      CD(2) =2.97612D-1
      EXX(3)=7.16348D-2
      CD(3) =6.20373D-1
      EXX(4)=3.51148D-2
      CD(4) =1.73553D-1
      RETURN
    5 CONTINUE
      EXX(1)=8.14733D-1
      CD(1) =-7.36629D-3
      EXX(2)=2.73043D-1
      CD(2) =6.95976D-2
      EXX(3)=1.19670D-1
      CD(3) =4.23805D-1
      EXX(4)=5.98104D-2
      CD(4) =5.07395D-1
      EXX(5)=3.14652D-2
      CD(5) =1.00361D-1
      RETURN
    6 CONTINUE
      EXX(1)=1.37434D0
      CD(1) =-4.34638D-3
      EXX(2)=4.46516D-1
      CD(2) =4.89123D-3
      EXX(3)=1.92451D-1
      CD(3) =1.63480D-1
      EXX(4)=9.58282D-2
      CD(4) =4.80748D-1
      EXX(5)=5.16642D-2
      CD(5) =3.90692D-1
      EXX(6)=2.85894D-2
      CD(6) =5.78663D-2
      RETURN
      END
      SUBROUTINE S5SP(EXX,CS,CP,NGAUSS)
C*
C     --------------
C     U OF T VERSION
C     FEBRUARY 1983
C     --------------
C*
C     LEAST SQUARES FITS TO SLATER 5S AND 5P FUNCTIONS
C     BY GAUSSIAN 1S AND 2P FUNCTIONS WITH COMMON EXPONENTS.
C*
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      DIMENSION EXX(6),CS(6),CP(6)
      GO TO (1,2,3,4,5,6),NGAUSS
C     *****************************************************************
    1 CONTINUE
C*****************      STO(5S---1(1S),5P---1(2P))
      EXX(1)=0.0D0
      CS(1)=0.0D0
      CP(1)=0.0D0
      RETURN
C     *****************************************************************
    2 CONTINUE
C*****************      STO(5S---2(1S),5P---2(2P))
C*********           ER1 ??????????      ER2 ??????????
      EXX(1)= 8.12432D-02
      CS(1)=-1.09369D0
      CP(1)=-1.04740D-01
      EXX(2)= 3.93036D-02
      CS(2)= 1.88137D0
      CP(2)= 1.08763D0
      RETURN
C     *****************************************************************
    3 CONTINUE
C*****************      STO(5S---3(1S),5P---3(2P))
C*********           ER1 ??????????      ER2 ??????????
      EXX(1)= 1.34901D-01
      CS(1)=-3.84264D-01
      CP(1)=-3.48169D-01
      EXX(2)= 7.26361D-02
      CS(2)=-1.97257D-01
      CP(2)= 6.29032D-01
      EXX(3)= 3.20846D-02
      CS(3)= 1.37550D0
      CP(3)= 6.66283D-01
      RETURN
C     *****************************************************************
    4 CONTINUE
C*****************      STO(5S---4(1S),5P---4(2P))
C*********           ER1 ??????????      ER2 ??????????
      EXX(1)= 2.57771D-01
      CS(1)= 4.04511D-02
      CP(1)=-8.58615D-02
      EXX(2)= 1.18964D-01
      CS(2)=-6.57669D-01
      CP(2)=-1.09015D-01
      EXX(3)= 5.27078D-02
      CS(3)= 3.79252D-01
      CP(3)= 7.23404D-01
      EXX(4)= 2.87036D-02
      CS(4)= 1.03859D0
      CP(4)= 4.11743D-01
      RETURN
C     *****************************************************************
    5 CONTINUE
C*****************      STO(5S---5(1S),5P---5(2P))
C*********           ER1 ??????????      ER2 ??????????
      EXX(1)= 4.82262D-01
      CS(1)= 3.03766D-02
      CP(1)=-1.25767D-02
      EXX(2)= 1.81352D-01
      CS(2)=-1.82506D-01
      CP(2)=-1.56394D-01
      EXX(3)= 8.58891D-02
      CS(3)=-6.59149D-01
      CP(3)= 6.50075D-02
      EXX(4)= 4.61741D-02
      CS(4)= 9.18693D-01
      CP(4)= 7.85982D-01
      EXX(5)= 2.58255D-02
      CS(5)= 6.95274D-01
      CP(5)= 2.58228D-01
      RETURN
C     *****************************************************************
    6 CONTINUE
C*****************      STO(5S---6(1S),5P---6(2P))
C*********           ER1 ??????????      ER2 ??????????
      EXX(1)= 7.70142D-01
      CS(1)= 1.26745D-02
      CP(1)=-1.10568D-03
      EXX(2)= 2.34839D-02
      CS(2)= 4.36850D-01
      CP(2)= 1.49315D-01
      EXX(3)= 4.00255D-02
      CS(3)= 1.10432D0
      CP(3)= 6.96458D-01
      EXX(4)= 6.95344D-02
      CS(4)=-3.23200D-01
      CP(4)= 3.21033D-01
      EXX(5)= 1.30185D-01
      CS(5)=-4.30756D-01
      CP(5)=-1.62848D-01
      EXX(6)= 2.75627D-01
      CS(6)= 3.26670D-03
      CP(6)=-6.24314D-02
      RETURN
      END
