C     GL0701       04 DEC 88                                         MRP
C?IBM/GLD/GBR/VAX/UNX
      SUBROUTINE FORCEB
C??
C?CDC
C     PROGRAM FORCEB
C??
C1INTRODUCTION
C     LINK 0701
C*
C     --------------
C     U OF T VERSION
C     FEBRUARY 1987
C     --------------
C*
C     FORCES ON THE NUCLEI AND BASIS FUNCTIONS FOR SP FUNCTIONS.
C     THE FORCES ARE CALCULATED BY THE METHOD OF PULAY:
C     P. PULAY, MOL. PHYS., 17, 197 (1969).
C
C     AUTHOR: H.B. SCHLEGEL, QUEEN'S UNIVERSITY CHEMISTRY DEPT,
C     KINGSTON, ONTARIO, CANADA.
C     MODIFIED: MIKE PETERSON, U OF T CHEMISTRY DEPT, TORONTO, CANADA.
C*
C1OPTIONS
C     ******************************************************************
C     OPTIONS ... IOP()
C     ******************************************************************
C     SEE PROGRAM GBOPT ... LINK 0711.
C     ******************************************************************
C*
C/
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C#
C     PARAMETER (NA=#NA, NB=#NB)
C     PARAMETER (NP=#NP)
C     PARAMETER (NR=#NR, NF=#NF, NC=#NC, NE=2*NB)
C##
      PARAMETER (NA= 36, NB=200)
      PARAMETER (NP=300)
      PARAMETER (NR=101, NF=120, NC=120, NE=2*NB)
C###
      PARAMETER (NA3=3*NA, NFOR=8+6*NA3+6*NP, NFORM4=NFOR-4)
      PARAMETER (NBB=NB*(NB+1)/2)
      PARAMETER (NR1=NR+1, NF2=NF+2)
      PARAMETER (ZERO=0.0D0, ONE=1.0D0, TWO=2.0D0)
C
      COMMON /A/ IOP(99)
      COMMON /A/ NATOMS,ICHARG,MULTIP,IAN(NA),NAE,NBE,NEE,NBASIS,C(NA,3)
      COMMON /A/ CDUM(4),ICDUM(401)
C
      COMMON/FFQB/F(NB,NB)
      COMMON/DENSB/D1(NBB),D2(NBB)
C     NOTE: THIS COMMON BLOCK HAS LENGTH NFOR - SEE EQUIVALENCE BELOW.
      COMMON/C701A/SAVIMO(4),E(NE),DUM1(NF),DUM2(137),DUM3(NC),
     1 ICONF(NC),IRHF,NCONF,NCORE,NVAL,NOPEN,NFOCK,IMO(4)
      COMMON/FP4B/FP4D1(203),FP4D2(NF,NF2)
C
      COMMON/IO/IN,IOUT,IODUM1(4),IFILE,IODUM2(10),NFILE(100,2)
C
      DIMENSION FILL(NFORM4),X(NR,NR),Y(NR,NB),IMOSAV(4)
C
      EQUIVALENCE (FILL(1),E(1)), (X(1,1),F(1,NR1)), (Y(1,1),D1(1))
C
 1000 FORMAT ('0FORCEB: FMTGEN WAS CALLED',I9,' TIMES.')
C
C     FORM THE DENSITY MATRIX AND THE ENERGY WEIGHTED DENSITY.
      IF(IOP(10).EQ.0)GO TO 900
      IOP9=IOP(9)
      NTT=(NBASIS*(NBASIS+1))/2
      IF(IOP9.EQ.2)GO TO 120
      DO 10 I=1,NTT
      D1(I)=ZERO
   10 D2(I)=ZERO
      AX=TWO
      I=NBASIS
      IF(IOP9.EQ.0)GO TO 20
      I=I+I
      AX=ONE
   20 CALL TREAD(25,F,NB,NB,NBASIS,NAE,0)
      CALL TREAD(5,E,NB+NB,1,I,1,0)
      NAB=NAE
      II=0
  100 DO 110 I=1,NAB
      L=0
      II=II+1
      DO 110 J=1,NBASIS
      DO 110 K=1,J
      L=L+1
      T=F(J,I)*F(K,I)*AX
      D1(L)=D1(L)+T
  110 D2(L)=D2(L)-T*E(II)
      IF(IOP9.EQ.0.OR.NBE.EQ.0)GO TO 900
      CALL TREAD(27,F,NB,NB,NBASIS,NBE,0)
      NAB=NBE
      II=NBASIS
      IOP9=0
      GO TO 100
C     SPECIAL CODE FOR RHF OPEN SHELL RUNS.
  120 CALL TREAD(5,E,NFILE(5,1),1,NFILE(5,1),1,0)
      NAB=IMO(4)-1
      CALL TREAD(25,F,NB,NB,NBASIS,NAB,0)
C     GET FULL LAGRANGE MULTIPLIER MATRIX INTO X.
      CALL TREAD(15,X,NR,NR,NAB,NAB,1)
C     FORM W = -2 * F * X * F'. FIRST Y = - X * F'.
      DO 150 I=1,NAB
      DO 150 J=1,NBASIS
      T=ZERO
      DO 140 K=1,NAB
  140 T=T-X(I,K)*F(J,K)
  150 Y(I,J)=T
C     NOW W = 2 * F * Y. ACCUMULATE PRODUCT IN F, USING E FOR SCRATCH.
      DO 180 I=1,NBASIS
      DO 160 K=1,NAB
  160 E(K)=F(I,K)+F(I,K)
      DO 180 J=1,I
      T=ZERO
      DO 170 K=1,NAB
  170 T=T+E(K)*Y(K,J)
      F(J,I)=T
  180 F(I,J)=T
C     SAVE W IN SCRATCH FILE FOR NOW.
      CALL TWRITE(31,F,NB,NB,NBASIS,NBASIS,1)
C     GET 2-ELECTRON DENSITY MATRICES.
      CALL TREAD(25,F,NB,NB,NBASIS,NAB,0)
      NFM1=NFOCK-1
      II=0
      DO 230 I=1,NBASIS
      DO 230 J=1,I
C     CORE PART.
      T=ZERO
      IF(NCORE.EQ.0)GO TO 210
      DO 200 K=1,NCORE
  200 T=T+F(I,K)*F(J,K)
  210 II=II+1
      D1(II)=T+T
C     VALENCE AND OPEN SHELL ORBITAL PART.
      IF(NFM1.EQ.0)GO TO 230
      DO 220 K=1,NFM1
      KK=NCORE+K
      II=II+1
  220 D1(II)=TWO*F(I,KK)*F(J,KK)
  230 CONTINUE
      I=NTT*NFOCK
      REWIND IFILE
      WRITE(IFILE)(D1(J),J=1,I)
      ENDFILE IFILE
      REWIND IFILE
      IMOSAV(1)=IMO(1)
      IMOSAV(2)=IMO(2)
      IMOSAV(3)=IMO(3)
      IMOSAV(4)=IMO(4)
C     GET TOTAL DENSITY IN D1, ENERGY WEIGHTED DENSITY IN D2.
      CALL TREAD(19,D1,NBB,1,NTT,1,0)
      CALL TREAD(21,D2,NBB,1,NTT,1,0)
      DO 800 I=1,NTT
  800 D1(I)=D1(I)+D2(I)
      CALL TREAD(31,D2,NBB,1,NTT,1,0)
  900 CALL ONELB (FMT1, FMT2, IFMT, VTOL1, VTOL2, VTOLS)
      IF(IOP(1).NE.0.OR.IOP(10).EQ.0)RETURN
      CALL TWOLB (IMOSAV, IFILE, FMT1, FMT2, IFMT, VTOL1, VTOL2, VTOLS)
C     WRITE DERIVATIVES TO DISK.
      CALL TWRITE (14, SAVIMO, NFILE(14,1), 1, NFILE(14,1), 1, 0)
      IF (IOP(21).NE.1 .AND. IFMT.NE.0) WRITE (IOUT,1000) IFMT
      RETURN
      END
      SUBROUTINE ONELB (FMT1, FMT2, IFMT, VTOL1, VTOL2, VTOLS)
C
C     EVALUATION OF THE ONE ELECTRON INTEGRAL CONTRIBUTION TO THE FORCE.
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C#
C     PARAMETER (NA=#NA, NB=#NB)
C     PARAMETER (NS=#NS, NP=#NP)
C##
      PARAMETER (NA= 36, NB=200)
      PARAMETER (NS=120, NP=300)
C###
      PARAMETER (NA3=3*NA)
      PARAMETER (NBB=NB*(NB+1)/2, NB2=NB*NB)
      PARAMETER (ZERO=0.0D0, ONE=1.0D0, TWO=2.0D0)
C*
      DOUBLE PRECISION KOO,KRO,KOQ,KRQ,LOO,LRO,LOQ,LRQ
C
      INTEGER SHELLA,SHELLN,SHELLT,AOS,SHELLC
C
      COMMON /A/ IOP(99)
      COMMON /A/ NATOMS,ICHARG,MULTIP,IAN(NA),NAE,NBE,NE,NBASIS,C(NA,3)
      COMMON /A/ CDUM(4),ICDUM(401)
C
      COMMON/C701A/FDUM(4),TXX,VNEXX,VEEXX,VNNXX,FN(NA3,6),FBEXX(NP,2),
     1 FBC1(NP,2),FBC2(NP,2)
      COMMON/FFQB/FQ0,FQ1,FQ2,FQ3,FQ4,FQ5,AIJNDX(NB),
     1 TA0(400),TB0(400),TC0(400),TA1(400),TB1(400),TC1(400),
     2 TA2(400),TB2(400),TC2(400),TA3(400),TB3(400),TC3(400),
     3 TA4(400),TB4(400),TC4(400),TA5(400),TB5(400),TC5(400),
     4 CAB(3),P(3),DPA(3),DPB(3),E(16),EO(16),FF0(NA),FF1(NA),
     5 FF2(NA),FF3(NA)
      COMMON/DENSB/DM(NBB),DO(NBB)
      COMMON/B/IXYZ(NS),SHELLA(NS),SHELLN(NS),SHELLT(NS),
     1 SHELLC(NS),AOS(NS),NSHELL,MAXTYP,EXX(NP),C1(NP),C2(NP)
      COMMON/IO/IINN,IOUT,IODUM(215)
C
      DIMENSION DEXX(NP),DC1(NP),DC2(NP),IJNDX(NB),FILL1(NB2)
      DIMENSION FQARRY(6)
C
      EQUIVALENCE (DEXX(1),FBEXX(1,1)), (DC1(1),FBC1(1,1)),
     1 (DC2(1),FBC2(1,1)), (FILL1(1),FQ0,FQARRY(1))
C     THIS EQUIVALENCE EASES CONVERSION BETWEEN IBM AND CDC VERSIONS.
      EQUIVALENCE (IJNDX(1),AIJNDX(1))
C
      DATA H/0.5D0/, THREE/3.0D0/, FOUR/4.0D0/
      DATA ONE5/1.5D0/, TEN/10.0D0/, TWENTY/20.0D0/
      DATA TWOPT5/2.5D0/
      DATA P75/0.75D0/
      DATA PI/3.14159265358979D0/, EXPCUT/80.0D0/
      DATA F16/16.0D0/, F19/19.0D0/, F60/60.0D0/, F100/100.0D0/
C*
 1010 FORMAT ('0*** FMTGEN FAILURE IN ONELB FOR T =',1PD15.6)
 9000 FORMAT('0FORCEB NOT POSSIBLE FOR D/F BASIS SETS')
C*
      IF(MAXTYP.GE.2)GO TO 3000
      IF(IOP(10).EQ.0)RETURN
      PT78=PI/FOUR
      TRP=TWO/DSQRT(PI)
      TXX=ZERO
      VNEXX=ZERO
      VEEXX=ZERO
      VNNXX=ZERO
      CALL TREAD(3,TA0,400,18,400,18,0)
C     PRESET F(M,T) ROUTINES.
      CALL FMTSET (0, 0, 0)
      IFMT = 0
C
C     SELECT CUTOFFS BASED ON IOP(20).
C
C...  *TEST* CUTOFFS ... DISABLE ALL CUTOFFS.
      IF (IOP(20) .EQ. 1) THEN
         VTOL1=TEN**(-30)
         VTOL2=TEN**(-30)
         VTOLS=TEN**(-30)
         FMT1=ZERO
         FMT2=F100
C...  "BERNY" ORIGINAL STO-3G CUTOFFS (QUICK BUT A LITTLE SLEAZY).
      ELSE IF (IOP(20) .EQ. 2) THEN
         VTOL1=TEN**(-11)
         VTOL2=TEN**(-9)
         VTOLS=TEN**(-14)
         FMT1=F16
         FMT2=ZERO
C...  STANDARD CUTOFFS (TRY TO COMPUTE INTEGRALS WITH 10**-8 ACC).
      ELSE
         VTOL1=TEN**(-12)
         VTOL2=TEN**(-12)
         VTOLS=TEN**(-20)
         FMT1=F19
         FMT2=F60
      END IF
      K=3*NATOMS
      DO 1 J=1,6
      DO 1 I=1,K
    1 FN(I,J)=ZERO
C     SET INDEXING ARRAY (FOR DM AND DO).
      DO 2 I=1,NBASIS
    2 IJNDX(I)=(I*(I-1))/2
      K=SHELLA(NSHELL)+SHELLN(NSHELL)-1
      DO 3 J=1,2
      DO 3 I=1,K
      FBEXX(I,J)=ZERO
      FBC1(I,J)=ZERO
    3 FBC2(I,J)=ZERO
C
C     CALCULATE NUCLEAR CONTRIBUTION.
C
      DO 5 I=1,NATOMS
      I1=IAN(I)
      IF(I1.LE.0)GO TO 5
      DO 4 J=1,I
      I2=IAN(J)
      IF(I2.LE.0.OR.I.EQ.J)GO TO 4
      II=3*(I-1)+1
      JJ=3*(J-1)+1
      ABX=C(I,1)-C(J,1)
      ABY=C(I,2)-C(J,2)
      ABZ=C(I,3)-C(J,3)
      R12=ABX**2+ABY**2+ABZ**2
      FNN=DFLOAT(I1*I2)/DSQRT(R12)
      VNNXX=VNNXX+FNN
      FNN=FNN/R12
      FN(II,6)=FN(II,6)-ABX*FNN
      FN(JJ,6)=FN(JJ,6)+ABX*FNN
      II=II+1
      JJ=JJ+1
      FN(II,6)=FN(II,6)-ABY*FNN
      FN(JJ,6)=FN(JJ,6)+ABY*FNN
      II=II+1
      JJ=JJ+1
      FN(II,6)=FN(II,6)-ABZ*FNN
      FN(JJ,6)=FN(JJ,6)+ABZ*FNN
    4 CONTINUE
    5 CONTINUE
C
C     BEGIN LOOP OVER SHELLS.
C
      DO 1001 ISHELL=1,NSHELL
      DO 1002 JSHELL=1,ISHELL
      AX1=ONE
      IF(ISHELL.NE.JSHELL) AX1=AX1+AX1
      INEW=ISHELL
      JNEW=JSHELL
      LA=SHELLT(INEW)
      LB=SHELLT(JNEW)
      IF(LA.GE.LB)GO TO 1016
      INEW=JSHELL
      JNEW=ISHELL
 1016 LA=3*SHELLT(INEW)+1
      LB=3*SHELLT(JNEW)+1
      IAT=IXYZ(INEW)
      JAT=IXYZ(JNEW)
      AX=C(IAT,1)
      BX=C(JAT,1)
      AY=C(IAT,2)
      BY=C(JAT,2)
      AZ=C(IAT,3)
      BZ=C(JAT,3)
      ABX=AX-BX
      ABY=AY-BY
      ABZ=AZ-BZ
      R12=ABX**2+ABY**2+ABZ**2
      CAB(1)=ABX
      CAB(2)=ABY
      CAB(3)=ABZ
      ISTART=SHELLA(INEW)
      JSTART=SHELLA(JNEW)
      IEND=ISTART+SHELLN(INEW)-1
      JEND=JSTART+SHELLN(JNEW)-1
      IAOS=AOS(INEW)-1
      JAOS=AOS(JNEW)-1
      LA1=SHELLC(INEW)+1
      LB1=SHELLC(JNEW)+1
      DO 1021 I=LA1,LA
      IAS=IAOS+I
      DO 1021 J=LB1,LB
      JAS=JAOS+J
      ID=4*I+J-4
      LIJ=IJNDX(IAS)+JAS
      IF(IAS.LT.JAS)LIJ=IJNDX(JAS)+IAS
      E(ID)=DM(LIJ)
 1021 EO(ID)=DO(LIJ)
C
C     LOOP OVER THE PRIMITIVE GAUSSIANS.
C
      DO 2001 I=ISTART,IEND
      A1=EXX(I)
      CSA=C1(I)
      CPA=C2(I)
      DO 2001 J=JSTART,JEND
C
C     PRELIMINARY INFORMATION.
C
      A2=EXX(J)
      A12=A1+A2
      A12I=ONE/A12
      S1=A1*A12I
      S2=A2*A12I
      S12=A1*S2
      R12S12=R12*S12
      E12=ZERO
      IF(R12S12.LE.EXPCUT)E12=DEXP(-R12S12)*(PI*A12I)**ONE5
      DS12A=S2*S2
      DS12B=S1*S1
      DS1A= S2*A12I
      DS1B=-S1*A12I
      DS2A=-S2*A12I
      DS2B= S1*A12I
      CSB=C1(J)*E12
      CPB=C2(J)*E12
      CSS=CSA*CSB
      CPS=CPA*CSB
      CSP=CSA*CPB
      CPP=CPA*CPB
      P(1)=AX*S1+BX*S2
      P(2)=AY*S1+BY*S2
      P(3)=AZ*S1+BZ*S2
      T2=TRP*DSQRT(A12)
      DO 799 JJ=1,NATOMS
      I1=IAN(JJ)
      IF(I1.LE.0)GO TO 799
      ZJ=-T2*DFLOAT(I1)
      TT=A12*((C(JJ,1)-P(1))**2+(C(JJ,2)-P(2))**2+(C(JJ,3)-P(3))**2)
      IF(TT.LE.FMT1)GO TO 100
      IF(TT.LE.FMT2)GO TO 120
      FQ0=DSQRT(PT78/TT)
      FQ1=H*FQ0/TT
      FQ2=ONE5*FQ1/TT
      FQ3=TWOPT5*FQ2/TT
      GO TO 110
  100 QQ=TT*TWENTY
      N=QQ
      THETA=QQ-N
      N1=N+1
      N2=N1+1
      THETA2=THETA*(THETA-ONE)
      THETA3=THETA2*(THETA-TWO)
      THETA4=THETA2*(THETA+ONE)
      FQ0=TA0(N1)+THETA*TB0(N1)-THETA3*TC0(N1)+THETA4*TC0(N2)
      FQ1=TA1(N1)+THETA*TB1(N1)-THETA3*TC1(N1)+THETA4*TC1(N2)
      FQ2=TA2(N1)+THETA*TB2(N1)-THETA3*TC2(N1)+THETA4*TC2(N2)
      FQ3=TA3(N1)+THETA*TB3(N1)-THETA3*TC3(N1)+THETA4*TC3(N2)
      GO TO 110
  120 IFMT = IFMT + 1
      CALL FMTGEN (FQARRY, TT, 4, ICK)
      IF (ICK .NE. 0) THEN
         WRITE (IOUT,1010) TT
         IOP(1) = -2
         RETURN
      END IF
  110 FF0(JJ)=FQ0*ZJ
      FF1(JJ)=FQ1*ZJ
      FF2(JJ)=FQ2*ZJ
      FF3(JJ)=FQ3*ZJ
  799 CONTINUE
      DE12A=-R12*DS12A-ONE5*A12I
      DE12B=-R12*DS12B-ONE5*A12I
      KOO=S12*(THREE-R12S12-R12S12)
      TT=THREE-FOUR*R12S12
      DKOOA=DS12A*TT
      DKOOB=DS12B*TT
      T1=-A12-A12
      T1I=ONE/T1
      DPA(1)=DS1A*AX+DS2A*BX
      DPA(2)=DS1A*AY+DS2A*BY
      DPA(3)=DS1A*AZ+DS2A*BZ
      DPB(1)=DS1B*AX+DS2B*BX
      DPB(2)=DS1B*AY+DS2B*BY
      DPB(3)=DS1B*AZ+DS2B*BZ
C
C     LOOP OVER S, PX, PY AND PZ FUNCTIONS.
C
      DO 2000 I1=LA1,LA
      IR1=I1-1
      DO 2000 I2=LB1,LB
      IR2=I2-1
      DRQ=ZERO
      IF(IR1.EQ.IR2) DRQ=ONE
      IDX=4*IR1+I2
C
C     1 ELECTRON INTEGRALS
C
C     KINETIC AND OVERLAP
C
C     S,S CASE
      DNA=P75/A1
      DNB=P75/A2
      IF(IR1.NE.0) GO TO 811
      IF(IR2.NE.0) GO TO 812
      OO=ONE
      T=KOO
      DOOA=ZERO
      DOOB=ZERO
      DTA=DKOOA
      DTB=DKOOB
      DMS=E (IDX)*CSS*AX1
      DDS=EO(IDX)*CSS*AX1
      GO TO 801
C     P,S CASE
  811 CONTINUE
      CR=CAB(IR1)
      ORO=-S2*CR
      DOROA=-DS2A*CR
      DOROB=-DS2B*CR
      TT=-(CR+CR)
      KRO=TT*S12*S2
      DKROA=TT*(DS12A*S2+S12*DS2A)
      DKROB=TT*(DS12B*S2+S12*DS2B)
      IF(IR2.NE.0) GO TO 812
      OO=ORO
      T=KRO+KOO*ORO
      DNA=DNA+H/A1
      DOOA=DOROA
      DOOB=DOROB
      DTA=DKROA+DKOOA*ORO+KOO*DOROA
      DTB=DKROB+DKOOB*ORO+KOO*DOROB
      DMS=E (IDX)*CPS*AX1
      DDS=EO(IDX)*CPS*AX1
      GO TO 801
C     S,P CASE
  812 CONTINUE
      CQ=CAB(IR2)
      OOQ=S1*CQ
      DOOQA=DS1A*CQ
      DOOQB=DS1B*CQ
      TT=CQ+CQ
      KOQ= TT*S12*S1
      DKOQA= TT*(DS12A*S1+S12*DS1A)
      DKOQB=TT*(DS12B*S1+S12*DS1B)
      IF(IR1.NE.0) GO TO 813
      OO=OOQ
      T=KOQ+KOO*OOQ
      DNB=DNB+H/A2
      DOOA=DOOQA
      DOOB=DOOQB
      DTA=DKOQA+DKOOA*OOQ+KOO*DOOQA
      DTB=DKOQB+DKOOB*OOQ+KOO*DOOQB
      DMS=E (IDX)*CSP*AX1
      DDS=EO(IDX)*CSP*AX1
      GO TO 801
C     P,P CASE
  813 CONTINUE
      ORQ=H*DRQ*A12I-S1*S2*CR*CQ
      DNA=DNA+H/A1
      DNB=DNB+H/A2
      TT=-H*DRQ*A12I*A12I
      TA=DS1A*S2+S1*DS2A
      TB=DS1B*S2+S1*DS2B
      DORQA=TT-TA*CR*CQ
      DORQB=TT-TB*CR*CQ
      KRQ=S1*S2*DRQ
      DKRQA=TA*DRQ
      DKRQB=TB*DRQ
      OO=ORQ
      T=KRQ+KRO*OOQ+KOQ*ORO+KOO*ORQ
      DOOA=DORQA
      DOOB=DORQB
      DTA=DKRQA+DKROA*OOQ+KRO*DOOQA+DKOQA*ORO+KOQ*DOROA+DKOOA*ORQ+KOO*DO
     *RQA
      DTB=DKRQB+DKROB*OOQ+KRO*DOOQB+DKOQB*ORO+KOQ*DOROB+DKOOB*ORQ+KOO*DO
     *RQB
      DMS=E (IDX)*CPP*AX1
      DDS=EO(IDX)*CPP*AX1
  801 CONTINUE
      TXX=TXX+T*DMS
C
C     VNE
C
      V=ZERO
      DVA=ZERO
      DVB=ZERO
      DO 800 JJ=1,NATOMS
      IF(IAN(JJ).LE.0)GO TO 800
      TA=C(JJ,1)-P(1)
      TB=C(JJ,2)-P(2)
      TC=C(JJ,3)-P(3)
      DFQ=-(TA*TA+TB*TB+TC*TC)
      DFQA=DFQ+TWO*(TA*DPA(1)+TB*DPA(2)+TC*DPA(3))*A12
      DFQB=DFQ+TWO*(TA*DPB(1)+TB*DPB(2)+TC*DPB(3))*A12
      FQ0=FF0(JJ)
      FQ1=FF1(JJ)
      FQ2=FF2(JJ)
      FQ3=FF3(JJ)
C     S,S CASE
      LOO=FQ0
      DLOOA=FQ1*DFQA
      DLOOB=FQ1*DFQB
      IF(IR1.NE.0) GO TO 802
      IF(IR2.NE.0) GO TO 804
      V=V+LOO
      DVA=DLOOA+DVA
      DVB=DLOOB+DVB
      GO TO 800
C     P,S CASE
  802 CONTINUE
      CPR=C(JJ,IR1)-P(IR1)
      LRO=CPR*FQ1
      DLROA=CPR*FQ2*DFQA-DPA(IR1)*FQ1
      DLROB=CPR*FQ2*DFQB-DPB(IR1)*FQ1
      IF(IR2.NE.0) GO TO 804
      V=V+LRO+LOO*ORO
      DVA=DLROA+DLOOA*ORO+LOO*DOROA+DVA
      DVB=DLROB+DLOOB*ORO+LOO*DOROB+DVB
      GO TO 800
C     S,P CASE
  804 CONTINUE
      CPQ =C(JJ,IR2)-P(IR2)
      LOQ=CPQ*FQ1
      DLOQA=CPQ*FQ2*DFQA-DPA(IR2)*FQ1
      DLOQB=CPQ*FQ2*DFQB-DPB(IR2)*FQ1
      IF(IR1.NE.0) GO TO 803
      V=V+LOQ+LOO*OOQ
      DVA=DLOQA+DLOOA*OOQ+LOO*DOOQA+DVA
      DVB=DLOQB+DLOOB*OOQ+LOO*DOOQB+DVB
      GO TO 800
C     P,P CASE
  803 CONTINUE
      LRQ=CPR*CPQ*FQ2+DRQ*FQ1*T1I
      TT=CPR*CPQ*FQ3+DRQ*FQ2*T1I
      TA=-DRQ*FQ1*T1I*A12I
      DLRQA=TT*DFQA-(DPA(IR1)*CPQ+CPR*DPA(IR2))*FQ2+TA
      DLRQB=TT*DFQB-(DPB(IR1)*CPQ+CPR*DPB(IR2))*FQ2+TA
      V=V+LRQ+LRO*OOQ+LOQ*ORO+LOO*ORQ
      DVA=DLRQA+DLROA*OOQ+LRO*DOOQA+DLOQA*ORO+LOQ*DOROA+DLOOA*ORQ+LOO*DO
     *RQA+DVA
      DVB=DLRQB+DLROB*OOQ+LRO*DOOQB+DLOQB*ORO+LOQ*DOROB+DLOOB*ORQ+LOO*DO
     *RQB+DVB
  800 CONTINUE
      VNEXX=VNEXX+V*DMS
      TA=DE12A+DNA
      TB=DE12B+DNB
      DEXX(I)=DEXX(I)+(DTA+T*TA+DVA+V*(TA+H*A12I))*DMS
     *+(DOOA+OO*TA)*DDS
      DEXX(J)=DEXX(J)+(DTB+T*TB+DVB+V*(TB+H*A12I))*DMS
     *+(DOOB+OO*TB)*DDS
      DDC=(T+V)*DMS+OO*DDS
      IF(I1.EQ.1) DC1(I)=DC1(I)+DDC/CSA
      IF(I1.NE.1) DC2(I)=DC2(I)+DDC/CPA
      IF(I2.EQ.1) DC1(J)=DC1(J)+DDC/C1(J)
      IF(I2.NE.1) DC2(J)=DC2(J)+DDC/C2(J)
C
C     DERIVATIVES OF 1-ELECTRON INTEGRALS
C
      DO 1071 IF1=1,2
      M=IXYZ(INEW)
      IF(IF1.EQ.2) M=IXYZ(JNEW)
      DO 1071 NN=1,3
C
C     KINETIC AND OVERLAP DERIVATIVES
C
      MNN=3*(M-1)+NN
      CN=CAB(NN)
      DRN=ZERO
      DQN=ZERO
      IF(NN.EQ.IR1) DRN=ONE
      IF(NN.EQ.IR2) DQN=ONE
      DM1=ZERO
      DM2=ZERO
      IF(IF1.EQ.1) DM1=ONE
      IF(IF1.EQ.2) DM2=ONE
      CD12=DM1-DM2
      DE12=-TWO*CN*CD12*S12
C     S,S CASE
      DKOO=-FOUR*CN*CD12*S12*S12
      IF(IR1.NE.0) GO TO 821
      IF(IR2.NE.0) GO TO 822
      DOO=DE12
      DT=DE12*T+DKOO
      GO TO 820
C     P,S CASE
  821 CONTINUE
      DORO=-S2*DRN*CD12
      DKRO=- TWO*DRN*CD12*S12*S2
      IF(IR2.NE.0) GO TO 822
      DOO=DE12*ORO+DORO
      DT=DE12*T+DKRO+DKOO*ORO+KOO*DORO
      GO TO 820
C     S,P CASE
  822 CONTINUE
      DOOQ=S1*DQN*CD12
      DKOQ= TWO*DQN*CD12*S12*S1
      IF(IR1.NE.0) GO TO 823
      DOO=DE12*OO+DOOQ
      DT=DE12*T+DKOQ+DKOO*OOQ+KOO*DOOQ
      GO TO 820
C     P,P CASE
  823 CONTINUE
      DORQ=-S1*S2*(DRN*CQ+DQN*CR)*CD12
      DOO=DE12*ORQ+DORQ
      DT=DE12*T+DKRO*OOQ+KRO*DOOQ+DKOQ*ORO+KOQ*DORO+DKOO*ORQ+KOO*DORQ
  820 CONTINUE
C
C     VNE DERIVATIVES
C
      DVNE=ZERO
      PDM=-(S1*DM1+S2*DM2)
      DO 700 JJ=1,NATOMS
      IF(IAN(JJ).LE.0)GO TO 700
      JNN=3*(JJ-1)+NN
      CPN=C(JJ,NN)-P(NN)
      FQ0=FF0(JJ)
      FQ1=FF1(JJ)
      FQ2=FF2(JJ)
      FQ3=FF3(JJ)
C     S,S CASE
      LOO=FQ0
      DLNOO=T1*CPN*FQ1
      DLOO=DLNOO*PDM
      IF(IR1.NE.0) GO TO 702
      IF(IR2.NE.0) GO TO 704
      DVNE=DVNE+DLOO
      IF(IF1.NE.1) GO TO 700
      DVHF=DLNOO
      GO TO 701
C     P,S CASE
  702 CPR=C(JJ,IR1)-P(IR1)
      LRO=CPR*FQ1
      DLNRO=T1*CPR*CPN*FQ2+DRN*FQ1
      DLRO=DLNRO*PDM
      IF(IR2.NE.0) GO TO 704
      DVNE=DVNE+DLOO*ORO+LOO*DORO+DLRO
      IF(IF1.NE.1) GO TO 700
      DVHF=DLNOO*ORO+DLNRO
      GO TO 701
C     S,P CASE
  704 CPQ =C(JJ,IR2)-P(IR2)
      LOQ=CPQ*FQ1
      DLNOQ=T1*CPQ*CPN*FQ2+DQN*FQ1
      DLOQ=DLNOQ*PDM
      IF(IR1.NE.0) GO TO 705
      DVNE=DVNE+DLOO*OOQ+LOO*DOOQ+DLOQ
      IF(IF1.NE.1) GO TO 700
      DVHF=DLNOO*OOQ+DLNOQ
      GO TO 701
C     P,P CASE
  705 CONTINUE
      DLNRQ=T1*CPN*CPR*CPQ*FQ3+(DRN*CPQ+DQN*CPR+DRQ*CPN)*FQ2
      DLRQ=DLNRQ*PDM
      DVNE=DVNE+DLOO*ORQ+LOO*DORQ+DLRO*OOQ+LRO*DOOQ+DLOQ*ORO+LOQ*DORO+DL
     1RQ
      IF(IF1.NE.1) GO TO 700
      DVHF=DLNOO*ORQ+DLNOQ*ORO+DLNRO*OOQ+DLNRQ
  701 CONTINUE
      FN(JNN,1)=FN(JNN,1)+DVHF*DMS
  700 CONTINUE
      FN(MNN,2)=FN(MNN,2)+(DE12*V+DVNE)*DMS
      FN(MNN,3)=FN(MNN,3)+DT*DMS
      FN(MNN,5)=FN(MNN,5)+DOO*DDS
 1071 CONTINUE
 2000 CONTINUE
 2001 CONTINUE
 1002 CONTINUE
 1001 CONTINUE
      RETURN
C
 3000 WRITE(IOUT,9000)
      IOP(1)=-2
      RETURN
      END
      SUBROUTINE TWOLB (IMOSAV, IFILE, FMT1, FMT2, IFMT, VTOL1, VTOL2,
     1 VTOLS)
C
C     EVALUATION OF THE TWO ELECTRON INTEGRAL CONTRIBUTION TO THE FORCE.
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C#
C     PARAMETER (NA=#NA, NB=#NB)
C     PARAMETER (NS=#NS, NP=#NP)
C     PARAMETER (NF=#NF)
C##
      PARAMETER (NA= 36, NB=200)
      PARAMETER (NS=120, NP=300)
      PARAMETER (NF=120)
C###
      PARAMETER (NA3=3*NA)
      PARAMETER (NBB=NB*(NB+1)/2, NB2=NB*NB)
      PARAMETER (NF2=NF+2)
      PARAMETER (ZERO=0.0D0, ONE=1.0D0, TWO=2.0D0)
C*
      INTEGER SHELLA,SHELLN,SHELLT,AOS,SHELLC
C
      LOGICAL FLAG,OPEN,IJSAME,KLSAME,IKSMJL,NOGSCF
C
      COMMON /A/ IOP(99)
      COMMON /A/ NATOMS,ICHARG,MULTIP,IAN(NA),NAE,NBE,NE,NBASIS,C(NA,3)
      COMMON /A/ CDUM(4),ICDUM(401)
C
      COMMON/C701A/FDUM(4),TXX,VNEXX,VEEXX,VNNXX,FN(NA3,6),FBEXX(NP,2),
     1 FBC1(NP,2),FBC2(NP,2)
      COMMON/FFQB/FQ0,FQ1,FQ2,FQ3,FQ4,FQ5,AIJNDX(NB),
     1 TA0(400),TB0(400),TC0(400),TA1(400),TB1(400),TC1(400),
     2 TA2(400),TB2(400),TC2(400),TA3(400),TB3(400),TC3(400),
     3 TA4(400),TB4(400),TC4(400),TA5(400),TB5(400),TC5(400),
     4 XE34(100),E(256),
     5 QX(100),QY(100),QZ(100),TA34I(100),TS3(100),TS4(100),TS34(100),
     6 CSMCD(100)
      COMMON/DENSB/DM(NBB),DN(NBB)
      COMMON/B/IXYZ(NS),SHELLA(NS),SHELLN(NS),SHELLT(NS),
     1 SHELLC(NS),AOS(NS),NSHELL,MAXTYP,EXX(NP),C1(NP),C2(NP)
      COMMON /FP4B/ QA,QA1,QA2,A12,A34I,A1234I,
     $ PQXX,PQYY,PQZZ,PQXY,PQXZ,PQYZ,
     *V0000,V0010,V0020,V0030,V0100,V0200,V0300,
     *V0110,V0120,V0130,V0210,V0220,V0230,V0310,V0320,V0330,
     *V1010,V1020,V1030,V2010,V2020,V2030,V3010,V3020,V3030,
     *V1000,V2000,V3000,V1100,V2100,V3100,V1200,V2200,V3200,
     *V1300,V2300,V3300,V1110,V2110,V3110,V1210,V2210,V3210,
     *V1310,V2310,V3310,V1120,V2120,V3120,V1220,V2220,V3220,
     *V1320,V2320,V3320,V1130,V2130,V3130,V1230,V2230,V3230,
     *V1330,V2330,V3330
      COMMON /FP4B/ C1110,C2110,C3110,C1210,C2210,C3210,
     *C1320,C2320,C3320,C1130,C2130,C3130,C1230,C2230,C3230,
     *C1310,C2310,C3310,C1120,C2120,C3120,C1220,C2220,C3220,
     *C1330,C2330,C3330,OPXO,OPYO,OPZO,OPOX,OPOY,OPOZ,OPXOX,OPYOY,OPZOZ,
     *OPXX,OPXY,OPXZ,OPYX,OPYY,OPYZ,OPZX,OPZY,OPZZ,OQXO,OQYO,OQZO,
     *OQOX,OQOY,OQOZ,OQXOX,OQYOY,OQZOZ,OQXX,OQXY,OQXZ,OQYX,OQYY,OQYZ,
     *OQZX,OQZY,OQZZ
      COMMON /FP4B/
     *GOOOO,GOOXO,GOOYO,GOOZO,GXOOO,GXOXO,GXOYO,GXOZO,GXXOO,GXXXO,GXXYO,
     *GXXZO,GXYOO,GXYZO,GXZOO,GYOOO,GYOYO,GYOZO,GYYOO,GYYXO,GYYYO,
     *GYYZO,GYZOO,GZOOO,GZOZO,GZZOO,GZZXO,GZZYO,GZZZO,
     *VE00,VE11,VE12,VE13,VE14,VE21,VE22,VE23,VE24,VE31,VE32,VE33,VE34,
     *CSSSP,CSSPP,CSPSP,CPSSP,CSPPP,CPSPP,CPPSP,CPPPP
      COMMON /FP4B/ VC12,VC13,VC14,VC23,VC24,VC34
      COMMON /FP4B/ VSSSP,VPSSP,VSPSP,VPPSP,VSSPP,VPSPP,VSPPP,VPPPP
      COMMON/FP4B/VCC(NF,NF2)
      COMMON/IO/IINN,IOUT,IODUM(215)
C
      DIMENSION FXYZ(NA3),DEXX(NP),DC1(NP),DC2(NP),IJNDX(NB),
     1 FILL(NB2)
      DIMENSION IMOSAV(4), FQARRY(6)
C*
      EQUIVALENCE (FXYZ(1),FN(1,4))
      EQUIVALENCE (DEXX(1),FBEXX(1,2)), (DC1(1),FBC1(1,2)),
     1 (DC2(1),FBC2(1,2))
      EQUIVALENCE (IJNDX(1),AIJNDX(1)), (FILL(1),FQ0,FQARRY(1))
C
      DATA PI/3.14159265358979D0/, EXPCUT/80.D0/
      DATA H/0.5D0/
      DATA ONE5/1.5D0/, PT25/0.25D0/
      DATA TWENTY/20.0D0/
      DATA P75/0.75D0/
      DATA TWOPT5/2.5D0/, THRPT5/3.5D0/, FORPT5/4.5D0/
C
 1010 FORMAT ('0*** FMTGEN FAILURE IN TWOLB FOR T =',1PD15.6)
C
      PT78=PI*PT25
      PITO52=TWO*(PI**TWOPT5)
      NOGSCF=.TRUE.
      OPEN=.FALSE.
      J=(NBASIS*(NBASIS+1))/2
      IOP9=IOP(9)-1
      IF(IOP9)10,20,30
   20 CALL TREAD(19,DM,NXX,1,J,1,0)
      CALL TREAD(21,DN,NXX,1,J,1,0)
      OPEN=.TRUE.
      GO TO 10
C     READ THE DENSITY MATRICES AND THE VECTOR COUPLING COEFFICIENTS.
   30 NVAL=IMOSAV(3)-IMOSAV(1)
      NOPEN=IMOSAV(4)-IMOSAV(3)
      NFOCK=NVAL+NOPEN+1
      K=J*NFOCK
      READ(IFILE)(DM(I),I=1,K)
      REWIND IFILE
      CALL TREAD(17,VCC,NF,NF2,NFOCK,NFOCK+2,0)
      NOGSCF=.FALSE.
C
C     BEGIN LOOPS OVER SHELLS.
C
   10 DO 1001 ISHELL=1,NSHELL
      DO 1002 JSHELL=1,ISHELL
      DO 1003 KSHELL=1,ISHELL
      LMAX=KSHELL
      IF(ISHELL.EQ.KSHELL)LMAX=JSHELL
      DO 1004 LSHELL=1,LMAX
      AX1=H
      IF(ISHELL.NE.JSHELL) AX1=AX1+AX1
      IF(KSHELL.NE.LSHELL) AX1=AX1+AX1
      IF(ISHELL.NE.KSHELL.OR.JSHELL.NE.LSHELL) AX1=AX1+AX1
      INEW=ISHELL
      JNEW=JSHELL
      KNEW=KSHELL
      LNEW=LSHELL
      LA=SHELLT(INEW)
      LB=SHELLT(JNEW)
      LC=SHELLT(KNEW)
      LD=SHELLT(LNEW)
C
C     PUT SHELLS IN STANDARD ORDER.
C
      IF(LA.GE.LB)GO TO 1012
      INEW=JSHELL
      JNEW=ISHELL
 1012 IF(LC.GE.LD)GO TO 1014
      KNEW=LSHELL
      LNEW=KSHELL
 1014 IF(LA+LB.GE.LC+LD)GO TO 1016
      ID=INEW
      INEW=KNEW
      KNEW=ID
      ID=JNEW
      JNEW=LNEW
      LNEW=ID
C     GET SOME SHELL INFORMATION.
 1016 IAT=IXYZ(INEW)
      JAT=IXYZ(JNEW)
      KAT=IXYZ(KNEW)
      LAT=IXYZ(LNEW)
      IJSAME=INEW.EQ.JNEW
      KLSAME=KNEW.EQ.LNEW
      IKSMJL=(INEW.EQ.KNEW).AND.(JNEW.EQ.LNEW)
      LA=3*SHELLT(INEW)+1
      LB=3*SHELLT(JNEW)+1
      LC=3*SHELLT(KNEW)+1
      LD=3*SHELLT(LNEW)+1
      JTYPE=(LA+LB+LC+LC+LD-2)/3
      AX=C(IAT,1)
      AY=C(IAT,2)
      AZ=C(IAT,3)
      IATX=3*(IAT-1)+1
      IATY=IATX+1
      IATZ=IATY+1
      BX=C(JAT,1)
      BY=C(JAT,2)
      BZ=C(JAT,3)
      JATX=3*(JAT-1)+1
      JATY=JATX+1
      JATZ=JATY+1
      CX=C(KAT,1)
      CY=C(KAT,2)
      CZ=C(KAT,3)
      KATX=3*(KAT-1)+1
      KATY=KATX+1
      KATZ=KATY+1
      DX=C(LAT,1)
      DY=C(LAT,2)
      DZ=C(LAT,3)
      LATX=3*(LAT-1)+1
      LATY=LATX+1
      LATZ=LATY+1
      ABX=AX-BX
      ABY=AY-BY
      ABZ=AZ-BZ
      CDX=CX-DX
      CDY=CY-DY
      CDZ=CZ-DZ
      R12=ABX**2+ABY**2+ABZ**2
      R34=CDX**2+CDY**2+CDZ**2
      ISTART=SHELLA(INEW)
      JSTART=SHELLA(JNEW)
      KSTART=SHELLA(KNEW)
      LSTART=SHELLA(LNEW)
      IEND=ISTART+SHELLN(INEW)-1
      JEND=JSTART+SHELLN(JNEW)-1
      KEND=KSTART+SHELLN(KNEW)-1
      LEND=LSTART+SHELLN(LNEW)-1
C     GET THE DENSITY MATRIX CONTRIBUTIONS.
      IAOS=AOS(INEW)-1
      JAOS=AOS(JNEW)-1
      KAOS=AOS(KNEW)-1
      LAOS=AOS(LNEW)-1
      DMAX=ZERO
      LA1=SHELLC(INEW)+1
      LB1=SHELLC(JNEW)+1
      LC1=SHELLC(KNEW)+1
      LD1=SHELLC(LNEW)+1
      DO 1020 I=1,256
 1020 E(I)=ZERO
C
      DO 1021 I=LA1,LA
      IAS=IAOS+I
      LII=IJNDX(IAS)
      DO 1021 J=LB1,LB
      JAS=JAOS+J
      LJJ=IJNDX(JAS)
      LIJ=LII+JAS
      IF(IAS.LT.JAS)LIJ=LJJ+IAS
      IF(NOGSCF)D12=DM(LIJ)
      IF(OPEN)D12B=DN(LIJ)
      DO 1021 K=LC1,LC
      KAS=KAOS+K
      LKK=IJNDX(KAS)
      LIK=LII+KAS
      IF(IAS.LT.KAS)LIK=LKK+IAS
      LJK=LJJ+KAS
      IF(JAS.LT.KAS)LJK=LKK+JAS
      IF(NOGSCF)D13=DM(LIK)
      IF(NOGSCF)D23=DM(LJK)
      IF(OPEN)D13B=DN(LIK)
      IF(OPEN)D23B=DN(LJK)
      DO 1021 L=LD1,LD
      LAS=LAOS+L
      LLL=IJNDX(LAS)
      LIL=LII+LAS
      IF(IAS.LT.LAS)LIL=LLL+IAS
      LJL=LJJ+LAS
      IF(JAS.LT.LAS)LJL=LLL+JAS
      LKL=LKK+LAS
      IF(KAS.LT.LAS)LKL=LLL+KAS
      ID=64*I+16*J+4*K+L-84
      IF(IOP9)1030,1040,1050
 1030 E(ID)=(D12*DM(LKL)-PT25*(D13*DM(LJL)+D23*DM(LIL)))*AX1
      GO TO 1060
 1040 E(ID)=((D12+D12B)*(DM(LKL)+DN(LKL))-H*(D13*DM(LJL)+
     $ D23*DM(LIL)+D13B*DN(LJL)+D23B*DN(LIL)))*AX1
      GO TO 1060
C     GENERAL SCF - OFFSET EACH INDEX BY THE NUMBER OF FOCK MATRICES.
 1050 NFIJ=LIJ*NFOCK-NFOCK
      NFIK=LIK*NFOCK-NFOCK
      NFIL=LIL*NFOCK-NFOCK
      NFJK=LJK*NFOCK-NFOCK
      NFJL=LJL*NFOCK-NFOCK
      NFKL=LKL*NFOCK-NFOCK
      D12=DM(NFIJ+1)
      D13=DM(NFIK+1)
      D14=DM(NFIL+1)
      D23=DM(NFJK+1)
      D24=DM(NFJL+1)
      D34=DM(NFKL+1)
C     CORE PART.
      D1234=D12*D34-PT25*(D13*D24+D14*D23)
      IF(NFOCK.EQ.1)GO TO 1056
      DO 1055 NI=2,NFOCK
      D12B=DM(NFIJ+NI)
      D13B=DM(NFIK+NI)
      D14B=DM(NFIL+NI)
      D23B=DM(NFJK+NI)
      D24B=DM(NFJL+NI)
      D34B=DM(NFKL+NI)
C     CORE - VALENCE-OPEN PART.
      D1234=D1234+H*VCC(NI,1)*(D12*D34B+D12B*D34)+
     $ PT25*VCC(1,NI)*(D13*D24B+D13B*D24+D14*D23B+D14B*D23)
C     VALENCE-OPEN - VALENCE-OPEN PART.
C     SELF-CONTRIBUTION.
      D1234=D1234+H*VCC(NI,NFOCK+1)*D12B*D34B+
     $ PT25*VCC(NI,NFOCK+2)*(D13B*D24B+D14B*D23B)
      IF(NI.EQ.2)GO TO 1055
      N=NI-1
      DO 1054 NJ=2,N
 1054 D1234=D1234+H*VCC(NI,NJ)*(D12B*DM(NFKL+NJ)+DM(NFIJ+NJ)*D34B) +
     $ PT25*VCC(NJ,NI)*(D13B*DM(NFJL+NJ)+DM(NFIK+NJ)*D24B+
     $ D14B*DM(NFJK+NJ)+DM(NFIL+NJ)*D23B)
 1055 CONTINUE
 1056 E(ID)=D1234*AX1
 1060 D1234=DABS(E(ID))
 1021 IF(D1234.GT.DMAX)DMAX=D1234
C
      IF(DMAX.LT.VTOL1)GO TO 1004
C     HUNT OUT THE LARGEST DENSITY*CONTRACTION AND REJECT IF POSSIBLE.
      E34MAX=ZERO
      KZERO=-10
C
      DO 2 K=KSTART,KEND
      KZERO=KZERO+10
      KL=KZERO
      A3=EXX(K)
      CSUMC=DABS(C1(K))+DABS(C2(K))
      LND=LEND
      IF(KLSAME)LND=K
C
      DO 2 L=LSTART,LND
      A4=EXX(L)
      KL=KL+1
      A34I=ONE/(A3+A4)
      S3=A3*A34I
      S4=A4*A34I
      S34=A3*S4
      QX(KL)=S3*CX+S4*DX
      QY(KL)=S3*CY+S4*DY
      QZ(KL)=S3*CZ+S4*DZ
      TA34I(KL)=A34I
      TS3(KL)=S3
      TS4(KL)=S4
      TS34(KL)=S34
      ARGEXP=R34*S34
      E34=ZERO
      IF(ARGEXP.LE.EXPCUT)E34=DEXP(-ARGEXP)*A34I
      IF(KLSAME.AND.(K.NE.L))E34=E34+E34
      XE34(KL)=E34
      E34=E34*CSUMC*(DABS(C1(L))+DABS(C2(L)))
      CSMCD(KL)=E34*E34
    2 IF(E34.GT.E34MAX)E34MAX=E34
C
      IF(DMAX*E34MAX.LT.VTOL1)GO TO 1004
      FXI=ZERO
      FXJ=ZERO
      FXK=ZERO
      FYI=ZERO
      FYJ=ZERO
      FYK=ZERO
      FZI=ZERO
      FZJ=ZERO
      FZK=ZERO
      VE11=ZERO
      VE12=ZERO
      VE13=ZERO
      VE14=ZERO
      VE21=ZERO
      VE22=ZERO
      VE23=ZERO
      VE24=ZERO
      VE31=ZERO
      VE32=ZERO
      VE33=ZERO
      VE34=ZERO
      IZERO=-10
C
C     LOOP OVER THE PRIMITIVES IN EACH SHELL.
C
      DO 2001 I=ISTART,IEND
      IZERO=IZERO+10
      IJ=IZERO
      A1=EXX(I)
      CSA=C1(I)
      CPA=C2(I)
      CSUMA=(DABS(CSA)+DABS(CPA))*DMAX
      JND=JEND
      IF(IJSAME)JND=I
C
      DO 2002 J=JSTART,JND
      IJ=IJ+1
      A2=EXX(J)
      A12=A1+A2
      A12I=ONE/A12
      S1=A1*A12I
      S2=A2*A12I
      S12=A1*S2
      E12=ZERO
      IF(R12*S12.LE.EXPCUT)E12=DEXP(-R12*S12)*PITO52*A12I
      IF(IJSAME.AND.(I.NE.J))E12=E12+E12
      CSB=C1(J)*E12
      CPB=C2(J)*E12
      CSMAB=CSUMA*(DABS(CSB)+DABS(CPB))
      IF(CSMAB*E34MAX.LT.VTOL2)GO TO 2002
      CSMAB=CSMAB*CSMAB
      CSS=CSA*CSB
      CPS=CPA*CSB
      CSP=CSA*CPB
      CPP=CPA*CPB
      PX=S1*AX+S2*BX
      PY=S1*AY+S2*BY
      PZ=S1*AZ+S2*BZ
      IF(LA.EQ.1)GO TO 51
      OPXO=-S2*ABX
      OPYO=-S2*ABY
      OPZO=-S2*ABZ
      IF(LB.EQ.1)GO TO 51
      OPOX=S1*ABX
      OPOY=S1*ABY
      OPOZ=S1*ABZ
      OPXOX=OPXO+OPOX
      OPYOY=OPYO+OPOY
      OPZOZ=OPZO+OPOZ
      HA12I=H*A12I
      OPXX=OPXO*OPOX+HA12I
      OPYY=OPYO*OPOY+HA12I
      OPZZ=OPZO*OPOZ+HA12I
      OPXY=OPXO*OPOY
      OPYX=OPXY
      OPXZ=OPXO*OPOZ
      OPZX=OPXZ
      OPYZ=OPYO*OPOZ
      OPZY=OPYZ
   51 VE00S=ZERO
      VE11S=ZERO
      VE12S=ZERO
      VE21S=ZERO
      VE22S=ZERO
      VE31S=ZERO
      VE32S=ZERO
      DVEXS=ZERO
      DVEYS=ZERO
      DVEZS=ZERO
      KND=KEND
      IF(IKSMJL)KND=I
      KZERO=-10
C
      DO 2003 K=KSTART,KND
      KZERO=KZERO+10
      KL=KZERO
      A3=EXX(K)
      CSC=C1(K)
      CPC=C2(K)
      CSSS=CSS*CSC
      CSSP=CSS*CPC
      CPSS=CPS*CSC
      CPSP=CPS*CPC
      CSPS=CSP*CSC
      CSPP=CSP*CPC
      CPPS=CPP*CSC
      CPPP=CPP*CPC
      LND=LEND
      IF(KLSAME)LND=K
      IF(IKSMJL.AND.(I.EQ.K))LND=J
C
      DO 2004 L=LSTART,LND
      KL=KL+1
      A4=EXX(L)
      A34=A3+A4
      A1234I=ONE/(A12+A34)
      VTEST=CSMAB*CSMCD(KL)*A1234I
      IF(VTEST.LT.VTOLS)GO TO 2004
      QA2=A34*A1234I
      QA=A12*QA2
      PQX=PX-QX(KL)
      PQY=PY-QY(KL)
      PQZ=PZ-QZ(KL)
      PQXX=PQX*PQX
      PQYY=PQY*PQY
      PQZZ=PQZ*PQZ
      T=QA*(PQXX+PQYY+PQZZ)
      A34I=TA34I(KL)
      S3=TS3(KL)
      S4=TS4(KL)
      S34=TS34(KL)
      E34=XE34(KL)*DSQRT(A1234I)
      IF(IKSMJL.AND.(IJ.NE.KL))E34=E34+E34
      CSD=C1(L)*E34
      EOOOO=E(1)*CSSS*CSD
      IF(T.LE.FMT1)GO TO 100
      IF(T.LE.FMT2)GO TO 120
      TI=ONE/T
      IF(VTEST*TI.LT.VTOLS)GO TO 2004
      FQ0=DSQRT(PT78*TI)
      FQ1=H*FQ0*TI
      FQ2=ONE5*FQ1*TI
      FQ3=TWOPT5*FQ2*TI
      FQ4=THRPT5*FQ3*TI
      FQ5=FORPT5*FQ4*TI
      GO TO 110
  100 QQ=T*TWENTY
      N=IDINT(QQ)
      THETA=QQ-DFLOAT(N)
      THETA2=THETA*(THETA-ONE)
      THETA3=THETA2*(THETA-TWO)
      THETA4=THETA2*(THETA+ONE)
      FQ5=TA5(N+1)+THETA*TB5(N+1)-THETA3*TC5(N+1)+THETA4*TC5(N+2)
      FQ4=TA4(N+1)+THETA*TB4(N+1)-THETA3*TC4(N+1)+THETA4*TC4(N+2)
      FQ3=TA3(N+1)+THETA*TB3(N+1)-THETA3*TC3(N+1)+THETA4*TC3(N+2)
      FQ2=TA2(N+1)+THETA*TB2(N+1)-THETA3*TC2(N+1)+THETA4*TC2(N+2)
      FQ1=TA1(N+1)+THETA*TB1(N+1)-THETA3*TC1(N+1)+THETA4*TC1(N+2)
      FQ0=TA0(N+1)+THETA*TB0(N+1)-THETA3*TC0(N+1)+THETA4*TC0(N+2)
      GO TO 110
  120 IFMT = IFMT + 1
      CALL FMTGEN (FQARRY, T, 6, ICK)
      IF (ICK .NE. 0) THEN
         WRITE (IOUT,1010) T
         IOP(1) = -2
         RETURN
      END IF
  110 PQXY=PQX*PQY
      PQXZ=PQX*PQZ
      PQYZ=PQY*PQZ
      QA1=A12*A1234I
      CPD=C2(L)*E34
      IF(LC.EQ.1)GO TO 52
      CSSPS=CSSP*CSD
      CPSPS=CPSP*CSD
      OQXO=-S4*CDX
      OQYO=-S4*CDY
      OQZO=-S4*CDZ
      IF(LD.EQ.1)GO TO 52
      CSSSP=CSSS*CPD
      CSSPP=CSSP*CPD
      CSPSP=CSPS*CPD
      CPSSP=CPSS*CPD
      CSPPP=CSPP*CPD
      CPSPP=CPSP*CPD
      CPPSP=CPPS*CPD
      CPPPP=CPPP*CPD
      OQOX=S3*CDX
      OQOY=S3*CDY
      OQOZ=S3*CDZ
      OQXX=OQXO*OQOX+H*A34I
      OQYY=OQYO*OQOY+H*A34I
      OQZZ=OQZO*OQOZ+H*A34I
      OQXY=OQXO*OQOY
      OQYX=OQXY
      OQXZ=OQXO*OQOZ
      OQZX=OQXZ
      OQYZ=OQYO*OQOZ
      OQZY=OQYZ
      OQXOX=OQXO+OQOX
      OQYOY=OQYO+OQOY
      OQZOZ=OQZO+OQOZ
   52 FLAG=.FALSE.
C
C     BEGIN THE FIRST PASS THROUGH THE INTEGRAL CALCULATIONS.
C
 3001 VPSSS=ZERO
      VSPSS=ZERO
      VPPSS=ZERO
      VSSPS=ZERO
      VPSPS=ZERO
      VSPPS=ZERO
      VPPPS=ZERO
      VSSSP=ZERO
      VPSSP=ZERO
      VSPSP=ZERO
      VPPSP=ZERO
      VSSPP=ZERO
      VPSPP=ZERO
      VSPPP=ZERO
      VPPPP=ZERO
      VC12=ZERO
      VC13=ZERO
      VC14=ZERO
      VC23=ZERO
      VC24=ZERO
      VC34=ZERO
C
C     INTEGRAL EVALUATION SECTION
C
C     (SS!SS) SECTION.
C
      GOOOO=FQ0
      V0000=GOOOO
      VSSSS=    V0000*EOOOO
      VE00=VSSSS
C
C     (PS!SS) SECTION.
C
      IF(JTYPE.LT.2) GO TO 4000
      QFQ1=-QA2*FQ1
      GXOOO=PQX*QFQ1
      GYOOO=PQY*QFQ1
      GZOOO=PQZ*QFQ1
      V1000=OPXO*GOOOO+GXOOO
      V2000=OPYO*GOOOO+GYOOO
      V3000=OPZO*GOOOO+GZOOO
      CPSSS=CPSS*CSD
      VPSSS=    (V1000*E(65)+V2000*E(129)+V3000*E(193))*CPSSS
      VE00=VE00+VPSSS
      TEMP=V0000*CPSSS
      VE11=TEMP*E( 65)
      VE21=TEMP*E(129)
      VE31=TEMP*E(193)
      IF(JTYPE-3) 4000,4003,4004
C
C     (PS!PS) AND (SS!PS) SECTION.
C
 4004 QFQ1=QA1*FQ1
      GOOXO=PQX*QFQ1
      GOOYO=PQY*QFQ1
      GOOZO=PQZ*QFQ1
      HFQ1=H*FQ1*A1234I
      QFQ2=-QA*FQ2*A1234I
      GXOXO=PQXX*QFQ2+HFQ1
      GYOYO=PQYY*QFQ2+HFQ1
      GZOZO=PQZZ*QFQ2+HFQ1
      GXOYO=PQXY*QFQ2
      GXOZO=PQXZ*QFQ2
      GYOZO=PQYZ*QFQ2
      V0010=OQXO*GOOOO+GOOXO
      V0020=OQYO*GOOOO+GOOYO
      V0030=OQZO*GOOOO+GOOZO
      V1010=OPXO*V0010+OQXO*GXOOO+GXOXO
      V1020=OPXO*V0020+OQYO*GXOOO+GXOYO
      V1030=OPXO*V0030+OQZO*GXOOO+GXOZO
      V2010=OPYO*V0010+OQXO*GYOOO+GXOYO
      V2020=OPYO*V0020+OQYO*GYOOO+GYOYO
      V2030=OPYO*V0030+OQZO*GYOOO+GYOZO
      V3010=OPZO*V0010+OQXO*GZOOO+GXOZO
      V3020=OPZO*V0020+OQYO*GZOOO+GYOZO
      V3030=OPZO*V0030+OQZO*GZOOO+GZOZO
      VSSPS=    (V0010*E(5)+V0020*E(9)+V0030*E(13))*CSSPS
      VE00=VE00+VSSPS
      TEMP=V0000*CSSPS
      VE13=TEMP*E(  5)
      VE23=TEMP*E(  9)
      VE33=TEMP*E( 13)
      VPSPS=    (V1010*E( 69)+V1020*E(73)+V1030*E( 77)
     *         +V2010*E(133)+V2020*E(137)+V2030*E(141)
     *         +V3010*E(197)+V3020*E(201)+V3030*E(205))*CPSPS
      VE00=VE00+VPSPS
      VE11=VE11+(V0010*E( 69)+V0020*E( 73)+V0030*E( 77))*CPSPS
      VE13=VE13+(V1000*E( 69)+V2000*E(133)+V3000*E(197))*CPSPS
      VE21=VE21+(V0010*E(133)+V0020*E(137)+V0030*E(141))*CPSPS
      VE23=VE23+(V1000*E( 73)+V2000*E(137)+V3000*E(201))*CPSPS
      VE31=VE31+(V0010*E(197)+V0020*E(201)+V0030*E(205))*CPSPS
      VE33=VE33+(V1000*E( 77)+V2000*E(141)+V3000*E(205))*CPSPS
      VC13=VC13+(V0000*(E( 69)+E(137)+E(205)))*CPSPS
      IF(JTYPE.EQ.4) GO TO 4000
C
C     (PP!SS) AND (SP!SS) SECTION.
C
 4003 HFQ1=-H*QA2*FQ1*A12I
      QFQ2=QA2*QA2*FQ2
      GXXOO=PQXX*QFQ2+HFQ1
      GYYOO=PQYY*QFQ2+HFQ1
      GZZOO=PQZZ*QFQ2+HFQ1
      GXYOO=PQXY*QFQ2
      GXZOO=PQXZ*QFQ2
      GYZOO=PQYZ*QFQ2
      V0100=OPOX*GOOOO+GXOOO
      V0200=OPOY*GOOOO+GYOOO
      V0300=OPOZ*GOOOO+GZOOO
      V1100=OPXX*GOOOO+OPXOX*GXOOO+GXXOO
      V2200=OPYY*GOOOO+OPYOY*GYOOO+GYYOO
      V3300=OPZZ*GOOOO+OPZOZ*GZOOO+GZZOO
      V1200=OPXY*GOOOO+OPXO*GYOOO+OPOY*GXOOO+GXYOO
      V1300=OPXZ*GOOOO+OPXO*GZOOO+OPOZ*GXOOO+GXZOO
      V2100=OPYX*GOOOO+OPYO*GXOOO+OPOX*GYOOO+GXYOO
      V2300=OPYZ*GOOOO+OPYO*GZOOO+OPOZ*GYOOO+GYZOO
      V3100=OPZX*GOOOO+OPZO*GXOOO+OPOX*GZOOO+GXZOO
      V3200=OPZY*GOOOO+OPZO*GYOOO+OPOY*GZOOO+GYZOO
      CSPSS=CSPS*CSD
      CPPSS=CPPS*CSD
      VSPSS=    (V0100*E( 17)+V0200*E( 33)+V0300*E( 49))*CSPSS
      VE00=VE00+VSPSS
      TEMP=V0000*CSPSS
      VE12=TEMP*E( 17)
      VE22=TEMP*E( 33)
      VE32=TEMP*E( 49)
      VPPSS=    (V1100*E( 81)+V1200*E( 97)+V1300*E(113)
     *         + V2100*E(145)+V2200*E(161)+V2300*E(177)
     *         + V3100*E(209)+V3200*E(225)+V3300*E(241))*CPPSS
      VE00=VE00+VPPSS
      VE11=VE11+(V0100*E( 81)+V0200*E( 97)+V0300*E(113))*CPPSS
      VE12=VE12+(V1000*E( 81)+V2000*E(145)+V3000*E(209))*CPPSS
      VE21=VE21+(V0100*E(145)+V0200*E(161)+V0300*E(177))*CPPSS
      VE22=VE22+(V1000*E( 97)+V2000*E(161)+V3000*E(225))*CPPSS
      VE31=VE31+(V0100*E(209)+V0200*E(225)+V0300*E(241))*CPPSS
      VE32=VE32+(V1000*E(113)+V2000*E(177)+V3000*E(241))*CPPSS
      VC12=VC12+(V0000*(E( 81)+E(161)+E(241)))*CPPSS
      IF(JTYPE.EQ.3) GO TO 4000
C
C     (PP!PS) AND (SP!PS) SECTION.
C
      V0110=OQXO*V0100+OPOX*GOOXO+GXOXO
      V0120=OQYO*V0100+OPOX*GOOYO+GXOYO
      V0130=OQZO*V0100+OPOX*GOOZO+GXOZO
      V0210=OQXO*V0200+OPOY*GOOXO+GXOYO
      V0220=OQYO*V0200+OPOY*GOOYO+GYOYO
      V0230=OQZO*V0200+OPOY*GOOZO+GYOZO
      V0310=OQXO*V0300+OPOZ*GOOXO+GXOZO
      V0320=OQYO*V0300+OPOZ*GOOYO+GYOZO
      V0330=OQZO*V0300+OPOZ*GOOZO+GZOZO
      CSPPS=CSPP*CSD
      CPPPS=CPPP*CSD
      VSPPS=    (V0110*E( 21)+V0120*E( 25)+V0130*E( 29)
     *         + V0210*E( 37)+V0220*E( 41)+V0230*E( 45)
     *         + V0310*E( 53)+V0320*E( 57)+V0330*E( 61))*CSPPS
      VE00=VE00+VSPPS
      VE12=VE12+(V0010*E( 21)+V0020*E( 25)+V0030*E( 29))*CSPPS
      VE13=VE13+(V0100*E( 21)+V0200*E( 37)+V0300*E( 53))*CSPPS
      VE22=VE22+(V0010*E( 37)+V0020*E( 41)+V0030*E( 45))*CSPPS
      VE23=VE23+(V0100*E( 25)+V0200*E( 41)+V0300*E( 57))*CSPPS
      VE32=VE32+(V0010*E( 53)+V0020*E( 57)+V0030*E( 61))*CSPPS
      VE33=VE33+(V0100*E( 29)+V0200*E( 45)+V0300*E( 61))*CSPPS
      VC23=VC23+(V0000*(E( 21)+E( 41)+E( 61)))*CSPPS
      QFQ3=QA1*QA2*QA2*FQ3
      HFQ2=-H*QA2*FQ2*A1234I
      TFQ2=HFQ2+HFQ2+HFQ2
      GXYZO=PQXY*PQZ*QFQ3
      TEMP=PQXX*QFQ3
      GXXXO=PQX*(TEMP+TFQ2)
      GXXYO=PQY*(TEMP+HFQ2)
      GXXZO=PQZ*(TEMP+HFQ2)
      TEMP=PQYY*QFQ3
      GYYYO=PQY*(TEMP+TFQ2)
      GYYXO=PQX*(TEMP+HFQ2)
      GYYZO=PQZ*(TEMP+HFQ2)
      TEMP=PQZZ*QFQ3
      GZZZO=PQZ*(TEMP+TFQ2)
      GZZXO=PQX*(TEMP+HFQ2)
      GZZYO=PQY*(TEMP+HFQ2)
      C1110=OPXX*GOOXO+OPXOX*GXOXO+GXXXO
      C1120=OPXX*GOOYO+OPXOX*GXOYO+GXXYO
      C1130=OPXX*GOOZO+OPXOX*GXOZO+GXXZO
      C2210=OPYY*GOOXO+OPYOY*GXOYO+GYYXO
      C2220=OPYY*GOOYO+OPYOY*GYOYO+GYYYO
      C2230=OPYY*GOOZO+OPYOY*GYOZO+GYYZO
      C3310=OPZZ*GOOXO+OPZOZ*GXOZO+GZZXO
      C3320=OPZZ*GOOYO+OPZOZ*GYOZO+GZZYO
      C3330=OPZZ*GOOZO+OPZOZ*GZOZO+GZZZO
      C1210=OPXY*GOOXO+OPXO*GXOYO+OPOY*GXOXO+GXXYO
      C1220=OPXY*GOOYO+OPXO*GYOYO+OPOY*GXOYO+GYYXO
      C1230=OPXY*GOOZO+OPXO*GYOZO+OPOY*GXOZO+GXYZO
      C1310=OPXZ*GOOXO+OPXO*GXOZO+OPOZ*GXOXO+GXXZO
      C1320=OPXZ*GOOYO+OPXO*GYOZO+OPOZ*GXOYO+GXYZO
      C1330=OPXZ*GOOZO+OPXO*GZOZO+OPOZ*GXOZO+GZZXO
      C2110=OPYX*GOOXO+OPYO*GXOXO+OPOX*GXOYO+GXXYO
      C2120=OPYX*GOOYO+OPYO*GXOYO+OPOX*GYOYO+GYYXO
      C2130=OPYX*GOOZO+OPYO*GXOZO+OPOX*GYOZO+GXYZO
      C2310=OPYZ*GOOXO+OPYO*GXOZO+OPOZ*GXOYO+GXYZO
      C2320=OPYZ*GOOYO+OPYO*GYOZO+OPOZ*GYOYO+GYYZO
      C2330=OPYZ*GOOZO+OPYO*GZOZO+OPOZ*GYOZO+GZZYO
      C3110=OPZX*GOOXO+OPZO*GXOXO+OPOX*GXOZO+GXXZO
      C3120=OPZX*GOOYO+OPZO*GXOYO+OPOX*GYOZO+GXYZO
      C3130=OPZX*GOOZO+OPZO*GXOZO+OPOX*GZOZO+GZZXO
      C3210=OPZY*GOOXO+OPZO*GXOYO+OPOY*GXOZO+GXYZO
      C3220=OPZY*GOOYO+OPZO*GYOYO+OPOY*GYOZO+GYYZO
      C3230=OPZY*GOOZO+OPZO*GYOZO+OPOY*GZOZO+GZZYO
      V1110=OQXO*V1100+C1110
      V1120=OQYO*V1100+C1120
      V1130=OQZO*V1100+C1130
      V1210=OQXO*V1200+C1210
      V1220=OQYO*V1200+C1220
      V1230=OQZO*V1200+C1230
      V1310=OQXO*V1300+C1310
      V1320=OQYO*V1300+C1320
      V1330=OQZO*V1300+C1330
      V2110=OQXO*V2100+C2110
      V2120=OQYO*V2100+C2120
      V2130=OQZO*V2100+C2130
      V2210=OQXO*V2200+C2210
      V2220=OQYO*V2200+C2220
      V2230=OQZO*V2200+C2230
      V2310=OQXO*V2300+C2310
      V2320=OQYO*V2300+C2320
      V2330=OQZO*V2300+C2330
      V3110=OQXO*V3100+C3110
      V3120=OQYO*V3100+C3120
      V3130=OQZO*V3100+C3130
      V3210=OQXO*V3200+C3210
      V3220=OQYO*V3200+C3220
      V3230=OQZO*V3200+C3230
      V3310=OQXO*V3300+C3310
      V3320=OQYO*V3300+C3320
      V3330=OQZO*V3300+C3330
      VPPPS=    (V1110*E( 85)+V1120*E( 89)+V1130*E( 93)
     *          +V1210*E(101)+V1220*E(105)+V1230*E(109)
     *          +V1310*E(117)+V1320*E(121)+V1330*E(125)
     *          +V2110*E(149)+V2120*E(153)+V2130*E(157)
     *          +V2210*E(165)+V2220*E(169)+V2230*E(173)
     *          +V2310*E(181)+V2320*E(185)+V2330*E(189)
     *          +V3110*E(213)+V3120*E(217)+V3130*E(221)
     *          +V3210*E(229)+V3220*E(233)+V3230*E(237)
     *          +V3310*E(245)+V3320*E(249)+V3330*E(253))*CPPPS
      VE00=VE00+VPPPS
      VE11=VE11+(V0110*E( 85)+V0120*E( 89)+V0130*E( 93)
     *         + V0210*E(101)+V0220*E(105)+V0230*E(109)
     *         + V0310*E(117)+V0320*E(121)+V0330*E(125))*CPPPS
      VE12=VE12+(V1010*E( 85)+V1020*E( 89)+V1030*E( 93)
     *         + V2010*E(149)+V2020*E(153)+V2030*E(157)
     *         + V3010*E(213)+V3020*E(217)+V3030*E(221))*CPPPS
      VE13=VE13+(V1100*E( 85)+V1200*E(101)+V1300*E(117)
     *         + V2100*E(149)+V2200*E(165)+V2300*E(181)
     *         + V3100*E(213)+V3200*E(229)+V3300*E(245))*CPPPS
      VE21=VE21+(V0110*E(149)+V0120*E(153)+V0130*E(157)
     *         + V0210*E(165)+V0220*E(169)+V0230*E(173)
     *         + V0310*E(181)+V0320*E(185)+V0330*E(189))*CPPPS
      VE22=VE22+(V1010*E(101)+V1020*E(105)+V1030*E(109)
     *         + V2010*E(165)+V2020*E(169)+V2030*E(173)
     *         + V3010*E(229)+V3020*E(233)+V3030*E(237))*CPPPS
      VE23=VE23+(V1100*E( 89)+V1200*E(105)+V1300*E(121)
     *         + V2100*E(153)+V2200*E(169)+V2300*E(185)
     *         + V3100*E(217)+V3200*E(233)+V3300*E(249))*CPPPS
      VE31=VE31+(V0110*E(213)+V0120*E(217)+V0130*E(221)
     *         + V0210*E(229)+V0220*E(233)+V0230*E(237)
     *         + V0310*E(245)+V0320*E(249)+V0330*E(253))*CPPPS
      VE32=VE32+(V1010*E(117)+V1020*E(121)+V1030*E(125)
     *         + V2010*E(181)+V2020*E(185)+V2030*E(189)
     *         + V3010*E(245)+V3020*E(249)+V3030*E(253))*CPPPS
      VE33=VE33+(V1100*E( 93)+V1200*E(109)+V1300*E(125)
     *         + V2100*E(157)+V2200*E(173)+V2300*E(189)
     *         + V3100*E(221)+V3200*E(237)+V3300*E(253))*CPPPS
      VC12=VC12+(V0010*(E( 85)+E(165)+E(245))
     *         + V0020*(E( 89)+E(169)+E(249))
     *         + V0030*(E( 93)+E(173)+E(253)))*CPPPS
      VC13=VC13+(V0100*(E( 85)+E(153)+E(221))
     *         + V0200*(E(101)+E(169)+E(237))
     *         + V0300*(E(117)+E(185)+E(253)))*CPPPS
      VC23=VC23+(V1000*(E( 85)+E(105)+E(125))
     *         + V2000*(E(149)+E(169)+E(189))
     *         + V3000*(E(213)+E(233)+E(253)))*CPPPS
      IF(JTYPE.NE.6) GO TO 4000
C
C     (PP!PP), (PP!SP), (PS!PP), (SP!PP), (SS!PP), (SP!SP), (PS!SP)
C     AND (SS!SP) SECTION.
C
      CALL FPPPPB
C
 4000 IF(FLAG) GO TO 3002
C
C     END OF FIRST PASS THROUGH INTEGRALS.
C
      FLAG=.TRUE.
      FQ0=FQ1
      FQ1=FQ2
      FQ2=FQ3
      FQ3=FQ4
      FQ4=FQ5
      IF(CSA.NE.ZERO)
     *DC1(I)=DC1(I)+(VSSSS+VSSSP+VSSPS+VSSPP+VSPSS+VSPSP+VSPPS+VSPPP)
     */CSA
      IF(CSB.NE.ZERO)
     *DC1(J)=DC1(J)+(VSSSS+VSSSP+VSSPS+VSSPP+VPSSS+VPSSP+VPSPS+VPSPP)
     */C1(J)
      IF(CSC.NE.ZERO)
     *DC1(K)=DC1(K)+(VSSSS+VSSSP+VSPSS+VSPSP+VPSSS+VPSSP+VPPSS+VPPSP)
     */CSC
      IF(CSD.NE.ZERO)
     *DC1(L)=DC1(L)+(VSSSS+VSSPS+VSPSS+VSPPS+VPSSS+VPSPS+VPPSS+VPPPS)
     */C1(L)
      VPA=(VPSSS+VPSSP+VPSPS+VPSPP+VPPSS+VPPSP+VPPPS+VPPPP)*(LA/4)
      VPB=(VSPSS+VSPSP+VSPPS+VSPPP+VPPSS+VPPSP+VPPPS+VPPPP)*(LB/4)
      VPC=(VSSPS+VSSPP+VSPPS+VSPPP+VPSPS+VPSPP+VPPPS+VPPPP)*(LC/4)
      VPD=(VSSSP+VSSPP+VSPSP+VSPPP+VPSSP+VPSPP+VPPSP+VPPPP)*(LD/4)
      IF(CPA.NE.ZERO) DC2(I)=DC2(I)+VPA/CPA
      IF(CPB.NE.ZERO) DC2(J)=DC2(J)+VPB/C2(J)
      IF(CPC.NE.ZERO) DC2(K)=DC2(K)+VPC/CPC
      IF(CPD.NE.ZERO) DC2(L)=DC2(L)+VPD/C2(L)
      VR12=VE00*R12+(VE11*ABX+VE21*ABY+VE31*ABZ)/A1
     *             -(VE12*ABX+VE22*ABY+VE32*ABZ)/A2-H*VC12/(A1*A2)
      VR34=VE00*R34+(VE13*CDX+VE23*CDY+VE33*CDZ)/A3
     *             -(VE14*CDX+VE24*CDY+VE34*CDZ)/A4-H*VC34/(A3*A4)
      DEXX(I)=DEXX(I)+VE00*((H*QA2-ONE5)*A12I)-S2**2*VR12
     *+(P75*VE00-H*VPA)/A1
      DEXX(J)=DEXX(J)+VE00*((H*QA2-ONE5)*A12I)-S1**2*VR12
     *+(P75*VE00-H*VPB)/A2
      DEXX(K)=DEXX(K)+VE00*((H*QA1-ONE5)*A34I)-S4**2*VR34
     *+(P75*VE00-H*VPC)/A3
      DEXX(L)=DEXX(L)+VE00*((H*QA1-ONE5)*A34I)-S3**2*VR34
     *+(P75*VE00-H*VPD)/A4
      VE00S=VE00S+VE00
      VE11S=VE11S+VE11
      VE21S=VE21S+VE21
      VE31S=VE31S+VE31
      VE12S=VE12S+VE12
      VE22S=VE22S+VE22
      VE32S=VE32S+VE32
      CDVE00=S34*(VE00+VE00)
      DX2X=-VE13*S4+VE14*S3-CDX*CDVE00
      DX2Y=-VE23*S4+VE24*S3-CDY*CDVE00
      DX2Z=-VE33*S4+VE34*S3-CDZ*CDVE00
      GO TO 3001
C
C     END OF SECOND PASS THROUGH THE INTEGRALS.
C
 3002 VP=PQX**2+PQY**2+PQZ**2
      VP1=(VE11+VE12)*A12I-(VE13+VE14)*A34I
      VP2=(VE21+VE22)*A12I-(VE23+VE24)*A34I
      VP3=(VE31+VE32)*A12I-(VE33+VE34)*A34I
      VR12= VE00*(PQX*ABX+PQY*ABY+PQZ*ABZ)*TWO+VP1*ABX+VP2*ABY+VP3*ABZ
     *+(VE11*PQX+VE21*PQY+VE31*PQZ)/A1-(VE12*PQX+VE22*PQY+VE32*PQZ)/A2
     *+((VC12*A12I-(VC13+VC14)*A34I)/A1-(VC12*A12I-(VC23+VC24)*A34I)/A2)
     * *H
      VR34= VE00*(PQX*CDX+PQY*CDY+PQZ*CDZ)*TWO+VP1*CDX+VP2*CDY+VP3*CDZ
     *+(VE13*PQX+VE23*PQY+VE33*PQZ)/A3-(VE14*PQX+VE24*PQY+VE34*PQZ)/A4
     *+(((VC13+VC23)*A12I-VC34*A34I)/A3-((VC14+VC24)*A12I-VC34*A34I)/A4)
     * *H
      VP=VE00*VP+(VP1*PQX+VP2*PQY+VP3*PQZ)+H*(VC12*(A12I**2)-(VC13+VC14
     *+VC23+VC24)*A12I*A34I+VC34*(A34I**2))
      DEXX(I)=DEXX(I)-QA2**2*VP-S2*QA2*VR12
      DEXX(J)=DEXX(J)-QA2**2*VP+S1*QA2*VR12
      DEXX(K)=DEXX(K)-QA1**2*VP+S4*QA1*VR34
      DEXX(L)=DEXX(L)-QA1**2*VP-S3*QA1*VR34
      QVE00=QA*(VE00+VE00)
      DVEX=-(VE11+VE12)*QA2+(VE13+VE14)*QA1-PQX*QVE00
      DVEY=-(VE21+VE22)*QA2+(VE23+VE24)*QA1-PQY*QVE00
      DVEZ=-(VE31+VE32)*QA2+(VE33+VE34)*QA1-PQZ*QVE00
      DVEXS=DVEXS+DVEX
      DVEYS=DVEYS+DVEY
      DVEZS=DVEZS+DVEZ
C
C     SUMMATION OF CONTRIBUTIONS FROM THE UNCONTRACTED GAUSSIANS.
C
      FXK=FXK+DX2X-DVEX*S3
      FYK=FYK+DX2Y-DVEY*S3
      FZK=FZK+DX2Z-DVEZ*S3
 2004 CONTINUE
 2003 CONTINUE
      VEEXX=VEEXX+VE00S
      ABVE00=S12*(VE00S+VE00S)
      DX1X=-VE11S*S2+VE12S*S1-ABX*ABVE00
      DX1Y=-VE21S*S2+VE22S*S1-ABY*ABVE00
      DX1Z=-VE31S*S2+VE32S*S1-ABZ*ABVE00
      FXI=FXI+DX1X+DVEXS*S1
      FYI=FYI+DX1Y+DVEYS*S1
      FZI=FZI+DX1Z+DVEZS*S1
      FXJ=FXJ-DX1X+DVEXS*S2
      FYJ=FYJ-DX1Y+DVEYS*S2
      FZJ=FZJ-DX1Z+DVEZS*S2
 2002 CONTINUE
 2001 CONTINUE
      FXYZ(IATX)=FXYZ(IATX)+FXI
      FXYZ(JATX)=FXYZ(JATX)+FXJ
      FXYZ(KATX)=FXYZ(KATX)+FXK
      FXYZ(LATX)=FXYZ(LATX)-FXI-FXJ-FXK
      FXYZ(IATY)=FXYZ(IATY)+FYI
      FXYZ(JATY)=FXYZ(JATY)+FYJ
      FXYZ(KATY)=FXYZ(KATY)+FYK
      FXYZ(LATY)=FXYZ(LATY)-FYI-FYJ-FYK
      FXYZ(IATZ)=FXYZ(IATZ)+FZI
      FXYZ(JATZ)=FXYZ(JATZ)+FZJ
      FXYZ(KATZ)=FXYZ(KATZ)+FZK
      FXYZ(LATZ)=FXYZ(LATZ)-FZI-FZJ-FZK
 1004 CONTINUE
 1003 CONTINUE
 1002 CONTINUE
 1001 CONTINUE
      RETURN
      END
      SUBROUTINE FPPPPB
C*
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C#
C     PARAMETER (NB=#NB)
C     PARAMETER (NF=#NF)
C##
      PARAMETER (NB=200)
      PARAMETER (NF=120)
C###
      PARAMETER (NB2=NB*NB)
      PARAMETER (NF2=NF+2)
C
      COMMON/FFQB/FQ0,FQ1,FQ2,FQ3,FQ4,FQ5,AIJNDX(NB),
     1 FILL1(400,18),XE34(100),E(256)
      COMMON /FP4B/ QA,QA1,QA2,A12,A34I,A1234I,
     $ PQXX,PQYY,PQZZ,PQXY,PQXZ,PQYZ,
     *V0000,V0010,V0020,V0030,V0100,V0200,V0300,
     *V0110,V0120,V0130,V0210,V0220,V0230,V0310,V0320,V0330,
     *V1010,V1020,V1030,V2010,V2020,V2030,V3010,V3020,V3030,
     *V1000,V2000,V3000,V1100,V2100,V3100,V1200,V2200,V3200,
     *V1300,V2300,V3300,V1110,V2110,V3110,V1210,V2210,V3210,
     *V1310,V2310,V3310,V1120,V2120,V3120,V1220,V2220,V3220,
     *V1320,V2320,V3320,V1130,V2130,V3130,V1230,V2230,V3230,
     *V1330,V2330,V3330
      COMMON /FP4B/ C1110,C2110,C3110,C1210,C2210,C3210,
     *C1320,C2320,C3320,C1130,C2130,C3130,C1230,C2230,C3230,
     *C1310,C2310,C3310,C1120,C2120,C3120,C1220,C2220,C3220,
     *C1330,C2330,C3330,OPXO,OPYO,OPZO,OPOX,OPOY,OPOZ,OPXOX,OPYOY,OPZOZ,
     *OPXX,OPXY,OPXZ,OPYX,OPYY,OPYZ,OPZX,OPZY,OPZZ,OQXO,OQYO,OQZO,
     *OQOX,OQOY,OQOZ,OQXOX,OQYOY,OQZOZ,OQXX,OQXY,OQXZ,OQYX,OQYY,OQYZ,
     *OQZX,OQZY,OQZZ
      COMMON /FP4B/
     *GOOOO,GOOXO,GOOYO,GOOZO,GXOOO,GXOXO,GXOYO,GXOZO,GXXOO,GXXXO,GXXYO,
     *GXXZO,GXYOO,GXYZO,GXZOO,GYOOO,GYOYO,GYOZO,GYYOO,GYYXO,GYYYO,
     *GYYZO,GYZOO,GZOOO,GZOZO,GZZOO,GZZXO,GZZYO,GZZZO,
     *VE00,VE11,VE12,VE13,VE14,VE21,VE22,VE23,VE24,VE31,VE32,VE33,VE34,
     *CSSSP,CSSPP,CSPSP,CPSSP,CSPPP,CPSPP,CPPSP,CPPPP
      COMMON /FP4B/ VC12,VC13,VC14,VC23,VC24,VC34
      COMMON /FP4B/ VSSSP,VPSSP,VSPSP,VPPSP,VSSPP,VPSPP,VSPPP,VPPPP
      COMMON/FP4B/VCC(NF,NF2)
C
      DIMENSION FILL(NB2)
C
      EQUIVALENCE (FILL(1),FQ0)
      EQUIVALENCE (GXYOO,GYXOO)
      EQUIVALENCE (GXZOO,GZXOO)
      EQUIVALENCE (GYZOO,GZYOO)
      EQUIVALENCE (GYXXO,GXYXO,GXXYO)
      EQUIVALENCE (GZXXO,GXZXO,GXXZO)
      EQUIVALENCE (GZYYO,GYZYO,GYYZO)
      EQUIVALENCE (GXYYO,GYXYO,GYYXO)
      EQUIVALENCE (GXZZO,GZXZO,GZZXO)
      EQUIVALENCE (GYZZO,GZYZO,GZZYO)
      EQUIVALENCE (GXYZO,GYZXO,GZXYO,GZYXO,GYXZO,GXZYO)
      EQUIVALENCE (GYYXX,GYXYX,GYXXY,GXYYX,GXYXY,GXXYY)
      EQUIVALENCE (GZZXX,GZXZX,GZXXZ,GXZZX,GXZXZ,GXXZZ)
      EQUIVALENCE (GZZYY,GZYZY,GZYYZ,GYZZY,GYZYZ,GYYZZ)
      EQUIVALENCE (GYXXX,GXYXX,GXXYX,GXXXY)
      EQUIVALENCE (GZXXX,GXZXX,GXXZX,GXXXZ)
      EQUIVALENCE (GXYYY,GYXYY,GYYXY,GYYYX)
      EQUIVALENCE (GZYYY,GYZYY,GYYZY,GYYYZ)
      EQUIVALENCE (GXZZZ,GZXZZ,GZZXZ,GZZZX)
      EQUIVALENCE (GYZZZ,GZYZZ,GZZYZ,GZZZY)
      EQUIVALENCE (GXYZZ,GXZYZ,GXZZY,GYXZZ,GYZXZ,GYZZX,
     *             GZXYZ,GZXZY,GZYXZ,GZYZX,GZZXY,GZZYX)
      EQUIVALENCE (GYZXX,GYXZX,GYXXZ,GZYXX,GZXYX,GZXXY,
     *             GXYZX,GXYXZ,GXZYX,GXZXY,GXXYZ,GXXZY)
      EQUIVALENCE (GZXYY,GZYXY,GZYYX,GXZYY,GXYZY,GXYYZ,
     *             GYZXY,GYZYX,GYXZY,GYXYZ,GYYZX,GYYXZ)
C*
      DATA P25,H/0.25D0,0.5D0/
C*
      V0001=OQOX*GOOOO+GOOXO
      V0002=OQOY*GOOOO+GOOYO
      V0003=OQOZ*GOOOO+GOOZO
      VSSSP=    (V0001*E(  2)+V0002*E(  3)+V0003*E(  4))*CSSSP
      VE00=VE00+VSSSP
      TEMP=V0000*CSSSP
      VE14=TEMP*E(2)
      VE24=TEMP*E(3)
      VE34=TEMP*E(4)
      PTOQ=-A12*A34I
      PTOQS=PTOQ*PTOQ
      GOOXX=GXXOO*PTOQS
      GOOYY=GYYOO*PTOQS
      GOOZZ=GZZOO*PTOQS
      GOOXY=GXYOO*PTOQS
      GOOXZ=GXZOO*PTOQS
      GOOYZ=GYZOO*PTOQS
      V0011=OQXX*GOOOO+OQXOX*GOOXO+GOOXX
      V0022=OQYY*GOOOO+OQYOY*GOOYO+GOOYY
      V0033=OQZZ*GOOOO+OQZOZ*GOOZO+GOOZZ
      V0012=OQXY*GOOOO+OQXO*GOOYO+OQOY*GOOXO+GOOXY
      V0013=OQXZ*GOOOO+OQXO*GOOZO+OQOZ*GOOXO+GOOXZ
      V0021=OQYX*GOOOO+OQYO*GOOXO+OQOX*GOOYO+GOOXY
      V0023=OQYZ*GOOOO+OQYO*GOOZO+OQOZ*GOOYO+GOOYZ
      V0031=OQZX*GOOOO+OQZO*GOOXO+OQOX*GOOZO+GOOXZ
      V0032=OQZY*GOOOO+OQZO*GOOYO+OQOY*GOOZO+GOOYZ
      VSSPP=    (V0011*E(  6)+V0012*E(  7)+V0013*E(  8)
     *          +V0021*E( 10)+V0022*E( 11)+V0023*E( 12)
     *          +V0031*E( 14)+V0032*E( 15)+V0033*E( 16))*CSSPP
      VE00=VE00+VSSPP
      VE14=VE14+(V0010*E(6)+V0020*E(10)+V0030*E(14))*CSSPP
      VE24=VE24+(V0010*E(7)+V0020*E(11)+V0030*E(15))*CSSPP
      VE34=VE34+(V0010*E(8)+V0020*E(12)+V0030*E(16))*CSSPP
      VE13=VE13+(V0001*E(6)+V0002*E(7)+V0003*E(8))*CSSPP
      VE23=VE23+(V0001*E(10)+V0002*E(11)+V0003*E(12))*CSSPP
      VE33=VE33+(V0001*E(14)+V0002*E(15)+V0003*E(16))*CSSPP
      VC34=VC34+(V0000*(E(  6)+E( 11)+E( 16)))*CSSPP
      V0101=OQOX*V0100+OPOX*GOOXO+GXOXO
      V0102=OQOY*V0100+OPOX*GOOYO+GXOYO
      V0103=OQOZ*V0100+OPOX*GOOZO+GXOZO
      V0201=OQOX*V0200+OPOY*GOOXO+GXOYO
      V0202=OQOY*V0200+OPOY*GOOYO+GYOYO
      V0203=OQOZ*V0200+OPOY*GOOZO+GYOZO
      V0301=OQOX*V0300+OPOZ*GOOXO+GXOZO
      V0302=OQOY*V0300+OPOZ*GOOYO+GYOZO
      V0303=OQOZ*V0300+OPOZ*GOOZO+GZOZO
      VSPSP=    (V0101*E( 18)+V0102*E( 19)+V0103*E( 20)
     *          +V0201*E( 34)+V0202*E( 35)+V0203*E( 36)
     *          +V0301*E( 50)+V0302*E( 51)+V0303*E( 52))*CSPSP
      VE00=VE00+VSPSP
      VE14=VE14+(V0100*E(18)+V0200*E(34)+V0300*E(50))*CSPSP
      VE24=VE24+(V0100*E(19)+V0200*E(35)+V0300*E(51))*CSPSP
      VE34=VE34+(V0100*E(20)+V0200*E(36)+V0300*E(52))*CSPSP
      VE12=VE12+(V0001*E(18)+V0002*E(19)+V0003*E(20))*CSPSP
      VE22=VE22+(V0001*E(34)+V0002*E(35)+V0003*E(36))*CSPSP
      VE32=VE32+(V0001*E(50)+V0002*E(51)+V0003*E(52))*CSPSP
      VC24=VC24+(V0000*(E( 18)+E( 35)+E( 52)))*CSPSP
      V1001=OQOX*V1000+OPXO*GOOXO+GXOXO
      V1002=OQOY*V1000+OPXO*GOOYO+GXOYO
      V1003=OQOZ*V1000+OPXO*GOOZO+GXOZO
      V2001=OQOX*V2000+OPYO*GOOXO+GXOYO
      V2002=OQOY*V2000+OPYO*GOOYO+GYOYO
      V2003=OQOZ*V2000+OPYO*GOOZO+GYOZO
      V3001=OQOX*V3000+OPZO*GOOXO+GXOZO
      V3002=OQOY*V3000+OPZO*GOOYO+GYOZO
      V3003=OQOZ*V3000+OPZO*GOOZO+GZOZO
      VPSSP=    (V1001*E( 66)+V1002*E( 67)+V1003*E( 68)
     *          +V2001*E(130)+V2002*E(131)+V2003*E(132)
     *          +V3001*E(194)+V3002*E(195)+V3003*E(196))*CPSSP
      VE00=VE00+VPSSP
      VE14=VE14+(V1000*E(66)+V2000*E(130)+V3000*E(194))*CPSSP
      VE24=VE24+(V1000*E(67)+V2000*E(131)+V3000*E(195))*CPSSP
      VE34=VE34+(V1000*E(68)+V2000*E(132)+V3000*E(196))*CPSSP
      VE11=VE11+(V0001*E(66)+V0002*E(67)+V0003*E(68))*CPSSP
      VE21=VE21+(V0001*E(130)+V0002*E(131)+V0003*E(132))*CPSSP
      VE31=VE31+(V0001*E(194)+V0002*E(195)+V0003*E(196))*CPSSP
      VC14=VC14+(V0000*(E( 66)+E(131)+E(196)))*CPSSP
      V1101=OQOX*V1100+C1110
      V1102=OQOY*V1100+C1120
      V1103=OQOZ*V1100+C1130
      V1201=OQOX*V1200+C1210
      V1202=OQOY*V1200+C1220
      V1203=OQOZ*V1200+C1230
      V1301=OQOX*V1300+C1310
      V1302=OQOY*V1300+C1320
      V1303=OQOZ*V1300+C1330
      V2101=OQOX*V2100+C2110
      V2102=OQOY*V2100+C2120
      V2103=OQOZ*V2100+C2130
      V2201=OQOX*V2200+C2210
      V2202=OQOY*V2200+C2220
      V2203=OQOZ*V2200+C2230
      V2301=OQOX*V2300+C2310
      V2302=OQOY*V2300+C2320
      V2303=OQOZ*V2300+C2330
      V3101=OQOX*V3100+C3110
      V3102=OQOY*V3100+C3120
      V3103=OQOZ*V3100+C3130
      V3201=OQOX*V3200+C3210
      V3202=OQOY*V3200+C3220
      V3203=OQOZ*V3200+C3230
      V3301=OQOX*V3300+C3310
      V3302=OQOY*V3300+C3320
      V3303=OQOZ*V3300+C3330
      VPPSP=    (V1101*E( 82)+V1102*E( 83)+V1103*E( 84)
     *          +V1201*E( 98)+V1202*E( 99)+V1203*E(100)
     *          +V1301*E(114)+V1302*E(115)+V1303*E(116)
     *          +V2101*E(146)+V2102*E(147)+V2103*E(148)
     *          +V2201*E(162)+V2202*E(163)+V2203*E(164)
     *          +V2301*E(178)+V2302*E(179)+V2303*E(180)
     *          +V3101*E(210)+V3102*E(211)+V3103*E(212)
     *          +V3201*E(226)+V3202*E(227)+V3203*E(228)
     *          +V3301*E(242)+V3302*E(243)+V3303*E(244))*CPPSP
      VE00=VE00+VPPSP
      VE14=VE14+(V1100*E( 82)+V1200*E( 98)+V1300*E(114)
     *          +V2100*E(146)+V2200*E(162)+V2300*E(178)
     *          +V3100*E(210)+V3200*E(226)+V3300*E(242))*CPPSP
      VE24=VE24+(V1100*E( 83)+V1200*E( 99)+V1300*E(115)
     *          +V2100*E(147)+V2200*E(163)+V2300*E(179)
     *          +V3100*E(211)+V3200*E(227)+V3300*E(243))*CPPSP
      VE34=VE34+(V1100*E( 84)+V1200*E(100)+V1300*E(116)
     *          +V2100*E(148)+V2200*E(164)+V2300*E(180)
     *          +V3100*E(212)+V3200*E(228)+V3300*E(244))*CPPSP
      VE12=VE12+(V1001*E( 82)+V1002*E( 83)+V1003*E( 84)
     *          +V2001*E(146)+V2002*E(147)+V2003*E(148)
     *          +V3001*E(210)+V3002*E(211)+V3003*E(212))*CPPSP
      VE22=VE22+(V1001*E( 98)+V1002*E( 99)+V1003*E(100)
     *          +V2001*E(162)+V2002*E(163)+V2003*E(164)
     *          +V3001*E(226)+V3002*E(227)+V3003*E(228))*CPPSP
      VE32=VE32+(V1001*E(114)+V1002*E(115)+V1003*E(116)
     *          +V2001*E(178)+V2002*E(179)+V2003*E(180)
     *          +V3001*E(242)+V3002*E(243)+V3003*E(244))*CPPSP
      VE11=VE11+(V0101*E( 82)+V0102*E( 83)+V0103*E( 84)
     *          +V0201*E( 98)+V0202*E( 99)+V0203*E(100)
     *          +V0301*E(114)+V0302*E(115)+V0303*E(116))*CPPSP
      VE21=VE21+(V0101*E(146)+V0102*E(147)+V0103*E(148)
     *          +V0201*E(162)+V0202*E(163)+V0203*E(164)
     *          +V0301*E(178)+V0302*E(179)+V0303*E(180))*CPPSP
      VE31=VE31+(V0101*E(210)+V0102*E(211)+V0103*E(212)
     *          +V0201*E(226)+V0202*E(227)+V0203*E(228)
     *          +V0301*E(242)+V0302*E(243)+V0303*E(244))*CPPSP
      VC12=VC12+(V0001*(E( 82)+E(162)+E(242))
     *         + V0002*(E( 83)+E(163)+E(243))
     *         + V0003*(E( 84)+E(164)+E(244)))*CPPSP
      VC14=VC14+(V0100*(E( 82)+E(147)+E(212))
     *         + V0200*(E( 98)+E(163)+E(228))
     *         + V0300*(E(114)+E(179)+E(244)))*CPPSP
      VC24=VC24+(V1000*(E( 82)+E( 99)+E(116))
     *         + V2000*(E(146)+E(163)+E(180))
     *         + V3000*(E(210)+E(227)+E(244)))*CPPSP
      GXOYZ=GXYZO*PTOQ
      GXOXX=GXXXO*PTOQ
      GYOYY=GYYYO*PTOQ
      GZOZZ=GZZZO*PTOQ
      GYOXX=GXXYO*PTOQ
      GZOXX=GXXZO*PTOQ
      GXOYY=GYYXO*PTOQ
      GZOYY=GYYZO*PTOQ
      GXOZZ=GZZXO*PTOQ
      GYOZZ=GZZYO*PTOQ
      C1011=OQXX*GXOOO+OQXOX*GXOXO+GXOXX
      C1022=OQYY*GXOOO+OQYOY*GXOYO+GXOYY
      C1033=OQZZ*GXOOO+OQZOZ*GXOZO+GXOZZ
      C2011=OQXX*GYOOO+OQXOX*GXOYO+GYOXX
      C2022=OQYY*GYOOO+OQYOY*GYOYO+GYOYY
      C2033=OQZZ*GYOOO+OQZOZ*GYOZO+GYOZZ
      C3011=OQXX*GZOOO+OQXOX*GXOZO+GZOXX
      C3022=OQYY*GZOOO+OQYOY*GYOZO+GZOYY
      C3033=OQZZ*GZOOO+OQZOZ*GZOZO+GZOZZ
      C1012=OQXY*GXOOO+OQXO*GXOYO+OQOY*GXOXO+GYOXX
      C1013=OQXZ*GXOOO+OQXO*GXOZO+OQOZ*GXOXO+GZOXX
      C1021=OQYX*GXOOO+OQYO*GXOXO+OQOX*GXOYO+GYOXX
      C1023=OQYZ*GXOOO+OQYO*GXOZO+OQOZ*GXOYO+GXOYZ
      C1031=OQZX*GXOOO+OQZO*GXOXO+OQOX*GXOZO+GZOXX
      C1032=OQZY*GXOOO+OQZO*GXOYO+OQOY*GXOZO+GXOYZ
      C2012=OQXY*GYOOO+OQXO*GYOYO+OQOY*GXOYO+GXOYY
      C2013=OQXZ*GYOOO+OQXO*GYOZO+OQOZ*GXOYO+GXOYZ
      C2021=OQYX*GYOOO+OQYO*GXOYO+OQOX*GYOYO+GXOYY
      C2023=OQYZ*GYOOO+OQYO*GYOZO+OQOZ*GYOYO+GZOYY
      C2031=OQZX*GYOOO+OQZO*GXOYO+OQOX*GYOZO+GXOYZ
      C2032=OQZY*GYOOO+OQZO*GYOYO+OQOY*GYOZO+GZOYY
      C3012=OQXY*GZOOO+OQXO*GYOZO+OQOY*GXOZO+GXOYZ
      C3013=OQXZ*GZOOO+OQXO*GZOZO+OQOZ*GXOZO+GXOZZ
      C3021=OQYX*GZOOO+OQYO*GXOZO+OQOX*GYOZO+GXOYZ
      C3023=OQYZ*GZOOO+OQYO*GZOZO+OQOZ*GYOZO+GYOZZ
      C3031=OQZX*GZOOO+OQZO*GXOZO+OQOX*GZOZO+GXOZZ
      C3032=OQZY*GZOOO+OQZO*GYOZO+OQOY*GZOZO+GYOZZ
      V0111=OPOX*V0011+C1011
      V0112=OPOX*V0012+C1012
      V0113=OPOX*V0013+C1013
      V0121=OPOX*V0021+C1021
      V0122=OPOX*V0022+C1022
      V0123=OPOX*V0023+C1023
      V0131=OPOX*V0031+C1031
      V0132=OPOX*V0032+C1032
      V0133=OPOX*V0033+C1033
      V0211=OPOY*V0011+C2011
      V0212=OPOY*V0012+C2012
      V0213=OPOY*V0013+C2013
      V0221=OPOY*V0021+C2021
      V0222=OPOY*V0022+C2022
      V0223=OPOY*V0023+C2023
      V0231=OPOY*V0031+C2031
      V0232=OPOY*V0032+C2032
      V0233=OPOY*V0033+C2033
      V0311=OPOZ*V0011+C3011
      V0312=OPOZ*V0012+C3012
      V0313=OPOZ*V0013+C3013
      V0321=OPOZ*V0021+C3021
      V0322=OPOZ*V0022+C3022
      V0323=OPOZ*V0023+C3023
      V0331=OPOZ*V0031+C3031
      V0332=OPOZ*V0032+C3032
      V0333=OPOZ*V0033+C3033
      VSPPP=    (V0111*E( 22)+V0112*E( 23)+V0113*E( 24)
     *          +V0121*E( 26)+V0122*E( 27)+V0123*E( 28)
     *          +V0131*E( 30)+V0132*E( 31)+V0133*E( 32)
     *          +V0211*E( 38)+V0212*E( 39)+V0213*E( 40)
     *          +V0221*E( 42)+V0222*E( 43)+V0223*E( 44)
     *          +V0231*E( 46)+V0232*E( 47)+V0233*E( 48)
     *          +V0311*E( 54)+V0312*E( 55)+V0313*E( 56)
     *          +V0321*E( 58)+V0322*E( 59)+V0323*E( 60)
     *          +V0331*E( 62)+V0332*E( 63)+V0333*E( 64))*CSPPP
      VE00=VE00+VSPPP
      VE14=VE14+(V0110*E( 22)+V0120*E( 26)+V0130*E( 30)
     *          +V0210*E( 38)+V0220*E( 42)+V0230*E( 46)
     *          +V0310*E( 54)+V0320*E( 58)+V0330*E( 62))*CSPPP
      VE24=VE24+(V0110*E( 23)+V0120*E( 27)+V0130*E( 31)
     *          +V0210*E( 39)+V0220*E( 43)+V0230*E( 47)
     *          +V0310*E( 55)+V0320*E( 59)+V0330*E( 63))*CSPPP
      VE34=VE34+(V0110*E( 24)+V0120*E( 28)+V0130*E( 32)
     *          +V0210*E( 40)+V0220*E( 44)+V0230*E( 48)
     *          +V0310*E( 56)+V0320*E( 60)+V0330*E( 64))*CSPPP
      VE13=VE13+(V0101*E( 22)+V0102*E( 23)+V0103*E( 24)
     *          +V0201*E( 38)+V0202*E( 39)+V0203*E( 40)
     *          +V0301*E( 54)+V0302*E( 55)+V0303*E( 56))*CSPPP
      VE23=VE23+(V0101*E( 26)+V0102*E( 27)+V0103*E( 28)
     *          +V0201*E( 42)+V0202*E( 43)+V0203*E( 44)
     *          +V0301*E( 58)+V0302*E( 59)+V0303*E( 60))*CSPPP
      VE33=VE33+(V0101*E( 30)+V0102*E( 31)+V0103*E( 32)
     *          +V0201*E( 46)+V0202*E( 47)+V0203*E( 48)
     *          +V0301*E( 62)+V0302*E( 63)+V0303*E( 64))*CSPPP
      VE12=VE12+(V0011*E( 22)+V0012*E( 23)+V0013*E( 24)
     *          +V0021*E( 26)+V0022*E( 27)+V0023*E( 28)
     *          +V0031*E( 30)+V0032*E( 31)+V0033*E( 32))*CSPPP
      VE22=VE22+(V0011*E( 38)+V0012*E( 39)+V0013*E( 40)
     *          +V0021*E( 42)+V0022*E( 43)+V0023*E( 44)
     *          +V0031*E( 46)+V0032*E( 47)+V0033*E( 48))*CSPPP
      VE32=VE32+(V0011*E( 54)+V0012*E( 55)+V0013*E( 56)
     *          +V0021*E( 58)+V0022*E( 59)+V0023*E( 60)
     *          +V0031*E( 62)+V0032*E( 63)+V0033*E( 64))*CSPPP
      VC23=VC23+(V0001*(E( 22)+E( 42)+E( 62))
     *         + V0002*(E( 23)+E( 43)+E( 63))
     *         + V0003*(E( 24)+E( 44)+E( 64)))*CSPPP
      VC24=VC24+(V0010*(E( 22)+E( 39)+E( 56))
     *         + V0020*(E( 26)+E( 43)+E( 60))
     *         + V0030*(E( 30)+E( 47)+E( 64)))*CSPPP
      VC34=VC34+(V0100*(E( 22)+E( 27)+E( 32))
     *         + V0200*(E( 38)+E( 43)+E( 48))
     *         + V0300*(E( 54)+E( 59)+E( 64)))*CSPPP
      V1011=OPXO*V0011+C1011
      V1012=OPXO*V0012+C1012
      V1013=OPXO*V0013+C1013
      V1021=OPXO*V0021+C1021
      V1022=OPXO*V0022+C1022
      V1023=OPXO*V0023+C1023
      V1031=OPXO*V0031+C1031
      V1032=OPXO*V0032+C1032
      V1033=OPXO*V0033+C1033
      V2011=OPYO*V0011+C2011
      V2012=OPYO*V0012+C2012
      V2013=OPYO*V0013+C2013
      V2021=OPYO*V0021+C2021
      V2022=OPYO*V0022+C2022
      V2023=OPYO*V0023+C2023
      V2031=OPYO*V0031+C2031
      V2032=OPYO*V0032+C2032
      V2033=OPYO*V0033+C2033
      V3011=OPZO*V0011+C3011
      V3012=OPZO*V0012+C3012
      V3013=OPZO*V0013+C3013
      V3021=OPZO*V0021+C3021
      V3022=OPZO*V0022+C3022
      V3023=OPZO*V0023+C3023
      V3031=OPZO*V0031+C3031
      V3032=OPZO*V0032+C3032
      V3033=OPZO*V0033+C3033
      VPSPP=    (V1011*E( 70)+V1012*E( 71)+V1013*E( 72)
     *          +V1021*E( 74)+V1022*E( 75)+V1023*E( 76)
     *          +V1031*E( 78)+V1032*E( 79)+V1033*E( 80)
     *          +V2011*E(134)+V2012*E(135)+V2013*E(136)
     *          +V2021*E(138)+V2022*E(139)+V2023*E(140)
     *          +V2031*E(142)+V2032*E(143)+V2033*E(144)
     *          +V3011*E(198)+V3012*E(199)+V3013*E(200)
     *          +V3021*E(202)+V3022*E(203)+V3023*E(204)
     *          +V3031*E(206)+V3032*E(207)+V3033*E(208))*CPSPP
      VE00=VE00+VPSPP
      VE14=VE14+(V1010*E( 70)+V1020*E( 74)+V1030*E( 78)
     *          +V2010*E(134)+V2020*E(138)+V2030*E(142)
     *          +V3010*E(198)+V3020*E(202)+V3030*E(206))*CPSPP
      VE24=VE24+(V1010*E( 71)+V1020*E( 75)+V1030*E( 79)
     *          +V2010*E(135)+V2020*E(139)+V2030*E(143)
     *          +V3010*E(199)+V3020*E(203)+V3030*E(207))*CPSPP
      VE34=VE34+(V1010*E( 72)+V1020*E( 76)+V1030*E( 80)
     *          +V2010*E(136)+V2020*E(140)+V2030*E(144)
     *          +V3010*E(200)+V3020*E(204)+V3030*E(208))*CPSPP
      VE13=VE13+(V1001*E( 70)+V1002*E( 71)+V1003*E( 72)
     *          +V2001*E(134)+V2002*E(135)+V2003*E(136)
     *          +V3001*E(198)+V3002*E(199)+V3003*E(200))*CPSPP
      VE23=VE23+(V1001*E( 74)+V1002*E( 75)+V1003*E( 76)
     *          +V2001*E(138)+V2002*E(139)+V2003*E(140)
     *          +V3001*E(202)+V3002*E(203)+V3003*E(204))*CPSPP
      VE33=VE33+(V1001*E( 78)+V1002*E( 79)+V1003*E( 80)
     *          +V2001*E(142)+V2002*E(143)+V2003*E(144)
     *          +V3001*E(206)+V3002*E(207)+V3003*E(208))*CPSPP
      VE11=VE11+(V0011*E( 70)+V0012*E( 71)+V0013*E( 72)
     *          +V0021*E( 74)+V0022*E( 75)+V0023*E( 76)
     *          +V0031*E( 78)+V0032*E( 79)+V0033*E( 80))*CPSPP
      VE21=VE21+(V0011*E(134)+V0012*E(135)+V0013*E(136)
     *          +V0021*E(138)+V0022*E(139)+V0023*E(140)
     *          +V0031*E(142)+V0032*E(143)+V0033*E(144))*CPSPP
      VE31=VE31+(V0011*E(198)+V0012*E(199)+V0013*E(200)
     *          +V0021*E(202)+V0022*E(203)+V0023*E(204)
     *          +V0031*E(206)+V0032*E(207)+V0033*E(208))*CPSPP
      VC13=VC13+(V0001*(E( 70)+E(138)+E(206))
     *         + V0002*(E( 71)+E(139)+E(207))
     *         + V0003*(E( 72)+E(140)+E(208)))*CPSPP
      VC14=VC14+(V0010*(E( 70)+E(135)+E(200))
     *         + V0020*(E( 74)+E(139)+E(204))
     *         + V0030*(E( 78)+E(143)+E(208)))*CPSPP
      VC34=VC34+(V1000*(E( 70)+E( 75)+E( 80))
     *         + V2000*(E(134)+E(139)+E(144))
     *         + V3000*(E(198)+E(203)+E(208)))*CPSPP
      QFQ4=QA1*QA1*QA2*QA2*FQ4
      TEMP=A1234I*A1234I
      HFQ3=H*QA*FQ3*TEMP
      TFQ3=HFQ3+HFQ3+HFQ3
      SFQ3=TFQ3+TFQ3
      P25FQ2=P25*FQ2*TEMP
      P75FQ2=P25FQ2+P25FQ2+P25FQ2
      TEMP=PQXX*QFQ4
      GXXXX=PQXX*(TEMP-SFQ3)+P75FQ2
      GYXXX=PQXY*(TEMP-TFQ3)
      GZXXX=PQXZ*(TEMP-TFQ3)
      GZYXX=PQYZ*(TEMP-HFQ3)
      GYYXX=PQYY*(TEMP-HFQ3)-PQXX*HFQ3+P25FQ2
      TEMP=PQYY*QFQ4
      GYYYY=PQYY*(TEMP-SFQ3)+P75FQ2
      GXYYY=PQXY*(TEMP-TFQ3)
      GZYYY=PQYZ*(TEMP-TFQ3)
      GZXYY=PQXZ*(TEMP-HFQ3)
      GZZYY=PQZZ*(TEMP-HFQ3)-PQYY*HFQ3+P25FQ2
      TEMP=PQZZ*QFQ4
      GZZZZ=PQZZ*(TEMP-SFQ3)+P75FQ2
      GXZZZ=PQXZ*(TEMP-TFQ3)
      GYZZZ=PQYZ*(TEMP-TFQ3)
      GXYZZ=PQXY*(TEMP-HFQ3)
      GXXZZ=PQXX*(TEMP-HFQ3)-PQZZ*HFQ3+P25FQ2
 1111 VP4=(OPXX*V0011+OPXOX*C1011+OQXX*GXXOO
     1+OQXOX*GXXXO+GXXXX)*E( 86)
 1112 VP4=(OPXX*V0012+OPXOX*C1012+OQXY*GXXOO
     1+OQXO*GXXYO+OQOY*GXXXO+GXXXY)*E( 87)+VP4
 1113 VP4=(OPXX*V0013+OPXOX*C1013+OQXZ*GXXOO
     1+OQXO*GXXZO+OQOZ*GXXXO+GXXXZ)*E( 88)+VP4
 1121 VP4=(OPXX*V0021+OPXOX*C1021+OQYX*GXXOO
     1+OQYO*GXXXO+OQOX*GXXYO+GXXYX)*E( 90)+VP4
 1122 VP4=(OPXX*V0022+OPXOX*C1022+OQYY*GXXOO
     1+OQYOY*GXXYO+GXXYY)*E( 91)+VP4
 1123 VP4=(OPXX*V0023+OPXOX*C1023+OQYZ*GXXOO
     1+OQYO*GXXZO+OQOZ*GXXYO+GXXYZ)*E( 92)+VP4
 1131 VP4=(OPXX*V0031+OPXOX*C1031+OQZX*GXXOO
     1+OQZO*GXXXO+OQOX*GXXZO+GXXZX)*E( 94)+VP4
 1132 VP4=(OPXX*V0032+OPXOX*C1032+OQZY*GXXOO
     1+OQZO*GXXYO+OQOY*GXXZO+GXXZY)*E( 95)+VP4
 1133 VP4=(OPXX*V0033+OPXOX*C1033+OQZZ*GXXOO
     1+OQZOZ*GXXZO+GXXZZ)*E( 96)+VP4
 1211 VP4=(OPXY*V0011+OPXO*C2011+OPOY*C1011+OQXX*GXYOO
     1+OQXOX*GXYXO+GXYXX)*E(102)+VP4
 1212 VP4=(OPXY*V0012+OPXO*C2012+OPOY*C1012+OQXY*GXYOO
     1+OQXO*GXYYO+OQOY*GXYXO+GXYXY)*E(103)+VP4
 1213 VP4=(OPXY*V0013+OPXO*C2013+OPOY*C1013+OQXZ*GXYOO
     1+OQXO*GXYZO+OQOZ*GXYXO+GXYXZ)*E(104)+VP4
 1221 VP4=(OPXY*V0021+OPXO*C2021+OPOY*C1021+OQYX*GXYOO
     1+OQYO*GXYXO+OQOX*GXYYO+GXYYX)*E(106)+VP4
 1222 VP4=(OPXY*V0022+OPXO*C2022+OPOY*C1022+OQYY*GXYOO
     1+OQYOY*GXYYO+GXYYY)*E(107)+VP4
 1223 VP4=(OPXY*V0023+OPXO*C2023+OPOY*C1023+OQYZ*GXYOO
     1+OQYO*GXYZO+OQOZ*GXYYO+GXYYZ)*E(108)+VP4
 1231 VP4=(OPXY*V0031+OPXO*C2031+OPOY*C1031+OQZX*GXYOO
     1+OQZO*GXYXO+OQOX*GXYZO+GXYZX)*E(110)+VP4
 1232 VP4=(OPXY*V0032+OPXO*C2032+OPOY*C1032+OQZY*GXYOO
     1+OQZO*GXYYO+OQOY*GXYZO+GXYZY)*E(111)+VP4
 1233 VP4=(OPXY*V0033+OPXO*C2033+OPOY*C1033+OQZZ*GXYOO
     1+OQZOZ*GXYZO+GXYZZ)*E(112)+VP4
 1311 VP4=(OPXZ*V0011+OPXO*C3011+OPOZ*C1011+OQXX*GXZOO
     1+OQXOX*GXZXO+GXZXX)*E(118)+VP4
 1312 VP4=(OPXZ*V0012+OPXO*C3012+OPOZ*C1012+OQXY*GXZOO
     1+OQXO*GXZYO+OQOY*GXZXO+GXZXY)*E(119)+VP4
 1313 VP4=(OPXZ*V0013+OPXO*C3013+OPOZ*C1013+OQXZ*GXZOO
     1+OQXO*GXZZO+OQOZ*GXZXO+GXZXZ)*E(120)+VP4
 1321 VP4=(OPXZ*V0021+OPXO*C3021+OPOZ*C1021+OQYX*GXZOO
     1+OQYO*GXZXO+OQOX*GXZYO+GXZYX)*E(122)+VP4
 1322 VP4=(OPXZ*V0022+OPXO*C3022+OPOZ*C1022+OQYY*GXZOO
     1+OQYOY*GXZYO+GXZYY)*E(123)+VP4
 1323 VP4=(OPXZ*V0023+OPXO*C3023+OPOZ*C1023+OQYZ*GXZOO
     1+OQYO*GXZZO+OQOZ*GXZYO+GXZYZ)*E(124)+VP4
 1331 VP4=(OPXZ*V0031+OPXO*C3031+OPOZ*C1031+OQZX*GXZOO
     1+OQZO*GXZXO+OQOX*GXZZO+GXZZX)*E(126)+VP4
 1332 VP4=(OPXZ*V0032+OPXO*C3032+OPOZ*C1032+OQZY*GXZOO
     1+OQZO*GXZYO+OQOY*GXZZO+GXZZY)*E(127)+VP4
 1333 VP4=(OPXZ*V0033+OPXO*C3033+OPOZ*C1033+OQZZ*GXZOO
     1+OQZOZ*GXZZO+GXZZZ)*E(128)+VP4
 2111 VP4=(OPYX*V0011+OPYO*C1011+OPOX*C2011+OQXX*GYXOO
     1+OQXOX*GYXXO+GYXXX)*E(150)+VP4
 2112 VP4=(OPYX*V0012+OPYO*C1012+OPOX*C2012+OQXY*GYXOO
     1+OQXO*GYXYO+OQOY*GYXXO+GYXXY)*E(151)+VP4
 2113 VP4=(OPYX*V0013+OPYO*C1013+OPOX*C2013+OQXZ*GYXOO
     1+OQXO*GYXZO+OQOZ*GYXXO+GYXXZ)*E(152)+VP4
 2121 VP4=(OPYX*V0021+OPYO*C1021+OPOX*C2021+OQYX*GYXOO
     1+OQYO*GYXXO+OQOX*GYXYO+GYXYX)*E(154)+VP4
 2122 VP4=(OPYX*V0022+OPYO*C1022+OPOX*C2022+OQYY*GYXOO
     1+OQYOY*GYXYO+GYXYY)*E(155)+VP4
 2123 VP4=(OPYX*V0023+OPYO*C1023+OPOX*C2023+OQYZ*GYXOO
     1+OQYO*GYXZO+OQOZ*GYXYO+GYXYZ)*E(156)+VP4
 2131 VP4=(OPYX*V0031+OPYO*C1031+OPOX*C2031+OQZX*GYXOO
     1+OQZO*GYXXO+OQOX*GYXZO+GYXZX)*E(158)+VP4
 2132 VP4=(OPYX*V0032+OPYO*C1032+OPOX*C2032+OQZY*GYXOO
     1+OQZO*GYXYO+OQOY*GYXZO+GYXZY)*E(159)+VP4
 2133 VP4=(OPYX*V0033+OPYO*C1033+OPOX*C2033+OQZZ*GYXOO
     1+OQZOZ*GYXZO+GYXZZ)*E(160)+VP4
 2211 VP4=(OPYY*V0011+OPYOY*C2011+OQXX*GYYOO
     1+OQXOX*GYYXO+GYYXX)*E(166)+VP4
 2212 VP4=(OPYY*V0012+OPYOY*C2012+OQXY*GYYOO
     1+OQXO*GYYYO+OQOY*GYYXO+GYYXY)*E(167)+VP4
 2213 VP4=(OPYY*V0013+OPYOY*C2013+OQXZ*GYYOO
     1+OQXO*GYYZO+OQOZ*GYYXO+GYYXZ)*E(168)+VP4
 2221 VP4=(OPYY*V0021+OPYOY*C2021+OQYX*GYYOO
     1+OQYO*GYYXO+OQOX*GYYYO+GYYYX)*E(170)+VP4
 2222 VP4=(OPYY*V0022+OPYOY*C2022+OQYY*GYYOO
     1+OQYOY*GYYYO+GYYYY)*E(171)+VP4
 2223 VP4=(OPYY*V0023+OPYOY*C2023+OQYZ*GYYOO
     1+OQYO*GYYZO+OQOZ*GYYYO+GYYYZ)*E(172)+VP4
 2231 VP4=(OPYY*V0031+OPYOY*C2031+OQZX*GYYOO
     1+OQZO*GYYXO+OQOX*GYYZO+GYYZX)*E(174)+VP4
 2232 VP4=(OPYY*V0032+OPYOY*C2032+OQZY*GYYOO
     1+OQZO*GYYYO+OQOY*GYYZO+GYYZY)*E(175)+VP4
 2233 VP4=(OPYY*V0033+OPYOY*C2033+OQZZ*GYYOO
     1+OQZOZ*GYYZO+GYYZZ)*E(176)+VP4
 2311 VP4=(OPYZ*V0011+OPYO*C3011+OPOZ*C2011+OQXX*GYZOO
     1+OQXOX*GYZXO+GYZXX)*E(182)+VP4
 2312 VP4=(OPYZ*V0012+OPYO*C3012+OPOZ*C2012+OQXY*GYZOO
     1+OQXO*GYZYO+OQOY*GYZXO+GYZXY)*E(183)+VP4
 2313 VP4=(OPYZ*V0013+OPYO*C3013+OPOZ*C2013+OQXZ*GYZOO
     1+OQXO*GYZZO+OQOZ*GYZXO+GYZXZ)*E(184)+VP4
 2321 VP4=(OPYZ*V0021+OPYO*C3021+OPOZ*C2021+OQYX*GYZOO
     1+OQYO*GYZXO+OQOX*GYZYO+GYZYX)*E(186)+VP4
 2322 VP4=(OPYZ*V0022+OPYO*C3022+OPOZ*C2022+OQYY*GYZOO
     1+OQYOY*GYZYO+GYZYY)*E(187)+VP4
 2323 VP4=(OPYZ*V0023+OPYO*C3023+OPOZ*C2023+OQYZ*GYZOO
     1+OQYO*GYZZO+OQOZ*GYZYO+GYZYZ)*E(188)+VP4
 2331 VP4=(OPYZ*V0031+OPYO*C3031+OPOZ*C2031+OQZX*GYZOO
     1+OQZO*GYZXO+OQOX*GYZZO+GYZZX)*E(190)+VP4
 2332 VP4=(OPYZ*V0032+OPYO*C3032+OPOZ*C2032+OQZY*GYZOO
     1+OQZO*GYZYO+OQOY*GYZZO+GYZZY)*E(191)+VP4
 2333 VP4=(OPYZ*V0033+OPYO*C3033+OPOZ*C2033+OQZZ*GYZOO
     1+OQZOZ*GYZZO+GYZZZ)*E(192)+VP4
 3111 VP4=(OPZX*V0011+OPZO*C1011+OPOX*C3011+OQXX*GZXOO
     1+OQXOX*GZXXO+GZXXX)*E(214)+VP4
 3112 VP4=(OPZX*V0012+OPZO*C1012+OPOX*C3012+OQXY*GZXOO
     1+OQXO*GZXYO+OQOY*GZXXO+GZXXY)*E(215)+VP4
 3113 VP4=(OPZX*V0013+OPZO*C1013+OPOX*C3013+OQXZ*GZXOO
     1+OQXO*GZXZO+OQOZ*GZXXO+GZXXZ)*E(216)+VP4
 3121 VP4=(OPZX*V0021+OPZO*C1021+OPOX*C3021+OQYX*GZXOO
     1+OQYO*GZXXO+OQOX*GZXYO+GZXYX)*E(218)+VP4
 3122 VP4=(OPZX*V0022+OPZO*C1022+OPOX*C3022+OQYY*GZXOO
     1+OQYOY*GZXYO+GZXYY)*E(219)+VP4
 3123 VP4=(OPZX*V0023+OPZO*C1023+OPOX*C3023+OQYZ*GZXOO
     1+OQYO*GZXZO+OQOZ*GZXYO+GZXYZ)*E(220)+VP4
 3131 VP4=(OPZX*V0031+OPZO*C1031+OPOX*C3031+OQZX*GZXOO
     1+OQZO*GZXXO+OQOX*GZXZO+GZXZX)*E(222)+VP4
 3132 VP4=(OPZX*V0032+OPZO*C1032+OPOX*C3032+OQZY*GZXOO
     1+OQZO*GZXYO+OQOY*GZXZO+GZXZY)*E(223)+VP4
 3133 VP4=(OPZX*V0033+OPZO*C1033+OPOX*C3033+OQZZ*GZXOO
     1+OQZOZ*GZXZO+GZXZZ)*E(224)+VP4
 3211 VP4=(OPZY*V0011+OPZO*C2011+OPOY*C3011+OQXX*GZYOO
     1+OQXOX*GZYXO+GZYXX)*E(230)+VP4
 3212 VP4=(OPZY*V0012+OPZO*C2012+OPOY*C3012+OQXY*GZYOO
     1+OQXO*GZYYO+OQOY*GZYXO+GZYXY)*E(231)+VP4
 3213 VP4=(OPZY*V0013+OPZO*C2013+OPOY*C3013+OQXZ*GZYOO
     1+OQXO*GZYZO+OQOZ*GZYXO+GZYXZ)*E(232)+VP4
 3221 VP4=(OPZY*V0021+OPZO*C2021+OPOY*C3021+OQYX*GZYOO
     1+OQYO*GZYXO+OQOX*GZYYO+GZYYX)*E(234)+VP4
 3222 VP4=(OPZY*V0022+OPZO*C2022+OPOY*C3022+OQYY*GZYOO
     1+OQYOY*GZYYO+GZYYY)*E(235)+VP4
 3223 VP4=(OPZY*V0023+OPZO*C2023+OPOY*C3023+OQYZ*GZYOO
     1+OQYO*GZYZO+OQOZ*GZYYO+GZYYZ)*E(236)+VP4
 3231 VP4=(OPZY*V0031+OPZO*C2031+OPOY*C3031+OQZX*GZYOO
     1+OQZO*GZYXO+OQOX*GZYZO+GZYZX)*E(238)+VP4
 3232 VP4=(OPZY*V0032+OPZO*C2032+OPOY*C3032+OQZY*GZYOO
     1+OQZO*GZYYO+OQOY*GZYZO+GZYZY)*E(239)+VP4
 3233 VP4=(OPZY*V0033+OPZO*C2033+OPOY*C3033+OQZZ*GZYOO
     1+OQZOZ*GZYZO+GZYZZ)*E(240)+VP4
 3311 VP4=(OPZZ*V0011+OPZOZ*C3011+OQXX*GZZOO
     1+OQXOX*GZZXO+GZZXX)*E(246)+VP4
 3312 VP4=(OPZZ*V0012+OPZOZ*C3012+OQXY*GZZOO
     1+OQXO*GZZYO+OQOY*GZZXO+GZZXY)*E(247)+VP4
 3313 VP4=(OPZZ*V0013+OPZOZ*C3013+OQXZ*GZZOO
     1+OQXO*GZZZO+OQOZ*GZZXO+GZZXZ)*E(248)+VP4
 3321 VP4=(OPZZ*V0021+OPZOZ*C3021+OQYX*GZZOO
     1+OQYO*GZZXO+OQOX*GZZYO+GZZYX)*E(250)+VP4
 3322 VP4=(OPZZ*V0022+OPZOZ*C3022+OQYY*GZZOO
     1+OQYOY*GZZYO+GZZYY)*E(251)+VP4
 3323 VP4=(OPZZ*V0023+OPZOZ*C3023+OQYZ*GZZOO
     1+OQYO*GZZZO+OQOZ*GZZYO+GZZYZ)*E(252)+VP4
 3331 VP4=(OPZZ*V0031+OPZOZ*C3031+OQZX*GZZOO
     1+OQZO*GZZXO+OQOX*GZZZO+GZZZX)*E(254)+VP4
 3332 VP4=(OPZZ*V0032+OPZOZ*C3032+OQZY*GZZOO
     1+OQZO*GZZYO+OQOY*GZZZO+GZZZY)*E(255)+VP4
 3333 VP4=(OPZZ*V0033+OPZOZ*C3033+OQZZ*GZZOO
     1+OQZOZ*GZZZO+GZZZZ)*E(256)+VP4
      VPPPP=VP4*CPPPP
      VE00=VE00+VPPPP
      VE14=VE14+(V1110*E( 86)+V1120*E( 90)+V1130*E( 94)
     *          +V1210*E(102)+V1220*E(106)+V1230*E(110)
     *          +V1310*E(118)+V1320*E(122)+V1330*E(126)
     *          +V2110*E(150)+V2120*E(154)+V2130*E(158)
     *          +V2210*E(166)+V2220*E(170)+V2230*E(174)
     *          +V2310*E(182)+V2320*E(186)+V2330*E(190)
     *          +V3110*E(214)+V3120*E(218)+V3130*E(222)
     *          +V3210*E(230)+V3220*E(234)+V3230*E(238)
     *          +V3310*E(246)+V3320*E(250)+V3330*E(254))*CPPPP
      VE24=VE24+(V1110*E( 87)+V1120*E( 91)+V1130*E( 95)
     *          +V1210*E(103)+V1220*E(107)+V1230*E(111)
     *          +V1310*E(119)+V1320*E(123)+V1330*E(127)
     *          +V2110*E(151)+V2120*E(155)+V2130*E(159)
     *          +V2210*E(167)+V2220*E(171)+V2230*E(175)
     *          +V2310*E(183)+V2320*E(187)+V2330*E(191)
     *          +V3110*E(215)+V3120*E(219)+V3130*E(223)
     *          +V3210*E(231)+V3220*E(235)+V3230*E(239)
     *          +V3310*E(247)+V3320*E(251)+V3330*E(255))*CPPPP
      VE34=VE34+(V1110*E( 88)+V1120*E( 92)+V1130*E( 96)
     *          +V1210*E(104)+V1220*E(108)+V1230*E(112)
     *          +V1310*E(120)+V1320*E(124)+V1330*E(128)
     *          +V2110*E(152)+V2120*E(156)+V2130*E(160)
     *          +V2210*E(168)+V2220*E(172)+V2230*E(176)
     *          +V2310*E(184)+V2320*E(188)+V2330*E(192)
     *          +V3110*E(216)+V3120*E(220)+V3130*E(224)
     *          +V3210*E(232)+V3220*E(236)+V3230*E(240)
     *          +V3310*E(248)+V3320*E(252)+V3330*E(256))*CPPPP
      VE13=VE13+(V1101*E( 86)+V1102*E( 87)+V1103*E( 88)
     *          +V1201*E(102)+V1202*E(103)+V1203*E(104)
     *          +V1301*E(118)+V1302*E(119)+V1303*E(120)
     *          +V2101*E(150)+V2102*E(151)+V2103*E(152)
     *          +V2201*E(166)+V2202*E(167)+V2203*E(168)
     *          +V2301*E(182)+V2302*E(183)+V2303*E(184)
     *          +V3101*E(214)+V3102*E(215)+V3103*E(216)
     *          +V3201*E(230)+V3202*E(231)+V3203*E(232)
     *          +V3301*E(246)+V3302*E(247)+V3303*E(248))*CPPPP
      VE23=VE23+(V1101*E( 90)+V1102*E( 91)+V1103*E( 92)
     *          +V1201*E(106)+V1202*E(107)+V1203*E(108)
     *          +V1301*E(122)+V1302*E(123)+V1303*E(124)
     *          +V2101*E(154)+V2102*E(155)+V2103*E(156)
     *          +V2201*E(170)+V2202*E(171)+V2203*E(172)
     *          +V2301*E(186)+V2302*E(187)+V2303*E(188)
     *          +V3101*E(218)+V3102*E(219)+V3103*E(220)
     *          +V3201*E(234)+V3202*E(235)+V3203*E(236)
     *          +V3301*E(250)+V3302*E(251)+V3303*E(252))*CPPPP
      VE33=VE33+(V1101*E( 94)+V1102*E( 95)+V1103*E( 96)
     *          +V1201*E(110)+V1202*E(111)+V1203*E(112)
     *          +V1301*E(126)+V1302*E(127)+V1303*E(128)
     *          +V2101*E(158)+V2102*E(159)+V2103*E(160)
     *          +V2201*E(174)+V2202*E(175)+V2203*E(176)
     *          +V2301*E(190)+V2302*E(191)+V2303*E(192)
     *          +V3101*E(222)+V3102*E(223)+V3103*E(224)
     *          +V3201*E(238)+V3202*E(239)+V3203*E(240)
     *          +V3301*E(254)+V3302*E(255)+V3303*E(256))*CPPPP
      VE12=VE12+(V1011*E( 86)+V1012*E( 87)+V1013*E( 88)
     *          +V1021*E( 90)+V1022*E( 91)+V1023*E( 92)
     *          +V1031*E( 94)+V1032*E( 95)+V1033*E( 96)
     *          +V2011*E(150)+V2012*E(151)+V2013*E(152)
     *          +V2021*E(154)+V2022*E(155)+V2023*E(156)
     *          +V2031*E(158)+V2032*E(159)+V2033*E(160)
     *          +V3011*E(214)+V3012*E(215)+V3013*E(216)
     *          +V3021*E(218)+V3022*E(219)+V3023*E(220)
     *          +V3031*E(222)+V3032*E(223)+V3033*E(224))*CPPPP
      VE22=VE22+(V1011*E(102)+V1012*E(103)+V1013*E(104)
     *          +V1021*E(106)+V1022*E(107)+V1023*E(108)
     *          +V1031*E(110)+V1032*E(111)+V1033*E(112)
     *          +V2011*E(166)+V2012*E(167)+V2013*E(168)
     *          +V2021*E(170)+V2022*E(171)+V2023*E(172)
     *          +V2031*E(174)+V2032*E(175)+V2033*E(176)
     *          +V3011*E(230)+V3012*E(231)+V3013*E(232)
     *          +V3021*E(234)+V3022*E(235)+V3023*E(236)
     *          +V3031*E(238)+V3032*E(239)+V3033*E(240))*CPPPP
      VE32=VE32+(V1011*E(118)+V1012*E(119)+V1013*E(120)
     *          +V1021*E(122)+V1022*E(123)+V1023*E(124)
     *          +V1031*E(126)+V1032*E(127)+V1033*E(128)
     *          +V2011*E(182)+V2012*E(183)+V2013*E(184)
     *          +V2021*E(186)+V2022*E(187)+V2023*E(188)
     *          +V2031*E(190)+V2032*E(191)+V2033*E(192)
     *          +V3011*E(246)+V3012*E(247)+V3013*E(248)
     *          +V3021*E(250)+V3022*E(251)+V3023*E(252)
     *          +V3031*E(254)+V3032*E(255)+V3033*E(256))*CPPPP
      VE11=VE11+(V0111*E( 86)+V0112*E( 87)+V0113*E( 88)
     *          +V0121*E( 90)+V0122*E( 91)+V0123*E( 92)
     *          +V0131*E( 94)+V0132*E( 95)+V0133*E( 96)
     *          +V0211*E(102)+V0212*E(103)+V0213*E(104)
     *          +V0221*E(106)+V0222*E(107)+V0223*E(108)
     *          +V0231*E(110)+V0232*E(111)+V0233*E(112)
     *          +V0311*E(118)+V0312*E(119)+V0313*E(120)
     *          +V0321*E(122)+V0322*E(123)+V0323*E(124)
     *          +V0331*E(126)+V0332*E(127)+V0333*E(128))*CPPPP
      VE21=VE21+(V0111*E(150)+V0112*E(151)+V0113*E(152)
     *          +V0121*E(154)+V0122*E(155)+V0123*E(156)
     *          +V0131*E(158)+V0132*E(159)+V0133*E(160)
     *          +V0211*E(166)+V0212*E(167)+V0213*E(168)
     *          +V0221*E(170)+V0222*E(171)+V0223*E(172)
     *          +V0231*E(174)+V0232*E(175)+V0233*E(176)
     *          +V0311*E(182)+V0312*E(183)+V0313*E(184)
     *          +V0321*E(186)+V0322*E(187)+V0323*E(188)
     *          +V0331*E(190)+V0332*E(191)+V0333*E(192))*CPPPP
      VE31=VE31+(V0111*E(214)+V0112*E(215)+V0113*E(216)
     *          +V0121*E(218)+V0122*E(219)+V0123*E(220)
     *          +V0131*E(222)+V0132*E(223)+V0133*E(224)
     *          +V0211*E(230)+V0212*E(231)+V0213*E(232)
     *          +V0221*E(234)+V0222*E(235)+V0223*E(236)
     *          +V0231*E(238)+V0232*E(239)+V0233*E(240)
     *          +V0311*E(246)+V0312*E(247)+V0313*E(248)
     *          +V0321*E(250)+V0322*E(251)+V0323*E(252)
     *          +V0331*E(254)+V0332*E(255)+V0333*E(256))*CPPPP
      VC12=VC12+(V0011*(E( 86)+E(166)+E(246))
     *         + V0012*(E( 87)+E(167)+E(247))
     *         + V0013*(E( 88)+E(168)+E(248))
     *         + V0021*(E( 90)+E(170)+E(250))
     *         + V0022*(E( 91)+E(171)+E(251))
     *         + V0023*(E( 92)+E(172)+E(252))
     *         + V0031*(E( 94)+E(174)+E(254))
     *         + V0032*(E( 95)+E(175)+E(255))
     *         + V0033*(E( 96)+E(176)+E(256)))*CPPPP
      VC13=VC13+(V0101*(E( 86)+E(154)+E(222))
     *         + V0102*(E( 87)+E(155)+E(223))
     *         + V0103*(E( 88)+E(156)+E(224))
     *         + V0201*(E(102)+E(170)+E(238))
     *         + V0202*(E(103)+E(171)+E(239))
     *         + V0203*(E(104)+E(172)+E(240))
     *         + V0301*(E(118)+E(186)+E(254))
     *         + V0302*(E(119)+E(187)+E(255))
     *         + V0303*(E(120)+E(188)+E(256)))*CPPPP
      VC14=VC14+(V0110*(E( 86)+E(151)+E(216))
     *         + V0120*(E( 90)+E(155)+E(220))
     *         + V0130*(E( 94)+E(159)+E(224))
     *         + V0210*(E(102)+E(167)+E(232))
     *         + V0220*(E(106)+E(171)+E(236))
     *         + V0230*(E(110)+E(175)+E(240))
     *         + V0310*(E(118)+E(183)+E(248))
     *         + V0320*(E(122)+E(187)+E(252))
     *         + V0330*(E(126)+E(191)+E(256)))*CPPPP
      VC23=VC23+(V1001*(E( 86)+E(106)+E(126))
     *         + V1002*(E( 87)+E(107)+E(127))
     *         + V1003*(E( 88)+E(108)+E(128))
     *         + V2001*(E(150)+E(170)+E(190))
     *         + V2002*(E(151)+E(171)+E(191))
     *         + V2003*(E(152)+E(172)+E(192))
     *         + V3001*(E(214)+E(234)+E(254))
     *         + V3002*(E(215)+E(235)+E(255))
     *         + V3003*(E(216)+E(236)+E(256)))*CPPPP
      VC24=VC24+(V1010*(E( 86)+E(103)+E(120))
     *         + V1020*(E( 90)+E(107)+E(124))
     *         + V1030*(E( 94)+E(111)+E(128))
     *         + V2010*(E(150)+E(167)+E(184))
     *         + V2020*(E(154)+E(171)+E(188))
     *         + V2030*(E(158)+E(175)+E(192))
     *         + V3010*(E(214)+E(231)+E(248))
     *         + V3020*(E(218)+E(235)+E(252))
     *         + V3030*(E(222)+E(239)+E(256)))*CPPPP
      VC34=VC34+(V1100*(E( 86)+E( 91)+E( 96))
     *         + V1200*(E(102)+E(107)+E(112))
     *         + V1300*(E(118)+E(123)+E(128))
     *         + V2100*(E(150)+E(155)+E(160))
     *         + V2200*(E(166)+E(171)+E(176))
     *         + V2300*(E(182)+E(187)+E(192))
     *         + V3100*(E(214)+E(219)+E(224))
     *         + V3200*(E(230)+E(235)+E(240))
     *         + V3300*(E(246)+E(251)+E(256)))*CPPPP
      RETURN
      END
