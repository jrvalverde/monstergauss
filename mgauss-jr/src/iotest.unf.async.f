      COMMON /BUFF/ IBUFF(3200)
C
      OPEN (UNIT=1, BLOCKED=.FALSE., FORM='UNFORMATTED')
C
C     LOOP OVER BUFFERS.
C
      DO 500 I=1,500
C
C     INITIALIZE THE ARRAY.
C
      DO 100 J=1,3200
  100 IBUFF(J) = I + J
C
C     WRITE OUT THE ARRAY.
C
      CALL BUFFEROUT (1, 1, IBUFF, 3200)
      CALL M:WAIT (1)
  210 CALL STATUS (1, ISTAT, NBYTES)
      GO TO (210,300,900,910), ISTAT
C
  300 IF (NBYTES .NE. 12800) THEN
         WRITE (6,310) NBYTES, I
  310    FORMAT ('0*** NBYTES =',I6,' FOR I =',I5/)
         STOP
      END IF
C
  500 CONTINUE
C
      ENDFILE 1
      STOP
C
  900 STOP 900
  910 STOP 910
      END
